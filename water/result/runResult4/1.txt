偶然发现节点嵌入自适应算法和权重学习的算法结合起来效果不错，
于是做了一整套单因子实验，每个因子做5次取平均



ssh://root@172.17.171.8:22/home/s304/miniconda3/envs/ysj_torch/bin/python -u /media/s304/Data/yangsj/project/waveNet2/water/waterTrainSingle.py --aptonly --gcn_bool --addaptadj --randomadj --adjtype doubletransition --data data/water/shangban/singleFac/0 --adjdata data/water/shangban/adjs/adj_shangban2.pkl --device cuda:1 --in_dim 2 --epochs 10 --num_nodes 10 --seq_length 3
data::data/water/shangban/singleFac/0,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/0', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.2401982545852661
Validation loss decreased (inf --> 0.240198).  Saving model ...
Epoch:2,validate loss:0.20811794698238373
Validation loss decreased (0.240198 --> 0.208118).  Saving model ...
Epoch:3,validate loss:0.22915586829185486
Epoch:4,validate loss:0.21802447736263275
Epoch:5,validate loss:0.1921757161617279
Validation loss decreased (0.208118 --> 0.192176).  Saving model ...
Epoch:6,validate loss:0.1911250501871109
Validation loss decreased (0.192176 --> 0.191125).  Saving model ...
Epoch:7,validate loss:0.18968679010868073
Validation loss decreased (0.191125 --> 0.189687).  Saving model ...
Epoch:8,validate loss:0.19405125081539154
Epoch:9,validate loss:0.18375718593597412
Validation loss decreased (0.189687 --> 0.183757).  Saving model ...
Epoch:10,validate loss:0.1821976900100708
Validation loss decreased (0.183757 --> 0.182198).  Saving model ...
Epoch:11,validate loss:0.17865267395973206
Validation loss decreased (0.182198 --> 0.178653).  Saving model ...
Epoch:12,validate loss:0.18657757341861725
Epoch:13,validate loss:0.1755768358707428
Validation loss decreased (0.178653 --> 0.175577).  Saving model ...
Epoch:14,validate loss:0.1753370761871338
Validation loss decreased (0.175577 --> 0.175337).  Saving model ...
Epoch:15,validate loss:0.1809340864419937
Epoch:16,validate loss:0.18441233038902283
Epoch:17,validate loss:0.17427128553390503
Validation loss decreased (0.175337 --> 0.174271).  Saving model ...
Epoch:18,validate loss:0.1730588674545288
Validation loss decreased (0.174271 --> 0.173059).  Saving model ...
Epoch:19,validate loss:0.18164224922657013
Epoch:20,validate loss:0.17817460000514984
Epoch:21,validate loss:0.17461638152599335
Epoch:22,validate loss:0.1763741374015808
Epoch:23,validate loss:0.17984795570373535
Epoch:24,validate loss:0.17762717604637146
Epoch:25,validate loss:0.1739722043275833
Epoch:26,validate loss:0.17346860468387604
Epoch:27,validate loss:0.17104703187942505
Validation loss decreased (0.173059 --> 0.171047).  Saving model ...
Epoch:28,validate loss:0.18047916889190674
Epoch:29,validate loss:0.17193324863910675
Epoch:30,validate loss:0.16990363597869873
Validation loss decreased (0.171047 --> 0.169904).  Saving model ...
Epoch:31,validate loss:0.1660386621952057
Validation loss decreased (0.169904 --> 0.166039).  Saving model ...
Epoch:32,validate loss:0.16630250215530396
Epoch:33,validate loss:0.16448476910591125
Validation loss decreased (0.166039 --> 0.164485).  Saving model ...
Epoch:34,validate loss:0.17746078968048096
Epoch:35,validate loss:0.16610783338546753
Epoch:36,validate loss:0.1763990819454193
Epoch:37,validate loss:0.16666443645954132
Epoch:38,validate loss:0.16475149989128113
Epoch:39,validate loss:0.16384081542491913
Validation loss decreased (0.164485 --> 0.163841).  Saving model ...
Epoch:40,validate loss:0.16881315410137177
Epoch:41,validate loss:0.16599133610725403
Epoch:42,validate loss:0.16206884384155273
Validation loss decreased (0.163841 --> 0.162069).  Saving model ...
Epoch:43,validate loss:0.16299569606781006
Epoch:44,validate loss:0.17004549503326416
Epoch:45,validate loss:0.1657193899154663
Epoch:46,validate loss:0.1619272530078888
Validation loss decreased (0.162069 --> 0.161927).  Saving model ...
Epoch:47,validate loss:0.162420392036438
Epoch:48,validate loss:0.17085540294647217
Epoch:49,validate loss:0.17367514967918396
Epoch:50,validate loss:0.16000528633594513
Validation loss decreased (0.161927 --> 0.160005).  Saving model ...
Epoch:51,validate loss:0.15739651024341583
Validation loss decreased (0.160005 --> 0.157397).  Saving model ...
Epoch:52,validate loss:0.15655387938022614
Validation loss decreased (0.157397 --> 0.156554).  Saving model ...
Epoch:53,validate loss:0.16375616192817688
Epoch:54,validate loss:0.16077487170696259
Epoch:55,validate loss:0.15653660893440247
Validation loss decreased (0.156554 --> 0.156537).  Saving model ...
Epoch:56,validate loss:0.15652599930763245
Validation loss decreased (0.156537 --> 0.156526).  Saving model ...
Epoch:57,validate loss:0.16210734844207764
Epoch:58,validate loss:0.15786835551261902
Epoch:59,validate loss:0.16123709082603455
Epoch:60,validate loss:0.1563509702682495
Validation loss decreased (0.156526 --> 0.156351).  Saving model ...
Epoch:61,validate loss:0.1576836258172989
Epoch:62,validate loss:0.1573040634393692
Epoch:63,validate loss:0.16047169268131256
Epoch:64,validate loss:0.15814946591854095
Epoch:65,validate loss:0.15560157597064972
Validation loss decreased (0.156351 --> 0.155602).  Saving model ...
Epoch:66,validate loss:0.16404083371162415
Epoch:67,validate loss:0.15324659645557404
Validation loss decreased (0.155602 --> 0.153247).  Saving model ...
Epoch:68,validate loss:0.15807078778743744
Epoch:69,validate loss:0.15537123382091522
Epoch:70,validate loss:0.15227772295475006
Validation loss decreased (0.153247 --> 0.152278).  Saving model ...
Epoch:71,validate loss:0.1544000655412674
Epoch:72,validate loss:0.16112378239631653
Epoch:73,validate loss:0.15924058854579926
Epoch:74,validate loss:0.15475285053253174
Epoch:75,validate loss:0.16224922239780426
Epoch:76,validate loss:0.15221631526947021
Validation loss decreased (0.152278 --> 0.152216).  Saving model ...
Epoch:77,validate loss:0.15352000296115875
Epoch:78,validate loss:0.1531248390674591
Epoch:79,validate loss:0.1511821150779724
Validation loss decreased (0.152216 --> 0.151182).  Saving model ...
Epoch:80,validate loss:0.15746739506721497
Epoch:81,validate loss:0.15415482223033905
Epoch:82,validate loss:0.15384922921657562
Epoch:83,validate loss:0.15323598682880402
Epoch:84,validate loss:0.1510133594274521
Validation loss decreased (0.151182 --> 0.151013).  Saving model ...
Epoch:85,validate loss:0.1552692949771881
Epoch:86,validate loss:0.15522153675556183
Epoch:87,validate loss:0.15208549797534943
Epoch:88,validate loss:0.15150383114814758
Epoch:89,validate loss:0.15269716084003448
Epoch:90,validate loss:0.15579839050769806
Epoch:91,validate loss:0.150847390294075
Validation loss decreased (0.151013 --> 0.150847).  Saving model ...
Epoch:92,validate loss:0.15370266139507294
Epoch:93,validate loss:0.1530342847108841
Epoch:94,validate loss:0.15220174193382263
Epoch:95,validate loss:0.15331090986728668
Epoch:96,validate loss:0.15103210508823395
Epoch:97,validate loss:0.15579383075237274
Epoch:98,validate loss:0.15368801355361938
Epoch:99,validate loss:0.15009410679340363
Validation loss decreased (0.150847 --> 0.150094).  Saving model ...
Epoch:100,validate loss:0.1532502919435501
Epoch:101,validate loss:0.15738166868686676
Epoch:102,validate loss:0.15290731191635132
Epoch:103,validate loss:0.15736763179302216
Epoch:104,validate loss:0.1531485617160797
Epoch:105,validate loss:0.15257686376571655
Epoch:106,validate loss:0.15314175188541412
Epoch:107,validate loss:0.15277937054634094
Epoch:108,validate loss:0.15264834463596344
Epoch:109,validate loss:0.1512300819158554
Epoch:110,validate loss:0.16011859476566315
Epoch:111,validate loss:0.15407200157642365
Epoch:112,validate loss:0.1499275267124176
Validation loss decreased (0.150094 --> 0.149928).  Saving model ...
Epoch:113,validate loss:0.1528470367193222
Epoch:114,validate loss:0.15027745068073273
Epoch:115,validate loss:0.15171515941619873
Epoch:116,validate loss:0.15376073122024536
Epoch:117,validate loss:0.1566731184720993
Epoch:118,validate loss:0.1499835103750229
Epoch:119,validate loss:0.1493040770292282
Validation loss decreased (0.149928 --> 0.149304).  Saving model ...
Epoch:120,validate loss:0.15106679499149323
Epoch:121,validate loss:0.15019309520721436
Epoch:122,validate loss:0.15345361828804016
Epoch:123,validate loss:0.1537933498620987
Epoch:124,validate loss:0.15075957775115967
Epoch:125,validate loss:0.14953944087028503
Epoch:126,validate loss:0.14841721951961517
Validation loss decreased (0.149304 --> 0.148417).  Saving model ...
Epoch:127,validate loss:0.15656234323978424
Epoch:128,validate loss:0.1506296545267105
Epoch:129,validate loss:0.14985424280166626
Epoch:130,validate loss:0.1491907238960266
Epoch:131,validate loss:0.15501084923744202
Epoch:132,validate loss:0.15083234012126923
Epoch:133,validate loss:0.152528777718544
Epoch:134,validate loss:0.14945794641971588
Epoch:135,validate loss:0.15209612250328064
Epoch:136,validate loss:0.15101152658462524
Epoch:137,validate loss:0.1512274146080017
Epoch:138,validate loss:0.14864547550678253
Epoch:139,validate loss:0.15168096125125885
Epoch:140,validate loss:0.1552208662033081
Epoch:141,validate loss:0.14998120069503784
Epoch:142,validate loss:0.14857742190361023
Epoch:143,validate loss:0.14991557598114014
Epoch:144,validate loss:0.15695127844810486
Epoch:145,validate loss:0.147433802485466
Validation loss decreased (0.148417 --> 0.147434).  Saving model ...
Epoch:146,validate loss:0.15127146244049072
Epoch:147,validate loss:0.148603156208992
Epoch:148,validate loss:0.1530008614063263
Epoch:149,validate loss:0.15102297067642212
Epoch:150,validate loss:0.1565108597278595
Epoch:151,validate loss:0.15195892751216888
Epoch:152,validate loss:0.15149730443954468
Epoch:153,validate loss:0.1482999622821808
Epoch:154,validate loss:0.15318483114242554
Epoch:155,validate loss:0.15140467882156372
Epoch:156,validate loss:0.15270061790943146
Epoch:157,validate loss:0.1515035331249237
Epoch:158,validate loss:0.1508861929178238
Epoch:159,validate loss:0.15125808119773865
Epoch:160,validate loss:0.149391308426857
Epoch:161,validate loss:0.15018899738788605
Epoch:162,validate loss:0.15136942267417908
Epoch:163,validate loss:0.15549297630786896
Epoch:164,validate loss:0.15284691751003265
Epoch:165,validate loss:0.14782829582691193
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.961,avg=0.100
0.02753645,0.0003546959,0.0056372625,0.0016637691,0.0003546959,0.0014366981,0.0013026731,0.9610044,0.0003546959,0.0003546959,
0.36581895,0.002877423,0.0033419954,0.5938643,0.0041000578,0.002877423,0.002877423,0.008974646,0.002877423,0.012390369,
0.008459752,0.008459752,0.9238622,0.008459752,0.008459752,0.008459752,0.008459752,0.008459752,0.008459752,0.008459752,
0.003439718,0.003439718,0.66249746,0.003439718,0.004220902,0.30216292,0.010480357,0.003439718,0.003439718,0.003439718,
0.005062387,0.9267609,0.008302437,0.005062387,0.009657333,0.009470073,0.0050814277,0.0067784227,0.005062387,0.018762277,
0.0040380093,0.005440121,0.0017693577,0.0017693577,0.0017693577,0.48130244,0.49457085,0.0017693577,0.0017693577,0.005801705,
0.030963285,0.007539653,0.007539653,0.46687666,0.007539653,0.007539653,0.007539653,0.007539653,0.007539653,0.44938242,
0.017233599,0.055160742,0.0007635616,0.0031260524,0.8121272,0.0026356103,0.0021819647,0.10452916,0.00088330323,0.0013587722,
0.0005578845,0.0005578845,0.0005578845,0.692855,0.0005578845,0.0005578845,0.0017916766,0.0005578845,0.0005578845,0.3014482,
0.88844377,0.02318328,0.034160815,0.0077445707,0.0077445707,0.0077445707,0.0077445707,0.0077445707,0.0077445707,0.0077445707,
Evaluate model on site 1 , Test MAE: 0.1176, Test MAPE: 0.0186, Test RMSE: 0.2117
Evaluate model on site 2 , Test MAE: 0.1213, Test MAPE: 0.0187, Test RMSE: 0.1990
Evaluate model on site 3 , Test MAE: 0.1651, Test MAPE: 0.0275, Test RMSE: 0.3370
Evaluate model on site 4 , Test MAE: 0.1486, Test MAPE: 0.0208, Test RMSE: 0.2627
Evaluate model on site 5 , Test MAE: 0.1516, Test MAPE: 0.0249, Test RMSE: 0.2237
Evaluate model on site 6 , Test MAE: 0.1354, Test MAPE: 0.0235, Test RMSE: 0.2536
Evaluate model on site 7 , Test MAE: 0.1841, Test MAPE: 0.0278, Test RMSE: 0.2935
Evaluate model on site 8 , Test MAE: 0.1633, Test MAPE: 0.0255, Test RMSE: 0.3293
Evaluate model on site 9 , Test MAE: 0.1159, Test MAPE: 0.0169, Test RMSE: 0.2228
Evaluate model on site 10 , Test MAE: 0.1022, Test MAPE: 0.0145, Test RMSE: 0.1917
On average over all site, Test MAE: 0.1405, Test MAPE: 0.0219, Test RMSE: 0.2525
(0.14051945134997368, 0.021879681292921303, 0.252487313747406)
data::data/water/shangban/singleFac/0,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/0', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.25276872515678406
Validation loss decreased (inf --> 0.252769).  Saving model ...
Epoch:2,validate loss:0.20381534099578857
Validation loss decreased (0.252769 --> 0.203815).  Saving model ...
Epoch:3,validate loss:0.19894939661026
Validation loss decreased (0.203815 --> 0.198949).  Saving model ...
Epoch:4,validate loss:0.19528236985206604
Validation loss decreased (0.198949 --> 0.195282).  Saving model ...
Epoch:5,validate loss:0.19843286275863647
Epoch:6,validate loss:0.18732857704162598
Validation loss decreased (0.195282 --> 0.187329).  Saving model ...
Epoch:7,validate loss:0.18608252704143524
Validation loss decreased (0.187329 --> 0.186083).  Saving model ...
Epoch:8,validate loss:0.18726082146167755
Epoch:9,validate loss:0.18636010587215424
Epoch:10,validate loss:0.18559116125106812
Validation loss decreased (0.186083 --> 0.185591).  Saving model ...
Epoch:11,validate loss:0.19184726476669312
Epoch:12,validate loss:0.18307200074195862
Validation loss decreased (0.185591 --> 0.183072).  Saving model ...
Epoch:13,validate loss:0.1852322220802307
Epoch:14,validate loss:0.18076469004154205
Validation loss decreased (0.183072 --> 0.180765).  Saving model ...
Epoch:15,validate loss:0.1793883591890335
Validation loss decreased (0.180765 --> 0.179388).  Saving model ...
Epoch:16,validate loss:0.18300919234752655
Epoch:17,validate loss:0.18423962593078613
Epoch:18,validate loss:0.18998898565769196
Epoch:19,validate loss:0.1982966810464859
Epoch:20,validate loss:0.18051733076572418
Epoch:21,validate loss:0.1776673048734665
Validation loss decreased (0.179388 --> 0.177667).  Saving model ...
Epoch:22,validate loss:0.1770113706588745
Validation loss decreased (0.177667 --> 0.177011).  Saving model ...
Epoch:23,validate loss:0.18242032825946808
Epoch:24,validate loss:0.17463377118110657
Validation loss decreased (0.177011 --> 0.174634).  Saving model ...
Epoch:25,validate loss:0.17795544862747192
Epoch:26,validate loss:0.17835354804992676
Epoch:27,validate loss:0.17216899991035461
Validation loss decreased (0.174634 --> 0.172169).  Saving model ...
Epoch:28,validate loss:0.17189258337020874
Validation loss decreased (0.172169 --> 0.171893).  Saving model ...
Epoch:29,validate loss:0.17403994500637054
Epoch:30,validate loss:0.17401817440986633
Epoch:31,validate loss:0.1777743548154831
Epoch:32,validate loss:0.1781679391860962
Epoch:33,validate loss:0.16950760781764984
Validation loss decreased (0.171893 --> 0.169508).  Saving model ...
Epoch:34,validate loss:0.17341090738773346
Epoch:35,validate loss:0.1704934984445572
Epoch:36,validate loss:0.17423716187477112
Epoch:37,validate loss:0.16695952415466309
Validation loss decreased (0.169508 --> 0.166960).  Saving model ...
Epoch:38,validate loss:0.1778104305267334
Epoch:39,validate loss:0.1668202430009842
Validation loss decreased (0.166960 --> 0.166820).  Saving model ...
Epoch:40,validate loss:0.1680980771780014
Epoch:41,validate loss:0.16547556221485138
Validation loss decreased (0.166820 --> 0.165476).  Saving model ...
Epoch:42,validate loss:0.16998842358589172
Epoch:43,validate loss:0.17099858820438385
Epoch:44,validate loss:0.16615036129951477
Epoch:45,validate loss:0.16674290597438812
Epoch:46,validate loss:0.16666080057621002
Epoch:47,validate loss:0.1641027182340622
Validation loss decreased (0.165476 --> 0.164103).  Saving model ...
Epoch:48,validate loss:0.1618734747171402
Validation loss decreased (0.164103 --> 0.161873).  Saving model ...
Epoch:49,validate loss:0.16474470496177673
Epoch:50,validate loss:0.1638796329498291
Epoch:51,validate loss:0.16420452296733856
Epoch:52,validate loss:0.16630274057388306
Epoch:53,validate loss:0.15881913900375366
Validation loss decreased (0.161873 --> 0.158819).  Saving model ...
Epoch:54,validate loss:0.16043569147586823
Epoch:55,validate loss:0.1608213186264038
Epoch:56,validate loss:0.16530238091945648
Epoch:57,validate loss:0.17072691023349762
Epoch:58,validate loss:0.1578928530216217
Validation loss decreased (0.158819 --> 0.157893).  Saving model ...
Epoch:59,validate loss:0.17074814438819885
Epoch:60,validate loss:0.15898622572422028
Epoch:61,validate loss:0.16376817226409912
Epoch:62,validate loss:0.1602047085762024
Epoch:63,validate loss:0.16027328372001648
Epoch:64,validate loss:0.15844158828258514
Epoch:65,validate loss:0.16017654538154602
Epoch:66,validate loss:0.16140197217464447
Epoch:67,validate loss:0.15581853687763214
Validation loss decreased (0.157893 --> 0.155819).  Saving model ...
Epoch:68,validate loss:0.15738514065742493
Epoch:69,validate loss:0.16443271934986115
Epoch:70,validate loss:0.15702608227729797
Epoch:71,validate loss:0.16053850948810577
Epoch:72,validate loss:0.15751913189888
Epoch:73,validate loss:0.1563551127910614
Epoch:74,validate loss:0.15731602907180786
Epoch:75,validate loss:0.16122157871723175
Epoch:76,validate loss:0.1552211046218872
Validation loss decreased (0.155819 --> 0.155221).  Saving model ...
Epoch:77,validate loss:0.16089726984500885
Epoch:78,validate loss:0.15630298852920532
Epoch:79,validate loss:0.15612860023975372
Epoch:80,validate loss:0.15760400891304016
Epoch:81,validate loss:0.15661993622779846
Epoch:82,validate loss:0.15779320895671844
Epoch:83,validate loss:0.15593299269676208
Epoch:84,validate loss:0.15378473699092865
Validation loss decreased (0.155221 --> 0.153785).  Saving model ...
Epoch:85,validate loss:0.1549798995256424
Epoch:86,validate loss:0.15991392731666565
Epoch:87,validate loss:0.1594056785106659
Epoch:88,validate loss:0.15280959010124207
Validation loss decreased (0.153785 --> 0.152810).  Saving model ...
Epoch:89,validate loss:0.15440939366817474
Epoch:90,validate loss:0.15513338148593903
Epoch:91,validate loss:0.15460239350795746
Epoch:92,validate loss:0.15407101809978485
Epoch:93,validate loss:0.15644221007823944
Epoch:94,validate loss:0.15575896203517914
Epoch:95,validate loss:0.15545159578323364
Epoch:96,validate loss:0.1557130068540573
Epoch:97,validate loss:0.15437862277030945
Epoch:98,validate loss:0.15336264669895172
Epoch:99,validate loss:0.15635904669761658
Epoch:100,validate loss:0.1534045934677124
Epoch:101,validate loss:0.1537161022424698
Epoch:102,validate loss:0.15455739200115204
Epoch:103,validate loss:0.15363745391368866
Epoch:104,validate loss:0.15393780171871185
Epoch:105,validate loss:0.16267314553260803
Epoch:106,validate loss:0.1542208045721054
Epoch:107,validate loss:0.1527237743139267
Validation loss decreased (0.152810 --> 0.152724).  Saving model ...
Epoch:108,validate loss:0.15294866263866425
Epoch:109,validate loss:0.15060272812843323
Validation loss decreased (0.152724 --> 0.150603).  Saving model ...
Epoch:110,validate loss:0.15392538905143738
Epoch:111,validate loss:0.1557799130678177
Epoch:112,validate loss:0.16679538786411285
Epoch:113,validate loss:0.15497523546218872
Epoch:114,validate loss:0.15170320868492126
Epoch:115,validate loss:0.154321551322937
Epoch:116,validate loss:0.15243346989154816
Epoch:117,validate loss:0.15376076102256775
Epoch:118,validate loss:0.15466882288455963
Epoch:119,validate loss:0.15370261669158936
Epoch:120,validate loss:0.1513253152370453
Epoch:121,validate loss:0.1541607677936554
Epoch:122,validate loss:0.15257412195205688
Epoch:123,validate loss:0.15084080398082733
Epoch:124,validate loss:0.1503351926803589
Validation loss decreased (0.150603 --> 0.150335).  Saving model ...
Epoch:125,validate loss:0.15217679738998413
Epoch:126,validate loss:0.1529565453529358
Epoch:127,validate loss:0.1519215852022171
Epoch:128,validate loss:0.1495986133813858
Validation loss decreased (0.150335 --> 0.149599).  Saving model ...
Epoch:129,validate loss:0.15459315478801727
Epoch:130,validate loss:0.15063686668872833
Epoch:131,validate loss:0.1531524360179901
Epoch:132,validate loss:0.14971290528774261
Epoch:133,validate loss:0.15314076840877533
Epoch:134,validate loss:0.1532311737537384
Epoch:135,validate loss:0.15100382268428802
Epoch:136,validate loss:0.15191850066184998
Epoch:137,validate loss:0.1509002149105072
Epoch:138,validate loss:0.1540568768978119
Epoch:139,validate loss:0.1497674435377121
Epoch:140,validate loss:0.15001605451107025
Epoch:141,validate loss:0.14922191202640533
Validation loss decreased (0.149599 --> 0.149222).  Saving model ...
Epoch:142,validate loss:0.14823323488235474
Validation loss decreased (0.149222 --> 0.148233).  Saving model ...
Epoch:143,validate loss:0.15410350263118744
Epoch:144,validate loss:0.15417833626270294
Epoch:145,validate loss:0.14758355915546417
Validation loss decreased (0.148233 --> 0.147584).  Saving model ...
Epoch:146,validate loss:0.15092307329177856
Epoch:147,validate loss:0.15221375226974487
Epoch:148,validate loss:0.15021255612373352
Epoch:149,validate loss:0.14799897372722626
Epoch:150,validate loss:0.15168315172195435
Epoch:151,validate loss:0.14931462705135345
Epoch:152,validate loss:0.149790957570076
Epoch:153,validate loss:0.1512874960899353
Epoch:154,validate loss:0.1559663712978363
Epoch:155,validate loss:0.15120844542980194
Epoch:156,validate loss:0.15653523802757263
Epoch:157,validate loss:0.1506321281194687
Epoch:158,validate loss:0.1512681394815445
Epoch:159,validate loss:0.15113911032676697
Epoch:160,validate loss:0.1482374519109726
Epoch:161,validate loss:0.15003816783428192
Epoch:162,validate loss:0.14894206821918488
Epoch:163,validate loss:0.14788320660591125
Epoch:164,validate loss:0.1466861069202423
Validation loss decreased (0.147584 --> 0.146686).  Saving model ...
Epoch:165,validate loss:0.1477857530117035
Epoch:166,validate loss:0.15167109668254852
Epoch:167,validate loss:0.1522156298160553
Epoch:168,validate loss:0.14935795962810516
Epoch:169,validate loss:0.15669956803321838
Epoch:170,validate loss:0.1453225463628769
Validation loss decreased (0.146686 --> 0.145323).  Saving model ...
Epoch:171,validate loss:0.14846067130565643
Epoch:172,validate loss:0.15118803083896637
Epoch:173,validate loss:0.14898549020290375
Epoch:174,validate loss:0.14536015689373016
Epoch:175,validate loss:0.1494041234254837
Epoch:176,validate loss:0.1507682502269745
Epoch:177,validate loss:0.14656893908977509
Epoch:178,validate loss:0.147496297955513
Epoch:179,validate loss:0.14799799025058746
Epoch:180,validate loss:0.14689916372299194
Epoch:181,validate loss:0.1495729386806488
Epoch:182,validate loss:0.15310248732566833
Epoch:183,validate loss:0.1507490575313568
Epoch:184,validate loss:0.14972878992557526
Epoch:185,validate loss:0.14920251071453094
Epoch:186,validate loss:0.14854714274406433
Epoch:187,validate loss:0.14750030636787415
Epoch:188,validate loss:0.14947287738323212
Epoch:189,validate loss:0.1471826583147049
Epoch:190,validate loss:0.14959953725337982
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.934,avg=0.100
0.021932622,0.009052144,0.009052144,0.015578232,0.009172278,0.009052144,0.009052144,0.89900386,0.009052144,0.009052144,
0.8726149,0.012943202,0.012943202,0.012943202,0.023092894,0.012943202,0.012943202,0.012943202,0.013689715,0.012943202,
0.0064077685,0.0064077685,0.7985408,0.008400331,0.0064077685,0.0067141927,0.14789817,0.0064077685,0.0064077685,0.0064077685,
0.009383616,0.009383616,0.012398179,0.009383616,0.009383616,0.009383616,0.9083909,0.009383616,0.013172939,0.009736307,
2.9654706e-05,2.9654706e-05,0.00015271945,0.42657354,2.9654706e-05,2.9654706e-05,2.9654706e-05,2.9654706e-05,0.001005318,0.5720905,
0.0004169761,0.65255654,0.0026455382,0.32432333,0.00047146773,0.00043179787,0.0019932059,0.013970383,0.000674,0.0025166715,
0.006285114,0.006285114,0.006285114,0.008978617,0.006285114,0.006285114,0.00632163,0.012836895,0.006285114,0.9341522,
0.005584722,0.044223826,0.0025813703,0.0025813703,0.90388376,0.002725076,0.004121904,0.0025813703,0.0025813703,0.029135214,
0.010420013,0.010420013,0.010420013,0.036357336,0.014458924,0.010420013,0.010420013,0.010420013,0.023267943,0.86339575,
0.14771555,0.013681801,0.010771077,0.025673795,0.010771077,0.010771077,0.010771077,0.010771077,0.7483023,0.010771077,
Evaluate model on site 1 , Test MAE: 0.1143, Test MAPE: 0.0181, Test RMSE: 0.2197
Evaluate model on site 2 , Test MAE: 0.1223, Test MAPE: 0.0188, Test RMSE: 0.2029
Evaluate model on site 3 , Test MAE: 0.1634, Test MAPE: 0.0274, Test RMSE: 0.3484
Evaluate model on site 4 , Test MAE: 0.1504, Test MAPE: 0.0211, Test RMSE: 0.2688
Evaluate model on site 5 , Test MAE: 0.1445, Test MAPE: 0.0237, Test RMSE: 0.2167
Evaluate model on site 6 , Test MAE: 0.1347, Test MAPE: 0.0231, Test RMSE: 0.2525
Evaluate model on site 7 , Test MAE: 0.1759, Test MAPE: 0.0265, Test RMSE: 0.2776
Evaluate model on site 8 , Test MAE: 0.1506, Test MAPE: 0.0234, Test RMSE: 0.3159
Evaluate model on site 9 , Test MAE: 0.1092, Test MAPE: 0.0158, Test RMSE: 0.2150
Evaluate model on site 10 , Test MAE: 0.1042, Test MAPE: 0.0148, Test RMSE: 0.1879
On average over all site, Test MAE: 0.1369, Test MAPE: 0.0213, Test RMSE: 0.2505
(0.13694464787840843, 0.021270065940916537, 0.25054441690444945)
data::data/water/shangban/singleFac/0,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/0', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.2441728115081787
Validation loss decreased (inf --> 0.244173).  Saving model ...
Epoch:2,validate loss:0.214136004447937
Validation loss decreased (0.244173 --> 0.214136).  Saving model ...
Epoch:3,validate loss:0.20489837229251862
Validation loss decreased (0.214136 --> 0.204898).  Saving model ...
Epoch:4,validate loss:0.1990700513124466
Validation loss decreased (0.204898 --> 0.199070).  Saving model ...
Epoch:5,validate loss:0.1902431696653366
Validation loss decreased (0.199070 --> 0.190243).  Saving model ...
Epoch:6,validate loss:0.19795024394989014
Epoch:7,validate loss:0.1867869794368744
Validation loss decreased (0.190243 --> 0.186787).  Saving model ...
Epoch:8,validate loss:0.18569615483283997
Validation loss decreased (0.186787 --> 0.185696).  Saving model ...
Epoch:9,validate loss:0.18179605901241302
Validation loss decreased (0.185696 --> 0.181796).  Saving model ...
Epoch:10,validate loss:0.186038538813591
Epoch:11,validate loss:0.18119430541992188
Validation loss decreased (0.181796 --> 0.181194).  Saving model ...
Epoch:12,validate loss:0.17710496485233307
Validation loss decreased (0.181194 --> 0.177105).  Saving model ...
Epoch:13,validate loss:0.17815126478672028
Epoch:14,validate loss:0.18403582274913788
Epoch:15,validate loss:0.1789613664150238
Epoch:16,validate loss:0.17606395483016968
Validation loss decreased (0.177105 --> 0.176064).  Saving model ...
Epoch:17,validate loss:0.17953678965568542
Epoch:18,validate loss:0.17328108847141266
Validation loss decreased (0.176064 --> 0.173281).  Saving model ...
Epoch:19,validate loss:0.1744137555360794
Epoch:20,validate loss:0.17103393375873566
Validation loss decreased (0.173281 --> 0.171034).  Saving model ...
Epoch:21,validate loss:0.17046985030174255
Validation loss decreased (0.171034 --> 0.170470).  Saving model ...
Epoch:22,validate loss:0.1716006100177765
Epoch:23,validate loss:0.16952209174633026
Validation loss decreased (0.170470 --> 0.169522).  Saving model ...
Epoch:24,validate loss:0.16923841834068298
Validation loss decreased (0.169522 --> 0.169238).  Saving model ...
Epoch:25,validate loss:0.1705218106508255
Epoch:26,validate loss:0.16940757632255554
Epoch:27,validate loss:0.17476651072502136
Epoch:28,validate loss:0.16890369355678558
Validation loss decreased (0.169238 --> 0.168904).  Saving model ...
Epoch:29,validate loss:0.1703135222196579
Epoch:30,validate loss:0.1673046499490738
Validation loss decreased (0.168904 --> 0.167305).  Saving model ...
Epoch:31,validate loss:0.1711469143629074
Epoch:32,validate loss:0.17005053162574768
Epoch:33,validate loss:0.1670217663049698
Validation loss decreased (0.167305 --> 0.167022).  Saving model ...
Epoch:34,validate loss:0.16835570335388184
Epoch:35,validate loss:0.1671411544084549
Epoch:36,validate loss:0.16661348938941956
Validation loss decreased (0.167022 --> 0.166613).  Saving model ...
Epoch:37,validate loss:0.1698823869228363
Epoch:38,validate loss:0.16858497262001038
Epoch:39,validate loss:0.16663993895053864
Epoch:40,validate loss:0.16588692367076874
Validation loss decreased (0.166613 --> 0.165887).  Saving model ...
Epoch:41,validate loss:0.1670934110879898
Epoch:42,validate loss:0.1652897149324417
Validation loss decreased (0.165887 --> 0.165290).  Saving model ...
Epoch:43,validate loss:0.1629161536693573
Validation loss decreased (0.165290 --> 0.162916).  Saving model ...
Epoch:44,validate loss:0.16406750679016113
Epoch:45,validate loss:0.16291216015815735
Validation loss decreased (0.162916 --> 0.162912).  Saving model ...
Epoch:46,validate loss:0.1633290946483612
Epoch:47,validate loss:0.1624641865491867
Validation loss decreased (0.162912 --> 0.162464).  Saving model ...
Epoch:48,validate loss:0.16258616745471954
Epoch:49,validate loss:0.16110998392105103
Validation loss decreased (0.162464 --> 0.161110).  Saving model ...
Epoch:50,validate loss:0.16155113279819489
Epoch:51,validate loss:0.15891946852207184
Validation loss decreased (0.161110 --> 0.158919).  Saving model ...
Epoch:52,validate loss:0.16052663326263428
Epoch:53,validate loss:0.15883100032806396
Validation loss decreased (0.158919 --> 0.158831).  Saving model ...
Epoch:54,validate loss:0.15915384888648987
Epoch:55,validate loss:0.16376012563705444
Epoch:56,validate loss:0.15953615307807922
Epoch:57,validate loss:0.15966695547103882
Epoch:58,validate loss:0.15730473399162292
Validation loss decreased (0.158831 --> 0.157305).  Saving model ...
Epoch:59,validate loss:0.15937075018882751
Epoch:60,validate loss:0.15660220384597778
Validation loss decreased (0.157305 --> 0.156602).  Saving model ...
Epoch:61,validate loss:0.1590859442949295
Epoch:62,validate loss:0.1567572057247162
Epoch:63,validate loss:0.15747010707855225
Epoch:64,validate loss:0.158305361866951
Epoch:65,validate loss:0.15901048481464386
Epoch:66,validate loss:0.15642966330051422
Validation loss decreased (0.156602 --> 0.156430).  Saving model ...
Epoch:67,validate loss:0.16000258922576904
Epoch:68,validate loss:0.1621350198984146
Epoch:69,validate loss:0.1593603491783142
Epoch:70,validate loss:0.15657515823841095
Epoch:71,validate loss:0.15565672516822815
Validation loss decreased (0.156430 --> 0.155657).  Saving model ...
Epoch:72,validate loss:0.1575499325990677
Epoch:73,validate loss:0.1533431112766266
Validation loss decreased (0.155657 --> 0.153343).  Saving model ...
Epoch:74,validate loss:0.15457074344158173
Epoch:75,validate loss:0.15306256711483002
Validation loss decreased (0.153343 --> 0.153063).  Saving model ...
Epoch:76,validate loss:0.15260463953018188
Validation loss decreased (0.153063 --> 0.152605).  Saving model ...
Epoch:77,validate loss:0.15511305630207062
Epoch:78,validate loss:0.15360261499881744
Epoch:79,validate loss:0.15665210783481598
Epoch:80,validate loss:0.15309065580368042
Epoch:81,validate loss:0.15624231100082397
Epoch:82,validate loss:0.15149539709091187
Validation loss decreased (0.152605 --> 0.151495).  Saving model ...
Epoch:83,validate loss:0.15380500257015228
Epoch:84,validate loss:0.15307405591011047
Epoch:85,validate loss:0.15754634141921997
Epoch:86,validate loss:0.15378132462501526
Epoch:87,validate loss:0.15394042432308197
Epoch:88,validate loss:0.15488214790821075
Epoch:89,validate loss:0.15524522960186005
Epoch:90,validate loss:0.15995925664901733
Epoch:91,validate loss:0.15174302458763123
Epoch:92,validate loss:0.15234725177288055
Epoch:93,validate loss:0.15874698758125305
Epoch:94,validate loss:0.15079715847969055
Validation loss decreased (0.151495 --> 0.150797).  Saving model ...
Epoch:95,validate loss:0.15239837765693665
Epoch:96,validate loss:0.15131692588329315
Epoch:97,validate loss:0.1481916755437851
Validation loss decreased (0.150797 --> 0.148192).  Saving model ...
Epoch:98,validate loss:0.14968088269233704
Epoch:99,validate loss:0.1495109647512436
Epoch:100,validate loss:0.15134897828102112
Epoch:101,validate loss:0.15116123855113983
Epoch:102,validate loss:0.1517091989517212
Epoch:103,validate loss:0.15318676829338074
Epoch:104,validate loss:0.15267843008041382
Epoch:105,validate loss:0.15127049386501312
Epoch:106,validate loss:0.14924414455890656
Epoch:107,validate loss:0.1518288403749466
Epoch:108,validate loss:0.14966222643852234
Epoch:109,validate loss:0.15146300196647644
Epoch:110,validate loss:0.15145882964134216
Epoch:111,validate loss:0.15082326531410217
Epoch:112,validate loss:0.15201622247695923
Epoch:113,validate loss:0.14862032234668732
Epoch:114,validate loss:0.15056303143501282
Epoch:115,validate loss:0.1533201038837433
Epoch:116,validate loss:0.14954274892807007
Epoch:117,validate loss:0.14930947124958038
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.972,avg=0.100
0.00073339825,0.7833311,0.010888768,0.17604211,0.00072202145,0.0042911987,0.00072202145,0.00072202145,0.021770425,0.0007769468,
0.008483149,0.008483149,0.057383496,0.55712754,0.008483149,0.28128913,0.008483149,0.05330097,0.008483149,0.008483149,
0.0046653333,0.0046653333,0.0046653333,0.010807435,0.005249909,0.95100987,0.0046653333,0.0049407543,0.0046653333,0.0046653333,
0.0010673272,0.0010673272,0.0010673272,0.002966908,0.0010673272,0.0010673272,0.72884345,0.0010673272,0.0010673272,0.2607183,
0.00024149906,0.000352848,0.00032065774,0.00038293563,7.519732e-05,7.519732e-05,7.519732e-05,7.519732e-05,0.7800709,0.21833035,
0.011025077,0.38163605,0.023585813,0.008606081,0.5213034,0.010405606,0.008606081,0.008606081,0.01761968,0.008606081,
0.5117139,0.0076812585,0.4169663,0.0076812585,0.010428766,0.0076812585,0.014803578,0.0076812585,0.0076812585,0.0076812585,
0.0027621018,0.0026369235,0.9718076,0.0026369235,0.003125786,0.005205021,0.0026369235,0.0039149076,0.0026369235,0.0026369235,
0.00873044,0.0037474467,0.0037474467,0.953702,0.0037474467,0.008298289,0.0037474467,0.0067846747,0.0037474467,0.0037474467,
0.015075703,0.015075703,0.015075703,0.015075703,0.015075703,0.041513316,0.015075703,0.8378811,0.015075703,0.015075703,
Evaluate model on site 1 , Test MAE: 0.1191, Test MAPE: 0.0188, Test RMSE: 0.2229
Evaluate model on site 2 , Test MAE: 0.1295, Test MAPE: 0.0198, Test RMSE: 0.2091
Evaluate model on site 3 , Test MAE: 0.1630, Test MAPE: 0.0276, Test RMSE: 0.3435
Evaluate model on site 4 , Test MAE: 0.1486, Test MAPE: 0.0209, Test RMSE: 0.2660
Evaluate model on site 5 , Test MAE: 0.1559, Test MAPE: 0.0255, Test RMSE: 0.2281
Evaluate model on site 6 , Test MAE: 0.1319, Test MAPE: 0.0227, Test RMSE: 0.2466
Evaluate model on site 7 , Test MAE: 0.1864, Test MAPE: 0.0281, Test RMSE: 0.2900
Evaluate model on site 8 , Test MAE: 0.1628, Test MAPE: 0.0253, Test RMSE: 0.3376
Evaluate model on site 9 , Test MAE: 0.1074, Test MAPE: 0.0156, Test RMSE: 0.2107
Evaluate model on site 10 , Test MAE: 0.1065, Test MAPE: 0.0151, Test RMSE: 0.1986
On average over all site, Test MAE: 0.1411, Test MAPE: 0.0219, Test RMSE: 0.2553
(0.1411006473004818, 0.021949938591569663, 0.25531198382377623)
data::data/water/shangban/singleFac/0,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/0', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.30648714303970337
Validation loss decreased (inf --> 0.306487).  Saving model ...
Epoch:2,validate loss:0.21426096558570862
Validation loss decreased (0.306487 --> 0.214261).  Saving model ...
Epoch:3,validate loss:0.19565266370773315
Validation loss decreased (0.214261 --> 0.195653).  Saving model ...
Epoch:4,validate loss:0.1995319426059723
Epoch:5,validate loss:0.19326452910900116
Validation loss decreased (0.195653 --> 0.193265).  Saving model ...
Epoch:6,validate loss:0.20198476314544678
Epoch:7,validate loss:0.1941630095243454
Epoch:8,validate loss:0.18970206379890442
Validation loss decreased (0.193265 --> 0.189702).  Saving model ...
Epoch:9,validate loss:0.18958024680614471
Validation loss decreased (0.189702 --> 0.189580).  Saving model ...
Epoch:10,validate loss:0.21684877574443817
Epoch:11,validate loss:0.20202618837356567
Epoch:12,validate loss:0.19036820530891418
Epoch:13,validate loss:0.18633173406124115
Validation loss decreased (0.189580 --> 0.186332).  Saving model ...
Epoch:14,validate loss:0.1847553700208664
Validation loss decreased (0.186332 --> 0.184755).  Saving model ...
Epoch:15,validate loss:0.18019916117191315
Validation loss decreased (0.184755 --> 0.180199).  Saving model ...
Epoch:16,validate loss:0.17979037761688232
Validation loss decreased (0.180199 --> 0.179790).  Saving model ...
Epoch:17,validate loss:0.18597355484962463
Epoch:18,validate loss:0.18771152198314667
Epoch:19,validate loss:0.17542310059070587
Validation loss decreased (0.179790 --> 0.175423).  Saving model ...
Epoch:20,validate loss:0.17348112165927887
Validation loss decreased (0.175423 --> 0.173481).  Saving model ...
Epoch:21,validate loss:0.17192693054676056
Validation loss decreased (0.173481 --> 0.171927).  Saving model ...
Epoch:22,validate loss:0.17114655673503876
Validation loss decreased (0.171927 --> 0.171147).  Saving model ...
Epoch:23,validate loss:0.17536191642284393
Epoch:24,validate loss:0.1688394695520401
Validation loss decreased (0.171147 --> 0.168839).  Saving model ...
Epoch:25,validate loss:0.16896337270736694
Epoch:26,validate loss:0.17152519524097443
Epoch:27,validate loss:0.17130382359027863
Epoch:28,validate loss:0.1700805127620697
Epoch:29,validate loss:0.1786385029554367
Epoch:30,validate loss:0.16688579320907593
Validation loss decreased (0.168839 --> 0.166886).  Saving model ...
Epoch:31,validate loss:0.16492705047130585
Validation loss decreased (0.166886 --> 0.164927).  Saving model ...
Epoch:32,validate loss:0.18318378925323486
Epoch:33,validate loss:0.16611136496067047
Epoch:34,validate loss:0.16847538948059082
Epoch:35,validate loss:0.16625793278217316
Epoch:36,validate loss:0.16725270450115204
Epoch:37,validate loss:0.17793422937393188
Epoch:38,validate loss:0.1715812385082245
Epoch:39,validate loss:0.1618197113275528
Validation loss decreased (0.164927 --> 0.161820).  Saving model ...
Epoch:40,validate loss:0.16409306228160858
Epoch:41,validate loss:0.15941639244556427
Validation loss decreased (0.161820 --> 0.159416).  Saving model ...
Epoch:42,validate loss:0.16027435660362244
Epoch:43,validate loss:0.1726328581571579
Epoch:44,validate loss:0.169915109872818
Epoch:45,validate loss:0.15676873922348022
Validation loss decreased (0.159416 --> 0.156769).  Saving model ...
Epoch:46,validate loss:0.15598425269126892
Validation loss decreased (0.156769 --> 0.155984).  Saving model ...
Epoch:47,validate loss:0.15976254642009735
Epoch:48,validate loss:0.16418035328388214
Epoch:49,validate loss:0.1544996052980423
Validation loss decreased (0.155984 --> 0.154500).  Saving model ...
Epoch:50,validate loss:0.16158658266067505
Epoch:51,validate loss:0.15976972877979279
Epoch:52,validate loss:0.15957868099212646
Epoch:53,validate loss:0.15618743002414703
Epoch:54,validate loss:0.1564893126487732
Epoch:55,validate loss:0.15400302410125732
Validation loss decreased (0.154500 --> 0.154003).  Saving model ...
Epoch:56,validate loss:0.1542787104845047
Epoch:57,validate loss:0.1551859974861145
Epoch:58,validate loss:0.15510162711143494
Epoch:59,validate loss:0.1525188386440277
Validation loss decreased (0.154003 --> 0.152519).  Saving model ...
Epoch:60,validate loss:0.15537644922733307
Epoch:61,validate loss:0.15560764074325562
Epoch:62,validate loss:0.15261413156986237
Epoch:63,validate loss:0.15329279005527496
Epoch:64,validate loss:0.15530827641487122
Epoch:65,validate loss:0.151258185505867
Validation loss decreased (0.152519 --> 0.151258).  Saving model ...
Epoch:66,validate loss:0.15444092452526093
Epoch:67,validate loss:0.15468017756938934
Epoch:68,validate loss:0.1526317298412323
Epoch:69,validate loss:0.15585286915302277
Epoch:70,validate loss:0.15158610045909882
Epoch:71,validate loss:0.15158933401107788
Epoch:72,validate loss:0.15189652144908905
Epoch:73,validate loss:0.15140441060066223
Epoch:74,validate loss:0.152262344956398
Epoch:75,validate loss:0.1523996889591217
Epoch:76,validate loss:0.15629972517490387
Epoch:77,validate loss:0.14846834540367126
Validation loss decreased (0.151258 --> 0.148468).  Saving model ...
Epoch:78,validate loss:0.15020570158958435
Epoch:79,validate loss:0.1524428427219391
Epoch:80,validate loss:0.15229004621505737
Epoch:81,validate loss:0.15025018155574799
Epoch:82,validate loss:0.15030735731124878
Epoch:83,validate loss:0.14970944821834564
Epoch:84,validate loss:0.15122441947460175
Epoch:85,validate loss:0.14981691539287567
Epoch:86,validate loss:0.14958766102790833
Epoch:87,validate loss:0.1510118544101715
Epoch:88,validate loss:0.14995412528514862
Epoch:89,validate loss:0.14725755155086517
Validation loss decreased (0.148468 --> 0.147258).  Saving model ...
Epoch:90,validate loss:0.15334607660770416
Epoch:91,validate loss:0.1503576636314392
Epoch:92,validate loss:0.1543291211128235
Epoch:93,validate loss:0.15086790919303894
Epoch:94,validate loss:0.1474490910768509
Epoch:95,validate loss:0.14952746033668518
Epoch:96,validate loss:0.151657372713089
Epoch:97,validate loss:0.15151585638523102
Epoch:98,validate loss:0.1494322121143341
Epoch:99,validate loss:0.14888998866081238
Epoch:100,validate loss:0.14931294322013855
Epoch:101,validate loss:0.14702174067497253
Validation loss decreased (0.147258 --> 0.147022).  Saving model ...
Epoch:102,validate loss:0.15496040880680084
Epoch:103,validate loss:0.14760562777519226
Epoch:104,validate loss:0.14716051518917084
Epoch:105,validate loss:0.14830662310123444
Epoch:106,validate loss:0.1504114866256714
Epoch:107,validate loss:0.14711569249629974
Epoch:108,validate loss:0.14956830441951752
Epoch:109,validate loss:0.15151216089725494
Epoch:110,validate loss:0.15046009421348572
Epoch:111,validate loss:0.14861848950386047
Epoch:112,validate loss:0.14736443758010864
Epoch:113,validate loss:0.1533869355916977
Epoch:114,validate loss:0.15068252384662628
Epoch:115,validate loss:0.14572227001190186
Validation loss decreased (0.147022 --> 0.145722).  Saving model ...
Epoch:116,validate loss:0.14815662801265717
Epoch:117,validate loss:0.14854568243026733
Epoch:118,validate loss:0.14757512509822845
Epoch:119,validate loss:0.1461452841758728
Epoch:120,validate loss:0.14725805819034576
Epoch:121,validate loss:0.15150007605552673
Epoch:122,validate loss:0.14894534647464752
Epoch:123,validate loss:0.14902356266975403
Epoch:124,validate loss:0.15177428722381592
Epoch:125,validate loss:0.14950504899024963
Epoch:126,validate loss:0.14847931265830994
Epoch:127,validate loss:0.15056295692920685
Epoch:128,validate loss:0.1520400494337082
Epoch:129,validate loss:0.14981169998645782
Epoch:130,validate loss:0.1523292362689972
Epoch:131,validate loss:0.15336808562278748
Epoch:132,validate loss:0.15193933248519897
Epoch:133,validate loss:0.14845460653305054
Epoch:134,validate loss:0.14890672266483307
Epoch:135,validate loss:0.14899572730064392
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.939,avg=0.100
0.8096613,0.008650887,0.008650887,0.008650887,0.008650887,0.12079909,0.008983373,0.008650887,0.008650887,0.008650887,
0.0015331927,0.29644927,0.001669263,0.0011711994,0.0005319885,0.0005319885,0.024390578,0.6666828,0.0009418905,0.006097775,
0.05385013,0.05385013,0.05385013,0.32987666,0.05385013,0.05385013,0.05385013,0.23932227,0.05385013,0.05385013,
0.47463068,0.5174314,0.00013368964,0.0030438737,8.072476e-05,0.0016917426,0.0020074332,0.0008063897,9.332044e-05,8.072476e-05,
0.04096842,0.0018478071,0.9387873,0.010012469,0.002151724,0.0012464509,0.0012464509,0.0012464509,0.0012464509,0.0012464509,
0.068414055,0.7402353,0.015823064,0.068209186,0.011832125,0.018101173,0.034313828,0.011832125,0.011832125,0.019406976,
0.018443262,0.018443262,0.06912386,0.018443262,0.018443262,0.018443262,0.78315425,0.01861898,0.018443262,0.018443262,
0.0026125885,0.0026125885,0.0026125885,0.008284731,0.1554819,0.0071217595,0.2372624,0.0026125885,0.0026125885,0.5787863,
0.012971892,0.007810845,0.6891216,0.012386209,0.099843204,0.04099551,0.123636216,0.0030369316,0.0071606985,0.0030369316,
0.0034028525,0.0034028525,0.004719045,0.09190055,0.6801786,0.19556579,0.009294598,0.004729987,0.0034028525,0.0034028525,
Evaluate model on site 1 , Test MAE: 0.1210, Test MAPE: 0.0192, Test RMSE: 0.2215
Evaluate model on site 2 , Test MAE: 0.1266, Test MAPE: 0.0193, Test RMSE: 0.2086
Evaluate model on site 3 , Test MAE: 0.1618, Test MAPE: 0.0273, Test RMSE: 0.3423
Evaluate model on site 4 , Test MAE: 0.1513, Test MAPE: 0.0212, Test RMSE: 0.2711
Evaluate model on site 5 , Test MAE: 0.1480, Test MAPE: 0.0239, Test RMSE: 0.2226
Evaluate model on site 6 , Test MAE: 0.1361, Test MAPE: 0.0235, Test RMSE: 0.2549
Evaluate model on site 7 , Test MAE: 0.1839, Test MAPE: 0.0278, Test RMSE: 0.2927
Evaluate model on site 8 , Test MAE: 0.1553, Test MAPE: 0.0243, Test RMSE: 0.3173
Evaluate model on site 9 , Test MAE: 0.1180, Test MAPE: 0.0171, Test RMSE: 0.2236
Evaluate model on site 10 , Test MAE: 0.0992, Test MAPE: 0.0140, Test RMSE: 0.1873
On average over all site, Test MAE: 0.1401, Test MAPE: 0.0218, Test RMSE: 0.2542
(0.1401188664138317, 0.02176786810159683, 0.2541800871491432)
data::data/water/shangban/singleFac/0,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/0', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.26005831360816956
Validation loss decreased (inf --> 0.260058).  Saving model ...
Epoch:2,validate loss:0.22111420333385468
Validation loss decreased (0.260058 --> 0.221114).  Saving model ...
Epoch:3,validate loss:0.1979730725288391
Validation loss decreased (0.221114 --> 0.197973).  Saving model ...
Epoch:4,validate loss:0.20127606391906738
Epoch:5,validate loss:0.1891443133354187
Validation loss decreased (0.197973 --> 0.189144).  Saving model ...
Epoch:6,validate loss:0.18831299245357513
Validation loss decreased (0.189144 --> 0.188313).  Saving model ...
Epoch:7,validate loss:0.1882527768611908
Validation loss decreased (0.188313 --> 0.188253).  Saving model ...
Epoch:8,validate loss:0.18980827927589417
Epoch:9,validate loss:0.19256599247455597
Epoch:10,validate loss:0.18364137411117554
Validation loss decreased (0.188253 --> 0.183641).  Saving model ...
Epoch:11,validate loss:0.18862171471118927
Epoch:12,validate loss:0.18292850255966187
Validation loss decreased (0.183641 --> 0.182929).  Saving model ...
Epoch:13,validate loss:0.18718719482421875
Epoch:14,validate loss:0.18105681240558624
Validation loss decreased (0.182929 --> 0.181057).  Saving model ...
Epoch:15,validate loss:0.18049290776252747
Validation loss decreased (0.181057 --> 0.180493).  Saving model ...
Epoch:16,validate loss:0.17753277719020844
Validation loss decreased (0.180493 --> 0.177533).  Saving model ...
Epoch:17,validate loss:0.1910681277513504
Epoch:18,validate loss:0.17710305750370026
Validation loss decreased (0.177533 --> 0.177103).  Saving model ...
Epoch:19,validate loss:0.17669014632701874
Validation loss decreased (0.177103 --> 0.176690).  Saving model ...
Epoch:20,validate loss:0.17506800591945648
Validation loss decreased (0.176690 --> 0.175068).  Saving model ...
Epoch:21,validate loss:0.19072405993938446
Epoch:22,validate loss:0.1823512762784958
Epoch:23,validate loss:0.1734745055437088
Validation loss decreased (0.175068 --> 0.173475).  Saving model ...
Epoch:24,validate loss:0.17729060351848602
Epoch:25,validate loss:0.17200933396816254
Validation loss decreased (0.173475 --> 0.172009).  Saving model ...
Epoch:26,validate loss:0.1716771274805069
Validation loss decreased (0.172009 --> 0.171677).  Saving model ...
Epoch:27,validate loss:0.17581085860729218
Epoch:28,validate loss:0.17261536419391632
Epoch:29,validate loss:0.17036956548690796
Validation loss decreased (0.171677 --> 0.170370).  Saving model ...
Epoch:30,validate loss:0.17000193893909454
Validation loss decreased (0.170370 --> 0.170002).  Saving model ...
Epoch:31,validate loss:0.17998571693897247
Epoch:32,validate loss:0.16747048497200012
Validation loss decreased (0.170002 --> 0.167470).  Saving model ...
Epoch:33,validate loss:0.16778641939163208
Epoch:34,validate loss:0.16766710579395294
Epoch:35,validate loss:0.16345399618148804
Validation loss decreased (0.167470 --> 0.163454).  Saving model ...
Epoch:36,validate loss:0.16412268579006195
Epoch:37,validate loss:0.1616765856742859
Validation loss decreased (0.163454 --> 0.161677).  Saving model ...
Epoch:38,validate loss:0.16607502102851868
Epoch:39,validate loss:0.16035611927509308
Validation loss decreased (0.161677 --> 0.160356).  Saving model ...
Epoch:40,validate loss:0.1634754240512848
Epoch:41,validate loss:0.16476479172706604
Epoch:42,validate loss:0.1614464521408081
Epoch:43,validate loss:0.1600581556558609
Validation loss decreased (0.160356 --> 0.160058).  Saving model ...
Epoch:44,validate loss:0.1619969606399536
Epoch:45,validate loss:0.163164421916008
Epoch:46,validate loss:0.160125270485878
Epoch:47,validate loss:0.1613977998495102
Epoch:48,validate loss:0.15762779116630554
Validation loss decreased (0.160058 --> 0.157628).  Saving model ...
Epoch:49,validate loss:0.16019286215305328
Epoch:50,validate loss:0.15999218821525574
Epoch:51,validate loss:0.15856948494911194
Epoch:52,validate loss:0.15936261415481567
Epoch:53,validate loss:0.16064515709877014
Epoch:54,validate loss:0.1561141163110733
Validation loss decreased (0.157628 --> 0.156114).  Saving model ...
Epoch:55,validate loss:0.1572176069021225
Epoch:56,validate loss:0.15646757185459137
Epoch:57,validate loss:0.15664972364902496
Epoch:58,validate loss:0.15400773286819458
Validation loss decreased (0.156114 --> 0.154008).  Saving model ...
Epoch:59,validate loss:0.1548304706811905
Epoch:60,validate loss:0.15978562831878662
Epoch:61,validate loss:0.16583780944347382
Epoch:62,validate loss:0.15735651552677155
Epoch:63,validate loss:0.15723203122615814
Epoch:64,validate loss:0.15615762770175934
Epoch:65,validate loss:0.15886643528938293
Epoch:66,validate loss:0.15681174397468567
Epoch:67,validate loss:0.1604289412498474
Epoch:68,validate loss:0.15797552466392517
Epoch:69,validate loss:0.15663428604602814
Epoch:70,validate loss:0.15485233068466187
Epoch:71,validate loss:0.15492665767669678
Epoch:72,validate loss:0.1533849537372589
Validation loss decreased (0.154008 --> 0.153385).  Saving model ...
Epoch:73,validate loss:0.15632827579975128
Epoch:74,validate loss:0.15741217136383057
Epoch:75,validate loss:0.15281623601913452
Validation loss decreased (0.153385 --> 0.152816).  Saving model ...
Epoch:76,validate loss:0.15148255228996277
Validation loss decreased (0.152816 --> 0.151483).  Saving model ...
Epoch:77,validate loss:0.1560484915971756
Epoch:78,validate loss:0.15683266520500183
Epoch:79,validate loss:0.15305033326148987
Epoch:80,validate loss:0.1577126830816269
Epoch:81,validate loss:0.15278714895248413
Epoch:82,validate loss:0.15846380591392517
Epoch:83,validate loss:0.15154649317264557
Epoch:84,validate loss:0.15251748263835907
Epoch:85,validate loss:0.15191321074962616
Epoch:86,validate loss:0.1523056924343109
Epoch:87,validate loss:0.15300144255161285
Epoch:88,validate loss:0.1509629189968109
Validation loss decreased (0.151483 --> 0.150963).  Saving model ...
Epoch:89,validate loss:0.15429620444774628
Epoch:90,validate loss:0.15242666006088257
Epoch:91,validate loss:0.15159589052200317
Epoch:92,validate loss:0.1520702987909317
Epoch:93,validate loss:0.15285594761371613
Epoch:94,validate loss:0.1527731716632843
Epoch:95,validate loss:0.1530497819185257
Epoch:96,validate loss:0.15295785665512085
Epoch:97,validate loss:0.15047819912433624
Validation loss decreased (0.150963 --> 0.150478).  Saving model ...
Epoch:98,validate loss:0.15052613615989685
Epoch:99,validate loss:0.15103015303611755
Epoch:100,validate loss:0.15385249257087708
Epoch:101,validate loss:0.15095695853233337
Epoch:102,validate loss:0.15386877954006195
Epoch:103,validate loss:0.1508137732744217
Epoch:104,validate loss:0.14998950064182281
Validation loss decreased (0.150478 --> 0.149990).  Saving model ...
Epoch:105,validate loss:0.15003763139247894
Epoch:106,validate loss:0.14859594404697418
Validation loss decreased (0.149990 --> 0.148596).  Saving model ...
Epoch:107,validate loss:0.15392544865608215
Epoch:108,validate loss:0.15209738910198212
Epoch:109,validate loss:0.15168800950050354
Epoch:110,validate loss:0.15137925744056702
Epoch:111,validate loss:0.15185604989528656
Epoch:112,validate loss:0.15112142264842987
Epoch:113,validate loss:0.1493169069290161
Epoch:114,validate loss:0.14991408586502075
Epoch:115,validate loss:0.15199433267116547
Epoch:116,validate loss:0.14726108312606812
Validation loss decreased (0.148596 --> 0.147261).  Saving model ...
Epoch:117,validate loss:0.14793358743190765
Epoch:118,validate loss:0.1477474868297577
Epoch:119,validate loss:0.1504567414522171
Epoch:120,validate loss:0.14915427565574646
Epoch:121,validate loss:0.15008659660816193
Epoch:122,validate loss:0.15257655084133148
Epoch:123,validate loss:0.15103274583816528
Epoch:124,validate loss:0.148333340883255
Epoch:125,validate loss:0.15069738030433655
Epoch:126,validate loss:0.15036419034004211
Epoch:127,validate loss:0.14950796961784363
Epoch:128,validate loss:0.1491425484418869
Epoch:129,validate loss:0.15018846094608307
Epoch:130,validate loss:0.1499168425798416
Epoch:131,validate loss:0.15271857380867004
Epoch:132,validate loss:0.15294738113880157
Epoch:133,validate loss:0.15013138949871063
Epoch:134,validate loss:0.14970293641090393
Epoch:135,validate loss:0.14860865473747253
Epoch:136,validate loss:0.14856399595737457
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.966,avg=0.100
0.0018904903,0.5022336,0.017299263,0.41791117,0.0018904903,0.012063551,0.040528275,0.0024021426,0.0018904903,0.0018904903,
0.23350506,0.0072042593,0.009977263,0.027274115,0.68601805,0.0072042593,0.0072042593,0.0072042593,0.0072042593,0.0072042593,
0.008926543,0.008926543,0.008926543,0.008926543,0.80340934,0.008926543,0.008926543,0.008926543,0.114646584,0.019458199,
0.08012736,0.019672787,0.019672787,0.019672787,0.019672787,0.019672787,0.049353268,0.019672787,0.7303027,0.022180034,
0.003519431,0.2946819,0.019102197,0.003519431,0.008284988,0.003519431,0.6567612,0.003519431,0.0035726186,0.003519431,
0.003879431,0.008470948,0.008723743,0.003879431,0.017570358,0.3305211,0.3047144,0.3144817,0.003879431,0.003879431,
0.54321223,0.0025553298,0.0034254212,0.0025553298,0.0025553298,0.0025553298,0.0025553298,0.42930987,0.00872048,0.0025553298,
0.0004463544,0.006506515,0.029577933,0.8911802,0.0004463544,0.000511455,0.0004463544,0.06891352,0.0004463544,0.0015249567,
0.001969653,0.015742164,0.5494934,0.0025281922,0.001969653,0.001969653,0.002027344,0.42036062,0.001969653,0.001969653,
0.0038925547,0.0026586668,0.010214062,0.0032278,0.0026586668,0.0026586668,0.0026586668,0.9662497,0.0030782481,0.0027029298,
Evaluate model on site 1 , Test MAE: 0.1154, Test MAPE: 0.0183, Test RMSE: 0.2086
Evaluate model on site 2 , Test MAE: 0.1239, Test MAPE: 0.0189, Test RMSE: 0.2042
Evaluate model on site 3 , Test MAE: 0.1610, Test MAPE: 0.0271, Test RMSE: 0.3457
Evaluate model on site 4 , Test MAE: 0.1529, Test MAPE: 0.0214, Test RMSE: 0.2718
Evaluate model on site 5 , Test MAE: 0.1397, Test MAPE: 0.0228, Test RMSE: 0.2079
Evaluate model on site 6 , Test MAE: 0.1332, Test MAPE: 0.0229, Test RMSE: 0.2491
Evaluate model on site 7 , Test MAE: 0.1816, Test MAPE: 0.0274, Test RMSE: 0.2872
Evaluate model on site 8 , Test MAE: 0.1591, Test MAPE: 0.0248, Test RMSE: 0.3184
Evaluate model on site 9 , Test MAE: 0.1073, Test MAPE: 0.0155, Test RMSE: 0.2101
Evaluate model on site 10 , Test MAE: 0.1087, Test MAPE: 0.0154, Test RMSE: 0.2055
On average over all site, Test MAE: 0.1383, Test MAPE: 0.0215, Test RMSE: 0.2509
(0.1382823869585991, 0.02145479675382376, 0.2508559376001358)
[0.14051945134997368, 0.13694464787840843, 0.1411006473004818, 0.1401188664138317, 0.1382823869585991]
data::data/water/shangban/singleFac/1,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/1', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.6291416883468628
Validation loss decreased (inf --> 0.629142).  Saving model ...
Epoch:2,validate loss:0.518731415271759
Validation loss decreased (0.629142 --> 0.518731).  Saving model ...
Epoch:3,validate loss:0.5234007239341736
Epoch:4,validate loss:0.5371686816215515
Epoch:5,validate loss:0.48531046509742737
Validation loss decreased (0.518731 --> 0.485310).  Saving model ...
Epoch:6,validate loss:0.48505327105522156
Validation loss decreased (0.485310 --> 0.485053).  Saving model ...
Epoch:7,validate loss:0.48259851336479187
Validation loss decreased (0.485053 --> 0.482599).  Saving model ...
Epoch:8,validate loss:0.48276859521865845
Epoch:9,validate loss:0.504768967628479
Epoch:10,validate loss:0.48220545053482056
Validation loss decreased (0.482599 --> 0.482205).  Saving model ...
Epoch:11,validate loss:0.4877690374851227
Epoch:12,validate loss:0.4956444501876831
Epoch:13,validate loss:0.4721697270870209
Validation loss decreased (0.482205 --> 0.472170).  Saving model ...
Epoch:14,validate loss:0.48229140043258667
Epoch:15,validate loss:0.4614711403846741
Validation loss decreased (0.472170 --> 0.461471).  Saving model ...
Epoch:16,validate loss:0.46619799733161926
Epoch:17,validate loss:0.46106308698654175
Validation loss decreased (0.461471 --> 0.461063).  Saving model ...
Epoch:18,validate loss:0.46525439620018005
Epoch:19,validate loss:0.49236053228378296
Epoch:20,validate loss:0.4563840329647064
Validation loss decreased (0.461063 --> 0.456384).  Saving model ...
Epoch:21,validate loss:0.452486127614975
Validation loss decreased (0.456384 --> 0.452486).  Saving model ...
Epoch:22,validate loss:0.4607548415660858
Epoch:23,validate loss:0.4510977268218994
Validation loss decreased (0.452486 --> 0.451098).  Saving model ...
Epoch:24,validate loss:0.45520448684692383
Epoch:25,validate loss:0.4577350616455078
Epoch:26,validate loss:0.4565093219280243
Epoch:27,validate loss:0.45708000659942627
Epoch:28,validate loss:0.45944759249687195
Epoch:29,validate loss:0.4545655846595764
Epoch:30,validate loss:0.45303648710250854
Epoch:31,validate loss:0.45493948459625244
Epoch:32,validate loss:0.4563029706478119
Epoch:33,validate loss:0.45100927352905273
Validation loss decreased (0.451098 --> 0.451009).  Saving model ...
Epoch:34,validate loss:0.4492388367652893
Validation loss decreased (0.451009 --> 0.449239).  Saving model ...
Epoch:35,validate loss:0.45279547572135925
Epoch:36,validate loss:0.446394681930542
Validation loss decreased (0.449239 --> 0.446395).  Saving model ...
Epoch:37,validate loss:0.4394387900829315
Validation loss decreased (0.446395 --> 0.439439).  Saving model ...
Epoch:38,validate loss:0.4553191661834717
Epoch:39,validate loss:0.4496977627277374
Epoch:40,validate loss:0.4625649154186249
Epoch:41,validate loss:0.44801267981529236
Epoch:42,validate loss:0.46063485741615295
Epoch:43,validate loss:0.45919525623321533
Epoch:44,validate loss:0.43837571144104004
Validation loss decreased (0.439439 --> 0.438376).  Saving model ...
Epoch:45,validate loss:0.4518275260925293
Epoch:46,validate loss:0.4491290748119354
Epoch:47,validate loss:0.46166130900382996
Epoch:48,validate loss:0.46387147903442383
Epoch:49,validate loss:0.45504966378211975
Epoch:50,validate loss:0.4583093822002411
Epoch:51,validate loss:0.43320146203041077
Validation loss decreased (0.438376 --> 0.433201).  Saving model ...
Epoch:52,validate loss:0.43357163667678833
Epoch:53,validate loss:0.4404717981815338
Epoch:54,validate loss:0.4386003613471985
Epoch:55,validate loss:0.4327981472015381
Validation loss decreased (0.433201 --> 0.432798).  Saving model ...
Epoch:56,validate loss:0.4448409080505371
Epoch:57,validate loss:0.43905261158943176
Epoch:58,validate loss:0.43593528866767883
Epoch:59,validate loss:0.4367799460887909
Epoch:60,validate loss:0.43626365065574646
Epoch:61,validate loss:0.4356478452682495
Epoch:62,validate loss:0.4405114948749542
Epoch:63,validate loss:0.4355824887752533
Epoch:64,validate loss:0.44379299879074097
Epoch:65,validate loss:0.4355652928352356
Epoch:66,validate loss:0.42946410179138184
Validation loss decreased (0.432798 --> 0.429464).  Saving model ...
Epoch:67,validate loss:0.43206432461738586
Epoch:68,validate loss:0.4347247779369354
Epoch:69,validate loss:0.4386805593967438
Epoch:70,validate loss:0.45420458912849426
Epoch:71,validate loss:0.42888638377189636
Validation loss decreased (0.429464 --> 0.428886).  Saving model ...
Epoch:72,validate loss:0.44205108284950256
Epoch:73,validate loss:0.42278531193733215
Validation loss decreased (0.428886 --> 0.422785).  Saving model ...
Epoch:74,validate loss:0.422127366065979
Validation loss decreased (0.422785 --> 0.422127).  Saving model ...
Epoch:75,validate loss:0.4296717643737793
Epoch:76,validate loss:0.43382272124290466
Epoch:77,validate loss:0.43271684646606445
Epoch:78,validate loss:0.43645143508911133
Epoch:79,validate loss:0.42858654260635376
Epoch:80,validate loss:0.43255582451820374
Epoch:81,validate loss:0.44346335530281067
Epoch:82,validate loss:0.42563167214393616
Epoch:83,validate loss:0.43019887804985046
Epoch:84,validate loss:0.4258768856525421
Epoch:85,validate loss:0.43038612604141235
Epoch:86,validate loss:0.42147067189216614
Validation loss decreased (0.422127 --> 0.421471).  Saving model ...
Epoch:87,validate loss:0.43450218439102173
Epoch:88,validate loss:0.4171363413333893
Validation loss decreased (0.421471 --> 0.417136).  Saving model ...
Epoch:89,validate loss:0.4370430111885071
Epoch:90,validate loss:0.42330440878868103
Epoch:91,validate loss:0.4180023968219757
Epoch:92,validate loss:0.4177400469779968
Epoch:93,validate loss:0.42576608061790466
Epoch:94,validate loss:0.4202338457107544
Epoch:95,validate loss:0.4146672189235687
Validation loss decreased (0.417136 --> 0.414667).  Saving model ...
Epoch:96,validate loss:0.4249885678291321
Epoch:97,validate loss:0.43122217059135437
Epoch:98,validate loss:0.4168781638145447
Epoch:99,validate loss:0.42299365997314453
Epoch:100,validate loss:0.4179880917072296
Epoch:101,validate loss:0.41717442870140076
Epoch:102,validate loss:0.4125434458255768
Validation loss decreased (0.414667 --> 0.412543).  Saving model ...
Epoch:103,validate loss:0.4247533082962036
Epoch:104,validate loss:0.4155052900314331
Epoch:105,validate loss:0.4256339371204376
Epoch:106,validate loss:0.4107358753681183
Validation loss decreased (0.412543 --> 0.410736).  Saving model ...
Epoch:107,validate loss:0.41951945424079895
Epoch:108,validate loss:0.41985970735549927
Epoch:109,validate loss:0.40890631079673767
Validation loss decreased (0.410736 --> 0.408906).  Saving model ...
Epoch:110,validate loss:0.41533035039901733
Epoch:111,validate loss:0.41489526629447937
Epoch:112,validate loss:0.4143073260784149
Epoch:113,validate loss:0.41524964570999146
Epoch:114,validate loss:0.41414374113082886
Epoch:115,validate loss:0.4119186997413635
Epoch:116,validate loss:0.4176824390888214
Epoch:117,validate loss:0.41020116209983826
Epoch:118,validate loss:0.41594797372817993
Epoch:119,validate loss:0.41916659474372864
Epoch:120,validate loss:0.4276535212993622
Epoch:121,validate loss:0.41695138812065125
Epoch:122,validate loss:0.41172024607658386
Epoch:123,validate loss:0.4277923107147217
Epoch:124,validate loss:0.41136011481285095
Epoch:125,validate loss:0.41243046522140503
Epoch:126,validate loss:0.4060460329055786
Validation loss decreased (0.408906 --> 0.406046).  Saving model ...
Epoch:127,validate loss:0.4094322919845581
Epoch:128,validate loss:0.4106748402118683
Epoch:129,validate loss:0.4182274639606476
Epoch:130,validate loss:0.4178490936756134
Epoch:131,validate loss:0.41857782006263733
Epoch:132,validate loss:0.4109170734882355
Epoch:133,validate loss:0.424937903881073
Epoch:134,validate loss:0.411282479763031
Epoch:135,validate loss:0.42173731327056885
Epoch:136,validate loss:0.4163265824317932
Epoch:137,validate loss:0.41240841150283813
Epoch:138,validate loss:0.4097934365272522
Epoch:139,validate loss:0.4142315089702606
Epoch:140,validate loss:0.42297661304473877
Epoch:141,validate loss:0.41589900851249695
Epoch:142,validate loss:0.4109210669994354
Epoch:143,validate loss:0.40714097023010254
Epoch:144,validate loss:0.41743674874305725
Epoch:145,validate loss:0.40845879912376404
Epoch:146,validate loss:0.4104726314544678
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.798,avg=0.100
4.4068118e-05,4.4068118e-05,0.06322438,0.00022040405,4.4068118e-05,4.4068118e-05,0.7399988,0.00056152756,0.19577447,4.4068118e-05,
0.00018560948,0.00018560948,0.00018560948,0.11048471,0.00018560948,0.013997318,0.40278614,0.47146326,0.0003405969,0.00018560948,
0.34267506,0.0015369549,0.0017091036,0.02275386,0.40294287,0.0015369549,0.221617,0.002154335,0.0015369549,0.0015369549,
0.013663038,0.79777205,0.017631577,0.07877028,0.013663038,0.013663038,0.02384796,0.013663038,0.013663038,0.013663038,
0.004970969,0.004970969,0.030546658,0.061217178,0.004970969,0.13442266,0.019052852,0.72990584,0.004970969,0.004970969,
0.0069016595,0.2305649,0.0069016595,0.009936641,0.0069016595,0.03909264,0.0069016595,0.06721597,0.6186815,0.0069016595,
0.014093212,0.025705855,0.03642505,0.014093212,0.09023451,0.36913973,0.014093212,0.014093212,0.04838161,0.37374043,
0.007815273,0.3291913,0.51376253,0.007815273,0.007815273,0.016879136,0.007815273,0.07769558,0.023395134,0.007815273,
0.1306439,0.011446198,0.0075425026,0.5585587,0.009788782,0.24674372,0.002714093,0.027133815,0.002714093,0.002714093,
0.00044671563,0.00044671563,0.21810262,0.00044671563,0.12008773,0.47867653,0.00044671563,0.00044671563,0.00044671563,0.18045288,
Evaluate model on site 1 , Test MAE: 0.5609, Test MAPE: 0.0681, Test RMSE: 0.9058
Evaluate model on site 2 , Test MAE: 0.8315, Test MAPE: 0.1697, Test RMSE: 1.4228
Evaluate model on site 3 , Test MAE: 0.3214, Test MAPE: 0.0536, Test RMSE: 0.6620
Evaluate model on site 4 , Test MAE: 0.6919, Test MAPE: 0.0858, Test RMSE: 0.9833
Evaluate model on site 5 , Test MAE: 0.3574, Test MAPE: 0.0482, Test RMSE: 0.6131
Evaluate model on site 6 , Test MAE: 0.5659, Test MAPE: 0.0793, Test RMSE: 1.0726
Evaluate model on site 7 , Test MAE: 0.3626, Test MAPE: 0.0556, Test RMSE: 0.6571
Evaluate model on site 8 , Test MAE: 0.3998, Test MAPE: 0.0843, Test RMSE: 0.6933
Evaluate model on site 9 , Test MAE: 0.6913, Test MAPE: 0.1075, Test RMSE: 1.1143
Evaluate model on site 10 , Test MAE: 0.2171, Test MAPE: 0.2123, Test RMSE: 0.3650
On average over all site, Test MAE: 0.5000, Test MAPE: 0.0964, Test RMSE: 0.8489
(0.49998979568481444, 0.09642752818763256, 0.8489390760660172)
data::data/water/shangban/singleFac/1,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/1', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.700538158416748
Validation loss decreased (inf --> 0.700538).  Saving model ...
Epoch:2,validate loss:0.531312882900238
Validation loss decreased (0.700538 --> 0.531313).  Saving model ...
Epoch:3,validate loss:0.5261756181716919
Validation loss decreased (0.531313 --> 0.526176).  Saving model ...
Epoch:4,validate loss:0.5244431495666504
Validation loss decreased (0.526176 --> 0.524443).  Saving model ...
Epoch:5,validate loss:0.5315287113189697
Epoch:6,validate loss:0.5151889324188232
Validation loss decreased (0.524443 --> 0.515189).  Saving model ...
Epoch:7,validate loss:0.516067385673523
Epoch:8,validate loss:0.4899415969848633
Validation loss decreased (0.515189 --> 0.489942).  Saving model ...
Epoch:9,validate loss:0.48311325907707214
Validation loss decreased (0.489942 --> 0.483113).  Saving model ...
Epoch:10,validate loss:0.5050824284553528
Epoch:11,validate loss:0.48470228910446167
Epoch:12,validate loss:0.47877252101898193
Validation loss decreased (0.483113 --> 0.478773).  Saving model ...
Epoch:13,validate loss:0.48339229822158813
Epoch:14,validate loss:0.48241713643074036
Epoch:15,validate loss:0.47372865676879883
Validation loss decreased (0.478773 --> 0.473729).  Saving model ...
Epoch:16,validate loss:0.47553160786628723
Epoch:17,validate loss:0.4747557044029236
Epoch:18,validate loss:0.49108007550239563
Epoch:19,validate loss:0.47865504026412964
Epoch:20,validate loss:0.46657589077949524
Validation loss decreased (0.473729 --> 0.466576).  Saving model ...
Epoch:21,validate loss:0.47998735308647156
Epoch:22,validate loss:0.4728046655654907
Epoch:23,validate loss:0.46489080786705017
Validation loss decreased (0.466576 --> 0.464891).  Saving model ...
Epoch:24,validate loss:0.49244174361228943
Epoch:25,validate loss:0.46795645356178284
Epoch:26,validate loss:0.4710133969783783
Epoch:27,validate loss:0.4849511682987213
Epoch:28,validate loss:0.4659571051597595
Epoch:29,validate loss:0.46360352635383606
Validation loss decreased (0.464891 --> 0.463604).  Saving model ...
Epoch:30,validate loss:0.46314749121665955
Validation loss decreased (0.463604 --> 0.463147).  Saving model ...
Epoch:31,validate loss:0.46724802255630493
Epoch:32,validate loss:0.4611584544181824
Validation loss decreased (0.463147 --> 0.461158).  Saving model ...
Epoch:33,validate loss:0.46491557359695435
Epoch:34,validate loss:0.4591290354728699
Validation loss decreased (0.461158 --> 0.459129).  Saving model ...
Epoch:35,validate loss:0.4691464900970459
Epoch:36,validate loss:0.4703461825847626
Epoch:37,validate loss:0.4797235131263733
Epoch:38,validate loss:0.4769286513328552
Epoch:39,validate loss:0.47588294744491577
Epoch:40,validate loss:0.4550478756427765
Validation loss decreased (0.459129 --> 0.455048).  Saving model ...
Epoch:41,validate loss:0.4636421203613281
Epoch:42,validate loss:0.4772633910179138
Epoch:43,validate loss:0.45244091749191284
Validation loss decreased (0.455048 --> 0.452441).  Saving model ...
Epoch:44,validate loss:0.45735323429107666
Epoch:45,validate loss:0.46316713094711304
Epoch:46,validate loss:0.4555937945842743
Epoch:47,validate loss:0.45656976103782654
Epoch:48,validate loss:0.4809829890727997
Epoch:49,validate loss:0.4484882056713104
Validation loss decreased (0.452441 --> 0.448488).  Saving model ...
Epoch:50,validate loss:0.4691343605518341
Epoch:51,validate loss:0.45217281579971313
Epoch:52,validate loss:0.4965726435184479
Epoch:53,validate loss:0.4474564492702484
Validation loss decreased (0.448488 --> 0.447456).  Saving model ...
Epoch:54,validate loss:0.45020386576652527
Epoch:55,validate loss:0.45530638098716736
Epoch:56,validate loss:0.46549898386001587
Epoch:57,validate loss:0.44963690638542175
Epoch:58,validate loss:0.4463660418987274
Validation loss decreased (0.447456 --> 0.446366).  Saving model ...
Epoch:59,validate loss:0.443665474653244
Validation loss decreased (0.446366 --> 0.443665).  Saving model ...
Epoch:60,validate loss:0.4581127464771271
Epoch:61,validate loss:0.44398126006126404
Epoch:62,validate loss:0.4447198510169983
Epoch:63,validate loss:0.4376554787158966
Validation loss decreased (0.443665 --> 0.437655).  Saving model ...
Epoch:64,validate loss:0.44104552268981934
Epoch:65,validate loss:0.4528156518936157
Epoch:66,validate loss:0.43920227885246277
Epoch:67,validate loss:0.44939666986465454
Epoch:68,validate loss:0.4491243064403534
Epoch:69,validate loss:0.4480993449687958
Epoch:70,validate loss:0.4419463574886322
Epoch:71,validate loss:0.4405079185962677
Epoch:72,validate loss:0.4480306804180145
Epoch:73,validate loss:0.4367830157279968
Validation loss decreased (0.437655 --> 0.436783).  Saving model ...
Epoch:74,validate loss:0.43026232719421387
Validation loss decreased (0.436783 --> 0.430262).  Saving model ...
Epoch:75,validate loss:0.44375142455101013
Epoch:76,validate loss:0.43324825167655945
Epoch:77,validate loss:0.43928155303001404
Epoch:78,validate loss:0.4405439496040344
Epoch:79,validate loss:0.4328988492488861
Epoch:80,validate loss:0.4249221384525299
Validation loss decreased (0.430262 --> 0.424922).  Saving model ...
Epoch:81,validate loss:0.42366456985473633
Validation loss decreased (0.424922 --> 0.423665).  Saving model ...
Epoch:82,validate loss:0.43115055561065674
Epoch:83,validate loss:0.4262515902519226
Epoch:84,validate loss:0.4289260804653168
Epoch:85,validate loss:0.4261940121650696
Epoch:86,validate loss:0.4211811423301697
Validation loss decreased (0.423665 --> 0.421181).  Saving model ...
Epoch:87,validate loss:0.43427255749702454
Epoch:88,validate loss:0.42102503776550293
Validation loss decreased (0.421181 --> 0.421025).  Saving model ...
Epoch:89,validate loss:0.4312979578971863
Epoch:90,validate loss:0.4223634898662567
Epoch:91,validate loss:0.4216965138912201
Epoch:92,validate loss:0.4346778988838196
Epoch:93,validate loss:0.4215739071369171
Epoch:94,validate loss:0.43047741055488586
Epoch:95,validate loss:0.4259222149848938
Epoch:96,validate loss:0.41934990882873535
Validation loss decreased (0.421025 --> 0.419350).  Saving model ...
Epoch:97,validate loss:0.42516258358955383
Epoch:98,validate loss:0.4259265065193176
Epoch:99,validate loss:0.41832974553108215
Validation loss decreased (0.419350 --> 0.418330).  Saving model ...
Epoch:100,validate loss:0.4204251766204834
Epoch:101,validate loss:0.4192846417427063
Epoch:102,validate loss:0.41640806198120117
Validation loss decreased (0.418330 --> 0.416408).  Saving model ...
Epoch:103,validate loss:0.4265025556087494
Epoch:104,validate loss:0.4437441825866699
Epoch:105,validate loss:0.419537752866745
Epoch:106,validate loss:0.41539689898490906
Validation loss decreased (0.416408 --> 0.415397).  Saving model ...
Epoch:107,validate loss:0.4210013747215271
Epoch:108,validate loss:0.41327840089797974
Validation loss decreased (0.415397 --> 0.413278).  Saving model ...
Epoch:109,validate loss:0.4220679700374603
Epoch:110,validate loss:0.4227679669857025
Epoch:111,validate loss:0.4183785319328308
Epoch:112,validate loss:0.4137592017650604
Epoch:113,validate loss:0.4174005687236786
Epoch:114,validate loss:0.42635801434516907
Epoch:115,validate loss:0.42806342244148254
Epoch:116,validate loss:0.4206085503101349
Epoch:117,validate loss:0.40852242708206177
Validation loss decreased (0.413278 --> 0.408522).  Saving model ...
Epoch:118,validate loss:0.40993571281433105
Epoch:119,validate loss:0.42699986696243286
Epoch:120,validate loss:0.41468507051467896
Epoch:121,validate loss:0.4153858423233032
Epoch:122,validate loss:0.4169234037399292
Epoch:123,validate loss:0.409432053565979
Epoch:124,validate loss:0.4146742820739746
Epoch:125,validate loss:0.4162183105945587
Epoch:126,validate loss:0.4165806770324707
Epoch:127,validate loss:0.41292205452919006
Epoch:128,validate loss:0.41388076543807983
Epoch:129,validate loss:0.41772788763046265
Epoch:130,validate loss:0.4064027965068817
Validation loss decreased (0.408522 --> 0.406403).  Saving model ...
Epoch:131,validate loss:0.39822766184806824
Validation loss decreased (0.406403 --> 0.398228).  Saving model ...
Epoch:132,validate loss:0.4137263894081116
Epoch:133,validate loss:0.40972355008125305
Epoch:134,validate loss:0.40700119733810425
Epoch:135,validate loss:0.41921043395996094
Epoch:136,validate loss:0.40756890177726746
Epoch:137,validate loss:0.41000330448150635
Epoch:138,validate loss:0.40661266446113586
Epoch:139,validate loss:0.4050707221031189
Epoch:140,validate loss:0.41016846895217896
Epoch:141,validate loss:0.4060710370540619
Epoch:142,validate loss:0.40711432695388794
Epoch:143,validate loss:0.4165228605270386
Epoch:144,validate loss:0.41562801599502563
Epoch:145,validate loss:0.4003613293170929
Epoch:146,validate loss:0.41819193959236145
Epoch:147,validate loss:0.41515326499938965
Epoch:148,validate loss:0.4112599492073059
Epoch:149,validate loss:0.4027474820613861
Epoch:150,validate loss:0.4067288637161255
Epoch:151,validate loss:0.41196972131729126
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.841,avg=0.100
0.07209609,0.07209609,0.10846553,0.07209609,0.07209609,0.07209609,0.07209609,0.31476584,0.07209609,0.07209609,
0.011638696,0.011638696,0.10036261,0.011638696,0.011638696,0.011638696,0.011638696,0.013537938,0.30465722,0.51161003,
0.0054631582,0.0054631582,0.21853393,0.6690781,0.0741458,0.0054631582,0.0054631582,0.0054631582,0.0054631582,0.0054631582,
0.00039533936,0.00039533936,0.00039533936,0.052928697,0.001827337,0.095510006,0.00039533936,0.84125626,0.0065009505,0.00039533936,
0.13798153,0.003938967,0.11312426,0.036232468,0.44483557,0.00635308,0.24571718,0.003938967,0.003938967,0.003938967,
0.00049991556,0.00049991556,0.00049991556,0.63319683,0.00049991556,0.26617122,0.00049991556,0.08428578,0.012794367,0.0010521956,
0.7951768,0.015502179,0.03903971,0.019872293,0.008633011,0.008633011,0.03669948,0.059177507,0.008633011,0.008633011,
0.00022532206,0.00031935575,0.00022532206,0.000848503,0.00022532206,0.00022532206,0.003941682,0.35165837,0.64210546,0.00022532206,
0.1208969,0.58349884,0.0020155834,0.0020155834,0.017360335,0.0020155834,0.0020155834,0.2486567,0.019509248,0.0020155834,
0.0008310931,0.0002888733,0.2772396,0.0002888733,0.00072598265,0.21797734,0.0012854739,0.028844085,0.0002888733,0.47222984,
Evaluate model on site 1 , Test MAE: 0.5480, Test MAPE: 0.0669, Test RMSE: 0.8822
Evaluate model on site 2 , Test MAE: 0.8274, Test MAPE: 0.1646, Test RMSE: 1.4201
Evaluate model on site 3 , Test MAE: 0.3169, Test MAPE: 0.0529, Test RMSE: 0.6374
Evaluate model on site 4 , Test MAE: 0.6689, Test MAPE: 0.0825, Test RMSE: 0.9476
Evaluate model on site 5 , Test MAE: 0.3655, Test MAPE: 0.0523, Test RMSE: 0.6466
Evaluate model on site 6 , Test MAE: 0.5682, Test MAPE: 0.0809, Test RMSE: 1.1250
Evaluate model on site 7 , Test MAE: 0.3417, Test MAPE: 0.0526, Test RMSE: 0.6523
Evaluate model on site 8 , Test MAE: 0.4144, Test MAPE: 0.0869, Test RMSE: 0.6934
Evaluate model on site 9 , Test MAE: 0.6615, Test MAPE: 0.1028, Test RMSE: 1.0973
Evaluate model on site 10 , Test MAE: 0.2138, Test MAPE: 0.2101, Test RMSE: 0.3547
On average over all site, Test MAE: 0.4926, Test MAPE: 0.0953, Test RMSE: 0.8457
(0.49262887686491014, 0.09525227472186089, 0.8456557899713516)
data::data/water/shangban/singleFac/1,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/1', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.6464598774909973
Validation loss decreased (inf --> 0.646460).  Saving model ...
Epoch:2,validate loss:0.5554219484329224
Validation loss decreased (0.646460 --> 0.555422).  Saving model ...
Epoch:3,validate loss:0.5151779651641846
Validation loss decreased (0.555422 --> 0.515178).  Saving model ...
Epoch:4,validate loss:0.5054790377616882
Validation loss decreased (0.515178 --> 0.505479).  Saving model ...
Epoch:5,validate loss:0.49465274810791016
Validation loss decreased (0.505479 --> 0.494653).  Saving model ...
Epoch:6,validate loss:0.5062157511711121
Epoch:7,validate loss:0.5111899375915527
Epoch:8,validate loss:0.5056313872337341
Epoch:9,validate loss:0.4834860563278198
Validation loss decreased (0.494653 --> 0.483486).  Saving model ...
Epoch:10,validate loss:0.4863325357437134
Epoch:11,validate loss:0.4885057210922241
Epoch:12,validate loss:0.47583818435668945
Validation loss decreased (0.483486 --> 0.475838).  Saving model ...
Epoch:13,validate loss:0.4755975604057312
Validation loss decreased (0.475838 --> 0.475598).  Saving model ...
Epoch:14,validate loss:0.4773096442222595
Epoch:15,validate loss:0.47208452224731445
Validation loss decreased (0.475598 --> 0.472085).  Saving model ...
Epoch:16,validate loss:0.4798656105995178
Epoch:17,validate loss:0.4825601577758789
Epoch:18,validate loss:0.47403019666671753
Epoch:19,validate loss:0.478451132774353
Epoch:20,validate loss:0.4869890511035919
Epoch:21,validate loss:0.47404101490974426
Epoch:22,validate loss:0.47705453634262085
Epoch:23,validate loss:0.4741963744163513
Epoch:24,validate loss:0.4683658480644226
Validation loss decreased (0.472085 --> 0.468366).  Saving model ...
Epoch:25,validate loss:0.474168598651886
Epoch:26,validate loss:0.47832605242729187
Epoch:27,validate loss:0.48524540662765503
Epoch:28,validate loss:0.4709071218967438
Epoch:29,validate loss:0.46618980169296265
Validation loss decreased (0.468366 --> 0.466190).  Saving model ...
Epoch:30,validate loss:0.4681394100189209
Epoch:31,validate loss:0.5169292092323303
Epoch:32,validate loss:0.47231999039649963
Epoch:33,validate loss:0.49340638518333435
Epoch:34,validate loss:0.46154242753982544
Validation loss decreased (0.466190 --> 0.461542).  Saving model ...
Epoch:35,validate loss:0.4596242606639862
Validation loss decreased (0.461542 --> 0.459624).  Saving model ...
Epoch:36,validate loss:0.4668615162372589
Epoch:37,validate loss:0.4596881568431854
Epoch:38,validate loss:0.4669185280799866
Epoch:39,validate loss:0.46260905265808105
Epoch:40,validate loss:0.4592204689979553
Validation loss decreased (0.459624 --> 0.459220).  Saving model ...
Epoch:41,validate loss:0.46001943945884705
Epoch:42,validate loss:0.4560256600379944
Validation loss decreased (0.459220 --> 0.456026).  Saving model ...
Epoch:43,validate loss:0.45973387360572815
Epoch:44,validate loss:0.46328872442245483
Epoch:45,validate loss:0.4579845070838928
Epoch:46,validate loss:0.4543808102607727
Validation loss decreased (0.456026 --> 0.454381).  Saving model ...
Epoch:47,validate loss:0.46214938163757324
Epoch:48,validate loss:0.45262110233306885
Validation loss decreased (0.454381 --> 0.452621).  Saving model ...
Epoch:49,validate loss:0.46248871088027954
Epoch:50,validate loss:0.44830185174942017
Validation loss decreased (0.452621 --> 0.448302).  Saving model ...
Epoch:51,validate loss:0.4482751190662384
Validation loss decreased (0.448302 --> 0.448275).  Saving model ...
Epoch:52,validate loss:0.44526413083076477
Validation loss decreased (0.448275 --> 0.445264).  Saving model ...
Epoch:53,validate loss:0.45263904333114624
Epoch:54,validate loss:0.44513750076293945
Validation loss decreased (0.445264 --> 0.445138).  Saving model ...
Epoch:55,validate loss:0.44683101773262024
Epoch:56,validate loss:0.45015254616737366
Epoch:57,validate loss:0.43964582681655884
Validation loss decreased (0.445138 --> 0.439646).  Saving model ...
Epoch:58,validate loss:0.4412309229373932
Epoch:59,validate loss:0.4443226456642151
Epoch:60,validate loss:0.4560244083404541
Epoch:61,validate loss:0.46681585907936096
Epoch:62,validate loss:0.43861594796180725
Validation loss decreased (0.439646 --> 0.438616).  Saving model ...
Epoch:63,validate loss:0.4376947581768036
Validation loss decreased (0.438616 --> 0.437695).  Saving model ...
Epoch:64,validate loss:0.44215649366378784
Epoch:65,validate loss:0.4644593894481659
Epoch:66,validate loss:0.4334046244621277
Validation loss decreased (0.437695 --> 0.433405).  Saving model ...
Epoch:67,validate loss:0.4526856541633606
Epoch:68,validate loss:0.4446907043457031
Epoch:69,validate loss:0.447037935256958
Epoch:70,validate loss:0.4449158012866974
Epoch:71,validate loss:0.4404519498348236
Epoch:72,validate loss:0.42986592650413513
Validation loss decreased (0.433405 --> 0.429866).  Saving model ...
Epoch:73,validate loss:0.4437229335308075
Epoch:74,validate loss:0.43804672360420227
Epoch:75,validate loss:0.4412212669849396
Epoch:76,validate loss:0.44040966033935547
Epoch:77,validate loss:0.43457502126693726
Epoch:78,validate loss:0.43588265776634216
Epoch:79,validate loss:0.4341683089733124
Epoch:80,validate loss:0.43342262506484985
Epoch:81,validate loss:0.4291338324546814
Validation loss decreased (0.429866 --> 0.429134).  Saving model ...
Epoch:82,validate loss:0.4305356442928314
Epoch:83,validate loss:0.43968871235847473
Epoch:84,validate loss:0.4317827820777893
Epoch:85,validate loss:0.42385345697402954
Validation loss decreased (0.429134 --> 0.423853).  Saving model ...
Epoch:86,validate loss:0.4300483167171478
Epoch:87,validate loss:0.4373275339603424
Epoch:88,validate loss:0.4257320761680603
Epoch:89,validate loss:0.4269949793815613
Epoch:90,validate loss:0.42296653985977173
Validation loss decreased (0.423853 --> 0.422967).  Saving model ...
Epoch:91,validate loss:0.4333696663379669
Epoch:92,validate loss:0.42703819274902344
Epoch:93,validate loss:0.4177630543708801
Validation loss decreased (0.422967 --> 0.417763).  Saving model ...
Epoch:94,validate loss:0.4253422021865845
Epoch:95,validate loss:0.4160914719104767
Validation loss decreased (0.417763 --> 0.416091).  Saving model ...
Epoch:96,validate loss:0.4226951599121094
Epoch:97,validate loss:0.41647735238075256
Epoch:98,validate loss:0.42938369512557983
Epoch:99,validate loss:0.41480931639671326
Validation loss decreased (0.416091 --> 0.414809).  Saving model ...
Epoch:100,validate loss:0.42609983682632446
Epoch:101,validate loss:0.4198797643184662
Epoch:102,validate loss:0.42249348759651184
Epoch:103,validate loss:0.43164923787117004
Epoch:104,validate loss:0.41872653365135193
Epoch:105,validate loss:0.405234158039093
Validation loss decreased (0.414809 --> 0.405234).  Saving model ...
Epoch:106,validate loss:0.4148394763469696
Epoch:107,validate loss:0.420518696308136
Epoch:108,validate loss:0.4175804853439331
Epoch:109,validate loss:0.4191434979438782
Epoch:110,validate loss:0.41467759013175964
Epoch:111,validate loss:0.4184945821762085
Epoch:112,validate loss:0.41311880946159363
Epoch:113,validate loss:0.40289339423179626
Validation loss decreased (0.405234 --> 0.402893).  Saving model ...
Epoch:114,validate loss:0.4158283770084381
Epoch:115,validate loss:0.40891560912132263
Epoch:116,validate loss:0.41355976462364197
Epoch:117,validate loss:0.4151570200920105
Epoch:118,validate loss:0.41590121388435364
Epoch:119,validate loss:0.4026696979999542
Validation loss decreased (0.402893 --> 0.402670).  Saving model ...
Epoch:120,validate loss:0.40494754910469055
Epoch:121,validate loss:0.41060981154441833
Epoch:122,validate loss:0.4102141559123993
Epoch:123,validate loss:0.4070355296134949
Epoch:124,validate loss:0.39717328548431396
Validation loss decreased (0.402670 --> 0.397173).  Saving model ...
Epoch:125,validate loss:0.41133469343185425
Epoch:126,validate loss:0.40871462225914
Epoch:127,validate loss:0.41426995396614075
Epoch:128,validate loss:0.40456944704055786
Epoch:129,validate loss:0.40417608618736267
Epoch:130,validate loss:0.39968550205230713
Epoch:131,validate loss:0.39731141924858093
Epoch:132,validate loss:0.41304290294647217
Epoch:133,validate loss:0.3990814983844757
Epoch:134,validate loss:0.4067297577857971
Epoch:135,validate loss:0.40119263529777527
Epoch:136,validate loss:0.4110591411590576
Epoch:137,validate loss:0.4053957760334015
Epoch:138,validate loss:0.40561169385910034
Epoch:139,validate loss:0.41548511385917664
Epoch:140,validate loss:0.4069008231163025
Epoch:141,validate loss:0.41133105754852295
Epoch:142,validate loss:0.4018237292766571
Epoch:143,validate loss:0.402645468711853
Epoch:144,validate loss:0.39396771788597107
Validation loss decreased (0.397173 --> 0.393968).  Saving model ...
Epoch:145,validate loss:0.4090312421321869
Epoch:146,validate loss:0.40112781524658203
Epoch:147,validate loss:0.39800402522087097
Epoch:148,validate loss:0.39700281620025635
Epoch:149,validate loss:0.40591058135032654
Epoch:150,validate loss:0.3950626254081726
Epoch:151,validate loss:0.39661771059036255
Epoch:152,validate loss:0.40154892206192017
Epoch:153,validate loss:0.394061803817749
Epoch:154,validate loss:0.3985997438430786
Epoch:155,validate loss:0.39091530442237854
Validation loss decreased (0.393968 --> 0.390915).  Saving model ...
Epoch:156,validate loss:0.39904212951660156
Epoch:157,validate loss:0.3973116874694824
Epoch:158,validate loss:0.40419167280197144
Epoch:159,validate loss:0.39643874764442444
Epoch:160,validate loss:0.4031003415584564
Epoch:161,validate loss:0.408847838640213
Epoch:162,validate loss:0.39987456798553467
Epoch:163,validate loss:0.3976150155067444
Epoch:164,validate loss:0.4016574025154114
Epoch:165,validate loss:0.4078705906867981
Epoch:166,validate loss:0.3995121121406555
Epoch:167,validate loss:0.39820966124534607
Epoch:168,validate loss:0.40287089347839355
Epoch:169,validate loss:0.38994771242141724
Validation loss decreased (0.390915 --> 0.389948).  Saving model ...
Epoch:170,validate loss:0.3980622887611389
Epoch:171,validate loss:0.393588662147522
Epoch:172,validate loss:0.3928292691707611
Epoch:173,validate loss:0.3943497836589813
Epoch:174,validate loss:0.402180939912796
Epoch:175,validate loss:0.39925143122673035
Epoch:176,validate loss:0.39555424451828003
Epoch:177,validate loss:0.40179237723350525
Epoch:178,validate loss:0.4050567150115967
Epoch:179,validate loss:0.3989467918872833
Epoch:180,validate loss:0.401030957698822
Epoch:181,validate loss:0.39410650730133057
Epoch:182,validate loss:0.39489153027534485
Epoch:183,validate loss:0.39254915714263916
Epoch:184,validate loss:0.39540424942970276
Epoch:185,validate loss:0.3987812101840973
Epoch:186,validate loss:0.39635351300239563
Epoch:187,validate loss:0.39290931820869446
Epoch:188,validate loss:0.39346620440483093
Epoch:189,validate loss:0.3967329263687134
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.789,avg=0.100
0.72624385,0.0019249582,0.0019249582,0.0019249582,0.0019249582,0.0019249582,0.0073726024,0.0019249582,0.10560598,0.14922774,
0.020712635,0.38499787,0.0075910636,0.5547571,0.0020534256,0.0026376618,0.012750637,0.0065506953,0.0058953986,0.0020534256,
0.0018134518,0.0018134518,0.08728972,0.28877503,0.25016257,0.0018134518,0.0018134518,0.34654844,0.0018134518,0.018156936,
0.19429784,0.0041489135,0.78892833,0.0009597585,0.002349103,0.0011277061,0.0009597585,0.0009597585,0.0050615985,0.0012072293,
0.05488219,0.0001907039,0.17981885,0.01687625,0.00016089874,0.00016089874,0.0005984508,0.00016089874,0.7030843,0.044066545,
0.0024554045,0.0024554045,0.0024554045,0.70911634,0.0024554045,0.0024554045,0.051060315,0.22216365,0.0029272423,0.0024554045,
0.029086402,0.22703339,0.004024209,0.0061768442,0.7177887,0.0023059675,0.0023059675,0.0023059675,0.0023059675,0.0066665974,
0.0008987881,0.0008987881,0.0008987881,0.40542656,0.0008987881,0.5522065,0.030947283,0.00431621,0.0008987881,0.0026094823,
0.00048111507,0.00048111507,0.0074938135,0.00048111507,0.00048111507,0.00048111507,0.67211026,0.016881479,0.08787699,0.21323197,
0.05355043,0.05355043,0.5180462,0.05355043,0.05355043,0.05355043,0.05355043,0.05355043,0.05355043,0.05355043,
Evaluate model on site 1 , Test MAE: 0.5224, Test MAPE: 0.0639, Test RMSE: 0.8609
Evaluate model on site 2 , Test MAE: 0.8250, Test MAPE: 0.1665, Test RMSE: 1.3999
Evaluate model on site 3 , Test MAE: 0.3025, Test MAPE: 0.0524, Test RMSE: 0.6048
Evaluate model on site 4 , Test MAE: 0.6555, Test MAPE: 0.0812, Test RMSE: 0.9367
Evaluate model on site 5 , Test MAE: 0.3400, Test MAPE: 0.0465, Test RMSE: 0.6044
Evaluate model on site 6 , Test MAE: 0.5723, Test MAPE: 0.0827, Test RMSE: 1.0920
Evaluate model on site 7 , Test MAE: 0.3445, Test MAPE: 0.0530, Test RMSE: 0.6481
Evaluate model on site 8 , Test MAE: 0.4027, Test MAPE: 0.0841, Test RMSE: 0.6812
Evaluate model on site 9 , Test MAE: 0.6554, Test MAPE: 0.1009, Test RMSE: 1.0590
Evaluate model on site 10 , Test MAE: 0.2132, Test MAPE: 0.2102, Test RMSE: 0.3565
On average over all site, Test MAE: 0.4834, Test MAPE: 0.0942, Test RMSE: 0.8244
(0.4833537757396698, 0.09415042176842689, 0.8243598282337189)
data::data/water/shangban/singleFac/1,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/1', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.6750916242599487
Validation loss decreased (inf --> 0.675092).  Saving model ...
Epoch:2,validate loss:0.537577211856842
Validation loss decreased (0.675092 --> 0.537577).  Saving model ...
Epoch:3,validate loss:0.5139707922935486
Validation loss decreased (0.537577 --> 0.513971).  Saving model ...
Epoch:4,validate loss:0.5383152961730957
Epoch:5,validate loss:0.4962937831878662
Validation loss decreased (0.513971 --> 0.496294).  Saving model ...
Epoch:6,validate loss:0.49390819668769836
Validation loss decreased (0.496294 --> 0.493908).  Saving model ...
Epoch:7,validate loss:0.49466028809547424
Epoch:8,validate loss:0.49029332399368286
Validation loss decreased (0.493908 --> 0.490293).  Saving model ...
Epoch:9,validate loss:0.48082584142684937
Validation loss decreased (0.490293 --> 0.480826).  Saving model ...
Epoch:10,validate loss:0.4907051920890808
Epoch:11,validate loss:0.480550080537796
Validation loss decreased (0.480826 --> 0.480550).  Saving model ...
Epoch:12,validate loss:0.4850570857524872
Epoch:13,validate loss:0.47717171907424927
Validation loss decreased (0.480550 --> 0.477172).  Saving model ...
Epoch:14,validate loss:0.48120713233947754
Epoch:15,validate loss:0.5071465373039246
Epoch:16,validate loss:0.4809630215167999
Epoch:17,validate loss:0.491221159696579
Epoch:18,validate loss:0.46035224199295044
Validation loss decreased (0.477172 --> 0.460352).  Saving model ...
Epoch:19,validate loss:0.4629666209220886
Epoch:20,validate loss:0.4812527596950531
Epoch:21,validate loss:0.46815794706344604
Epoch:22,validate loss:0.4847576916217804
Epoch:23,validate loss:0.4667860269546509
Epoch:24,validate loss:0.4699193239212036
Epoch:25,validate loss:0.4888056814670563
Epoch:26,validate loss:0.4587111473083496
Validation loss decreased (0.460352 --> 0.458711).  Saving model ...
Epoch:27,validate loss:0.45882648229599
Epoch:28,validate loss:0.46032652258872986
Epoch:29,validate loss:0.4654950201511383
Epoch:30,validate loss:0.4630504250526428
Epoch:31,validate loss:0.4709135890007019
Epoch:32,validate loss:0.4569336175918579
Validation loss decreased (0.458711 --> 0.456934).  Saving model ...
Epoch:33,validate loss:0.46365243196487427
Epoch:34,validate loss:0.4554210901260376
Validation loss decreased (0.456934 --> 0.455421).  Saving model ...
Epoch:35,validate loss:0.4643293023109436
Epoch:36,validate loss:0.4591592252254486
Epoch:37,validate loss:0.4597721993923187
Epoch:38,validate loss:0.4676360785961151
Epoch:39,validate loss:0.456220805644989
Epoch:40,validate loss:0.44889405369758606
Validation loss decreased (0.455421 --> 0.448894).  Saving model ...
Epoch:41,validate loss:0.4549703598022461
Epoch:42,validate loss:0.4534509479999542
Epoch:43,validate loss:0.4490412175655365
Epoch:44,validate loss:0.44837626814842224
Validation loss decreased (0.448894 --> 0.448376).  Saving model ...
Epoch:45,validate loss:0.43886682391166687
Validation loss decreased (0.448376 --> 0.438867).  Saving model ...
Epoch:46,validate loss:0.4517528712749481
Epoch:47,validate loss:0.4404652416706085
Epoch:48,validate loss:0.4519030451774597
Epoch:49,validate loss:0.4374622702598572
Validation loss decreased (0.438867 --> 0.437462).  Saving model ...
Epoch:50,validate loss:0.4475143551826477
Epoch:51,validate loss:0.4516560435295105
Epoch:52,validate loss:0.44949886202812195
Epoch:53,validate loss:0.46053627133369446
Epoch:54,validate loss:0.44243547320365906
Epoch:55,validate loss:0.43587252497673035
Validation loss decreased (0.437462 --> 0.435873).  Saving model ...
Epoch:56,validate loss:0.43711066246032715
Epoch:57,validate loss:0.43207985162734985
Validation loss decreased (0.435873 --> 0.432080).  Saving model ...
Epoch:58,validate loss:0.43971529603004456
Epoch:59,validate loss:0.44204625487327576
Epoch:60,validate loss:0.4353490471839905
Epoch:61,validate loss:0.4324319362640381
Epoch:62,validate loss:0.4187469780445099
Validation loss decreased (0.432080 --> 0.418747).  Saving model ...
Epoch:63,validate loss:0.42386147379875183
Epoch:64,validate loss:0.4153112769126892
Validation loss decreased (0.418747 --> 0.415311).  Saving model ...
Epoch:65,validate loss:0.42481958866119385
Epoch:66,validate loss:0.427946537733078
Epoch:67,validate loss:0.42597588896751404
Epoch:68,validate loss:0.4224187433719635
Epoch:69,validate loss:0.41461145877838135
Validation loss decreased (0.415311 --> 0.414611).  Saving model ...
Epoch:70,validate loss:0.4235686659812927
Epoch:71,validate loss:0.4213075041770935
Epoch:72,validate loss:0.42056015133857727
Epoch:73,validate loss:0.4217066764831543
Epoch:74,validate loss:0.42130398750305176
Epoch:75,validate loss:0.42426541447639465
Epoch:76,validate loss:0.4345760941505432
Epoch:77,validate loss:0.41623273491859436
Epoch:78,validate loss:0.4334040582180023
Epoch:79,validate loss:0.4241293668746948
Epoch:80,validate loss:0.42738401889801025
Epoch:81,validate loss:0.41142573952674866
Validation loss decreased (0.414611 --> 0.411426).  Saving model ...
Epoch:82,validate loss:0.4101681113243103
Validation loss decreased (0.411426 --> 0.410168).  Saving model ...
Epoch:83,validate loss:0.410837322473526
Epoch:84,validate loss:0.4038810431957245
Validation loss decreased (0.410168 --> 0.403881).  Saving model ...
Epoch:85,validate loss:0.41591009497642517
Epoch:86,validate loss:0.4075920879840851
Epoch:87,validate loss:0.40960583090782166
Epoch:88,validate loss:0.4067400097846985
Epoch:89,validate loss:0.4188356101512909
Epoch:90,validate loss:0.3979851007461548
Validation loss decreased (0.403881 --> 0.397985).  Saving model ...
Epoch:91,validate loss:0.3976922333240509
Validation loss decreased (0.397985 --> 0.397692).  Saving model ...
Epoch:92,validate loss:0.40122002363204956
Epoch:93,validate loss:0.4121008813381195
Epoch:94,validate loss:0.41225868463516235
Epoch:95,validate loss:0.3972683250904083
Validation loss decreased (0.397692 --> 0.397268).  Saving model ...
Epoch:96,validate loss:0.40121912956237793
Epoch:97,validate loss:0.40799689292907715
Epoch:98,validate loss:0.4083205759525299
Epoch:99,validate loss:0.4037160277366638
Epoch:100,validate loss:0.40247905254364014
Epoch:101,validate loss:0.4114541709423065
Epoch:102,validate loss:0.40795910358428955
Epoch:103,validate loss:0.40113765001296997
Epoch:104,validate loss:0.4019511044025421
Epoch:105,validate loss:0.4061965346336365
Epoch:106,validate loss:0.40302079916000366
Epoch:107,validate loss:0.39720043540000916
Validation loss decreased (0.397268 --> 0.397200).  Saving model ...
Epoch:108,validate loss:0.40319758653640747
Epoch:109,validate loss:0.40136000514030457
Epoch:110,validate loss:0.39800402522087097
Epoch:111,validate loss:0.40296077728271484
Epoch:112,validate loss:0.39772143959999084
Epoch:113,validate loss:0.3930917978286743
Validation loss decreased (0.397200 --> 0.393092).  Saving model ...
Epoch:114,validate loss:0.39440128207206726
Epoch:115,validate loss:0.3975749611854553
Epoch:116,validate loss:0.3926239311695099
Validation loss decreased (0.393092 --> 0.392624).  Saving model ...
Epoch:117,validate loss:0.402057409286499
Epoch:118,validate loss:0.39041516184806824
Validation loss decreased (0.392624 --> 0.390415).  Saving model ...
Epoch:119,validate loss:0.39390018582344055
Epoch:120,validate loss:0.39365318417549133
Epoch:121,validate loss:0.39825940132141113
Epoch:122,validate loss:0.39473870396614075
Epoch:123,validate loss:0.3950901925563812
Epoch:124,validate loss:0.4028581976890564
Epoch:125,validate loss:0.40061646699905396
Epoch:126,validate loss:0.3938859701156616
Epoch:127,validate loss:0.39739131927490234
Epoch:128,validate loss:0.3917115032672882
Epoch:129,validate loss:0.3887401521205902
Validation loss decreased (0.390415 --> 0.388740).  Saving model ...
Epoch:130,validate loss:0.40189188718795776
Epoch:131,validate loss:0.39226534962654114
Epoch:132,validate loss:0.3999576270580292
Epoch:133,validate loss:0.39349934458732605
Epoch:134,validate loss:0.4045383334159851
Epoch:135,validate loss:0.39836084842681885
Epoch:136,validate loss:0.3929583430290222
Epoch:137,validate loss:0.3988564610481262
Epoch:138,validate loss:0.39731237292289734
Epoch:139,validate loss:0.3880332112312317
Validation loss decreased (0.388740 --> 0.388033).  Saving model ...
Epoch:140,validate loss:0.40002965927124023
Epoch:141,validate loss:0.38774001598358154
Validation loss decreased (0.388033 --> 0.387740).  Saving model ...
Epoch:142,validate loss:0.39781653881073
Epoch:143,validate loss:0.3921370208263397
Epoch:144,validate loss:0.39809831976890564
Epoch:145,validate loss:0.39257022738456726
Epoch:146,validate loss:0.3935467302799225
Epoch:147,validate loss:0.390341579914093
Epoch:148,validate loss:0.3870985805988312
Validation loss decreased (0.387740 --> 0.387099).  Saving model ...
Epoch:149,validate loss:0.39867162704467773
Epoch:150,validate loss:0.39176714420318604
Epoch:151,validate loss:0.3853473365306854
Validation loss decreased (0.387099 --> 0.385347).  Saving model ...
Epoch:152,validate loss:0.39034679532051086
Epoch:153,validate loss:0.3976720869541168
Epoch:154,validate loss:0.3974957764148712
Epoch:155,validate loss:0.3907521069049835
Epoch:156,validate loss:0.3852546215057373
Validation loss decreased (0.385347 --> 0.385255).  Saving model ...
Epoch:157,validate loss:0.39768919348716736
Epoch:158,validate loss:0.3958008885383606
Epoch:159,validate loss:0.3923273980617523
Epoch:160,validate loss:0.39469993114471436
Epoch:161,validate loss:0.39357423782348633
Epoch:162,validate loss:0.3944533169269562
Epoch:163,validate loss:0.3867299258708954
Epoch:164,validate loss:0.3973831236362457
Epoch:165,validate loss:0.3996550440788269
Epoch:166,validate loss:0.39810988306999207
Epoch:167,validate loss:0.3920241594314575
Epoch:168,validate loss:0.401312917470932
Epoch:169,validate loss:0.3904336392879486
Epoch:170,validate loss:0.39515987038612366
Epoch:171,validate loss:0.3926795423030853
Epoch:172,validate loss:0.38897502422332764
Epoch:173,validate loss:0.40488341450691223
Epoch:174,validate loss:0.39218568801879883
Epoch:175,validate loss:0.3888610601425171
Epoch:176,validate loss:0.38782212138175964
Early stopping.
Training finished
邻接矩阵：min=0.001,max=0.775,avg=0.100
0.0014549453,0.0014549453,0.0014549453,0.0014549453,0.0014549453,0.5309169,0.42211363,0.03285965,0.0014549453,0.005380145,
0.003672492,0.003672492,0.003672492,0.014240589,0.003672492,0.009224226,0.003672492,0.17904328,0.77545696,0.003672492,
0.010650299,0.007071772,0.007447856,0.007071772,0.20947301,0.575086,0.010377335,0.031498425,0.007071772,0.13425173,
0.16648515,0.002247374,0.34013098,0.39924407,0.00075318746,0.00075318746,0.078891866,0.009987824,0.00075318746,0.00075318746,
0.025029639,0.025029639,0.025029639,0.7747333,0.025029639,0.025029639,0.025029639,0.025029639,0.025029639,0.025029639,
0.04326098,0.14375964,0.05820155,0.04326098,0.495212,0.04326098,0.04326098,0.04326098,0.04326098,0.04326098,
0.03238251,0.6674348,0.03238251,0.03238251,0.03238251,0.03238251,0.03238251,0.03238251,0.03238251,0.07350505,
0.58183634,0.0027482728,0.0027482728,0.25835875,0.0027482728,0.106940635,0.0027482728,0.026776295,0.0027482728,0.012346612,
0.00058361335,0.00058361335,0.00747705,0.064833626,0.21820304,0.14670403,0.5588486,0.00075172173,0.0011056167,0.0009091727,
0.0138827935,0.0067089,0.0067089,0.058518466,0.511035,0.07205714,0.08935391,0.0067089,0.0067089,0.2283171,
Evaluate model on site 1 , Test MAE: 0.5417, Test MAPE: 0.0663, Test RMSE: 0.8818
Evaluate model on site 2 , Test MAE: 0.8416, Test MAPE: 0.1694, Test RMSE: 1.4358
Evaluate model on site 3 , Test MAE: 0.3104, Test MAPE: 0.0521, Test RMSE: 0.6313
Evaluate model on site 4 , Test MAE: 0.6874, Test MAPE: 0.0855, Test RMSE: 0.9691
Evaluate model on site 5 , Test MAE: 0.3391, Test MAPE: 0.0457, Test RMSE: 0.5781
Evaluate model on site 6 , Test MAE: 0.5705, Test MAPE: 0.0813, Test RMSE: 1.0778
Evaluate model on site 7 , Test MAE: 0.3628, Test MAPE: 0.0560, Test RMSE: 0.6696
Evaluate model on site 8 , Test MAE: 0.4143, Test MAPE: 0.0869, Test RMSE: 0.7034
Evaluate model on site 9 , Test MAE: 0.6757, Test MAPE: 0.1044, Test RMSE: 1.0865
Evaluate model on site 10 , Test MAE: 0.2197, Test MAPE: 0.2116, Test RMSE: 0.3635
On average over all site, Test MAE: 0.4963, Test MAPE: 0.0959, Test RMSE: 0.8397
(0.49632167667150495, 0.09592253118753433, 0.8396938413381576)
data::data/water/shangban/singleFac/1,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/1', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.6135973930358887
Validation loss decreased (inf --> 0.613597).  Saving model ...
Epoch:2,validate loss:0.5096368193626404
Validation loss decreased (0.613597 --> 0.509637).  Saving model ...
Epoch:3,validate loss:0.5155802369117737
Epoch:4,validate loss:0.5249993205070496
Epoch:5,validate loss:0.5118890404701233
Epoch:6,validate loss:0.49402666091918945
Validation loss decreased (0.509637 --> 0.494027).  Saving model ...
Epoch:7,validate loss:0.5260536670684814
Epoch:8,validate loss:0.48011451959609985
Validation loss decreased (0.494027 --> 0.480115).  Saving model ...
Epoch:9,validate loss:0.4806051254272461
Epoch:10,validate loss:0.47498297691345215
Validation loss decreased (0.480115 --> 0.474983).  Saving model ...
Epoch:11,validate loss:0.4814240336418152
Epoch:12,validate loss:0.4759320914745331
Epoch:13,validate loss:0.47185730934143066
Validation loss decreased (0.474983 --> 0.471857).  Saving model ...
Epoch:14,validate loss:0.4749864637851715
Epoch:15,validate loss:0.475614994764328
Epoch:16,validate loss:0.47467947006225586
Epoch:17,validate loss:0.4820922613143921
Epoch:18,validate loss:0.5048131942749023
Epoch:19,validate loss:0.4838728904724121
Epoch:20,validate loss:0.5003634095191956
Epoch:21,validate loss:0.4852571189403534
Epoch:22,validate loss:0.49163007736206055
Epoch:23,validate loss:0.4792371690273285
Epoch:24,validate loss:0.4994232952594757
Epoch:25,validate loss:0.4871125817298889
Epoch:26,validate loss:0.47496283054351807
Epoch:27,validate loss:0.47423359751701355
Epoch:28,validate loss:0.47738972306251526
Epoch:29,validate loss:0.4689325988292694
Validation loss decreased (0.471857 --> 0.468933).  Saving model ...
Epoch:30,validate loss:0.46314772963523865
Validation loss decreased (0.468933 --> 0.463148).  Saving model ...
Epoch:31,validate loss:0.46892544627189636
Epoch:32,validate loss:0.46254026889801025
Validation loss decreased (0.463148 --> 0.462540).  Saving model ...
Epoch:33,validate loss:0.4620457887649536
Validation loss decreased (0.462540 --> 0.462046).  Saving model ...
Epoch:34,validate loss:0.4807024300098419
Epoch:35,validate loss:0.46798112988471985
Epoch:36,validate loss:0.48137620091438293
Epoch:37,validate loss:0.4786447286605835
Epoch:38,validate loss:0.47437575459480286
Epoch:39,validate loss:0.4634675979614258
Epoch:40,validate loss:0.46226561069488525
Epoch:41,validate loss:0.4588576555252075
Validation loss decreased (0.462046 --> 0.458858).  Saving model ...
Epoch:42,validate loss:0.4600573182106018
Epoch:43,validate loss:0.45799922943115234
Validation loss decreased (0.458858 --> 0.457999).  Saving model ...
Epoch:44,validate loss:0.45676806569099426
Validation loss decreased (0.457999 --> 0.456768).  Saving model ...
Epoch:45,validate loss:0.4630803167819977
Epoch:46,validate loss:0.4568820893764496
Epoch:47,validate loss:0.45644500851631165
Validation loss decreased (0.456768 --> 0.456445).  Saving model ...
Epoch:48,validate loss:0.45302221179008484
Validation loss decreased (0.456445 --> 0.453022).  Saving model ...
Epoch:49,validate loss:0.4696729779243469
Epoch:50,validate loss:0.45484620332717896
Epoch:51,validate loss:0.4519013464450836
Validation loss decreased (0.453022 --> 0.451901).  Saving model ...
Epoch:52,validate loss:0.4554726481437683
Epoch:53,validate loss:0.4520895779132843
Epoch:54,validate loss:0.4512398838996887
Validation loss decreased (0.451901 --> 0.451240).  Saving model ...
Epoch:55,validate loss:0.45217427611351013
Epoch:56,validate loss:0.46067243814468384
Epoch:57,validate loss:0.4543765187263489
Epoch:58,validate loss:0.44720402359962463
Validation loss decreased (0.451240 --> 0.447204).  Saving model ...
Epoch:59,validate loss:0.4453493356704712
Validation loss decreased (0.447204 --> 0.445349).  Saving model ...
Epoch:60,validate loss:0.4474150240421295
Epoch:61,validate loss:0.4677913784980774
Epoch:62,validate loss:0.4511853754520416
Epoch:63,validate loss:0.45786115527153015
Epoch:64,validate loss:0.45545437932014465
Epoch:65,validate loss:0.4531204402446747
Epoch:66,validate loss:0.4526405930519104
Epoch:67,validate loss:0.4534371495246887
Epoch:68,validate loss:0.45786529779434204
Epoch:69,validate loss:0.44543924927711487
Epoch:70,validate loss:0.4599422812461853
Epoch:71,validate loss:0.44521158933639526
Validation loss decreased (0.445349 --> 0.445212).  Saving model ...
Epoch:72,validate loss:0.43773534893989563
Validation loss decreased (0.445212 --> 0.437735).  Saving model ...
Epoch:73,validate loss:0.4439392685890198
Epoch:74,validate loss:0.4515458643436432
Epoch:75,validate loss:0.4407421350479126
Epoch:76,validate loss:0.43999066948890686
Epoch:77,validate loss:0.44832801818847656
Epoch:78,validate loss:0.438730388879776
Epoch:79,validate loss:0.4479822516441345
Epoch:80,validate loss:0.44146597385406494
Epoch:81,validate loss:0.4480186700820923
Epoch:82,validate loss:0.44534653425216675
Epoch:83,validate loss:0.4574233591556549
Epoch:84,validate loss:0.4430527985095978
Epoch:85,validate loss:0.44360485672950745
Epoch:86,validate loss:0.4517575800418854
Epoch:87,validate loss:0.43685266375541687
Validation loss decreased (0.437735 --> 0.436853).  Saving model ...
Epoch:88,validate loss:0.45110300183296204
Epoch:89,validate loss:0.4384028911590576
Epoch:90,validate loss:0.43838781118392944
Epoch:91,validate loss:0.45037397742271423
Epoch:92,validate loss:0.43855974078178406
Epoch:93,validate loss:0.43343299627304077
Validation loss decreased (0.436853 --> 0.433433).  Saving model ...
Epoch:94,validate loss:0.44053760170936584
Epoch:95,validate loss:0.43081051111221313
Validation loss decreased (0.433433 --> 0.430811).  Saving model ...
Epoch:96,validate loss:0.4410768747329712
Epoch:97,validate loss:0.43069958686828613
Validation loss decreased (0.430811 --> 0.430700).  Saving model ...
Epoch:98,validate loss:0.44165492057800293
Epoch:99,validate loss:0.4450731873512268
Epoch:100,validate loss:0.43402794003486633
Epoch:101,validate loss:0.43951061367988586
Epoch:102,validate loss:0.4337477385997772
Epoch:103,validate loss:0.436922162771225
Epoch:104,validate loss:0.42879432439804077
Validation loss decreased (0.430700 --> 0.428794).  Saving model ...
Epoch:105,validate loss:0.42162561416625977
Validation loss decreased (0.428794 --> 0.421626).  Saving model ...
Epoch:106,validate loss:0.4350849986076355
Epoch:107,validate loss:0.4274981915950775
Epoch:108,validate loss:0.4338160753250122
Epoch:109,validate loss:0.42832544445991516
Epoch:110,validate loss:0.43463653326034546
Epoch:111,validate loss:0.42966172099113464
Epoch:112,validate loss:0.4309900999069214
Epoch:113,validate loss:0.4381346106529236
Epoch:114,validate loss:0.43991729617118835
Epoch:115,validate loss:0.42874664068222046
Epoch:116,validate loss:0.43340110778808594
Epoch:117,validate loss:0.42431724071502686
Epoch:118,validate loss:0.43650686740875244
Epoch:119,validate loss:0.4282236397266388
Epoch:120,validate loss:0.4238884150981903
Epoch:121,validate loss:0.42008644342422485
Validation loss decreased (0.421626 --> 0.420086).  Saving model ...
Epoch:122,validate loss:0.42043522000312805
Epoch:123,validate loss:0.4319833219051361
Epoch:124,validate loss:0.43636855483055115
Epoch:125,validate loss:0.43005773425102234
Epoch:126,validate loss:0.42604026198387146
Epoch:127,validate loss:0.4185050427913666
Validation loss decreased (0.420086 --> 0.418505).  Saving model ...
Epoch:128,validate loss:0.41904550790786743
Epoch:129,validate loss:0.4295915961265564
Epoch:130,validate loss:0.43132683634757996
Epoch:131,validate loss:0.4382150173187256
Epoch:132,validate loss:0.4271836280822754
Epoch:133,validate loss:0.4284118413925171
Epoch:134,validate loss:0.4315114915370941
Epoch:135,validate loss:0.4278140664100647
Epoch:136,validate loss:0.4316445589065552
Epoch:137,validate loss:0.4239903390407562
Epoch:138,validate loss:0.4334838092327118
Epoch:139,validate loss:0.42025497555732727
Epoch:140,validate loss:0.4263100028038025
Epoch:141,validate loss:0.428266704082489
Epoch:142,validate loss:0.4387684762477875
Epoch:143,validate loss:0.4292699694633484
Epoch:144,validate loss:0.4232542812824249
Epoch:145,validate loss:0.4246736168861389
Epoch:146,validate loss:0.41845059394836426
Validation loss decreased (0.418505 --> 0.418451).  Saving model ...
Epoch:147,validate loss:0.42837297916412354
Epoch:148,validate loss:0.4211452007293701
Epoch:149,validate loss:0.43587058782577515
Epoch:150,validate loss:0.4305993616580963
Epoch:151,validate loss:0.4345160126686096
Epoch:152,validate loss:0.4255189597606659
Epoch:153,validate loss:0.42086169123649597
Epoch:154,validate loss:0.42536792159080505
Epoch:155,validate loss:0.41972917318344116
Epoch:156,validate loss:0.4238354563713074
Epoch:157,validate loss:0.42732733488082886
Epoch:158,validate loss:0.42754411697387695
Epoch:159,validate loss:0.4389932155609131
Epoch:160,validate loss:0.4227968156337738
Epoch:161,validate loss:0.4222275912761688
Epoch:162,validate loss:0.4198673367500305
Epoch:163,validate loss:0.41349300742149353
Validation loss decreased (0.418451 --> 0.413493).  Saving model ...
Epoch:164,validate loss:0.416546493768692
Epoch:165,validate loss:0.42081043124198914
Epoch:166,validate loss:0.4188043773174286
Epoch:167,validate loss:0.4213877022266388
Epoch:168,validate loss:0.4214637279510498
Epoch:169,validate loss:0.4143953323364258
Epoch:170,validate loss:0.41989368200302124
Epoch:171,validate loss:0.43314915895462036
Epoch:172,validate loss:0.42512246966362
Epoch:173,validate loss:0.4176780581474304
Epoch:174,validate loss:0.4305090606212616
Epoch:175,validate loss:0.4124244153499603
Validation loss decreased (0.413493 --> 0.412424).  Saving model ...
Epoch:176,validate loss:0.41137266159057617
Validation loss decreased (0.412424 --> 0.411373).  Saving model ...
Epoch:177,validate loss:0.4249526560306549
Epoch:178,validate loss:0.4152871072292328
Epoch:179,validate loss:0.41506755352020264
Epoch:180,validate loss:0.4127786159515381
Epoch:181,validate loss:0.4165019989013672
Epoch:182,validate loss:0.424274206161499
Epoch:183,validate loss:0.4188009202480316
Epoch:184,validate loss:0.4142869710922241
Epoch:185,validate loss:0.4272802174091339
Epoch:186,validate loss:0.4196738600730896
Epoch:187,validate loss:0.42711177468299866
Epoch:188,validate loss:0.4321615993976593
Epoch:189,validate loss:0.42962977290153503
Epoch:190,validate loss:0.41726577281951904
Epoch:191,validate loss:0.42716747522354126
Epoch:192,validate loss:0.4181259870529175
Epoch:193,validate loss:0.4229978024959564
Epoch:194,validate loss:0.41856664419174194
Epoch:195,validate loss:0.4225461184978485
Epoch:196,validate loss:0.4206699728965759
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.826,avg=0.100
0.0012873202,0.2955031,0.0049776253,0.0012873202,0.0016363754,0.0016593698,0.0012873202,0.18894072,0.5021335,0.0012873202,
9.2617114e-07,0.7667452,0.00052784913,3.0419682e-05,9.2617114e-07,0.23268993,9.2617114e-07,9.2617114e-07,9.2617114e-07,2.0171549e-06,
0.0034606121,0.0034606121,0.82638836,0.0034606121,0.0034606121,0.0034606121,0.14592679,0.0034606121,0.0034606121,0.0034606121,
0.0056827986,0.0056827986,0.36292544,0.48603615,0.0056827986,0.0056827986,0.0056827986,0.0056827986,0.0380317,0.07890989,
0.21500212,0.038588747,0.027083945,0.43550453,0.0042680604,0.0042680604,0.0053065247,0.26144195,0.0042680604,0.0042680604,
0.0020483679,0.014884681,0.6226243,0.0020483679,0.0079599,0.016547153,0.004253359,0.022132235,0.13167964,0.17582208,
0.5586689,0.28472883,0.009127489,0.00010367546,0.0005558461,0.00010367546,0.00010367546,0.00010367546,0.14353867,0.0029656165,
0.016899077,0.011893921,0.609695,0.0036985334,0.0036985334,0.025980955,0.31703842,0.0036985334,0.0036985334,0.0036985334,
0.0067186253,0.0067186253,0.0067186253,0.0067186253,0.27398166,0.6722692,0.0067186253,0.0067186253,0.0067186253,0.0067186253,
0.0035762338,0.0035762338,0.48307994,0.0035762338,0.010711312,0.0035762338,0.0035762338,0.0035762338,0.2915036,0.19324772,
Evaluate model on site 1 , Test MAE: 0.5815, Test MAPE: 0.0708, Test RMSE: 0.9509
Evaluate model on site 2 , Test MAE: 0.8622, Test MAPE: 0.1691, Test RMSE: 1.4756
Evaluate model on site 3 , Test MAE: 0.3241, Test MAPE: 0.0570, Test RMSE: 0.6425
Evaluate model on site 4 , Test MAE: 0.7069, Test MAPE: 0.0887, Test RMSE: 1.0238
Evaluate model on site 5 , Test MAE: 0.3708, Test MAPE: 0.0505, Test RMSE: 0.6326
Evaluate model on site 6 , Test MAE: 0.6050, Test MAPE: 0.0874, Test RMSE: 1.1370
Evaluate model on site 7 , Test MAE: 0.3512, Test MAPE: 0.0537, Test RMSE: 0.6542
Evaluate model on site 8 , Test MAE: 0.4254, Test MAPE: 0.0900, Test RMSE: 0.7141
Evaluate model on site 9 , Test MAE: 0.6758, Test MAPE: 0.1029, Test RMSE: 1.0972
Evaluate model on site 10 , Test MAE: 0.2184, Test MAPE: 0.2139, Test RMSE: 0.3637
On average over all site, Test MAE: 0.5121, Test MAPE: 0.0984, Test RMSE: 0.8692
(0.5121261671185493, 0.09839731678366662, 0.8691621631383896)
[0.49998979568481444, 0.49262887686491014, 0.4833537757396698, 0.49632167667150495, 0.5121261671185493]
data::data/water/shangban/singleFac/2,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/2', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.06908116489648819
Validation loss decreased (inf --> 0.069081).  Saving model ...
Epoch:2,validate loss:0.05966658145189285
Validation loss decreased (0.069081 --> 0.059667).  Saving model ...
Epoch:3,validate loss:0.052860889583826065
Validation loss decreased (0.059667 --> 0.052861).  Saving model ...
Epoch:4,validate loss:0.05574759095907211
Epoch:5,validate loss:0.05373932048678398
Epoch:6,validate loss:0.05230879783630371
Validation loss decreased (0.052861 --> 0.052309).  Saving model ...
Epoch:7,validate loss:0.051331862807273865
Validation loss decreased (0.052309 --> 0.051332).  Saving model ...
Epoch:8,validate loss:0.051197826862335205
Validation loss decreased (0.051332 --> 0.051198).  Saving model ...
Epoch:9,validate loss:0.05386805161833763
Epoch:10,validate loss:0.05285856872797012
Epoch:11,validate loss:0.05317619815468788
Epoch:12,validate loss:0.04990534111857414
Validation loss decreased (0.051198 --> 0.049905).  Saving model ...
Epoch:13,validate loss:0.05076676979660988
Epoch:14,validate loss:0.05108650401234627
Epoch:15,validate loss:0.05372017249464989
Epoch:16,validate loss:0.05132301151752472
Epoch:17,validate loss:0.048924002796411514
Validation loss decreased (0.049905 --> 0.048924).  Saving model ...
Epoch:18,validate loss:0.048850491642951965
Validation loss decreased (0.048924 --> 0.048850).  Saving model ...
Epoch:19,validate loss:0.047964971512556076
Validation loss decreased (0.048850 --> 0.047965).  Saving model ...
Epoch:20,validate loss:0.04827034845948219
Epoch:21,validate loss:0.047000009566545486
Validation loss decreased (0.047965 --> 0.047000).  Saving model ...
Epoch:22,validate loss:0.04842930659651756
Epoch:23,validate loss:0.04743872210383415
Epoch:24,validate loss:0.04800346866250038
Epoch:25,validate loss:0.04750467464327812
Epoch:26,validate loss:0.047004543244838715
Epoch:27,validate loss:0.047762323170900345
Epoch:28,validate loss:0.0472237691283226
Epoch:29,validate loss:0.04754031077027321
Epoch:30,validate loss:0.046250853687524796
Validation loss decreased (0.047000 --> 0.046251).  Saving model ...
Epoch:31,validate loss:0.04722847044467926
Epoch:32,validate loss:0.046365708112716675
Epoch:33,validate loss:0.046278875321149826
Epoch:34,validate loss:0.046567656099796295
Epoch:35,validate loss:0.04643814638257027
Epoch:36,validate loss:0.048073768615722656
Epoch:37,validate loss:0.046615034341812134
Epoch:38,validate loss:0.046828191727399826
Epoch:39,validate loss:0.04975416883826256
Epoch:40,validate loss:0.04826805740594864
Epoch:41,validate loss:0.047997474670410156
Epoch:42,validate loss:0.04633196443319321
Epoch:43,validate loss:0.04666215181350708
Epoch:44,validate loss:0.04647347331047058
Epoch:45,validate loss:0.04644918069243431
Epoch:46,validate loss:0.04692740738391876
Epoch:47,validate loss:0.047336604446172714
Epoch:48,validate loss:0.045599061995744705
Validation loss decreased (0.046251 --> 0.045599).  Saving model ...
Epoch:49,validate loss:0.04610339552164078
Epoch:50,validate loss:0.04582890123128891
Epoch:51,validate loss:0.04717988148331642
Epoch:52,validate loss:0.046207305043935776
Epoch:53,validate loss:0.04866217449307442
Epoch:54,validate loss:0.04664808511734009
Epoch:55,validate loss:0.04667096212506294
Epoch:56,validate loss:0.046541549265384674
Epoch:57,validate loss:0.045703768730163574
Epoch:58,validate loss:0.045545268803834915
Validation loss decreased (0.045599 --> 0.045545).  Saving model ...
Epoch:59,validate loss:0.04616899415850639
Epoch:60,validate loss:0.04892610013484955
Epoch:61,validate loss:0.04762180149555206
Epoch:62,validate loss:0.045676782727241516
Epoch:63,validate loss:0.04672446846961975
Epoch:64,validate loss:0.046171147376298904
Epoch:65,validate loss:0.045606330037117004
Epoch:66,validate loss:0.045855142176151276
Epoch:67,validate loss:0.045782461762428284
Epoch:68,validate loss:0.04690372571349144
Epoch:69,validate loss:0.04608412832021713
Epoch:70,validate loss:0.04526737332344055
Validation loss decreased (0.045545 --> 0.045267).  Saving model ...
Epoch:71,validate loss:0.04558081179857254
Epoch:72,validate loss:0.04624984785914421
Epoch:73,validate loss:0.045767053961753845
Epoch:74,validate loss:0.04886896163225174
Epoch:75,validate loss:0.046546828001737595
Epoch:76,validate loss:0.04593564197421074
Epoch:77,validate loss:0.045296866446733475
Epoch:78,validate loss:0.046099789440631866
Epoch:79,validate loss:0.046670086681842804
Epoch:80,validate loss:0.04538042098283768
Epoch:81,validate loss:0.04784461483359337
Epoch:82,validate loss:0.04690827056765556
Epoch:83,validate loss:0.0477963462471962
Epoch:84,validate loss:0.0467386431992054
Epoch:85,validate loss:0.0454394593834877
Epoch:86,validate loss:0.045256417244672775
Validation loss decreased (0.045267 --> 0.045256).  Saving model ...
Epoch:87,validate loss:0.046517062932252884
Epoch:88,validate loss:0.04602746292948723
Epoch:89,validate loss:0.04545050486922264
Epoch:90,validate loss:0.04627710580825806
Epoch:91,validate loss:0.04574914276599884
Epoch:92,validate loss:0.045949820429086685
Epoch:93,validate loss:0.04641072079539299
Epoch:94,validate loss:0.04613141715526581
Epoch:95,validate loss:0.04556949809193611
Epoch:96,validate loss:0.0451074056327343
Validation loss decreased (0.045256 --> 0.045107).  Saving model ...
Epoch:97,validate loss:0.047142788767814636
Epoch:98,validate loss:0.046806156635284424
Epoch:99,validate loss:0.0456300750374794
Epoch:100,validate loss:0.045457836240530014
Epoch:101,validate loss:0.04649224132299423
Epoch:102,validate loss:0.046126846224069595
Epoch:103,validate loss:0.04584841802716255
Epoch:104,validate loss:0.045374855399131775
Epoch:105,validate loss:0.04634229466319084
Epoch:106,validate loss:0.045737847685813904
Epoch:107,validate loss:0.04649435356259346
Epoch:108,validate loss:0.04589405655860901
Epoch:109,validate loss:0.04601200297474861
Epoch:110,validate loss:0.0457523874938488
Epoch:111,validate loss:0.045015860348939896
Validation loss decreased (0.045107 --> 0.045016).  Saving model ...
Epoch:112,validate loss:0.04600904509425163
Epoch:113,validate loss:0.046548645943403244
Epoch:114,validate loss:0.0461350679397583
Epoch:115,validate loss:0.047576963901519775
Epoch:116,validate loss:0.04530319571495056
Epoch:117,validate loss:0.04522407799959183
Epoch:118,validate loss:0.045652493834495544
Epoch:119,validate loss:0.046745847910642624
Epoch:120,validate loss:0.045337386429309845
Epoch:121,validate loss:0.04613584280014038
Epoch:122,validate loss:0.04586537927389145
Epoch:123,validate loss:0.045143917202949524
Epoch:124,validate loss:0.04523999243974686
Epoch:125,validate loss:0.046115610748529434
Epoch:126,validate loss:0.048065055161714554
Epoch:127,validate loss:0.04641081020236015
Epoch:128,validate loss:0.04695139080286026
Epoch:129,validate loss:0.04597655311226845
Epoch:130,validate loss:0.045131947845220566
Epoch:131,validate loss:0.044836193323135376
Validation loss decreased (0.045016 --> 0.044836).  Saving model ...
Epoch:132,validate loss:0.04549173638224602
Epoch:133,validate loss:0.04718439653515816
Epoch:134,validate loss:0.04579971730709076
Epoch:135,validate loss:0.04551209136843681
Epoch:136,validate loss:0.04559154808521271
Epoch:137,validate loss:0.04537522420287132
Epoch:138,validate loss:0.045086633414030075
Epoch:139,validate loss:0.046548258513212204
Epoch:140,validate loss:0.04569953680038452
Epoch:141,validate loss:0.04557453468441963
Epoch:142,validate loss:0.04541952908039093
Epoch:143,validate loss:0.0450088195502758
Epoch:144,validate loss:0.04705736041069031
Epoch:145,validate loss:0.04663116857409477
Epoch:146,validate loss:0.04592876508831978
Epoch:147,validate loss:0.04557786136865616
Epoch:148,validate loss:0.045863863080739975
Epoch:149,validate loss:0.046609047800302505
Epoch:150,validate loss:0.046322524547576904
Epoch:151,validate loss:0.04537270963191986
Early stopping.
Training finished
邻接矩阵：min=0.025,max=0.726,avg=0.100
0.037434362,0.037434362,0.04505793,0.06075235,0.037434362,0.04318068,0.061924,0.037434362,0.6019132,0.037434362,
0.035245474,0.035245474,0.043699525,0.046262804,0.035245474,0.6593838,0.035245474,0.039180994,0.035245474,0.035245474,
0.036126163,0.036126163,0.35871446,0.036126163,0.16799764,0.036126163,0.2148593,0.036126163,0.04167159,0.036126163,
0.042173646,0.04212107,0.04212107,0.04212107,0.04212107,0.04212107,0.0583596,0.04212107,0.17550045,0.47123992,
0.047677435,0.047677435,0.047677435,0.09818694,0.21865703,0.047677435,0.047677435,0.34941402,0.047677435,0.047677435,
0.03732209,0.03732209,0.03732209,0.04735342,0.03732209,0.03732209,0.03742563,0.038869884,0.6524185,0.03732209,
0.040548436,0.040548436,0.040548436,0.040548436,0.061443113,0.040548436,0.044541176,0.04420159,0.054767072,0.5923047,
0.046136208,0.047221784,0.04729689,0.046136208,0.046136208,0.5825279,0.046136208,0.046136208,0.046136208,0.046136208,
0.02497126,0.02497126,0.02497126,0.7262148,0.02497126,0.043144383,0.02497126,0.02497126,0.02497126,0.055841975,
0.056243785,0.0468907,0.07046602,0.059775878,0.04534015,0.04798904,0.061983995,0.07908804,0.04534015,0.4868823,
Evaluate model on site 1 , Test MAE: 0.0514, Test MAPE: 0.0623, Test RMSE: 0.0913
Evaluate model on site 2 , Test MAE: 0.0684, Test MAPE: 0.0969, Test RMSE: 0.1166
Evaluate model on site 3 , Test MAE: 0.0310, Test MAPE: 0.1219, Test RMSE: 0.0873
Evaluate model on site 4 , Test MAE: 0.0580, Test MAPE: 0.1892, Test RMSE: 0.1059
Evaluate model on site 5 , Test MAE: 0.0373, Test MAPE: 0.0908, Test RMSE: 0.0753
Evaluate model on site 6 , Test MAE: 0.0613, Test MAPE: 0.1056, Test RMSE: 0.1076
Evaluate model on site 7 , Test MAE: 0.0360, Test MAPE: 0.0954, Test RMSE: 0.0769
Evaluate model on site 8 , Test MAE: 0.0447, Test MAPE: 0.0656, Test RMSE: 0.0867
Evaluate model on site 9 , Test MAE: 0.0545, Test MAPE: 0.1091, Test RMSE: 0.0932
Evaluate model on site 10 , Test MAE: 0.0142, Test MAPE: 0.1024, Test RMSE: 0.0241
On average over all site, Test MAE: 0.0457, Test MAPE: 0.1039, Test RMSE: 0.0865
(0.04568463256582618, 0.10392784550786019, 0.08648962378501893)
data::data/water/shangban/singleFac/2,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/2', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.07028084248304367
Validation loss decreased (inf --> 0.070281).  Saving model ...
Epoch:2,validate loss:0.05602623149752617
Validation loss decreased (0.070281 --> 0.056026).  Saving model ...
Epoch:3,validate loss:0.05499489605426788
Validation loss decreased (0.056026 --> 0.054995).  Saving model ...
Epoch:4,validate loss:0.05250285193324089
Validation loss decreased (0.054995 --> 0.052503).  Saving model ...
Epoch:5,validate loss:0.05319009721279144
Epoch:6,validate loss:0.05236927047371864
Validation loss decreased (0.052503 --> 0.052369).  Saving model ...
Epoch:7,validate loss:0.052956338971853256
Epoch:8,validate loss:0.05227407440543175
Validation loss decreased (0.052369 --> 0.052274).  Saving model ...
Epoch:9,validate loss:0.053711362183094025
Epoch:10,validate loss:0.051101695746183395
Validation loss decreased (0.052274 --> 0.051102).  Saving model ...
Epoch:11,validate loss:0.05339810997247696
Epoch:12,validate loss:0.05130074545741081
Epoch:13,validate loss:0.05050380527973175
Validation loss decreased (0.051102 --> 0.050504).  Saving model ...
Epoch:14,validate loss:0.04984227940440178
Validation loss decreased (0.050504 --> 0.049842).  Saving model ...
Epoch:15,validate loss:0.04943326488137245
Validation loss decreased (0.049842 --> 0.049433).  Saving model ...
Epoch:16,validate loss:0.05089272931218147
Epoch:17,validate loss:0.04981072619557381
Epoch:18,validate loss:0.04934171587228775
Validation loss decreased (0.049433 --> 0.049342).  Saving model ...
Epoch:19,validate loss:0.04888719320297241
Validation loss decreased (0.049342 --> 0.048887).  Saving model ...
Epoch:20,validate loss:0.050596319139003754
Epoch:21,validate loss:0.0481579415500164
Validation loss decreased (0.048887 --> 0.048158).  Saving model ...
Epoch:22,validate loss:0.048053670674562454
Validation loss decreased (0.048158 --> 0.048054).  Saving model ...
Epoch:23,validate loss:0.04743178188800812
Validation loss decreased (0.048054 --> 0.047432).  Saving model ...
Epoch:24,validate loss:0.04640232026576996
Validation loss decreased (0.047432 --> 0.046402).  Saving model ...
Epoch:25,validate loss:0.04738380014896393
Epoch:26,validate loss:0.04731106385588646
Epoch:27,validate loss:0.04691827669739723
Epoch:28,validate loss:0.05061030015349388
Epoch:29,validate loss:0.048178017139434814
Epoch:30,validate loss:0.04810529947280884
Epoch:31,validate loss:0.04615911841392517
Validation loss decreased (0.046402 --> 0.046159).  Saving model ...
Epoch:32,validate loss:0.04744243994355202
Epoch:33,validate loss:0.046570733189582825
Epoch:34,validate loss:0.04564781114459038
Validation loss decreased (0.046159 --> 0.045648).  Saving model ...
Epoch:35,validate loss:0.04586925357580185
Epoch:36,validate loss:0.04570683091878891
Epoch:37,validate loss:0.046514641493558884
Epoch:38,validate loss:0.047540292143821716
Epoch:39,validate loss:0.0477670393884182
Epoch:40,validate loss:0.045942652970552444
Epoch:41,validate loss:0.04610665887594223
Epoch:42,validate loss:0.04581121727824211
Epoch:43,validate loss:0.04597209021449089
Epoch:44,validate loss:0.045921310782432556
Epoch:45,validate loss:0.04615463688969612
Epoch:46,validate loss:0.046144627034664154
Epoch:47,validate loss:0.046646516770124435
Epoch:48,validate loss:0.046535659581422806
Epoch:49,validate loss:0.045741766691207886
Epoch:50,validate loss:0.04519496113061905
Validation loss decreased (0.045648 --> 0.045195).  Saving model ...
Epoch:51,validate loss:0.045955151319503784
Epoch:52,validate loss:0.04477141425013542
Validation loss decreased (0.045195 --> 0.044771).  Saving model ...
Epoch:53,validate loss:0.04545583203434944
Epoch:54,validate loss:0.04714963585138321
Epoch:55,validate loss:0.04722852259874344
Epoch:56,validate loss:0.04716281220316887
Epoch:57,validate loss:0.04539763927459717
Epoch:58,validate loss:0.04583558067679405
Epoch:59,validate loss:0.045561499893665314
Epoch:60,validate loss:0.04476116970181465
Validation loss decreased (0.044771 --> 0.044761).  Saving model ...
Epoch:61,validate loss:0.04475376754999161
Validation loss decreased (0.044761 --> 0.044754).  Saving model ...
Epoch:62,validate loss:0.046458955854177475
Epoch:63,validate loss:0.044873133301734924
Epoch:64,validate loss:0.04811412841081619
Epoch:65,validate loss:0.04818737134337425
Epoch:66,validate loss:0.04655303433537483
Epoch:67,validate loss:0.04664519056677818
Epoch:68,validate loss:0.04594769328832626
Epoch:69,validate loss:0.04487479850649834
Epoch:70,validate loss:0.04672591760754585
Epoch:71,validate loss:0.04531613364815712
Epoch:72,validate loss:0.04653066396713257
Epoch:73,validate loss:0.046055398881435394
Epoch:74,validate loss:0.0444072000682354
Validation loss decreased (0.044754 --> 0.044407).  Saving model ...
Epoch:75,validate loss:0.047238532453775406
Epoch:76,validate loss:0.04473424330353737
Epoch:77,validate loss:0.04514070600271225
Epoch:78,validate loss:0.045110173523426056
Epoch:79,validate loss:0.04671437293291092
Epoch:80,validate loss:0.04586845263838768
Epoch:81,validate loss:0.04450317844748497
Epoch:82,validate loss:0.044484980404376984
Epoch:83,validate loss:0.04650413990020752
Epoch:84,validate loss:0.044904302805662155
Epoch:85,validate loss:0.045253731310367584
Epoch:86,validate loss:0.04581543803215027
Epoch:87,validate loss:0.04591070115566254
Epoch:88,validate loss:0.04619285836815834
Epoch:89,validate loss:0.045350100845098495
Epoch:90,validate loss:0.04696103185415268
Epoch:91,validate loss:0.04469909146428108
Epoch:92,validate loss:0.04454941302537918
Epoch:93,validate loss:0.04529112949967384
Epoch:94,validate loss:0.04448588192462921
Early stopping.
Training finished
邻接矩阵：min=0.002,max=0.939,avg=0.100
0.0021058829,0.0037347819,0.0021058829,0.04105085,0.0021058829,0.0021058829,0.0021058829,0.0021058829,0.93871284,0.003866137,
0.26273134,0.010318894,0.010318894,0.04857979,0.010318894,0.39716205,0.17121509,0.054465514,0.010318894,0.024570676,
0.009450268,0.01003389,0.009450268,0.009450268,0.009450268,0.009450268,0.9122283,0.01158599,0.009450268,0.009450268,
0.007837197,0.007837197,0.02896379,0.007837197,0.007837197,0.007837197,0.05153936,0.007837197,0.86463636,0.007837197,
0.29284567,0.02098224,0.02098224,0.02098224,0.02098224,0.028718289,0.02098224,0.02098224,0.5315603,0.02098224,
0.8490109,0.014787277,0.024068821,0.014787277,0.014787277,0.015868964,0.014787277,0.014787277,0.02232768,0.014787277,
0.013808563,0.019073168,0.45108745,0.011067252,0.011067252,0.011067252,0.011067252,0.011067252,0.41785383,0.042840756,
0.012398735,0.012398735,0.012398735,0.8818703,0.015037443,0.012398735,0.012398735,0.012398735,0.016301146,0.012398735,
0.014744696,0.85748106,0.014744696,0.014744696,0.014744696,0.014744696,0.024561398,0.014744696,0.014744696,0.014744696,
0.015915109,0.027967617,0.008466542,0.018713523,0.69328153,0.008466542,0.09479282,0.008466542,0.1154632,0.008466542,
Evaluate model on site 1 , Test MAE: 0.0519, Test MAPE: 0.0626, Test RMSE: 0.0893
Evaluate model on site 2 , Test MAE: 0.0700, Test MAPE: 0.0996, Test RMSE: 0.1171
Evaluate model on site 3 , Test MAE: 0.0309, Test MAPE: 0.1211, Test RMSE: 0.0865
Evaluate model on site 4 , Test MAE: 0.0579, Test MAPE: 0.1849, Test RMSE: 0.1061
Evaluate model on site 5 , Test MAE: 0.0370, Test MAPE: 0.0906, Test RMSE: 0.0741
Evaluate model on site 6 , Test MAE: 0.0639, Test MAPE: 0.1122, Test RMSE: 0.1100
Evaluate model on site 7 , Test MAE: 0.0354, Test MAPE: 0.0927, Test RMSE: 0.0771
Evaluate model on site 8 , Test MAE: 0.0455, Test MAPE: 0.0650, Test RMSE: 0.0895
Evaluate model on site 9 , Test MAE: 0.0544, Test MAPE: 0.1081, Test RMSE: 0.0952
Evaluate model on site 10 , Test MAE: 0.0144, Test MAPE: 0.1039, Test RMSE: 0.0242
On average over all site, Test MAE: 0.0461, Test MAPE: 0.1041, Test RMSE: 0.0869
(0.04612503414973616, 0.10406077131628991, 0.08691198024898768)
data::data/water/shangban/singleFac/2,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/2', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.06422163546085358
Validation loss decreased (inf --> 0.064222).  Saving model ...
Epoch:2,validate loss:0.056241121143102646
Validation loss decreased (0.064222 --> 0.056241).  Saving model ...
Epoch:3,validate loss:0.053863074630498886
Validation loss decreased (0.056241 --> 0.053863).  Saving model ...
Epoch:4,validate loss:0.05516573786735535
Epoch:5,validate loss:0.05359484627842903
Validation loss decreased (0.053863 --> 0.053595).  Saving model ...
Epoch:6,validate loss:0.05137332156300545
Validation loss decreased (0.053595 --> 0.051373).  Saving model ...
Epoch:7,validate loss:0.051976922899484634
Epoch:8,validate loss:0.05390072241425514
Epoch:9,validate loss:0.05154773220419884
Epoch:10,validate loss:0.05025539919734001
Validation loss decreased (0.051373 --> 0.050255).  Saving model ...
Epoch:11,validate loss:0.0491938553750515
Validation loss decreased (0.050255 --> 0.049194).  Saving model ...
Epoch:12,validate loss:0.04971824586391449
Epoch:13,validate loss:0.04777306690812111
Validation loss decreased (0.049194 --> 0.047773).  Saving model ...
Epoch:14,validate loss:0.04877718538045883
Epoch:15,validate loss:0.04896113649010658
Epoch:16,validate loss:0.04763597995042801
Validation loss decreased (0.047773 --> 0.047636).  Saving model ...
Epoch:17,validate loss:0.04694078862667084
Validation loss decreased (0.047636 --> 0.046941).  Saving model ...
Epoch:18,validate loss:0.04878532513976097
Epoch:19,validate loss:0.04913322255015373
Epoch:20,validate loss:0.04633651673793793
Validation loss decreased (0.046941 --> 0.046337).  Saving model ...
Epoch:21,validate loss:0.047264792025089264
Epoch:22,validate loss:0.04629033803939819
Validation loss decreased (0.046337 --> 0.046290).  Saving model ...
Epoch:23,validate loss:0.04771097004413605
Epoch:24,validate loss:0.04908064380288124
Epoch:25,validate loss:0.04827038571238518
Epoch:26,validate loss:0.04743589833378792
Epoch:27,validate loss:0.051711875945329666
Epoch:28,validate loss:0.04602358117699623
Validation loss decreased (0.046290 --> 0.046024).  Saving model ...
Epoch:29,validate loss:0.046634238213300705
Epoch:30,validate loss:0.04792187362909317
Epoch:31,validate loss:0.046052321791648865
Epoch:32,validate loss:0.04720388352870941
Epoch:33,validate loss:0.04608366638422012
Epoch:34,validate loss:0.04613545909523964
Epoch:35,validate loss:0.046138036996126175
Epoch:36,validate loss:0.045597657561302185
Validation loss decreased (0.046024 --> 0.045598).  Saving model ...
Epoch:37,validate loss:0.04618183150887489
Epoch:38,validate loss:0.048369113355875015
Epoch:39,validate loss:0.04689197614789009
Epoch:40,validate loss:0.047191210091114044
Epoch:41,validate loss:0.045190416276454926
Validation loss decreased (0.045598 --> 0.045190).  Saving model ...
Epoch:42,validate loss:0.04509839415550232
Validation loss decreased (0.045190 --> 0.045098).  Saving model ...
Epoch:43,validate loss:0.0455380342900753
Epoch:44,validate loss:0.045430734753608704
Epoch:45,validate loss:0.04522262513637543
Epoch:46,validate loss:0.0461888425052166
Epoch:47,validate loss:0.046567920595407486
Epoch:48,validate loss:0.04605056345462799
Epoch:49,validate loss:0.04569308087229729
Epoch:50,validate loss:0.0453559048473835
Epoch:51,validate loss:0.04502416402101517
Validation loss decreased (0.045098 --> 0.045024).  Saving model ...
Epoch:52,validate loss:0.04494521766901016
Validation loss decreased (0.045024 --> 0.044945).  Saving model ...
Epoch:53,validate loss:0.04510217159986496
Epoch:54,validate loss:0.04667402431368828
Epoch:55,validate loss:0.04549351707100868
Epoch:56,validate loss:0.04737694561481476
Epoch:57,validate loss:0.04588935896754265
Epoch:58,validate loss:0.04623914510011673
Epoch:59,validate loss:0.045274291187524796
Epoch:60,validate loss:0.045427996665239334
Epoch:61,validate loss:0.044948969036340714
Epoch:62,validate loss:0.04634583368897438
Epoch:63,validate loss:0.0455753430724144
Epoch:64,validate loss:0.044791143387556076
Validation loss decreased (0.044945 --> 0.044791).  Saving model ...
Epoch:65,validate loss:0.04570622742176056
Epoch:66,validate loss:0.049213554710149765
Epoch:67,validate loss:0.04652626812458038
Epoch:68,validate loss:0.0458671860396862
Epoch:69,validate loss:0.045525893568992615
Epoch:70,validate loss:0.04498986154794693
Epoch:71,validate loss:0.04500395432114601
Epoch:72,validate loss:0.04546286165714264
Epoch:73,validate loss:0.04579965025186539
Epoch:74,validate loss:0.045288484543561935
Epoch:75,validate loss:0.04623628780245781
Epoch:76,validate loss:0.046162933111190796
Epoch:77,validate loss:0.0452362596988678
Epoch:78,validate loss:0.04563417658209801
Epoch:79,validate loss:0.04593611881136894
Epoch:80,validate loss:0.045355334877967834
Epoch:81,validate loss:0.04694533720612526
Epoch:82,validate loss:0.044907450675964355
Epoch:83,validate loss:0.04482835531234741
Epoch:84,validate loss:0.0460585318505764
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.927,avg=0.100
0.7152442,0.00091450487,0.0021240998,0.00941275,0.00015251178,0.00015251178,0.00015251178,0.2710882,0.00042888455,0.00032979873,
0.015345163,0.015450765,0.015345163,0.055809848,0.82132334,0.015345163,0.015345163,0.015345163,0.015345163,0.015345163,
0.054962352,0.021293385,0.035298772,0.021293385,0.023661416,0.021293385,0.7583172,0.021293385,0.021293385,0.021293385,
0.02529311,0.03837232,0.009075476,0.009075476,0.018287128,0.77399796,0.009075476,0.009075476,0.009075476,0.098672114,
0.0012270142,0.0012270142,0.004510054,0.0012270142,0.0026679898,0.043360565,0.0024479462,0.08393906,0.015516862,0.84387654,
0.0020832007,0.8903845,0.00020457456,0.00011071115,0.00011071115,0.0037918678,0.00038916437,0.00011071115,0.08630305,0.016511606,
0.006900478,0.006900478,0.006900478,0.006900478,0.026020454,0.04804117,0.6634284,0.22110711,0.006900478,0.006900478,
0.046809476,0.025183186,0.09227027,0.5713464,0.055237908,0.012180331,0.014267301,0.14254253,0.014480491,0.025682174,
0.009919357,0.0064139864,0.92699337,0.0064139864,0.0064139864,0.018189277,0.0064140107,0.0064139864,0.0064139864,0.0064139864,
0.033459287,0.17795362,0.033544943,0.051038638,0.033459287,0.53670704,0.033459287,0.033459287,0.033459287,0.033459287,
Evaluate model on site 1 , Test MAE: 0.0527, Test MAPE: 0.0644, Test RMSE: 0.0924
Evaluate model on site 2 , Test MAE: 0.0686, Test MAPE: 0.0964, Test RMSE: 0.1169
Evaluate model on site 3 , Test MAE: 0.0319, Test MAPE: 0.1327, Test RMSE: 0.0861
Evaluate model on site 4 , Test MAE: 0.0585, Test MAPE: 0.1958, Test RMSE: 0.1047
Evaluate model on site 5 , Test MAE: 0.0371, Test MAPE: 0.0894, Test RMSE: 0.0764
Evaluate model on site 6 , Test MAE: 0.0611, Test MAPE: 0.1051, Test RMSE: 0.1084
Evaluate model on site 7 , Test MAE: 0.0357, Test MAPE: 0.0932, Test RMSE: 0.0774
Evaluate model on site 8 , Test MAE: 0.0458, Test MAPE: 0.0664, Test RMSE: 0.0894
Evaluate model on site 9 , Test MAE: 0.0560, Test MAPE: 0.1099, Test RMSE: 0.0975
Evaluate model on site 10 , Test MAE: 0.0151, Test MAPE: 0.1140, Test RMSE: 0.0242
On average over all site, Test MAE: 0.0462, Test MAPE: 0.1067, Test RMSE: 0.0873
(0.04623560821637511, 0.10674435421824455, 0.08734777383506298)
data::data/water/shangban/singleFac/2,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/2', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.06430237740278244
Validation loss decreased (inf --> 0.064302).  Saving model ...
Epoch:2,validate loss:0.05893033370375633
Validation loss decreased (0.064302 --> 0.058930).  Saving model ...
Epoch:3,validate loss:0.051701437681913376
Validation loss decreased (0.058930 --> 0.051701).  Saving model ...
Epoch:4,validate loss:0.05159379169344902
Validation loss decreased (0.051701 --> 0.051594).  Saving model ...
Epoch:5,validate loss:0.051320016384124756
Validation loss decreased (0.051594 --> 0.051320).  Saving model ...
Epoch:6,validate loss:0.05459652096033096
Epoch:7,validate loss:0.051965367048978806
Epoch:8,validate loss:0.05486678332090378
Epoch:9,validate loss:0.054284874349832535
Epoch:10,validate loss:0.05116543546319008
Validation loss decreased (0.051320 --> 0.051165).  Saving model ...
Epoch:11,validate loss:0.050357136875391006
Validation loss decreased (0.051165 --> 0.050357).  Saving model ...
Epoch:12,validate loss:0.049084074795246124
Validation loss decreased (0.050357 --> 0.049084).  Saving model ...
Epoch:13,validate loss:0.04811914265155792
Validation loss decreased (0.049084 --> 0.048119).  Saving model ...
Epoch:14,validate loss:0.04966467246413231
Epoch:15,validate loss:0.04829728603363037
Epoch:16,validate loss:0.05040641129016876
Epoch:17,validate loss:0.047793228179216385
Validation loss decreased (0.048119 --> 0.047793).  Saving model ...
Epoch:18,validate loss:0.04717119038105011
Validation loss decreased (0.047793 --> 0.047171).  Saving model ...
Epoch:19,validate loss:0.04719172418117523
Epoch:20,validate loss:0.04722461849451065
Epoch:21,validate loss:0.048538099974393845
Epoch:22,validate loss:0.04938621073961258
Epoch:23,validate loss:0.04942821338772774
Epoch:24,validate loss:0.04849379137158394
Epoch:25,validate loss:0.047056715935468674
Validation loss decreased (0.047171 --> 0.047057).  Saving model ...
Epoch:26,validate loss:0.04764329269528389
Epoch:27,validate loss:0.046267811208963394
Validation loss decreased (0.047057 --> 0.046268).  Saving model ...
Epoch:28,validate loss:0.04687241092324257
Epoch:29,validate loss:0.04709317162632942
Epoch:30,validate loss:0.04662900045514107
Epoch:31,validate loss:0.0477474182844162
Epoch:32,validate loss:0.04706225544214249
Epoch:33,validate loss:0.04607126861810684
Validation loss decreased (0.046268 --> 0.046071).  Saving model ...
Epoch:34,validate loss:0.047495342791080475
Epoch:35,validate loss:0.046120282262563705
Epoch:36,validate loss:0.04642977565526962
Epoch:37,validate loss:0.04630330577492714
Epoch:38,validate loss:0.04646391049027443
Epoch:39,validate loss:0.04823876917362213
Epoch:40,validate loss:0.04769209399819374
Epoch:41,validate loss:0.04706993326544762
Epoch:42,validate loss:0.04674302414059639
Epoch:43,validate loss:0.046560950577259064
Epoch:44,validate loss:0.046861689537763596
Epoch:45,validate loss:0.04699670895934105
Epoch:46,validate loss:0.04851892963051796
Epoch:47,validate loss:0.04730674624443054
Epoch:48,validate loss:0.046729639172554016
Epoch:49,validate loss:0.047354694455862045
Epoch:50,validate loss:0.04645943641662598
Epoch:51,validate loss:0.04626547917723656
Epoch:52,validate loss:0.04693511500954628
Epoch:53,validate loss:0.0462101474404335
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.942,avg=0.100
0.003193212,0.003193212,0.003193212,0.003193212,0.003193212,0.8617855,0.10798494,0.003193212,0.003193212,0.007877203,
0.0010223655,0.0010223655,0.0038595079,0.0069989706,0.03381157,0.0010223655,0.36382076,0.22539574,0.3556522,0.0073940963,
0.09166354,0.09166354,0.09166354,0.09166354,0.09166354,0.09166354,0.09166354,0.17502816,0.09166354,0.09166354,
0.015126415,0.05231127,0.44841236,0.023396298,0.018018031,0.015126415,0.015126415,0.015126415,0.015126415,0.38222992,
0.0018807083,0.0068955617,0.011294046,0.005597424,0.012566772,0.9421135,0.0018807083,0.0018807083,0.0062117698,0.009678725,
0.0033717786,0.0033717786,0.0033717786,0.6154404,0.023438912,0.0033717786,0.33252996,0.0033717786,0.0033717786,0.008360112,
0.0099147605,0.0099147605,0.07241211,0.059029896,0.0099147605,0.0425345,0.0099147605,0.0099147605,0.76653486,0.0099147605,
0.002705952,0.82622045,0.04288411,0.08417082,0.0012115674,0.0012115674,0.0012115674,0.0012115674,0.0030207548,0.036151655,
0.12161061,0.005653937,0.0050624297,0.0050624297,0.0050624297,0.0050624297,0.022138359,0.0050624297,0.7386561,0.0866288,
1.0701367e-05,3.184888e-06,0.0003670878,3.184888e-06,0.6961245,0.00018621687,6.0768667e-05,0.303172,3.184888e-06,6.9128044e-05,
Evaluate model on site 1 , Test MAE: 0.0535, Test MAPE: 0.0652, Test RMSE: 0.0916
Evaluate model on site 2 , Test MAE: 0.0712, Test MAPE: 0.1008, Test RMSE: 0.1211
Evaluate model on site 3 , Test MAE: 0.0324, Test MAPE: 0.1362, Test RMSE: 0.0869
Evaluate model on site 4 , Test MAE: 0.0583, Test MAPE: 0.1928, Test RMSE: 0.1059
Evaluate model on site 5 , Test MAE: 0.0372, Test MAPE: 0.0904, Test RMSE: 0.0748
Evaluate model on site 6 , Test MAE: 0.0657, Test MAPE: 0.1177, Test RMSE: 0.1081
Evaluate model on site 7 , Test MAE: 0.0354, Test MAPE: 0.0935, Test RMSE: 0.0764
Evaluate model on site 8 , Test MAE: 0.0458, Test MAPE: 0.0671, Test RMSE: 0.0878
Evaluate model on site 9 , Test MAE: 0.0531, Test MAPE: 0.1052, Test RMSE: 0.0902
Evaluate model on site 10 , Test MAE: 0.0160, Test MAPE: 0.1213, Test RMSE: 0.0248
On average over all site, Test MAE: 0.0468, Test MAPE: 0.1090, Test RMSE: 0.0868
(0.046847918070852757, 0.10902525559067726, 0.0867628276348114)
data::data/water/shangban/singleFac/2,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/2', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.08492935448884964
Validation loss decreased (inf --> 0.084929).  Saving model ...
Epoch:2,validate loss:0.059776268899440765
Validation loss decreased (0.084929 --> 0.059776).  Saving model ...
Epoch:3,validate loss:0.05763645097613335
Validation loss decreased (0.059776 --> 0.057636).  Saving model ...
Epoch:4,validate loss:0.054942674934864044
Validation loss decreased (0.057636 --> 0.054943).  Saving model ...
Epoch:5,validate loss:0.05279693007469177
Validation loss decreased (0.054943 --> 0.052797).  Saving model ...
Epoch:6,validate loss:0.05324747785925865
Epoch:7,validate loss:0.05382189154624939
Epoch:8,validate loss:0.05233221501111984
Validation loss decreased (0.052797 --> 0.052332).  Saving model ...
Epoch:9,validate loss:0.055279966443777084
Epoch:10,validate loss:0.05320459231734276
Epoch:11,validate loss:0.05186152458190918
Validation loss decreased (0.052332 --> 0.051862).  Saving model ...
Epoch:12,validate loss:0.05288737267255783
Epoch:13,validate loss:0.051419276744127274
Validation loss decreased (0.051862 --> 0.051419).  Saving model ...
Epoch:14,validate loss:0.05057988315820694
Validation loss decreased (0.051419 --> 0.050580).  Saving model ...
Epoch:15,validate loss:0.050708383321762085
Epoch:16,validate loss:0.04976746439933777
Validation loss decreased (0.050580 --> 0.049767).  Saving model ...
Epoch:17,validate loss:0.05153920501470566
Epoch:18,validate loss:0.0520523302257061
Epoch:19,validate loss:0.051915768533945084
Epoch:20,validate loss:0.051058001816272736
Epoch:21,validate loss:0.051267657428979874
Epoch:22,validate loss:0.049499768763780594
Validation loss decreased (0.049767 --> 0.049500).  Saving model ...
Epoch:23,validate loss:0.047665663063526154
Validation loss decreased (0.049500 --> 0.047666).  Saving model ...
Epoch:24,validate loss:0.04979981482028961
Epoch:25,validate loss:0.04791489988565445
Epoch:26,validate loss:0.047288913279771805
Validation loss decreased (0.047666 --> 0.047289).  Saving model ...
Epoch:27,validate loss:0.048532430082559586
Epoch:28,validate loss:0.04652818292379379
Validation loss decreased (0.047289 --> 0.046528).  Saving model ...
Epoch:29,validate loss:0.047641556710004807
Epoch:30,validate loss:0.04694944992661476
Epoch:31,validate loss:0.04613809660077095
Validation loss decreased (0.046528 --> 0.046138).  Saving model ...
Epoch:32,validate loss:0.04599369689822197
Validation loss decreased (0.046138 --> 0.045994).  Saving model ...
Epoch:33,validate loss:0.04650534689426422
Epoch:34,validate loss:0.046048421412706375
Epoch:35,validate loss:0.04728814959526062
Epoch:36,validate loss:0.04641849547624588
Epoch:37,validate loss:0.04688635095953941
Epoch:38,validate loss:0.04632730036973953
Epoch:39,validate loss:0.04721737280488014
Epoch:40,validate loss:0.04619129002094269
Epoch:41,validate loss:0.04658456891775131
Epoch:42,validate loss:0.04614987596869469
Epoch:43,validate loss:0.045781899243593216
Validation loss decreased (0.045994 --> 0.045782).  Saving model ...
Epoch:44,validate loss:0.045684006065130234
Validation loss decreased (0.045782 --> 0.045684).  Saving model ...
Epoch:45,validate loss:0.045618653297424316
Validation loss decreased (0.045684 --> 0.045619).  Saving model ...
Epoch:46,validate loss:0.04619276151061058
Epoch:47,validate loss:0.04624048247933388
Epoch:48,validate loss:0.04600623622536659
Epoch:49,validate loss:0.04573778063058853
Epoch:50,validate loss:0.04580563306808472
Epoch:51,validate loss:0.046237800270318985
Epoch:52,validate loss:0.04552489146590233
Validation loss decreased (0.045619 --> 0.045525).  Saving model ...
Epoch:53,validate loss:0.04594689980149269
Epoch:54,validate loss:0.04536578804254532
Validation loss decreased (0.045525 --> 0.045366).  Saving model ...
Epoch:55,validate loss:0.04586712643504143
Epoch:56,validate loss:0.04492702707648277
Validation loss decreased (0.045366 --> 0.044927).  Saving model ...
Epoch:57,validate loss:0.04553261026740074
Epoch:58,validate loss:0.04509763792157173
Epoch:59,validate loss:0.04740630462765694
Epoch:60,validate loss:0.04544912278652191
Epoch:61,validate loss:0.045372795313596725
Epoch:62,validate loss:0.04493875056505203
Epoch:63,validate loss:0.04530240595340729
Epoch:64,validate loss:0.045452654361724854
Epoch:65,validate loss:0.04532449319958687
Epoch:66,validate loss:0.04487600177526474
Validation loss decreased (0.044927 --> 0.044876).  Saving model ...
Epoch:67,validate loss:0.04592551663517952
Epoch:68,validate loss:0.04526303708553314
Epoch:69,validate loss:0.045286618173122406
Epoch:70,validate loss:0.0459393672645092
Epoch:71,validate loss:0.046115923672914505
Epoch:72,validate loss:0.04547301307320595
Epoch:73,validate loss:0.0466291606426239
Epoch:74,validate loss:0.04502040892839432
Epoch:75,validate loss:0.044689301401376724
Validation loss decreased (0.044876 --> 0.044689).  Saving model ...
Epoch:76,validate loss:0.04534820094704628
Epoch:77,validate loss:0.04607383534312248
Epoch:78,validate loss:0.04548996314406395
Epoch:79,validate loss:0.0458003431558609
Epoch:80,validate loss:0.046347297728061676
Epoch:81,validate loss:0.04562261328101158
Epoch:82,validate loss:0.04524068161845207
Epoch:83,validate loss:0.04612881690263748
Epoch:84,validate loss:0.045188985764980316
Epoch:85,validate loss:0.045249804854393005
Epoch:86,validate loss:0.0455467663705349
Epoch:87,validate loss:0.04573981836438179
Epoch:88,validate loss:0.04520712047815323
Epoch:89,validate loss:0.04676977917551994
Epoch:90,validate loss:0.047430023550987244
Epoch:91,validate loss:0.0455620102584362
Epoch:92,validate loss:0.04503461718559265
Epoch:93,validate loss:0.04528149217367172
Epoch:94,validate loss:0.044863998889923096
Epoch:95,validate loss:0.04486261308193207
Early stopping.
Training finished
邻接矩阵：min=0.004,max=0.892,avg=0.100
0.0064453976,0.0064453976,0.014085046,0.10746235,0.0064453976,0.8333348,0.0064453976,0.0064453976,0.0064453976,0.0064453976,
0.015203057,0.33545396,0.018113766,0.015203057,0.06662646,0.09488853,0.37340465,0.02958214,0.036321346,0.015203057,
0.0062647993,0.026099548,0.0062647993,0.0062647993,0.019419527,0.007098907,0.024544973,0.0062647993,0.89151305,0.0062647993,
0.27889824,0.03249974,0.018983644,0.017480223,0.017480223,0.025388112,0.017480223,0.017480223,0.55682915,0.017480223,
0.007079413,0.007079413,0.060087405,0.36587146,0.016792059,0.06047936,0.010374435,0.45807758,0.007079413,0.007079413,
0.016625067,0.016625067,0.0191768,0.016625067,0.016625067,0.016625067,0.8370876,0.016625067,0.018100215,0.025884997,
0.0039392794,0.0039392794,0.0039392794,0.0039392794,0.0039392794,0.0039392794,0.39432225,0.54352987,0.02717697,0.011335244,
0.010293754,0.14869647,0.029869352,0.010293754,0.03157729,0.47785518,0.2511819,0.010293754,0.013332256,0.016606212,
0.02322845,0.8431756,0.015584533,0.015584533,0.023923373,0.015584533,0.015584533,0.015584533,0.016165338,0.015584533,
0.0036096498,0.8133142,0.0073734783,0.0036096498,0.02746908,0.13018535,0.0036096498,0.0036096498,0.0036096498,0.0036096498,
Evaluate model on site 1 , Test MAE: 0.0522, Test MAPE: 0.0631, Test RMSE: 0.0918
Evaluate model on site 2 , Test MAE: 0.0691, Test MAPE: 0.0979, Test RMSE: 0.1155
Evaluate model on site 3 , Test MAE: 0.0314, Test MAPE: 0.1227, Test RMSE: 0.0882
Evaluate model on site 4 , Test MAE: 0.0585, Test MAPE: 0.1897, Test RMSE: 0.1069
Evaluate model on site 5 , Test MAE: 0.0375, Test MAPE: 0.0910, Test RMSE: 0.0760
Evaluate model on site 6 , Test MAE: 0.0621, Test MAPE: 0.1090, Test RMSE: 0.1073
Evaluate model on site 7 , Test MAE: 0.0358, Test MAPE: 0.0953, Test RMSE: 0.0767
Evaluate model on site 8 , Test MAE: 0.0455, Test MAPE: 0.0665, Test RMSE: 0.0881
Evaluate model on site 9 , Test MAE: 0.0554, Test MAPE: 0.1085, Test RMSE: 0.0961
Evaluate model on site 10 , Test MAE: 0.0146, Test MAPE: 0.1029, Test RMSE: 0.0246
On average over all site, Test MAE: 0.0462, Test MAPE: 0.1047, Test RMSE: 0.0871
(0.046218037232756616, 0.10465527325868607, 0.08713641632348298)
[0.04568463256582618, 0.04612503414973616, 0.04623560821637511, 0.046847918070852757, 0.046218037232756616]
data::data/water/shangban/singleFac/3,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/3', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.4514325261116028
Validation loss decreased (inf --> 0.451433).  Saving model ...
Epoch:2,validate loss:0.3907948434352875
Validation loss decreased (0.451433 --> 0.390795).  Saving model ...
Epoch:3,validate loss:0.3707580864429474
Validation loss decreased (0.390795 --> 0.370758).  Saving model ...
Epoch:4,validate loss:0.3648982048034668
Validation loss decreased (0.370758 --> 0.364898).  Saving model ...
Epoch:5,validate loss:0.36902356147766113
Epoch:6,validate loss:0.35010212659835815
Validation loss decreased (0.364898 --> 0.350102).  Saving model ...
Epoch:7,validate loss:0.34372833371162415
Validation loss decreased (0.350102 --> 0.343728).  Saving model ...
Epoch:8,validate loss:0.33904746174812317
Validation loss decreased (0.343728 --> 0.339047).  Saving model ...
Epoch:9,validate loss:0.33317458629608154
Validation loss decreased (0.339047 --> 0.333175).  Saving model ...
Epoch:10,validate loss:0.3505183160305023
Epoch:11,validate loss:0.33352208137512207
Epoch:12,validate loss:0.3221694529056549
Validation loss decreased (0.333175 --> 0.322169).  Saving model ...
Epoch:13,validate loss:0.32324865460395813
Epoch:14,validate loss:0.32253554463386536
Epoch:15,validate loss:0.33309733867645264
Epoch:16,validate loss:0.31915751099586487
Validation loss decreased (0.322169 --> 0.319158).  Saving model ...
Epoch:17,validate loss:0.31535080075263977
Validation loss decreased (0.319158 --> 0.315351).  Saving model ...
Epoch:18,validate loss:0.33330491185188293
Epoch:19,validate loss:0.31316256523132324
Validation loss decreased (0.315351 --> 0.313163).  Saving model ...
Epoch:20,validate loss:0.3163227438926697
Epoch:21,validate loss:0.3061363995075226
Validation loss decreased (0.313163 --> 0.306136).  Saving model ...
Epoch:22,validate loss:0.31680235266685486
Epoch:23,validate loss:0.30667489767074585
Epoch:24,validate loss:0.30648112297058105
Epoch:25,validate loss:0.30272677540779114
Validation loss decreased (0.306136 --> 0.302727).  Saving model ...
Epoch:26,validate loss:0.31892096996307373
Epoch:27,validate loss:0.29980576038360596
Validation loss decreased (0.302727 --> 0.299806).  Saving model ...
Epoch:28,validate loss:0.30807581543922424
Epoch:29,validate loss:0.3185182213783264
Epoch:30,validate loss:0.29648178815841675
Validation loss decreased (0.299806 --> 0.296482).  Saving model ...
Epoch:31,validate loss:0.30452224612236023
Epoch:32,validate loss:0.30103951692581177
Epoch:33,validate loss:0.2953103184700012
Validation loss decreased (0.296482 --> 0.295310).  Saving model ...
Epoch:34,validate loss:0.3077986538410187
Epoch:35,validate loss:0.3020492196083069
Epoch:36,validate loss:0.29846319556236267
Epoch:37,validate loss:0.29517272114753723
Validation loss decreased (0.295310 --> 0.295173).  Saving model ...
Epoch:38,validate loss:0.29597219824790955
Epoch:39,validate loss:0.2995322644710541
Epoch:40,validate loss:0.30273300409317017
Epoch:41,validate loss:0.29718419909477234
Epoch:42,validate loss:0.2950839400291443
Validation loss decreased (0.295173 --> 0.295084).  Saving model ...
Epoch:43,validate loss:0.30284354090690613
Epoch:44,validate loss:0.2948744595050812
Validation loss decreased (0.295084 --> 0.294874).  Saving model ...
Epoch:45,validate loss:0.29892200231552124
Epoch:46,validate loss:0.3005303144454956
Epoch:47,validate loss:0.2962101697921753
Epoch:48,validate loss:0.28935864567756653
Validation loss decreased (0.294874 --> 0.289359).  Saving model ...
Epoch:49,validate loss:0.2951763868331909
Epoch:50,validate loss:0.2956673502922058
Epoch:51,validate loss:0.31620267033576965
Epoch:52,validate loss:0.2883543372154236
Validation loss decreased (0.289359 --> 0.288354).  Saving model ...
Epoch:53,validate loss:0.29110586643218994
Epoch:54,validate loss:0.2875772714614868
Validation loss decreased (0.288354 --> 0.287577).  Saving model ...
Epoch:55,validate loss:0.30266088247299194
Epoch:56,validate loss:0.2906978130340576
Epoch:57,validate loss:0.2872273921966553
Validation loss decreased (0.287577 --> 0.287227).  Saving model ...
Epoch:58,validate loss:0.2951323091983795
Epoch:59,validate loss:0.29988059401512146
Epoch:60,validate loss:0.3076654374599457
Epoch:61,validate loss:0.2955092191696167
Epoch:62,validate loss:0.294472336769104
Epoch:63,validate loss:0.29023483395576477
Epoch:64,validate loss:0.28815725445747375
Epoch:65,validate loss:0.28627005219459534
Validation loss decreased (0.287227 --> 0.286270).  Saving model ...
Epoch:66,validate loss:0.29605478048324585
Epoch:67,validate loss:0.29344889521598816
Epoch:68,validate loss:0.2910619080066681
Epoch:69,validate loss:0.2956516742706299
Epoch:70,validate loss:0.3092508912086487
Epoch:71,validate loss:0.29422876238822937
Epoch:72,validate loss:0.28225016593933105
Validation loss decreased (0.286270 --> 0.282250).  Saving model ...
Epoch:73,validate loss:0.2863471210002899
Epoch:74,validate loss:0.28678029775619507
Epoch:75,validate loss:0.28826040029525757
Epoch:76,validate loss:0.2846340239048004
Epoch:77,validate loss:0.2828739881515503
Epoch:78,validate loss:0.2863479256629944
Epoch:79,validate loss:0.2895253896713257
Epoch:80,validate loss:0.2841704785823822
Epoch:81,validate loss:0.292261004447937
Epoch:82,validate loss:0.2874056100845337
Epoch:83,validate loss:0.2868250012397766
Epoch:84,validate loss:0.29659897089004517
Epoch:85,validate loss:0.287975549697876
Epoch:86,validate loss:0.293192058801651
Epoch:87,validate loss:0.2942578196525574
Epoch:88,validate loss:0.28573283553123474
Epoch:89,validate loss:0.28625375032424927
Epoch:90,validate loss:0.2894488573074341
Epoch:91,validate loss:0.2887844741344452
Epoch:92,validate loss:0.29202306270599365
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.974,avg=0.100
0.00075896614,0.27525604,0.00075896614,0.00075896614,0.0007791345,0.00075896614,0.00075896614,0.019865917,0.0018813502,0.69842273,
0.0017895157,0.8330355,0.0012727295,0.08090753,0.00046637718,0.0768362,0.00046637718,0.004293026,0.00046637718,0.00046637718,
0.00014777776,0.00053999183,0.00014777776,0.093683705,0.00059258984,0.76730466,0.13714017,0.00014777776,0.00014777776,0.00014777776,
0.008478646,0.008478646,0.008478646,0.008478646,0.008478646,0.031434603,0.45816886,0.008478646,0.008478646,0.45104602,
0.0007374604,0.27707738,0.00028040376,0.009880157,9.221073e-05,9.221073e-05,0.008855405,0.00012013216,0.6698271,0.03303743,
0.007959174,0.0006779405,0.0009625733,0.6863095,0.000641573,0.00081962894,0.0026395353,0.000641573,0.29870695,0.000641573,
0.008546604,0.03152651,0.5212903,0.008546604,0.008546604,0.08494449,0.008546604,0.008546604,0.23607492,0.083430715,
0.00030075628,5.952051e-05,0.0831646,5.952051e-05,5.952051e-05,5.952051e-05,5.952051e-05,0.2782714,0.6286547,0.009311005,
0.46190393,0.002328307,0.002328307,0.002328307,0.002328307,0.002328307,0.002328307,0.002328307,0.004712733,0.51708513,
0.0019353054,0.002791829,0.0040676035,0.0019353054,0.0019353054,0.0019353054,0.0019353054,0.0072888965,0.97398096,0.0021942048,
Evaluate model on site 1 , Test MAE: 0.3096, Test MAPE: 0.0863, Test RMSE: 0.4990
Evaluate model on site 2 , Test MAE: 0.4036, Test MAPE: 0.4688, Test RMSE: 0.7307
Evaluate model on site 3 , Test MAE: 0.1283, Test MAPE: 0.2761, Test RMSE: 0.3116
Evaluate model on site 4 , Test MAE: 0.3042, Test MAPE: 0.3739, Test RMSE: 0.5786
Evaluate model on site 5 , Test MAE: 0.2614, Test MAPE: 0.1739, Test RMSE: 0.4299
Evaluate model on site 6 , Test MAE: 0.4413, Test MAPE: 0.1697, Test RMSE: 0.6821
Evaluate model on site 7 , Test MAE: 0.2635, Test MAPE: 0.2929, Test RMSE: 0.5320
Evaluate model on site 8 , Test MAE: 0.1793, Test MAPE: 0.3868, Test RMSE: 0.3195
Evaluate model on site 9 , Test MAE: 0.4263, Test MAPE: 0.1970, Test RMSE: 0.6806
Evaluate model on site 10 , Test MAE: 0.2047, Test MAPE: 0.7604, Test RMSE: 0.3230
On average over all site, Test MAE: 0.2922, Test MAPE: 0.3186, Test RMSE: 0.5087
(0.29222303777933123, 0.3185779578983784, 0.5087097525596619)
data::data/water/shangban/singleFac/3,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/3', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.46339932084083557
Validation loss decreased (inf --> 0.463399).  Saving model ...
Epoch:2,validate loss:0.3797045648097992
Validation loss decreased (0.463399 --> 0.379705).  Saving model ...
Epoch:3,validate loss:0.3712208569049835
Validation loss decreased (0.379705 --> 0.371221).  Saving model ...
Epoch:4,validate loss:0.38388845324516296
Epoch:5,validate loss:0.3579542934894562
Validation loss decreased (0.371221 --> 0.357954).  Saving model ...
Epoch:6,validate loss:0.36485403776168823
Epoch:7,validate loss:0.351450115442276
Validation loss decreased (0.357954 --> 0.351450).  Saving model ...
Epoch:8,validate loss:0.35350364446640015
Epoch:9,validate loss:0.35270488262176514
Epoch:10,validate loss:0.34838539361953735
Validation loss decreased (0.351450 --> 0.348385).  Saving model ...
Epoch:11,validate loss:0.3453117609024048
Validation loss decreased (0.348385 --> 0.345312).  Saving model ...
Epoch:12,validate loss:0.34472525119781494
Validation loss decreased (0.345312 --> 0.344725).  Saving model ...
Epoch:13,validate loss:0.3409901559352875
Validation loss decreased (0.344725 --> 0.340990).  Saving model ...
Epoch:14,validate loss:0.3427627682685852
Epoch:15,validate loss:0.33591845631599426
Validation loss decreased (0.340990 --> 0.335918).  Saving model ...
Epoch:16,validate loss:0.33103039860725403
Validation loss decreased (0.335918 --> 0.331030).  Saving model ...
Epoch:17,validate loss:0.3328704833984375
Epoch:18,validate loss:0.33226069808006287
Epoch:19,validate loss:0.3310185372829437
Validation loss decreased (0.331030 --> 0.331019).  Saving model ...
Epoch:20,validate loss:0.3192613124847412
Validation loss decreased (0.331019 --> 0.319261).  Saving model ...
Epoch:21,validate loss:0.3308310806751251
Epoch:22,validate loss:0.3207608163356781
Epoch:23,validate loss:0.3265566825866699
Epoch:24,validate loss:0.32423630356788635
Epoch:25,validate loss:0.31489667296409607
Validation loss decreased (0.319261 --> 0.314897).  Saving model ...
Epoch:26,validate loss:0.31348028779029846
Validation loss decreased (0.314897 --> 0.313480).  Saving model ...
Epoch:27,validate loss:0.31407663226127625
Epoch:28,validate loss:0.31280583143234253
Validation loss decreased (0.313480 --> 0.312806).  Saving model ...
Epoch:29,validate loss:0.31151697039604187
Validation loss decreased (0.312806 --> 0.311517).  Saving model ...
Epoch:30,validate loss:0.31130003929138184
Validation loss decreased (0.311517 --> 0.311300).  Saving model ...
Epoch:31,validate loss:0.30999454855918884
Validation loss decreased (0.311300 --> 0.309995).  Saving model ...
Epoch:32,validate loss:0.31283876299858093
Epoch:33,validate loss:0.30902087688446045
Validation loss decreased (0.309995 --> 0.309021).  Saving model ...
Epoch:34,validate loss:0.3068348169326782
Validation loss decreased (0.309021 --> 0.306835).  Saving model ...
Epoch:35,validate loss:0.3224601149559021
Epoch:36,validate loss:0.30462342500686646
Validation loss decreased (0.306835 --> 0.304623).  Saving model ...
Epoch:37,validate loss:0.30833590030670166
Epoch:38,validate loss:0.3066117763519287
Epoch:39,validate loss:0.30408772826194763
Validation loss decreased (0.304623 --> 0.304088).  Saving model ...
Epoch:40,validate loss:0.3161439299583435
Epoch:41,validate loss:0.3074113726615906
Epoch:42,validate loss:0.2992623746395111
Validation loss decreased (0.304088 --> 0.299262).  Saving model ...
Epoch:43,validate loss:0.30345162749290466
Epoch:44,validate loss:0.3063833713531494
Epoch:45,validate loss:0.31017443537712097
Epoch:46,validate loss:0.2970179319381714
Validation loss decreased (0.299262 --> 0.297018).  Saving model ...
Epoch:47,validate loss:0.30511948466300964
Epoch:48,validate loss:0.300978422164917
Epoch:49,validate loss:0.3035949468612671
Epoch:50,validate loss:0.2982671856880188
Epoch:51,validate loss:0.3036554157733917
Epoch:52,validate loss:0.29779762029647827
Epoch:53,validate loss:0.2987469732761383
Epoch:54,validate loss:0.3175455927848816
Epoch:55,validate loss:0.29745736718177795
Epoch:56,validate loss:0.29655662178993225
Validation loss decreased (0.297018 --> 0.296557).  Saving model ...
Epoch:57,validate loss:0.29858633875846863
Epoch:58,validate loss:0.3030543029308319
Epoch:59,validate loss:0.29847946763038635
Epoch:60,validate loss:0.29498034715652466
Validation loss decreased (0.296557 --> 0.294980).  Saving model ...
Epoch:61,validate loss:0.29910552501678467
Epoch:62,validate loss:0.2969870865345001
Epoch:63,validate loss:0.3010803163051605
Epoch:64,validate loss:0.2974318265914917
Epoch:65,validate loss:0.29631590843200684
Epoch:66,validate loss:0.29480618238449097
Validation loss decreased (0.294980 --> 0.294806).  Saving model ...
Epoch:67,validate loss:0.30310967564582825
Epoch:68,validate loss:0.29728662967681885
Epoch:69,validate loss:0.29270583391189575
Validation loss decreased (0.294806 --> 0.292706).  Saving model ...
Epoch:70,validate loss:0.2988790273666382
Epoch:71,validate loss:0.2948943078517914
Epoch:72,validate loss:0.29665443301200867
Epoch:73,validate loss:0.2988024055957794
Epoch:74,validate loss:0.29944053292274475
Epoch:75,validate loss:0.29383066296577454
Epoch:76,validate loss:0.29354214668273926
Epoch:77,validate loss:0.30279457569122314
Epoch:78,validate loss:0.2942585051059723
Epoch:79,validate loss:0.2977038323879242
Epoch:80,validate loss:0.30066344141960144
Epoch:81,validate loss:0.2958398461341858
Epoch:82,validate loss:0.29758140444755554
Epoch:83,validate loss:0.29430943727493286
Epoch:84,validate loss:0.2929510176181793
Epoch:85,validate loss:0.2897113263607025
Validation loss decreased (0.292706 --> 0.289711).  Saving model ...
Epoch:86,validate loss:0.3016188144683838
Epoch:87,validate loss:0.29879260063171387
Epoch:88,validate loss:0.2909315824508667
Epoch:89,validate loss:0.29666391015052795
Epoch:90,validate loss:0.2968752682209015
Epoch:91,validate loss:0.2977118194103241
Epoch:92,validate loss:0.2972496747970581
Epoch:93,validate loss:0.2961254417896271
Epoch:94,validate loss:0.2967498302459717
Epoch:95,validate loss:0.29091352224349976
Epoch:96,validate loss:0.2916458547115326
Epoch:97,validate loss:0.29082414507865906
Epoch:98,validate loss:0.29267579317092896
Epoch:99,validate loss:0.2866910994052887
Validation loss decreased (0.289711 --> 0.286691).  Saving model ...
Epoch:100,validate loss:0.29301804304122925
Epoch:101,validate loss:0.2980818450450897
Epoch:102,validate loss:0.29599496722221375
Epoch:103,validate loss:0.2925375699996948
Epoch:104,validate loss:0.29147690534591675
Epoch:105,validate loss:0.29261496663093567
Epoch:106,validate loss:0.2960751950740814
Epoch:107,validate loss:0.29331615567207336
Epoch:108,validate loss:0.2926581799983978
Epoch:109,validate loss:0.291936457157135
Epoch:110,validate loss:0.289518803358078
Epoch:111,validate loss:0.29249605536460876
Epoch:112,validate loss:0.2910621762275696
Epoch:113,validate loss:0.29165640473365784
Epoch:114,validate loss:0.29109999537467957
Epoch:115,validate loss:0.28260064125061035
Validation loss decreased (0.286691 --> 0.282601).  Saving model ...
Epoch:116,validate loss:0.2951303720474243
Epoch:117,validate loss:0.2882451117038727
Epoch:118,validate loss:0.28587615489959717
Epoch:119,validate loss:0.28323426842689514
Epoch:120,validate loss:0.29091474413871765
Epoch:121,validate loss:0.2955537438392639
Epoch:122,validate loss:0.2891770899295807
Epoch:123,validate loss:0.29213592410087585
Epoch:124,validate loss:0.28430402278900146
Epoch:125,validate loss:0.2926746904850006
Epoch:126,validate loss:0.29148757457733154
Epoch:127,validate loss:0.29450079798698425
Epoch:128,validate loss:0.29086834192276
Epoch:129,validate loss:0.29387709498405457
Epoch:130,validate loss:0.2903144359588623
Epoch:131,validate loss:0.29378098249435425
Epoch:132,validate loss:0.2947065830230713
Epoch:133,validate loss:0.2913164794445038
Epoch:134,validate loss:0.2931150496006012
Epoch:135,validate loss:0.29296547174453735
Early stopping.
Training finished
邻接矩阵：min=0.001,max=0.939,avg=0.100
0.047896825,0.0019843671,0.37087166,0.0019843671,0.0019843671,0.00241013,0.0019843671,0.0019843671,0.5516154,0.017284092,
0.011435522,0.005551828,0.03474103,0.057967674,0.8563475,0.0117490515,0.005551828,0.005551828,0.005551828,0.005551828,
0.0013416301,0.001365515,0.0013416301,0.005865236,0.18099275,0.8037267,0.0013416301,0.0013416301,0.0013416301,0.0013416301,
0.003899865,0.9032611,0.003899865,0.019382304,0.041719295,0.003899865,0.006060153,0.010077855,0.003899865,0.003899865,
0.039079275,0.10209005,0.06679855,0.039079275,0.039079275,0.039079275,0.039079275,0.09537052,0.50126535,0.039079275,
0.0046400977,0.0013293452,0.0013293452,0.0013293452,0.53327835,0.0013293452,0.0064029046,0.0013293452,0.0013293452,0.44770256,
0.939346,0.0005471762,0.0005471762,0.0005471762,0.0005471762,0.0060307146,0.049533486,0.0009253284,0.0005471762,0.0014285997,
0.0033854728,0.0019885274,0.004733653,0.8126995,0.0019885274,0.0019885274,0.0730744,0.0019885274,0.096164405,0.0019885274,
0.014500237,0.014500237,0.014500237,0.014500237,0.014500237,0.030827971,0.014500237,0.033188097,0.8344824,0.014500237,
0.0060736053,0.18659005,0.0060736053,0.0060736053,0.0060736053,0.0060736053,0.36718047,0.0060736053,0.40371424,0.0060736053,
Evaluate model on site 1 , Test MAE: 0.3186, Test MAPE: 0.0906, Test RMSE: 0.5141
Evaluate model on site 2 , Test MAE: 0.4101, Test MAPE: 0.4676, Test RMSE: 0.7158
Evaluate model on site 3 , Test MAE: 0.1291, Test MAPE: 0.2555, Test RMSE: 0.3152
Evaluate model on site 4 , Test MAE: 0.3202, Test MAPE: 0.3782, Test RMSE: 0.6048
Evaluate model on site 5 , Test MAE: 0.2608, Test MAPE: 0.1668, Test RMSE: 0.4215
Evaluate model on site 6 , Test MAE: 0.4417, Test MAPE: 0.1673, Test RMSE: 0.6856
Evaluate model on site 7 , Test MAE: 0.2857, Test MAPE: 0.3228, Test RMSE: 0.5596
Evaluate model on site 8 , Test MAE: 0.1867, Test MAPE: 0.3785, Test RMSE: 0.3325
Evaluate model on site 9 , Test MAE: 0.3985, Test MAPE: 0.1808, Test RMSE: 0.6589
Evaluate model on site 10 , Test MAE: 0.2059, Test MAPE: 0.6435, Test RMSE: 0.3244
On average over all site, Test MAE: 0.2957, Test MAPE: 0.3052, Test RMSE: 0.5132
(0.2957257032394409, 0.3051587648689747, 0.5132403671741486)
data::data/water/shangban/singleFac/3,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/3', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.4232420325279236
Validation loss decreased (inf --> 0.423242).  Saving model ...
Epoch:2,validate loss:0.38280317187309265
Validation loss decreased (0.423242 --> 0.382803).  Saving model ...
Epoch:3,validate loss:0.36822688579559326
Validation loss decreased (0.382803 --> 0.368227).  Saving model ...
Epoch:4,validate loss:0.3797817826271057
Epoch:5,validate loss:0.36602717638015747
Validation loss decreased (0.368227 --> 0.366027).  Saving model ...
Epoch:6,validate loss:0.3549101650714874
Validation loss decreased (0.366027 --> 0.354910).  Saving model ...
Epoch:7,validate loss:0.3589264750480652
Epoch:8,validate loss:0.34709781408309937
Validation loss decreased (0.354910 --> 0.347098).  Saving model ...
Epoch:9,validate loss:0.33835533261299133
Validation loss decreased (0.347098 --> 0.338355).  Saving model ...
Epoch:10,validate loss:0.35195839405059814
Epoch:11,validate loss:0.32847511768341064
Validation loss decreased (0.338355 --> 0.328475).  Saving model ...
Epoch:12,validate loss:0.3358592391014099
Epoch:13,validate loss:0.360404372215271
Epoch:14,validate loss:0.32765573263168335
Validation loss decreased (0.328475 --> 0.327656).  Saving model ...
Epoch:15,validate loss:0.33637434244155884
Epoch:16,validate loss:0.3213116526603699
Validation loss decreased (0.327656 --> 0.321312).  Saving model ...
Epoch:17,validate loss:0.3235807716846466
Epoch:18,validate loss:0.3173852562904358
Validation loss decreased (0.321312 --> 0.317385).  Saving model ...
Epoch:19,validate loss:0.31497299671173096
Validation loss decreased (0.317385 --> 0.314973).  Saving model ...
Epoch:20,validate loss:0.31560859084129333
Epoch:21,validate loss:0.31202203035354614
Validation loss decreased (0.314973 --> 0.312022).  Saving model ...
Epoch:22,validate loss:0.31754687428474426
Epoch:23,validate loss:0.31256112456321716
Epoch:24,validate loss:0.32418063282966614
Epoch:25,validate loss:0.32186266779899597
Epoch:26,validate loss:0.3048972487449646
Validation loss decreased (0.312022 --> 0.304897).  Saving model ...
Epoch:27,validate loss:0.3111906349658966
Epoch:28,validate loss:0.3113923668861389
Epoch:29,validate loss:0.30955711007118225
Epoch:30,validate loss:0.3009437620639801
Validation loss decreased (0.304897 --> 0.300944).  Saving model ...
Epoch:31,validate loss:0.31105363368988037
Epoch:32,validate loss:0.31652185320854187
Epoch:33,validate loss:0.3166632354259491
Epoch:34,validate loss:0.3041229546070099
Epoch:35,validate loss:0.3086046874523163
Epoch:36,validate loss:0.2947068512439728
Validation loss decreased (0.300944 --> 0.294707).  Saving model ...
Epoch:37,validate loss:0.3048053979873657
Epoch:38,validate loss:0.2994716763496399
Epoch:39,validate loss:0.30059555172920227
Epoch:40,validate loss:0.3082803189754486
Epoch:41,validate loss:0.300322562456131
Epoch:42,validate loss:0.29763415455818176
Epoch:43,validate loss:0.3049631714820862
Epoch:44,validate loss:0.2948339581489563
Epoch:45,validate loss:0.2943434417247772
Validation loss decreased (0.294707 --> 0.294343).  Saving model ...
Epoch:46,validate loss:0.29873496294021606
Epoch:47,validate loss:0.3032735288143158
Epoch:48,validate loss:0.29551902413368225
Epoch:49,validate loss:0.3030707836151123
Epoch:50,validate loss:0.30037105083465576
Epoch:51,validate loss:0.28927862644195557
Validation loss decreased (0.294343 --> 0.289279).  Saving model ...
Epoch:52,validate loss:0.309719979763031
Epoch:53,validate loss:0.2929535210132599
Epoch:54,validate loss:0.2988940179347992
Epoch:55,validate loss:0.294585257768631
Epoch:56,validate loss:0.29487764835357666
Epoch:57,validate loss:0.2901036739349365
Epoch:58,validate loss:0.2990473210811615
Epoch:59,validate loss:0.2886812686920166
Validation loss decreased (0.289279 --> 0.288681).  Saving model ...
Epoch:60,validate loss:0.2973897457122803
Epoch:61,validate loss:0.2920716404914856
Epoch:62,validate loss:0.2959996163845062
Epoch:63,validate loss:0.2915624678134918
Epoch:64,validate loss:0.2955588102340698
Epoch:65,validate loss:0.2990896701812744
Epoch:66,validate loss:0.306292325258255
Epoch:67,validate loss:0.2947830259799957
Epoch:68,validate loss:0.288940966129303
Epoch:69,validate loss:0.2977089285850525
Epoch:70,validate loss:0.28866109251976013
Validation loss decreased (0.288681 --> 0.288661).  Saving model ...
Epoch:71,validate loss:0.2969306409358978
Epoch:72,validate loss:0.2942200005054474
Epoch:73,validate loss:0.3005836009979248
Epoch:74,validate loss:0.2980492413043976
Epoch:75,validate loss:0.2969669997692108
Epoch:76,validate loss:0.2918085753917694
Epoch:77,validate loss:0.2874588072299957
Validation loss decreased (0.288661 --> 0.287459).  Saving model ...
Epoch:78,validate loss:0.2955625057220459
Epoch:79,validate loss:0.295265257358551
Epoch:80,validate loss:0.2996428906917572
Epoch:81,validate loss:0.29251158237457275
Epoch:82,validate loss:0.2971246838569641
Epoch:83,validate loss:0.29083290696144104
Epoch:84,validate loss:0.29098403453826904
Epoch:85,validate loss:0.29160189628601074
Epoch:86,validate loss:0.29610592126846313
Epoch:87,validate loss:0.303429514169693
Epoch:88,validate loss:0.28942734003067017
Epoch:89,validate loss:0.2973591089248657
Epoch:90,validate loss:0.2947319746017456
Epoch:91,validate loss:0.29395753145217896
Epoch:92,validate loss:0.2950437366962433
Epoch:93,validate loss:0.29862353205680847
Epoch:94,validate loss:0.30002936720848083
Epoch:95,validate loss:0.2959176003932953
Epoch:96,validate loss:0.29953253269195557
Epoch:97,validate loss:0.2977138161659241
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.955,avg=0.100
0.036189374,0.08130985,0.036189374,0.036189374,0.036189374,0.036189374,0.036189374,0.6291752,0.036189374,0.036189374,
0.08862581,0.0020110828,0.15798649,0.026110597,0.60824764,0.0020110828,0.0020110828,0.06158322,0.0020110828,0.04940198,
0.0052221688,0.0024249733,0.0024249733,0.0077532944,0.0024249733,0.0024249733,0.9553123,0.0024249733,0.017162332,0.0024249733,
0.39177236,8.5105254e-05,3.3385757e-05,1.0925309e-05,1.0925309e-05,1.0925309e-05,0.5310395,0.073579,0.002774612,0.0006832817,
0.025707345,0.0014149038,0.014881903,0.0025059197,0.0965576,0.0014149038,0.13561669,0.03212599,0.6883598,0.0014149038,
0.0011954174,0.0011954174,0.014766032,0.0011954174,0.006530998,0.889195,0.0016833034,0.0011954174,0.081847526,0.0011954174,
0.010804616,0.0025665627,0.0012922629,0.48546505,6.691639e-05,6.691639e-05,0.00028111975,0.49829736,0.0007068128,0.0004522974,
0.012014856,0.38855317,0.012014856,0.014929128,0.012014856,0.45211077,0.012014856,0.07231769,0.012014856,0.012014856,
0.00040246962,0.00045658965,0.3915607,0.00046056937,0.00040246962,0.6050963,0.00040246962,0.00040246962,0.00040246962,0.0004135346,
0.0058150804,0.016867833,0.0058150804,0.0058150804,0.12930319,0.69376236,0.12517616,0.0058150804,0.0058150804,0.0058150804,
Evaluate model on site 1 , Test MAE: 0.3091, Test MAPE: 0.0870, Test RMSE: 0.5009
Evaluate model on site 2 , Test MAE: 0.4177, Test MAPE: 0.4861, Test RMSE: 0.7488
Evaluate model on site 3 , Test MAE: 0.1348, Test MAPE: 0.2675, Test RMSE: 0.3351
Evaluate model on site 4 , Test MAE: 0.3113, Test MAPE: 0.3741, Test RMSE: 0.6004
Evaluate model on site 5 , Test MAE: 0.2622, Test MAPE: 0.1686, Test RMSE: 0.4255
Evaluate model on site 6 , Test MAE: 0.4572, Test MAPE: 0.1762, Test RMSE: 0.6958
Evaluate model on site 7 , Test MAE: 0.2832, Test MAPE: 0.3174, Test RMSE: 0.5623
Evaluate model on site 8 , Test MAE: 0.1905, Test MAPE: 0.5238, Test RMSE: 0.3289
Evaluate model on site 9 , Test MAE: 0.4041, Test MAPE: 0.1915, Test RMSE: 0.6449
Evaluate model on site 10 , Test MAE: 0.2100, Test MAPE: 0.6252, Test RMSE: 0.3361
On average over all site, Test MAE: 0.2980, Test MAPE: 0.3218, Test RMSE: 0.5179
(0.2980059027671814, 0.32175260335206984, 0.5178695291280746)
data::data/water/shangban/singleFac/3,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/3', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.44574859738349915
Validation loss decreased (inf --> 0.445749).  Saving model ...
Epoch:2,validate loss:0.39329421520233154
Validation loss decreased (0.445749 --> 0.393294).  Saving model ...
Epoch:3,validate loss:0.3709743320941925
Validation loss decreased (0.393294 --> 0.370974).  Saving model ...
Epoch:4,validate loss:0.3621467649936676
Validation loss decreased (0.370974 --> 0.362147).  Saving model ...
Epoch:5,validate loss:0.36008134484291077
Validation loss decreased (0.362147 --> 0.360081).  Saving model ...
Epoch:6,validate loss:0.3554139733314514
Validation loss decreased (0.360081 --> 0.355414).  Saving model ...
Epoch:7,validate loss:0.34682148694992065
Validation loss decreased (0.355414 --> 0.346821).  Saving model ...
Epoch:8,validate loss:0.34516167640686035
Validation loss decreased (0.346821 --> 0.345162).  Saving model ...
Epoch:9,validate loss:0.34934139251708984
Epoch:10,validate loss:0.3415754735469818
Validation loss decreased (0.345162 --> 0.341575).  Saving model ...
Epoch:11,validate loss:0.32993316650390625
Validation loss decreased (0.341575 --> 0.329933).  Saving model ...
Epoch:12,validate loss:0.33707284927368164
Epoch:13,validate loss:0.33675292134284973
Epoch:14,validate loss:0.33059945702552795
Epoch:15,validate loss:0.3341447412967682
Epoch:16,validate loss:0.32042649388313293
Validation loss decreased (0.329933 --> 0.320426).  Saving model ...
Epoch:17,validate loss:0.3254435956478119
Epoch:18,validate loss:0.3163122236728668
Validation loss decreased (0.320426 --> 0.316312).  Saving model ...
Epoch:19,validate loss:0.3217149078845978
Epoch:20,validate loss:0.3144961893558502
Validation loss decreased (0.316312 --> 0.314496).  Saving model ...
Epoch:21,validate loss:0.3133070170879364
Validation loss decreased (0.314496 --> 0.313307).  Saving model ...
Epoch:22,validate loss:0.3130835294723511
Validation loss decreased (0.313307 --> 0.313084).  Saving model ...
Epoch:23,validate loss:0.3181842863559723
Epoch:24,validate loss:0.3141257166862488
Epoch:25,validate loss:0.310104638338089
Validation loss decreased (0.313084 --> 0.310105).  Saving model ...
Epoch:26,validate loss:0.30747994780540466
Validation loss decreased (0.310105 --> 0.307480).  Saving model ...
Epoch:27,validate loss:0.30488479137420654
Validation loss decreased (0.307480 --> 0.304885).  Saving model ...
Epoch:28,validate loss:0.3084889054298401
Epoch:29,validate loss:0.3120410740375519
Epoch:30,validate loss:0.30687105655670166
Epoch:31,validate loss:0.3068128228187561
Epoch:32,validate loss:0.29955071210861206
Validation loss decreased (0.304885 --> 0.299551).  Saving model ...
Epoch:33,validate loss:0.30933645367622375
Epoch:34,validate loss:0.31066203117370605
Epoch:35,validate loss:0.30102160573005676
Epoch:36,validate loss:0.30911028385162354
Epoch:37,validate loss:0.305044561624527
Epoch:38,validate loss:0.3043733835220337
Epoch:39,validate loss:0.30032986402511597
Epoch:40,validate loss:0.29598692059516907
Validation loss decreased (0.299551 --> 0.295987).  Saving model ...
Epoch:41,validate loss:0.3014748990535736
Epoch:42,validate loss:0.29892122745513916
Epoch:43,validate loss:0.2999297082424164
Epoch:44,validate loss:0.3002614378929138
Epoch:45,validate loss:0.2995905578136444
Epoch:46,validate loss:0.304292768239975
Epoch:47,validate loss:0.30270177125930786
Epoch:48,validate loss:0.29980045557022095
Epoch:49,validate loss:0.30602267384529114
Epoch:50,validate loss:0.30600249767303467
Epoch:51,validate loss:0.3040566146373749
Epoch:52,validate loss:0.31455522775650024
Epoch:53,validate loss:0.302696168422699
Epoch:54,validate loss:0.29902884364128113
Epoch:55,validate loss:0.2993122339248657
Epoch:56,validate loss:0.2980600595474243
Epoch:57,validate loss:0.30224695801734924
Epoch:58,validate loss:0.30668044090270996
Epoch:59,validate loss:0.3036898374557495
Epoch:60,validate loss:0.301690936088562
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.972,avg=0.100
0.0041118655,0.33904234,0.0007538603,0.0007538603,0.0007538603,0.6381316,0.012289186,0.0011081938,0.0007538603,0.0023014366,
0.0077982387,0.0077982387,0.0077982387,0.0077982387,0.0077982387,0.0077982387,0.0077982387,0.0077982387,0.0077982387,0.92981595,
0.022131616,0.022131616,0.022131616,0.049630854,0.04045483,0.022131616,0.022131616,0.022131616,0.022131616,0.75499296,
0.0020560774,0.0020560774,0.0020560774,0.0020560774,0.8024265,0.0020560774,0.1678264,0.0024869717,0.0020560774,0.014923564,
0.032219127,0.17608006,0.0001376355,0.0001376355,0.782098,0.0001376355,0.0001376355,0.0001376355,0.0001376355,0.008777077,
0.00527861,0.00068583805,0.004505113,0.00068583805,0.53213996,0.0013683998,0.12463678,0.00068583805,0.28544775,0.044565924,
0.00051893765,1.9915655e-05,0.6392556,1.9915655e-05,1.9915655e-05,0.11235242,1.9915655e-05,2.0362e-05,1.9915655e-05,0.2477532,
0.0014313449,0.0003696015,0.0003696015,0.0003696015,0.014697548,0.0681358,0.0003696015,0.0003696015,0.0003696015,0.91351765,
0.010298346,0.010298346,0.028304966,0.010298346,0.010298346,0.055330787,0.010298346,0.31915325,0.535421,0.010298346,
0.00049850834,0.0014594859,0.00049850834,0.00049850834,0.00049850834,0.97245353,0.00049850834,0.0019716623,0.021124242,0.00049850834,
Evaluate model on site 1 , Test MAE: 0.3330, Test MAPE: 0.0946, Test RMSE: 0.5473
Evaluate model on site 2 , Test MAE: 0.4138, Test MAPE: 0.4788, Test RMSE: 0.7554
Evaluate model on site 3 , Test MAE: 0.1308, Test MAPE: 0.2997, Test RMSE: 0.3164
Evaluate model on site 4 , Test MAE: 0.3143, Test MAPE: 0.3858, Test RMSE: 0.6140
Evaluate model on site 5 , Test MAE: 0.2647, Test MAPE: 0.1754, Test RMSE: 0.4188
Evaluate model on site 6 , Test MAE: 0.4678, Test MAPE: 0.1815, Test RMSE: 0.7149
Evaluate model on site 7 , Test MAE: 0.2974, Test MAPE: 0.3279, Test RMSE: 0.5718
Evaluate model on site 8 , Test MAE: 0.1955, Test MAPE: 0.3711, Test RMSE: 0.3489
Evaluate model on site 9 , Test MAE: 0.4446, Test MAPE: 0.2000, Test RMSE: 0.7203
Evaluate model on site 10 , Test MAE: 0.2184, Test MAPE: 0.8255, Test RMSE: 0.3326
On average over all site, Test MAE: 0.3080, Test MAPE: 0.3340, Test RMSE: 0.5340
(0.30804804265499114, 0.3340282440185547, 0.5340280920267105)
data::data/water/shangban/singleFac/3,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/3', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.44275403022766113
Validation loss decreased (inf --> 0.442754).  Saving model ...
Epoch:2,validate loss:0.38039731979370117
Validation loss decreased (0.442754 --> 0.380397).  Saving model ...
Epoch:3,validate loss:0.36429330706596375
Validation loss decreased (0.380397 --> 0.364293).  Saving model ...
Epoch:4,validate loss:0.36512523889541626
Epoch:5,validate loss:0.36060354113578796
Validation loss decreased (0.364293 --> 0.360604).  Saving model ...
Epoch:6,validate loss:0.3589325547218323
Validation loss decreased (0.360604 --> 0.358933).  Saving model ...
Epoch:7,validate loss:0.35278671979904175
Validation loss decreased (0.358933 --> 0.352787).  Saving model ...
Epoch:8,validate loss:0.3591311275959015
Epoch:9,validate loss:0.34855538606643677
Validation loss decreased (0.352787 --> 0.348555).  Saving model ...
Epoch:10,validate loss:0.34611621499061584
Validation loss decreased (0.348555 --> 0.346116).  Saving model ...
Epoch:11,validate loss:0.3423612415790558
Validation loss decreased (0.346116 --> 0.342361).  Saving model ...
Epoch:12,validate loss:0.3506914973258972
Epoch:13,validate loss:0.336063027381897
Validation loss decreased (0.342361 --> 0.336063).  Saving model ...
Epoch:14,validate loss:0.34168559312820435
Epoch:15,validate loss:0.3377111256122589
Epoch:16,validate loss:0.3294537365436554
Validation loss decreased (0.336063 --> 0.329454).  Saving model ...
Epoch:17,validate loss:0.3303883373737335
Epoch:18,validate loss:0.32130706310272217
Validation loss decreased (0.329454 --> 0.321307).  Saving model ...
Epoch:19,validate loss:0.32308027148246765
Epoch:20,validate loss:0.3174501955509186
Validation loss decreased (0.321307 --> 0.317450).  Saving model ...
Epoch:21,validate loss:0.31944844126701355
Epoch:22,validate loss:0.32104817032814026
Epoch:23,validate loss:0.3108536899089813
Validation loss decreased (0.317450 --> 0.310854).  Saving model ...
Epoch:24,validate loss:0.3109768033027649
Epoch:25,validate loss:0.31410685181617737
Epoch:26,validate loss:0.3128710687160492
Epoch:27,validate loss:0.30504271388053894
Validation loss decreased (0.310854 --> 0.305043).  Saving model ...
Epoch:28,validate loss:0.3133649230003357
Epoch:29,validate loss:0.3069348931312561
Epoch:30,validate loss:0.30406785011291504
Validation loss decreased (0.305043 --> 0.304068).  Saving model ...
Epoch:31,validate loss:0.30007460713386536
Validation loss decreased (0.304068 --> 0.300075).  Saving model ...
Epoch:32,validate loss:0.30308452248573303
Epoch:33,validate loss:0.29777687788009644
Validation loss decreased (0.300075 --> 0.297777).  Saving model ...
Epoch:34,validate loss:0.29838868975639343
Epoch:35,validate loss:0.3052244484424591
Epoch:36,validate loss:0.2978004217147827
Epoch:37,validate loss:0.29885318875312805
Epoch:38,validate loss:0.30071768164634705
Epoch:39,validate loss:0.297259658575058
Validation loss decreased (0.297777 --> 0.297260).  Saving model ...
Epoch:40,validate loss:0.29676783084869385
Validation loss decreased (0.297260 --> 0.296768).  Saving model ...
Epoch:41,validate loss:0.314177006483078
Epoch:42,validate loss:0.29297956824302673
Validation loss decreased (0.296768 --> 0.292980).  Saving model ...
Epoch:43,validate loss:0.2961251139640808
Epoch:44,validate loss:0.29519331455230713
Epoch:45,validate loss:0.29241812229156494
Validation loss decreased (0.292980 --> 0.292418).  Saving model ...
Epoch:46,validate loss:0.2990233302116394
Epoch:47,validate loss:0.2940891981124878
Epoch:48,validate loss:0.29750552773475647
Epoch:49,validate loss:0.294273316860199
Epoch:50,validate loss:0.29068848490715027
Validation loss decreased (0.292418 --> 0.290688).  Saving model ...
Epoch:51,validate loss:0.2955820560455322
Epoch:52,validate loss:0.2904279828071594
Validation loss decreased (0.290688 --> 0.290428).  Saving model ...
Epoch:53,validate loss:0.2899697422981262
Validation loss decreased (0.290428 --> 0.289970).  Saving model ...
Epoch:54,validate loss:0.2913627028465271
Epoch:55,validate loss:0.2901557981967926
Epoch:56,validate loss:0.2933887541294098
Epoch:57,validate loss:0.2974039316177368
Epoch:58,validate loss:0.29134923219680786
Epoch:59,validate loss:0.2849298417568207
Validation loss decreased (0.289970 --> 0.284930).  Saving model ...
Epoch:60,validate loss:0.29002031683921814
Epoch:61,validate loss:0.29004958271980286
Epoch:62,validate loss:0.299947053194046
Epoch:63,validate loss:0.28923216462135315
Epoch:64,validate loss:0.2959558665752411
Epoch:65,validate loss:0.29176515340805054
Epoch:66,validate loss:0.2941063344478607
Epoch:67,validate loss:0.29097244143486023
Epoch:68,validate loss:0.29127612709999084
Epoch:69,validate loss:0.2824094295501709
Validation loss decreased (0.284930 --> 0.282409).  Saving model ...
Epoch:70,validate loss:0.28352653980255127
Epoch:71,validate loss:0.2872326970100403
Epoch:72,validate loss:0.2881818413734436
Epoch:73,validate loss:0.2888975739479065
Epoch:74,validate loss:0.2842101454734802
Epoch:75,validate loss:0.2902286648750305
Epoch:76,validate loss:0.28608617186546326
Epoch:77,validate loss:0.28922709822654724
Epoch:78,validate loss:0.2839176654815674
Epoch:79,validate loss:0.29209330677986145
Epoch:80,validate loss:0.283137708902359
Epoch:81,validate loss:0.2938743829727173
Epoch:82,validate loss:0.2846735715866089
Epoch:83,validate loss:0.28246933221817017
Epoch:84,validate loss:0.28596073389053345
Epoch:85,validate loss:0.2813160717487335
Validation loss decreased (0.282409 --> 0.281316).  Saving model ...
Epoch:86,validate loss:0.28299224376678467
Epoch:87,validate loss:0.2864736020565033
Epoch:88,validate loss:0.285080224275589
Epoch:89,validate loss:0.28663814067840576
Epoch:90,validate loss:0.28243714570999146
Epoch:91,validate loss:0.2851715087890625
Epoch:92,validate loss:0.29327794909477234
Epoch:93,validate loss:0.29087361693382263
Epoch:94,validate loss:0.289383202791214
Epoch:95,validate loss:0.28688177466392517
Epoch:96,validate loss:0.2860442101955414
Epoch:97,validate loss:0.2838180959224701
Epoch:98,validate loss:0.29799583554267883
Epoch:99,validate loss:0.2920292019844055
Epoch:100,validate loss:0.2867923974990845
Epoch:101,validate loss:0.2884223461151123
Epoch:102,validate loss:0.29421454668045044
Epoch:103,validate loss:0.2894551157951355
Epoch:104,validate loss:0.2859961986541748
Epoch:105,validate loss:0.29045191407203674
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.917,avg=0.100
0.0004432582,0.0004432582,0.085129485,0.0004432582,0.004620938,0.0004432582,0.5489463,0.18229489,0.117906936,0.059328422,
0.00198656,0.014914179,0.041888513,0.001515543,0.46200407,0.045678217,0.010893364,0.41808844,0.001515543,0.001515543,
0.02070702,0.54012674,0.28661305,0.02070702,0.02070702,0.028310988,0.02070702,0.02070702,0.02070702,0.02070702,
0.204789,0.0058753886,0.0058753886,0.0058753886,0.0058753886,0.0058753886,0.0058753886,0.0075521027,0.72910976,0.02329678,
0.33014005,0.66105944,0.00025159548,0.00025159548,0.00025159548,0.00025159548,0.005343634,0.0019162851,0.00025159548,0.00028255262,
0.001366737,0.057668205,0.001366737,0.001366737,0.88470936,0.048055317,0.001366737,0.001366737,0.001366737,0.001366737,
0.1027836,0.011837998,0.011837998,0.011837998,0.011837998,0.5921221,0.13244212,0.011837998,0.10162422,0.011837998,
0.024284912,0.040371597,0.024284912,0.75450355,0.024284912,0.024284912,0.024284912,0.024284912,0.024284912,0.035130516,
0.00017305465,0.44036472,0.54005885,0.00017305465,0.0025825195,0.00017305465,0.00017305465,0.0060057836,0.010122816,0.00017305465,
0.00064970995,0.0021746177,0.02153033,0.00064970995,0.00064970995,0.00064970995,0.00064970995,0.012137868,0.043632366,0.91727626,
Evaluate model on site 1 , Test MAE: 0.3099, Test MAPE: 0.0874, Test RMSE: 0.5153
Evaluate model on site 2 , Test MAE: 0.3909, Test MAPE: 0.4284, Test RMSE: 0.7209
Evaluate model on site 3 , Test MAE: 0.1290, Test MAPE: 0.2970, Test RMSE: 0.3128
Evaluate model on site 4 , Test MAE: 0.3067, Test MAPE: 0.3577, Test RMSE: 0.5887
Evaluate model on site 5 , Test MAE: 0.2478, Test MAPE: 0.1630, Test RMSE: 0.3973
Evaluate model on site 6 , Test MAE: 0.4513, Test MAPE: 0.1735, Test RMSE: 0.7034
Evaluate model on site 7 , Test MAE: 0.2795, Test MAPE: 0.3200, Test RMSE: 0.5569
Evaluate model on site 8 , Test MAE: 0.1802, Test MAPE: 0.4093, Test RMSE: 0.3254
Evaluate model on site 9 , Test MAE: 0.4141, Test MAPE: 0.1913, Test RMSE: 0.6742
Evaluate model on site 10 , Test MAE: 0.2136, Test MAPE: 0.7674, Test RMSE: 0.3328
On average over all site, Test MAE: 0.2923, Test MAPE: 0.3195, Test RMSE: 0.5128
(0.29229163825511933, 0.31952090933918953, 0.5127691090106964)
[0.29222303777933123, 0.2957257032394409, 0.2980059027671814, 0.30804804265499114, 0.29229163825511933]
data::data/water/shangban/singleFac/6,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/6', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.9657649397850037
Validation loss decreased (inf --> 0.965765).  Saving model ...
Epoch:2,validate loss:0.9255951046943665
Validation loss decreased (0.965765 --> 0.925595).  Saving model ...
Epoch:3,validate loss:0.8656341433525085
Validation loss decreased (0.925595 --> 0.865634).  Saving model ...
Epoch:4,validate loss:0.848757803440094
Validation loss decreased (0.865634 --> 0.848758).  Saving model ...
Epoch:5,validate loss:0.8353732228279114
Validation loss decreased (0.848758 --> 0.835373).  Saving model ...
Epoch:6,validate loss:0.8366014361381531
Epoch:7,validate loss:0.8243783712387085
Validation loss decreased (0.835373 --> 0.824378).  Saving model ...
Epoch:8,validate loss:0.8202084302902222
Validation loss decreased (0.824378 --> 0.820208).  Saving model ...
Epoch:9,validate loss:0.8273252248764038
Epoch:10,validate loss:0.8483196496963501
Epoch:11,validate loss:0.8181142807006836
Validation loss decreased (0.820208 --> 0.818114).  Saving model ...
Epoch:12,validate loss:0.8561587929725647
Epoch:13,validate loss:0.8197216391563416
Epoch:14,validate loss:0.82464998960495
Epoch:15,validate loss:0.7977631092071533
Validation loss decreased (0.818114 --> 0.797763).  Saving model ...
Epoch:16,validate loss:0.7932674884796143
Validation loss decreased (0.797763 --> 0.793267).  Saving model ...
Epoch:17,validate loss:0.7995503544807434
Epoch:18,validate loss:0.7963867783546448
Epoch:19,validate loss:0.7867540717124939
Validation loss decreased (0.793267 --> 0.786754).  Saving model ...
Epoch:20,validate loss:0.7934119701385498
Epoch:21,validate loss:0.7938344478607178
Epoch:22,validate loss:0.7952707409858704
Epoch:23,validate loss:0.8122027516365051
Epoch:24,validate loss:0.7847383618354797
Validation loss decreased (0.786754 --> 0.784738).  Saving model ...
Epoch:25,validate loss:0.7755398154258728
Validation loss decreased (0.784738 --> 0.775540).  Saving model ...
Epoch:26,validate loss:0.7777374386787415
Epoch:27,validate loss:0.8058434128761292
Epoch:28,validate loss:0.7884810566902161
Epoch:29,validate loss:0.7746016383171082
Validation loss decreased (0.775540 --> 0.774602).  Saving model ...
Epoch:30,validate loss:0.7746443748474121
Epoch:31,validate loss:0.7823965549468994
Epoch:32,validate loss:0.7712238430976868
Validation loss decreased (0.774602 --> 0.771224).  Saving model ...
Epoch:33,validate loss:0.7728073596954346
Epoch:34,validate loss:0.7714685201644897
Epoch:35,validate loss:0.7705207467079163
Validation loss decreased (0.771224 --> 0.770521).  Saving model ...
Epoch:36,validate loss:0.7652941346168518
Validation loss decreased (0.770521 --> 0.765294).  Saving model ...
Epoch:37,validate loss:0.7683491110801697
Epoch:38,validate loss:0.7631524801254272
Validation loss decreased (0.765294 --> 0.763152).  Saving model ...
Epoch:39,validate loss:0.7872199416160583
Epoch:40,validate loss:0.7732720375061035
Epoch:41,validate loss:0.7718589305877686
Epoch:42,validate loss:0.7537259459495544
Validation loss decreased (0.763152 --> 0.753726).  Saving model ...
Epoch:43,validate loss:0.7709336876869202
Epoch:44,validate loss:0.779487669467926
Epoch:45,validate loss:0.7628268599510193
Epoch:46,validate loss:0.758781373500824
Epoch:47,validate loss:0.7711613178253174
Epoch:48,validate loss:0.7686354517936707
Epoch:49,validate loss:0.7672950029373169
Epoch:50,validate loss:0.773377537727356
Epoch:51,validate loss:0.7636590600013733
Epoch:52,validate loss:0.7708937525749207
Epoch:53,validate loss:0.7690025568008423
Epoch:54,validate loss:0.7670645713806152
Epoch:55,validate loss:0.7683658003807068
Epoch:56,validate loss:0.7802129983901978
Epoch:57,validate loss:0.7595019340515137
Epoch:58,validate loss:0.7573383450508118
Epoch:59,validate loss:0.7593864798545837
Epoch:60,validate loss:0.7610973715782166
Epoch:61,validate loss:0.7630006670951843
Epoch:62,validate loss:0.7647365927696228
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.847,avg=0.100
0.00024133828,0.023194522,0.4225789,0.0018032971,0.5390648,0.00030018957,0.0100649595,0.00024133828,0.0022692522,0.00024133828,
0.805274,0.0010040934,0.0017414864,0.0010040934,0.0010040934,0.18482667,0.0021332426,0.0010040934,0.0010040934,0.0010040934,
0.00020160385,0.3424304,0.00020160385,0.6532548,0.00020160385,0.0013594175,0.00020160385,0.0004967433,0.0006768012,0.00097542116,
0.018419957,0.49170983,0.018419957,0.19717687,0.018419957,0.018419957,0.13679971,0.020545648,0.018419957,0.0616682,
0.08533815,0.0067205387,0.0067205387,0.007189576,0.11974094,0.0067205387,0.20166174,0.018586962,0.033546567,0.51377445,
0.0008037124,0.033185445,0.0008037124,0.0008037124,0.11986923,0.0008037124,0.0015001647,0.016764972,0.0008037124,0.8246616,
0.089430176,0.0059234262,0.0059234262,0.0059234262,0.0059234262,0.24014346,0.47330618,0.0059234262,0.0068745785,0.1606284,
0.053746205,0.0028311552,0.0028311552,0.07789981,0.5615581,0.0028311552,0.0028311552,0.25416932,0.0028311552,0.038470767,
0.0041459873,0.36073095,0.0010806047,0.52628875,0.0010806047,0.0036889475,0.09796549,0.0010806047,0.0028574879,0.0010806047,
0.009366568,5.476209e-05,3.5770532e-05,0.14267805,0.00022131615,3.5770532e-05,0.84684074,3.5770532e-05,0.0006764915,5.470535e-05,
Evaluate model on site 1 , Test MAE: 0.7991, Test MAPE: 1.5204, Test RMSE: 1.2118
Evaluate model on site 2 , Test MAE: 0.7595, Test MAPE: 0.3129, Test RMSE: 1.2518
Evaluate model on site 3 , Test MAE: 0.7953, Test MAPE: 0.2508, Test RMSE: 1.1878
Evaluate model on site 4 , Test MAE: 0.6191, Test MAPE: 0.3700, Test RMSE: 0.9953
Evaluate model on site 5 , Test MAE: 0.6178, Test MAPE: 2.1546, Test RMSE: 1.1220
Evaluate model on site 6 , Test MAE: 0.7370, Test MAPE: 2.6870, Test RMSE: 1.2244
Evaluate model on site 7 , Test MAE: 0.9407, Test MAPE: 0.9600, Test RMSE: 1.7161
Evaluate model on site 8 , Test MAE: 0.7412, Test MAPE: 0.3508, Test RMSE: 1.2683
Evaluate model on site 9 , Test MAE: 1.0698, Test MAPE: 1.3476, Test RMSE: 1.6092
Evaluate model on site 10 , Test MAE: 0.8760, Test MAPE: 0.1889, Test RMSE: 1.3100
On average over all site, Test MAE: 0.7956, Test MAPE: 1.0143, Test RMSE: 1.2897
(0.7955514430999756, 1.0143098711967469, 1.2896660685539245)
data::data/water/shangban/singleFac/6,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/6', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:1.0211364030838013
Validation loss decreased (inf --> 1.021136).  Saving model ...
Epoch:2,validate loss:0.9217572808265686
Validation loss decreased (1.021136 --> 0.921757).  Saving model ...
Epoch:3,validate loss:0.9000526666641235
Validation loss decreased (0.921757 --> 0.900053).  Saving model ...
Epoch:4,validate loss:0.8767715692520142
Validation loss decreased (0.900053 --> 0.876772).  Saving model ...
Epoch:5,validate loss:0.8702656626701355
Validation loss decreased (0.876772 --> 0.870266).  Saving model ...
Epoch:6,validate loss:0.880827009677887
Epoch:7,validate loss:0.8588034510612488
Validation loss decreased (0.870266 --> 0.858803).  Saving model ...
Epoch:8,validate loss:0.8463070392608643
Validation loss decreased (0.858803 --> 0.846307).  Saving model ...
Epoch:9,validate loss:0.845728874206543
Validation loss decreased (0.846307 --> 0.845729).  Saving model ...
Epoch:10,validate loss:0.8452894687652588
Validation loss decreased (0.845729 --> 0.845289).  Saving model ...
Epoch:11,validate loss:0.8409426212310791
Validation loss decreased (0.845289 --> 0.840943).  Saving model ...
Epoch:12,validate loss:0.83064866065979
Validation loss decreased (0.840943 --> 0.830649).  Saving model ...
Epoch:13,validate loss:0.8329935669898987
Epoch:14,validate loss:0.8255483508110046
Validation loss decreased (0.830649 --> 0.825548).  Saving model ...
Epoch:15,validate loss:0.8323935866355896
Epoch:16,validate loss:0.8195337057113647
Validation loss decreased (0.825548 --> 0.819534).  Saving model ...
Epoch:17,validate loss:0.8227366805076599
Epoch:18,validate loss:0.8206673860549927
Epoch:19,validate loss:0.8035866618156433
Validation loss decreased (0.819534 --> 0.803587).  Saving model ...
Epoch:20,validate loss:0.8144062757492065
Epoch:21,validate loss:0.8026123642921448
Validation loss decreased (0.803587 --> 0.802612).  Saving model ...
Epoch:22,validate loss:0.7976865768432617
Validation loss decreased (0.802612 --> 0.797687).  Saving model ...
Epoch:23,validate loss:0.8430179357528687
Epoch:24,validate loss:0.7812015414237976
Validation loss decreased (0.797687 --> 0.781202).  Saving model ...
Epoch:25,validate loss:0.7955133318901062
Epoch:26,validate loss:0.7901803851127625
Epoch:27,validate loss:0.7910357117652893
Epoch:28,validate loss:0.7763415575027466
Validation loss decreased (0.781202 --> 0.776342).  Saving model ...
Epoch:29,validate loss:0.7787092328071594
Epoch:30,validate loss:0.7831186056137085
Epoch:31,validate loss:0.7804044485092163
Epoch:32,validate loss:0.7743745446205139
Validation loss decreased (0.776342 --> 0.774375).  Saving model ...
Epoch:33,validate loss:0.7814438939094543
Epoch:34,validate loss:0.779935359954834
Epoch:35,validate loss:0.7814010381698608
Epoch:36,validate loss:0.7568383812904358
Validation loss decreased (0.774375 --> 0.756838).  Saving model ...
Epoch:37,validate loss:0.7663623094558716
Epoch:38,validate loss:0.7629839777946472
Epoch:39,validate loss:0.7591689229011536
Epoch:40,validate loss:0.7703437209129333
Epoch:41,validate loss:0.7773339748382568
Epoch:42,validate loss:0.7551482319831848
Validation loss decreased (0.756838 --> 0.755148).  Saving model ...
Epoch:43,validate loss:0.760960042476654
Epoch:44,validate loss:0.7718596458435059
Epoch:45,validate loss:0.769046425819397
Epoch:46,validate loss:0.7591882348060608
Epoch:47,validate loss:0.7531542778015137
Validation loss decreased (0.755148 --> 0.753154).  Saving model ...
Epoch:48,validate loss:0.755677342414856
Epoch:49,validate loss:0.7530814409255981
Validation loss decreased (0.753154 --> 0.753081).  Saving model ...
Epoch:50,validate loss:0.7493770718574524
Validation loss decreased (0.753081 --> 0.749377).  Saving model ...
Epoch:51,validate loss:0.7459692358970642
Validation loss decreased (0.749377 --> 0.745969).  Saving model ...
Epoch:52,validate loss:0.7518361806869507
Epoch:53,validate loss:0.7433796525001526
Validation loss decreased (0.745969 --> 0.743380).  Saving model ...
Epoch:54,validate loss:0.7429577112197876
Validation loss decreased (0.743380 --> 0.742958).  Saving model ...
Epoch:55,validate loss:0.741337239742279
Validation loss decreased (0.742958 --> 0.741337).  Saving model ...
Epoch:56,validate loss:0.7695363163948059
Epoch:57,validate loss:0.7484983205795288
Epoch:58,validate loss:0.7575206160545349
Epoch:59,validate loss:0.7507824301719666
Epoch:60,validate loss:0.750429093837738
Epoch:61,validate loss:0.7569370865821838
Epoch:62,validate loss:0.7459415793418884
Epoch:63,validate loss:0.740507185459137
Validation loss decreased (0.741337 --> 0.740507).  Saving model ...
Epoch:64,validate loss:0.7480771541595459
Epoch:65,validate loss:0.7565475702285767
Epoch:66,validate loss:0.7459080815315247
Epoch:67,validate loss:0.753847062587738
Epoch:68,validate loss:0.7463209629058838
Epoch:69,validate loss:0.7496045827865601
Epoch:70,validate loss:0.7421739101409912
Epoch:71,validate loss:0.7603151798248291
Epoch:72,validate loss:0.7457119226455688
Epoch:73,validate loss:0.7459861040115356
Epoch:74,validate loss:0.737850546836853
Validation loss decreased (0.740507 --> 0.737851).  Saving model ...
Epoch:75,validate loss:0.7523886561393738
Epoch:76,validate loss:0.7427726984024048
Epoch:77,validate loss:0.7432739734649658
Epoch:78,validate loss:0.7496834397315979
Epoch:79,validate loss:0.7540088295936584
Epoch:80,validate loss:0.7495483756065369
Epoch:81,validate loss:0.756540060043335
Epoch:82,validate loss:0.7456353902816772
Epoch:83,validate loss:0.7501261830329895
Epoch:84,validate loss:0.7447529435157776
Epoch:85,validate loss:0.751660168170929
Epoch:86,validate loss:0.7417708039283752
Epoch:87,validate loss:0.7530397176742554
Epoch:88,validate loss:0.7628409266471863
Epoch:89,validate loss:0.7636331915855408
Epoch:90,validate loss:0.7563669681549072
Epoch:91,validate loss:0.7471203207969666
Epoch:92,validate loss:0.7578964829444885
Epoch:93,validate loss:0.7500501275062561
Epoch:94,validate loss:0.7703402638435364
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.917,avg=0.100
0.009619115,0.009619115,0.02940378,0.13606969,0.009619115,0.15219156,0.08458112,0.5496583,0.009619115,0.009619115,
0.00068973255,0.00022022799,2.9262505e-05,2.9262505e-05,0.5042548,2.9262505e-05,2.9262505e-05,0.030125983,0.46456298,2.9262505e-05,
0.0033895285,0.33430147,0.39250118,0.0033895285,0.0033895285,0.0033895285,0.009048182,0.24307317,0.0033895285,0.0041284114,
0.0068137287,0.03447646,0.0068137287,0.0068137287,0.0068137287,0.07005323,0.37335053,0.0068137287,0.0068137287,0.48123735,
0.018848758,0.018848758,0.018848758,0.37644562,0.38571236,0.042985335,0.018848758,0.08176409,0.018848758,0.018848758,
0.0933592,0.0933592,0.0933592,0.0933592,0.0933592,0.15976723,0.0933592,0.0933592,0.0933592,0.0933592,
0.0016322699,0.0016322699,0.030833336,0.0016322699,0.0016322699,0.48663938,0.46907878,0.0016322699,0.0016322699,0.0036549224,
0.003949887,0.003949887,0.003949887,0.017599592,0.003949887,0.9166101,0.003949887,0.003949887,0.003949887,0.03814111,
0.0036661327,0.0020556415,0.30068552,0.10699491,0.07621035,0.0028120128,0.00084134255,0.5009228,0.004969965,0.00084134255,
0.012134313,0.012134313,0.012134313,0.83317274,0.012134313,0.012134313,0.012134313,0.06975267,0.012134313,0.012134313,
Evaluate model on site 1 , Test MAE: 0.8087, Test MAPE: 1.0575, Test RMSE: 1.2405
Evaluate model on site 2 , Test MAE: 0.7479, Test MAPE: 0.3528, Test RMSE: 1.2264
Evaluate model on site 3 , Test MAE: 0.7599, Test MAPE: 0.1754, Test RMSE: 1.1834
Evaluate model on site 4 , Test MAE: 0.6105, Test MAPE: 0.3170, Test RMSE: 0.9841
Evaluate model on site 5 , Test MAE: 0.6099, Test MAPE: 2.1615, Test RMSE: 1.1087
Evaluate model on site 6 , Test MAE: 0.7544, Test MAPE: 2.8326, Test RMSE: 1.2603
Evaluate model on site 7 , Test MAE: 0.9220, Test MAPE: 1.1411, Test RMSE: 1.6637
Evaluate model on site 8 , Test MAE: 0.7234, Test MAPE: 0.3234, Test RMSE: 1.2368
Evaluate model on site 9 , Test MAE: 1.0175, Test MAPE: 1.1165, Test RMSE: 1.5757
Evaluate model on site 10 , Test MAE: 0.9078, Test MAPE: 0.2016, Test RMSE: 1.3597
On average over all site, Test MAE: 0.7862, Test MAPE: 0.9680, Test RMSE: 1.2839
(0.7862032413482666, 0.967954495549202, 1.283931040763855)
data::data/water/shangban/singleFac/6,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/6', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.9634183645248413
Validation loss decreased (inf --> 0.963418).  Saving model ...
Epoch:2,validate loss:0.9049423933029175
Validation loss decreased (0.963418 --> 0.904942).  Saving model ...
Epoch:3,validate loss:0.9112716913223267
Epoch:4,validate loss:0.8818745017051697
Validation loss decreased (0.904942 --> 0.881875).  Saving model ...
Epoch:5,validate loss:0.858823299407959
Validation loss decreased (0.881875 --> 0.858823).  Saving model ...
Epoch:6,validate loss:0.8491290211677551
Validation loss decreased (0.858823 --> 0.849129).  Saving model ...
Epoch:7,validate loss:0.8406457901000977
Validation loss decreased (0.849129 --> 0.840646).  Saving model ...
Epoch:8,validate loss:0.8364977836608887
Validation loss decreased (0.840646 --> 0.836498).  Saving model ...
Epoch:9,validate loss:0.8422475457191467
Epoch:10,validate loss:0.8293742537498474
Validation loss decreased (0.836498 --> 0.829374).  Saving model ...
Epoch:11,validate loss:0.8438082337379456
Epoch:12,validate loss:0.8260031938552856
Validation loss decreased (0.829374 --> 0.826003).  Saving model ...
Epoch:13,validate loss:0.8238304853439331
Validation loss decreased (0.826003 --> 0.823830).  Saving model ...
Epoch:14,validate loss:0.8141046762466431
Validation loss decreased (0.823830 --> 0.814105).  Saving model ...
Epoch:15,validate loss:0.8052166700363159
Validation loss decreased (0.814105 --> 0.805217).  Saving model ...
Epoch:16,validate loss:0.8024563789367676
Validation loss decreased (0.805217 --> 0.802456).  Saving model ...
Epoch:17,validate loss:0.8014359474182129
Validation loss decreased (0.802456 --> 0.801436).  Saving model ...
Epoch:18,validate loss:0.8074929714202881
Epoch:19,validate loss:0.796267569065094
Validation loss decreased (0.801436 --> 0.796268).  Saving model ...
Epoch:20,validate loss:0.7922511100769043
Validation loss decreased (0.796268 --> 0.792251).  Saving model ...
Epoch:21,validate loss:0.7985996603965759
Epoch:22,validate loss:0.78940749168396
Validation loss decreased (0.792251 --> 0.789407).  Saving model ...
Epoch:23,validate loss:0.794242262840271
Epoch:24,validate loss:0.8067359924316406
Epoch:25,validate loss:0.7911457419395447
Epoch:26,validate loss:0.7927231192588806
Epoch:27,validate loss:0.7835603356361389
Validation loss decreased (0.789407 --> 0.783560).  Saving model ...
Epoch:28,validate loss:0.7898463606834412
Epoch:29,validate loss:0.7739600539207458
Validation loss decreased (0.783560 --> 0.773960).  Saving model ...
Epoch:30,validate loss:0.7799497842788696
Epoch:31,validate loss:0.7772008776664734
Epoch:32,validate loss:0.7677942514419556
Validation loss decreased (0.773960 --> 0.767794).  Saving model ...
Epoch:33,validate loss:0.7705811858177185
Epoch:34,validate loss:0.7626630067825317
Validation loss decreased (0.767794 --> 0.762663).  Saving model ...
Epoch:35,validate loss:0.767498791217804
Epoch:36,validate loss:0.7749074697494507
Epoch:37,validate loss:0.7769554257392883
Epoch:38,validate loss:0.7626845240592957
Epoch:39,validate loss:0.7507132887840271
Validation loss decreased (0.762663 --> 0.750713).  Saving model ...
Epoch:40,validate loss:0.7667989730834961
Epoch:41,validate loss:0.7529882788658142
Epoch:42,validate loss:0.7628861665725708
Epoch:43,validate loss:0.7424169182777405
Validation loss decreased (0.750713 --> 0.742417).  Saving model ...
Epoch:44,validate loss:0.7475420832633972
Epoch:45,validate loss:0.7436372637748718
Epoch:46,validate loss:0.764454185962677
Epoch:47,validate loss:0.752206563949585
Epoch:48,validate loss:0.74701988697052
Epoch:49,validate loss:0.7449156045913696
Epoch:50,validate loss:0.7510207891464233
Epoch:51,validate loss:0.7481501698493958
Epoch:52,validate loss:0.7491194605827332
Epoch:53,validate loss:0.7582184672355652
Epoch:54,validate loss:0.7373777627944946
Validation loss decreased (0.742417 --> 0.737378).  Saving model ...
Epoch:55,validate loss:0.7452404499053955
Epoch:56,validate loss:0.7447561025619507
Epoch:57,validate loss:0.7607845067977905
Epoch:58,validate loss:0.7580559253692627
Epoch:59,validate loss:0.7637298703193665
Epoch:60,validate loss:0.756934404373169
Epoch:61,validate loss:0.756894588470459
Epoch:62,validate loss:0.7482389211654663
Epoch:63,validate loss:0.7567917108535767
Epoch:64,validate loss:0.7474994659423828
Epoch:65,validate loss:0.7445186972618103
Epoch:66,validate loss:0.7705700397491455
Epoch:67,validate loss:0.7436326742172241
Epoch:68,validate loss:0.74280846118927
Epoch:69,validate loss:0.7503550052642822
Epoch:70,validate loss:0.7616627216339111
Epoch:71,validate loss:0.7467023730278015
Epoch:72,validate loss:0.7503958940505981
Epoch:73,validate loss:0.7555782198905945
Epoch:74,validate loss:0.7529909014701843
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.860,avg=0.100
0.00078362547,4.9345235e-05,0.00073014275,0.21141228,4.9345235e-05,4.9345235e-05,0.11002051,4.9345235e-05,0.67660904,0.00024708398,
0.0050736414,0.037221298,0.0050736414,0.34734035,0.0050736414,0.0050736414,0.0050736414,0.0050736414,0.55484563,0.03015095,
0.28434888,0.0011179441,9.947891e-05,0.70079523,0.0024031873,9.947891e-05,0.010353719,9.947891e-05,0.0005831125,9.947891e-05,
0.0050494415,0.056769863,0.0050494415,0.0050494415,0.0050494415,0.0057638716,0.04428395,0.0058760187,0.0075582657,0.85955024,
0.028969677,0.0019177037,0.00057793746,0.7626546,0.00057793746,0.20138536,0.00057793746,0.0021829526,0.00057793746,0.00057793746,
0.0059268028,0.036476593,0.1348764,0.0059268028,0.0059268028,0.7149625,0.0059268028,0.0059268028,0.0059268028,0.07812374,
0.1613122,0.027796168,0.027796168,0.027796168,0.042464003,0.027796168,0.5967602,0.03268658,0.027796168,0.027796168,
0.13219488,0.0006323917,0.54558843,0.0006323917,0.0006323917,0.0037996387,0.0006323917,0.30162483,0.0006323917,0.013630254,
0.46766657,0.010460175,0.016588962,0.008243359,0.2625549,0.19301887,0.008243359,0.016737157,0.008243359,0.008243359,
0.1018597,0.003613641,0.25149682,0.003613641,0.003613641,0.003613641,0.003613641,0.62134796,0.003613641,0.003613641,
Evaluate model on site 1 , Test MAE: 0.8130, Test MAPE: 1.1056, Test RMSE: 1.2304
Evaluate model on site 2 , Test MAE: 0.7910, Test MAPE: 0.3450, Test RMSE: 1.2831
Evaluate model on site 3 , Test MAE: 0.7764, Test MAPE: 0.2140, Test RMSE: 1.1663
Evaluate model on site 4 , Test MAE: 0.5891, Test MAPE: 0.3377, Test RMSE: 0.9801
Evaluate model on site 5 , Test MAE: 0.6144, Test MAPE: 2.2468, Test RMSE: 1.1048
Evaluate model on site 6 , Test MAE: 0.7332, Test MAPE: 3.4144, Test RMSE: 1.2505
Evaluate model on site 7 , Test MAE: 0.9336, Test MAPE: 1.0252, Test RMSE: 1.6880
Evaluate model on site 8 , Test MAE: 0.7008, Test MAPE: 0.3921, Test RMSE: 1.2083
Evaluate model on site 9 , Test MAE: 1.0516, Test MAPE: 1.2219, Test RMSE: 1.5852
Evaluate model on site 10 , Test MAE: 0.8800, Test MAPE: 0.1955, Test RMSE: 1.3287
On average over all site, Test MAE: 0.7883, Test MAPE: 1.0498, Test RMSE: 1.2825
(0.7883063018321991, 1.0498270258307456, 1.2825401782989503)
data::data/water/shangban/singleFac/6,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/6', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.9808104634284973
Validation loss decreased (inf --> 0.980810).  Saving model ...
Epoch:2,validate loss:0.9179900288581848
Validation loss decreased (0.980810 --> 0.917990).  Saving model ...
Epoch:3,validate loss:0.8903375864028931
Validation loss decreased (0.917990 --> 0.890338).  Saving model ...
Epoch:4,validate loss:0.8942880630493164
Epoch:5,validate loss:0.8704538345336914
Validation loss decreased (0.890338 --> 0.870454).  Saving model ...
Epoch:6,validate loss:0.8585590124130249
Validation loss decreased (0.870454 --> 0.858559).  Saving model ...
Epoch:7,validate loss:0.8433511257171631
Validation loss decreased (0.858559 --> 0.843351).  Saving model ...
Epoch:8,validate loss:0.8564143180847168
Epoch:9,validate loss:0.8378984332084656
Validation loss decreased (0.843351 --> 0.837898).  Saving model ...
Epoch:10,validate loss:0.8365318775177002
Validation loss decreased (0.837898 --> 0.836532).  Saving model ...
Epoch:11,validate loss:0.8274170756340027
Validation loss decreased (0.836532 --> 0.827417).  Saving model ...
Epoch:12,validate loss:0.8294225931167603
Epoch:13,validate loss:0.8120145201683044
Validation loss decreased (0.827417 --> 0.812015).  Saving model ...
Epoch:14,validate loss:0.8103252649307251
Validation loss decreased (0.812015 --> 0.810325).  Saving model ...
Epoch:15,validate loss:0.8040663003921509
Validation loss decreased (0.810325 --> 0.804066).  Saving model ...
Epoch:16,validate loss:0.8061413168907166
Epoch:17,validate loss:0.7976247072219849
Validation loss decreased (0.804066 --> 0.797625).  Saving model ...
Epoch:18,validate loss:0.803868293762207
Epoch:19,validate loss:0.8026451468467712
Epoch:20,validate loss:0.7921581268310547
Validation loss decreased (0.797625 --> 0.792158).  Saving model ...
Epoch:21,validate loss:0.8017129898071289
Epoch:22,validate loss:0.7980568408966064
Epoch:23,validate loss:0.7891080379486084
Validation loss decreased (0.792158 --> 0.789108).  Saving model ...
Epoch:24,validate loss:0.7868484854698181
Validation loss decreased (0.789108 --> 0.786848).  Saving model ...
Epoch:25,validate loss:0.8129447102546692
Epoch:26,validate loss:0.7971901297569275
Epoch:27,validate loss:0.7903057336807251
Epoch:28,validate loss:0.7849258780479431
Validation loss decreased (0.786848 --> 0.784926).  Saving model ...
Epoch:29,validate loss:0.7911776900291443
Epoch:30,validate loss:0.7877318859100342
Epoch:31,validate loss:0.7852937579154968
Epoch:32,validate loss:0.7840280532836914
Validation loss decreased (0.784926 --> 0.784028).  Saving model ...
Epoch:33,validate loss:0.7689414620399475
Validation loss decreased (0.784028 --> 0.768941).  Saving model ...
Epoch:34,validate loss:0.7727444171905518
Epoch:35,validate loss:0.7713900208473206
Epoch:36,validate loss:0.768297016620636
Validation loss decreased (0.768941 --> 0.768297).  Saving model ...
Epoch:37,validate loss:0.7798405289649963
Epoch:38,validate loss:0.7879188656806946
Epoch:39,validate loss:0.7867143154144287
Epoch:40,validate loss:0.7755838632583618
Epoch:41,validate loss:0.7844045162200928
Epoch:42,validate loss:0.7701519131660461
Epoch:43,validate loss:0.7797663807868958
Epoch:44,validate loss:0.7704923152923584
Epoch:45,validate loss:0.772205650806427
Epoch:46,validate loss:0.7582527995109558
Validation loss decreased (0.768297 --> 0.758253).  Saving model ...
Epoch:47,validate loss:0.7720900177955627
Epoch:48,validate loss:0.77137291431427
Epoch:49,validate loss:0.7853572964668274
Epoch:50,validate loss:0.7801134586334229
Epoch:51,validate loss:0.7585944533348083
Epoch:52,validate loss:0.7671408653259277
Epoch:53,validate loss:0.7654145359992981
Epoch:54,validate loss:0.755314826965332
Validation loss decreased (0.758253 --> 0.755315).  Saving model ...
Epoch:55,validate loss:0.7584729790687561
Epoch:56,validate loss:0.7541683316230774
Validation loss decreased (0.755315 --> 0.754168).  Saving model ...
Epoch:57,validate loss:0.7630317807197571
Epoch:58,validate loss:0.7682737112045288
Epoch:59,validate loss:0.7663692235946655
Epoch:60,validate loss:0.7538778185844421
Validation loss decreased (0.754168 --> 0.753878).  Saving model ...
Epoch:61,validate loss:0.7529577016830444
Validation loss decreased (0.753878 --> 0.752958).  Saving model ...
Epoch:62,validate loss:0.7800382375717163
Epoch:63,validate loss:0.7618288397789001
Epoch:64,validate loss:0.7749550938606262
Epoch:65,validate loss:0.758251428604126
Epoch:66,validate loss:0.7744122743606567
Epoch:67,validate loss:0.7772373557090759
Epoch:68,validate loss:0.7486615180969238
Validation loss decreased (0.752958 --> 0.748662).  Saving model ...
Epoch:69,validate loss:0.7601493000984192
Epoch:70,validate loss:0.7724023461341858
Epoch:71,validate loss:0.759279191493988
Epoch:72,validate loss:0.7611764669418335
Epoch:73,validate loss:0.7568860054016113
Epoch:74,validate loss:0.7637361288070679
Epoch:75,validate loss:0.7782090902328491
Epoch:76,validate loss:0.7682833671569824
Epoch:77,validate loss:0.7584673762321472
Epoch:78,validate loss:0.7696595788002014
Epoch:79,validate loss:0.7668878436088562
Epoch:80,validate loss:0.7568367123603821
Epoch:81,validate loss:0.7581271529197693
Epoch:82,validate loss:0.7633000016212463
Epoch:83,validate loss:0.7526556849479675
Epoch:84,validate loss:0.7801427841186523
Epoch:85,validate loss:0.7724887132644653
Epoch:86,validate loss:0.7742497324943542
Epoch:87,validate loss:0.7718905806541443
Epoch:88,validate loss:0.7542899250984192
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.718,avg=0.100
0.001356394,0.006404586,0.001356394,0.51089895,0.001356394,0.001356394,0.001356394,0.005068245,0.46948984,0.001356394,
0.00051378465,0.00051378465,0.00051378465,0.0034512526,0.00051378465,0.00362055,0.00051378465,0.52372587,0.46611962,0.00051378465,
0.10347712,0.07534376,0.011112872,7.079838e-05,7.6592856e-05,7.079838e-05,0.47733483,0.33228296,0.0001594111,7.079838e-05,
0.023797106,0.023797106,0.023797106,0.023797106,0.023797106,0.29442883,0.023797106,0.51519436,0.023797106,0.023797106,
0.000119888115,0.67085236,0.000119888115,0.000119888115,0.000119888115,0.050473437,0.00015113146,0.000119888115,0.27601185,0.0019118232,
0.21984701,0.05475317,0.004964926,0.0005429248,0.20189136,0.06175068,0.0005429248,0.0005429248,0.0057286234,0.44943544,
0.12819873,0.010423328,0.40706363,0.010423328,0.010423328,0.010423328,0.010423328,0.010423328,0.010423328,0.39177424,
0.0015942586,0.0015942586,0.0015942586,0.0015942586,0.3164994,0.0015942586,0.0015942586,0.6707466,0.0015942586,0.0015942586,
0.022091318,0.13146299,0.00067830423,0.0091684675,0.00067830423,0.00090390944,0.00067830423,0.71770036,0.11595967,0.00067830423,
0.593209,0.35119903,0.00395497,0.00033241167,0.00058628415,0.00033241167,0.00033241167,0.00033241167,0.013675383,0.03604573,
Evaluate model on site 1 , Test MAE: 0.8008, Test MAPE: 1.2606, Test RMSE: 1.2419
Evaluate model on site 2 , Test MAE: 0.7345, Test MAPE: 0.2853, Test RMSE: 1.2199
Evaluate model on site 3 , Test MAE: 0.7832, Test MAPE: 0.2152, Test RMSE: 1.1841
Evaluate model on site 4 , Test MAE: 0.6026, Test MAPE: 0.7933, Test RMSE: 0.9927
Evaluate model on site 5 , Test MAE: 0.5874, Test MAPE: 1.5938, Test RMSE: 1.1140
Evaluate model on site 6 , Test MAE: 0.7222, Test MAPE: 2.4345, Test RMSE: 1.2276
Evaluate model on site 7 , Test MAE: 0.9240, Test MAPE: 0.7392, Test RMSE: 1.7253
Evaluate model on site 8 , Test MAE: 0.7208, Test MAPE: 0.3721, Test RMSE: 1.2114
Evaluate model on site 9 , Test MAE: 1.0684, Test MAPE: 1.3144, Test RMSE: 1.6096
Evaluate model on site 10 , Test MAE: 0.8530, Test MAPE: 0.1922, Test RMSE: 1.2706
On average over all site, Test MAE: 0.7797, Test MAPE: 0.9201, Test RMSE: 1.2797
(0.7796982645988464, 0.9200519725680352, 1.2797174155712128)
data::data/water/shangban/singleFac/6,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/6', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:1.0085453987121582
Validation loss decreased (inf --> 1.008545).  Saving model ...
Epoch:2,validate loss:0.9069525599479675
Validation loss decreased (1.008545 --> 0.906953).  Saving model ...
Epoch:3,validate loss:0.8654499650001526
Validation loss decreased (0.906953 --> 0.865450).  Saving model ...
Epoch:4,validate loss:0.8662624359130859
Epoch:5,validate loss:0.8646606206893921
Validation loss decreased (0.865450 --> 0.864661).  Saving model ...
Epoch:6,validate loss:0.8424793481826782
Validation loss decreased (0.864661 --> 0.842479).  Saving model ...
Epoch:7,validate loss:0.8369125723838806
Validation loss decreased (0.842479 --> 0.836913).  Saving model ...
Epoch:8,validate loss:0.8361154198646545
Validation loss decreased (0.836913 --> 0.836115).  Saving model ...
Epoch:9,validate loss:0.8299023509025574
Validation loss decreased (0.836115 --> 0.829902).  Saving model ...
Epoch:10,validate loss:0.8545008897781372
Epoch:11,validate loss:0.8104481101036072
Validation loss decreased (0.829902 --> 0.810448).  Saving model ...
Epoch:12,validate loss:0.8100008368492126
Validation loss decreased (0.810448 --> 0.810001).  Saving model ...
Epoch:13,validate loss:0.8140687942504883
Epoch:14,validate loss:0.7961606979370117
Validation loss decreased (0.810001 --> 0.796161).  Saving model ...
Epoch:15,validate loss:0.8141270875930786
Epoch:16,validate loss:0.7996470928192139
Epoch:17,validate loss:0.7907651662826538
Validation loss decreased (0.796161 --> 0.790765).  Saving model ...
Epoch:18,validate loss:0.80485999584198
Epoch:19,validate loss:0.7961821556091309
Epoch:20,validate loss:0.786536455154419
Validation loss decreased (0.790765 --> 0.786536).  Saving model ...
Epoch:21,validate loss:0.7888875603675842
Epoch:22,validate loss:0.800567626953125
Epoch:23,validate loss:0.7936675548553467
Epoch:24,validate loss:0.7848349809646606
Validation loss decreased (0.786536 --> 0.784835).  Saving model ...
Epoch:25,validate loss:0.8029329180717468
Epoch:26,validate loss:0.7833940982818604
Validation loss decreased (0.784835 --> 0.783394).  Saving model ...
Epoch:27,validate loss:0.7706462144851685
Validation loss decreased (0.783394 --> 0.770646).  Saving model ...
Epoch:28,validate loss:0.7658073902130127
Validation loss decreased (0.770646 --> 0.765807).  Saving model ...
Epoch:29,validate loss:0.7637969255447388
Validation loss decreased (0.765807 --> 0.763797).  Saving model ...
Epoch:30,validate loss:0.7873481512069702
Epoch:31,validate loss:0.7697932720184326
Epoch:32,validate loss:0.7623573541641235
Validation loss decreased (0.763797 --> 0.762357).  Saving model ...
Epoch:33,validate loss:0.763568103313446
Epoch:34,validate loss:0.7716154456138611
Epoch:35,validate loss:0.7649901509284973
Epoch:36,validate loss:0.7628516554832458
Epoch:37,validate loss:0.7573496103286743
Validation loss decreased (0.762357 --> 0.757350).  Saving model ...
Epoch:38,validate loss:0.7834523320198059
Epoch:39,validate loss:0.7670421600341797
Epoch:40,validate loss:0.7762855887413025
Epoch:41,validate loss:0.7602579593658447
Epoch:42,validate loss:0.7627246379852295
Epoch:43,validate loss:0.7613950371742249
Epoch:44,validate loss:0.7655773758888245
Epoch:45,validate loss:0.76985764503479
Epoch:46,validate loss:0.7556102871894836
Validation loss decreased (0.757350 --> 0.755610).  Saving model ...
Epoch:47,validate loss:0.7588517069816589
Epoch:48,validate loss:0.7521657347679138
Validation loss decreased (0.755610 --> 0.752166).  Saving model ...
Epoch:49,validate loss:0.7655526399612427
Epoch:50,validate loss:0.7507227063179016
Validation loss decreased (0.752166 --> 0.750723).  Saving model ...
Epoch:51,validate loss:0.7530372738838196
Epoch:52,validate loss:0.7696354389190674
Epoch:53,validate loss:0.7615606188774109
Epoch:54,validate loss:0.7583745718002319
Epoch:55,validate loss:0.7634093165397644
Epoch:56,validate loss:0.7619701623916626
Epoch:57,validate loss:0.7514606714248657
Epoch:58,validate loss:0.7570884227752686
Epoch:59,validate loss:0.7434952259063721
Validation loss decreased (0.750723 --> 0.743495).  Saving model ...
Epoch:60,validate loss:0.7589247226715088
Epoch:61,validate loss:0.7707525491714478
Epoch:62,validate loss:0.7524320483207703
Epoch:63,validate loss:0.7606558799743652
Epoch:64,validate loss:0.7633237838745117
Epoch:65,validate loss:0.753702700138092
Epoch:66,validate loss:0.7568937540054321
Epoch:67,validate loss:0.7571598291397095
Epoch:68,validate loss:0.7484630346298218
Epoch:69,validate loss:0.7515939474105835
Epoch:70,validate loss:0.7536206245422363
Epoch:71,validate loss:0.7475364804267883
Epoch:72,validate loss:0.7605288624763489
Epoch:73,validate loss:0.7573955655097961
Epoch:74,validate loss:0.7408812642097473
Validation loss decreased (0.743495 --> 0.740881).  Saving model ...
Epoch:75,validate loss:0.7443667054176331
Epoch:76,validate loss:0.7405003905296326
Validation loss decreased (0.740881 --> 0.740500).  Saving model ...
Epoch:77,validate loss:0.7616519927978516
Epoch:78,validate loss:0.7411829233169556
Epoch:79,validate loss:0.7496888041496277
Epoch:80,validate loss:0.7430534958839417
Epoch:81,validate loss:0.7791849970817566
Epoch:82,validate loss:0.7385400533676147
Validation loss decreased (0.740500 --> 0.738540).  Saving model ...
Epoch:83,validate loss:0.746811032295227
Epoch:84,validate loss:0.7515637874603271
Epoch:85,validate loss:0.7405171990394592
Epoch:86,validate loss:0.749502956867218
Epoch:87,validate loss:0.77289217710495
Epoch:88,validate loss:0.7382633686065674
Validation loss decreased (0.738540 --> 0.738263).  Saving model ...
Epoch:89,validate loss:0.7440418601036072
Epoch:90,validate loss:0.7377250790596008
Validation loss decreased (0.738263 --> 0.737725).  Saving model ...
Epoch:91,validate loss:0.7412464618682861
Epoch:92,validate loss:0.7424132227897644
Epoch:93,validate loss:0.7418769001960754
Epoch:94,validate loss:0.7373427748680115
Validation loss decreased (0.737725 --> 0.737343).  Saving model ...
Epoch:95,validate loss:0.7460864186286926
Epoch:96,validate loss:0.7484710216522217
Epoch:97,validate loss:0.7665037512779236
Epoch:98,validate loss:0.7423264384269714
Epoch:99,validate loss:0.7455270886421204
Epoch:100,validate loss:0.7463909387588501
Epoch:101,validate loss:0.7455396056175232
Epoch:102,validate loss:0.7395898699760437
Epoch:103,validate loss:0.742362380027771
Epoch:104,validate loss:0.7436637282371521
Epoch:105,validate loss:0.7431351542472839
Epoch:106,validate loss:0.7369464039802551
Validation loss decreased (0.737343 --> 0.736946).  Saving model ...
Epoch:107,validate loss:0.7369181513786316
Validation loss decreased (0.736946 --> 0.736918).  Saving model ...
Epoch:108,validate loss:0.7513843178749084
Epoch:109,validate loss:0.7366801500320435
Validation loss decreased (0.736918 --> 0.736680).  Saving model ...
Epoch:110,validate loss:0.752131998538971
Epoch:111,validate loss:0.7405543327331543
Epoch:112,validate loss:0.7468694448471069
Epoch:113,validate loss:0.728589653968811
Validation loss decreased (0.736680 --> 0.728590).  Saving model ...
Epoch:114,validate loss:0.7419286370277405
Epoch:115,validate loss:0.7428313493728638
Epoch:116,validate loss:0.7520291209220886
Epoch:117,validate loss:0.7387584447860718
Epoch:118,validate loss:0.746502697467804
Epoch:119,validate loss:0.7454670071601868
Epoch:120,validate loss:0.745652437210083
Epoch:121,validate loss:0.7501679062843323
Epoch:122,validate loss:0.7443730235099792
Epoch:123,validate loss:0.7606309652328491
Epoch:124,validate loss:0.7517293095588684
Epoch:125,validate loss:0.7490142583847046
Epoch:126,validate loss:0.7375912070274353
Epoch:127,validate loss:0.7580677270889282
Epoch:128,validate loss:0.7431568503379822
Epoch:129,validate loss:0.7536237239837646
Epoch:130,validate loss:0.7576524615287781
Epoch:131,validate loss:0.7497914433479309
Epoch:132,validate loss:0.7468690872192383
Epoch:133,validate loss:0.7485454678535461
Early stopping.
Training finished
邻接矩阵：min=0.001,max=0.883,avg=0.100
0.0016926853,0.014263637,0.0016926853,0.88342834,0.023686174,0.0016926853,0.0025172795,0.0016926853,0.0045594475,0.06477444,
0.023628103,0.41563663,0.023628103,0.023628103,0.023628103,0.064403996,0.10876967,0.2694211,0.023628103,0.023628103,
0.08835956,0.08209658,0.016712504,0.016712504,0.016712504,0.016712504,0.6412594,0.055828538,0.016712504,0.048893422,
0.73373616,0.017005341,0.0566452,0.017005341,0.017005341,0.017005341,0.017005341,0.090581164,0.017005341,0.017005341,
0.0026370634,0.51531166,0.0026370634,0.003351144,0.0026370634,0.0026370634,0.0058308397,0.0026370634,0.459684,0.0026370634,
0.0012922313,0.0012922313,0.0012922313,0.2483957,0.13303629,0.0061653373,0.055181768,0.0012922313,0.0012922313,0.55075973,
0.02794879,0.0010927456,0.0010927456,0.012781975,0.3336959,0.0010927456,0.3530526,0.027367886,0.0010927456,0.24078184,
0.006915596,0.13436915,0.016761214,0.002153832,0.4896733,0.002153832,0.29311982,0.002153832,0.002153832,0.05054562,
0.0025955115,0.21051162,0.33859766,0.02221178,0.4185342,0.0012939958,0.0012939958,0.0012939958,0.0012939958,0.0023732423,
0.01955406,0.37787166,0.0029322046,0.0029322046,0.059767243,0.0029322046,0.0029322046,0.5252138,0.0029322046,0.0029322046,
Evaluate model on site 1 , Test MAE: 0.7555, Test MAPE: 1.3692, Test RMSE: 1.1412
Evaluate model on site 2 , Test MAE: 0.7476, Test MAPE: 0.2905, Test RMSE: 1.2339
Evaluate model on site 3 , Test MAE: 0.7843, Test MAPE: 0.2267, Test RMSE: 1.2051
Evaluate model on site 4 , Test MAE: 0.6138, Test MAPE: 0.2841, Test RMSE: 0.9913
Evaluate model on site 5 , Test MAE: 0.5764, Test MAPE: 1.6051, Test RMSE: 1.0627
Evaluate model on site 6 , Test MAE: 0.7277, Test MAPE: 2.2893, Test RMSE: 1.2519
Evaluate model on site 7 , Test MAE: 0.9774, Test MAPE: 1.1087, Test RMSE: 1.7460
Evaluate model on site 8 , Test MAE: 0.7589, Test MAPE: 0.3713, Test RMSE: 1.2979
Evaluate model on site 9 , Test MAE: 1.0522, Test MAPE: 1.1537, Test RMSE: 1.5985
Evaluate model on site 10 , Test MAE: 0.8568, Test MAPE: 0.1897, Test RMSE: 1.3125
On average over all site, Test MAE: 0.7851, Test MAPE: 0.8888, Test RMSE: 1.2841
(0.7850712954998016, 0.8888338476419448, 1.284101003408432)
[0.7955514430999756, 0.7862032413482666, 0.7883063018321991, 0.7796982645988464, 0.7850712954998016]
data::data/water/shangban/singleFac/8,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/8', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.7427943348884583
Validation loss decreased (inf --> 0.742794).  Saving model ...
Epoch:2,validate loss:0.5493391752243042
Validation loss decreased (0.742794 --> 0.549339).  Saving model ...
Epoch:3,validate loss:0.5148690938949585
Validation loss decreased (0.549339 --> 0.514869).  Saving model ...
Epoch:4,validate loss:0.5234306454658508
Epoch:5,validate loss:0.49661126732826233
Validation loss decreased (0.514869 --> 0.496611).  Saving model ...
Epoch:6,validate loss:0.5051777362823486
Epoch:7,validate loss:0.49074646830558777
Validation loss decreased (0.496611 --> 0.490746).  Saving model ...
Epoch:8,validate loss:0.4686046838760376
Validation loss decreased (0.490746 --> 0.468605).  Saving model ...
Epoch:9,validate loss:0.4944068491458893
Epoch:10,validate loss:0.48431891202926636
Epoch:11,validate loss:0.47581833600997925
Epoch:12,validate loss:0.4981013834476471
Epoch:13,validate loss:0.4827376902103424
Epoch:14,validate loss:0.5118221640586853
Epoch:15,validate loss:0.4718131124973297
Epoch:16,validate loss:0.4697996973991394
Epoch:17,validate loss:0.4885731637477875
Epoch:18,validate loss:0.45946192741394043
Validation loss decreased (0.468605 --> 0.459462).  Saving model ...
Epoch:19,validate loss:0.4659135341644287
Epoch:20,validate loss:0.4729900658130646
Epoch:21,validate loss:0.46069929003715515
Epoch:22,validate loss:0.4540170133113861
Validation loss decreased (0.459462 --> 0.454017).  Saving model ...
Epoch:23,validate loss:0.4787029027938843
Epoch:24,validate loss:0.45338091254234314
Validation loss decreased (0.454017 --> 0.453381).  Saving model ...
Epoch:25,validate loss:0.4493406414985657
Validation loss decreased (0.453381 --> 0.449341).  Saving model ...
Epoch:26,validate loss:0.46329423785209656
Epoch:27,validate loss:0.5068642497062683
Epoch:28,validate loss:0.45983442664146423
Epoch:29,validate loss:0.46267056465148926
Epoch:30,validate loss:0.5046306252479553
Epoch:31,validate loss:0.4537196457386017
Epoch:32,validate loss:0.456464558839798
Epoch:33,validate loss:0.4661983847618103
Epoch:34,validate loss:0.4577953517436981
Epoch:35,validate loss:0.45807763934135437
Epoch:36,validate loss:0.46618738770484924
Epoch:37,validate loss:0.4874294400215149
Epoch:38,validate loss:0.44887539744377136
Validation loss decreased (0.449341 --> 0.448875).  Saving model ...
Epoch:39,validate loss:0.4496529698371887
Epoch:40,validate loss:0.45516327023506165
Epoch:41,validate loss:0.48106878995895386
Epoch:42,validate loss:0.4591290354728699
Epoch:43,validate loss:0.458344429731369
Epoch:44,validate loss:0.4460252821445465
Validation loss decreased (0.448875 --> 0.446025).  Saving model ...
Epoch:45,validate loss:0.44625982642173767
Epoch:46,validate loss:0.44951003789901733
Epoch:47,validate loss:0.44131606817245483
Validation loss decreased (0.446025 --> 0.441316).  Saving model ...
Epoch:48,validate loss:0.44322752952575684
Epoch:49,validate loss:0.43018996715545654
Validation loss decreased (0.441316 --> 0.430190).  Saving model ...
Epoch:50,validate loss:0.4451885521411896
Epoch:51,validate loss:0.434078186750412
Epoch:52,validate loss:0.48505157232284546
Epoch:53,validate loss:0.4341426491737366
Epoch:54,validate loss:0.43008169531822205
Validation loss decreased (0.430190 --> 0.430082).  Saving model ...
Epoch:55,validate loss:0.42854514718055725
Validation loss decreased (0.430082 --> 0.428545).  Saving model ...
Epoch:56,validate loss:0.4334445595741272
Epoch:57,validate loss:0.43706604838371277
Epoch:58,validate loss:0.42985427379608154
Epoch:59,validate loss:0.4348856508731842
Epoch:60,validate loss:0.43002697825431824
Epoch:61,validate loss:0.4501955807209015
Epoch:62,validate loss:0.4405584931373596
Epoch:63,validate loss:0.44340816140174866
Epoch:64,validate loss:0.4278339743614197
Validation loss decreased (0.428545 --> 0.427834).  Saving model ...
Epoch:65,validate loss:0.43350160121917725
Epoch:66,validate loss:0.4255368113517761
Validation loss decreased (0.427834 --> 0.425537).  Saving model ...
Epoch:67,validate loss:0.42730048298835754
Epoch:68,validate loss:0.41962912678718567
Validation loss decreased (0.425537 --> 0.419629).  Saving model ...
Epoch:69,validate loss:0.42824023962020874
Epoch:70,validate loss:0.42302635312080383
Epoch:71,validate loss:0.4202873110771179
Epoch:72,validate loss:0.4287131726741791
Epoch:73,validate loss:0.43231725692749023
Epoch:74,validate loss:0.4244137704372406
Epoch:75,validate loss:0.4260441064834595
Epoch:76,validate loss:0.4285966753959656
Epoch:77,validate loss:0.42115843296051025
Epoch:78,validate loss:0.41888728737831116
Validation loss decreased (0.419629 --> 0.418887).  Saving model ...
Epoch:79,validate loss:0.435741126537323
Epoch:80,validate loss:0.4171958565711975
Validation loss decreased (0.418887 --> 0.417196).  Saving model ...
Epoch:81,validate loss:0.42142966389656067
Epoch:82,validate loss:0.41861090064048767
Epoch:83,validate loss:0.42413198947906494
Epoch:84,validate loss:0.4188977777957916
Epoch:85,validate loss:0.41997140645980835
Epoch:86,validate loss:0.45973101258277893
Epoch:87,validate loss:0.4143308103084564
Validation loss decreased (0.417196 --> 0.414331).  Saving model ...
Epoch:88,validate loss:0.41970762610435486
Epoch:89,validate loss:0.41238880157470703
Validation loss decreased (0.414331 --> 0.412389).  Saving model ...
Epoch:90,validate loss:0.41760969161987305
Epoch:91,validate loss:0.4231392741203308
Epoch:92,validate loss:0.4180602729320526
Epoch:93,validate loss:0.42772376537323
Epoch:94,validate loss:0.4144188165664673
Epoch:95,validate loss:0.4214804470539093
Epoch:96,validate loss:0.41981029510498047
Epoch:97,validate loss:0.416887104511261
Epoch:98,validate loss:0.4157174229621887
Epoch:99,validate loss:0.41301262378692627
Epoch:100,validate loss:0.4276755750179291
Epoch:101,validate loss:0.42913344502449036
Epoch:102,validate loss:0.4154309630393982
Epoch:103,validate loss:0.4273247718811035
Epoch:104,validate loss:0.42262277007102966
Epoch:105,validate loss:0.4327813982963562
Epoch:106,validate loss:0.41965213418006897
Epoch:107,validate loss:0.4264051616191864
Epoch:108,validate loss:0.4192798137664795
Epoch:109,validate loss:0.4171660542488098
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.944,avg=0.100
0.018486576,0.00064455986,0.014679519,0.0005145014,0.016193923,0.00087517133,0.0036913264,0.0005145014,0.9438853,0.0005145014,
0.0005458312,0.1933332,0.5187207,0.26043454,0.00029361347,0.00029361347,0.00029361347,0.02549771,0.00029361347,0.00029361347,
0.39687118,0.0005116347,0.0005116347,0.0005116347,0.0005116347,0.0005116347,0.0005116347,0.0005116347,0.0074896263,0.59205776,
0.045608703,0.0017735858,0.0017735858,0.0017735858,0.51281494,0.0017735858,0.39613074,0.028275892,0.008301776,0.0017735858,
4.992718e-05,0.00014516321,4.992718e-05,0.032010693,0.2493151,0.00029877693,4.992718e-05,7.527084e-05,4.992718e-05,0.7179553,
0.03995676,0.007832118,0.021165898,0.007832118,0.007832118,0.007832118,0.007832118,0.007832118,0.8840526,0.007832118,
0.082894966,0.0001684261,0.0023254096,0.0001684261,0.0001684261,0.0001684261,0.016052222,0.0001684261,0.0001684261,0.8977168,
0.16969413,0.00035341582,0.00035341582,0.00035341582,0.55640143,0.0006962453,0.00035341582,0.00035341582,0.2710877,0.00035341582,
0.11768926,0.71180725,0.007648468,0.10543794,0.0006554699,0.0006554699,0.0051567275,0.0006554699,0.0006554699,0.049638413,
0.01676737,0.12776914,0.01676737,0.29682633,0.01676737,0.33500186,0.08505116,0.01676737,0.01676737,0.07151468,
Evaluate model on site 1 , Test MAE: 0.2841, Test MAPE: 0.0314, Test RMSE: 0.5012
Evaluate model on site 2 , Test MAE: 0.4576, Test MAPE: 0.0594, Test RMSE: 0.7088
Evaluate model on site 3 , Test MAE: 0.2602, Test MAPE: 0.0878, Test RMSE: 0.5793
Evaluate model on site 4 , Test MAE: 0.4856, Test MAPE: 0.1011, Test RMSE: 0.8514
Evaluate model on site 5 , Test MAE: 0.3819, Test MAPE: 0.0869, Test RMSE: 0.6863
Evaluate model on site 6 , Test MAE: 0.6776, Test MAPE: 0.2043, Test RMSE: 1.1274
Evaluate model on site 7 , Test MAE: 0.4469, Test MAPE: 0.1173, Test RMSE: 0.7448
Evaluate model on site 8 , Test MAE: 0.5228, Test MAPE: 0.0931, Test RMSE: 1.0846
Evaluate model on site 9 , Test MAE: 0.5095, Test MAPE: 0.0993, Test RMSE: 0.8848
Evaluate model on site 10 , Test MAE: 0.3585, Test MAPE: 0.5343, Test RMSE: 0.6234
On average over all site, Test MAE: 0.4385, Test MAPE: 0.1415, Test RMSE: 0.7792
(0.43848517835140227, 0.14148040413856505, 0.7792016506195069)
data::data/water/shangban/singleFac/8,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/8', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.7169919013977051
Validation loss decreased (inf --> 0.716992).  Saving model ...
Epoch:2,validate loss:0.5599689483642578
Validation loss decreased (0.716992 --> 0.559969).  Saving model ...
Epoch:3,validate loss:0.5407970547676086
Validation loss decreased (0.559969 --> 0.540797).  Saving model ...
Epoch:4,validate loss:0.5388790369033813
Validation loss decreased (0.540797 --> 0.538879).  Saving model ...
Epoch:5,validate loss:0.5081592798233032
Validation loss decreased (0.538879 --> 0.508159).  Saving model ...
Epoch:6,validate loss:0.4912731349468231
Validation loss decreased (0.508159 --> 0.491273).  Saving model ...
Epoch:7,validate loss:0.48421767354011536
Validation loss decreased (0.491273 --> 0.484218).  Saving model ...
Epoch:8,validate loss:0.5097239017486572
Epoch:9,validate loss:0.48397117853164673
Validation loss decreased (0.484218 --> 0.483971).  Saving model ...
Epoch:10,validate loss:0.48469802737236023
Epoch:11,validate loss:0.48035773634910583
Validation loss decreased (0.483971 --> 0.480358).  Saving model ...
Epoch:12,validate loss:0.47202086448669434
Validation loss decreased (0.480358 --> 0.472021).  Saving model ...
Epoch:13,validate loss:0.4702492356300354
Validation loss decreased (0.472021 --> 0.470249).  Saving model ...
Epoch:14,validate loss:0.4802353084087372
Epoch:15,validate loss:0.4804939031600952
Epoch:16,validate loss:0.4713601768016815
Epoch:17,validate loss:0.4722330868244171
Epoch:18,validate loss:0.4820079505443573
Epoch:19,validate loss:0.4700566828250885
Validation loss decreased (0.470249 --> 0.470057).  Saving model ...
Epoch:20,validate loss:0.46597883105278015
Validation loss decreased (0.470057 --> 0.465979).  Saving model ...
Epoch:21,validate loss:0.4786781072616577
Epoch:22,validate loss:0.4645874798297882
Validation loss decreased (0.465979 --> 0.464587).  Saving model ...
Epoch:23,validate loss:0.456032395362854
Validation loss decreased (0.464587 --> 0.456032).  Saving model ...
Epoch:24,validate loss:0.45451420545578003
Validation loss decreased (0.456032 --> 0.454514).  Saving model ...
Epoch:25,validate loss:0.45889657735824585
Epoch:26,validate loss:0.4541664123535156
Validation loss decreased (0.454514 --> 0.454166).  Saving model ...
Epoch:27,validate loss:0.4756415784358978
Epoch:28,validate loss:0.45369094610214233
Validation loss decreased (0.454166 --> 0.453691).  Saving model ...
Epoch:29,validate loss:0.4539399743080139
Epoch:30,validate loss:0.4506779611110687
Validation loss decreased (0.453691 --> 0.450678).  Saving model ...
Epoch:31,validate loss:0.44714879989624023
Validation loss decreased (0.450678 --> 0.447149).  Saving model ...
Epoch:32,validate loss:0.4504823386669159
Epoch:33,validate loss:0.4583996832370758
Epoch:34,validate loss:0.45423269271850586
Epoch:35,validate loss:0.45017725229263306
Epoch:36,validate loss:0.44959014654159546
Epoch:37,validate loss:0.4527125656604767
Epoch:38,validate loss:0.46960991621017456
Epoch:39,validate loss:0.456636518239975
Epoch:40,validate loss:0.4649255871772766
Epoch:41,validate loss:0.46520695090293884
Epoch:42,validate loss:0.4432866871356964
Validation loss decreased (0.447149 --> 0.443287).  Saving model ...
Epoch:43,validate loss:0.4493730068206787
Epoch:44,validate loss:0.4462602734565735
Epoch:45,validate loss:0.4467845559120178
Epoch:46,validate loss:0.43980878591537476
Validation loss decreased (0.443287 --> 0.439809).  Saving model ...
Epoch:47,validate loss:0.4374079704284668
Validation loss decreased (0.439809 --> 0.437408).  Saving model ...
Epoch:48,validate loss:0.44225168228149414
Epoch:49,validate loss:0.4721451997756958
Epoch:50,validate loss:0.43987199664115906
Epoch:51,validate loss:0.46630430221557617
Epoch:52,validate loss:0.4558098614215851
Epoch:53,validate loss:0.43584057688713074
Validation loss decreased (0.437408 --> 0.435841).  Saving model ...
Epoch:54,validate loss:0.44418880343437195
Epoch:55,validate loss:0.4370644986629486
Epoch:56,validate loss:0.44608181715011597
Epoch:57,validate loss:0.4353014826774597
Validation loss decreased (0.435841 --> 0.435301).  Saving model ...
Epoch:58,validate loss:0.4478667080402374
Epoch:59,validate loss:0.43103817105293274
Validation loss decreased (0.435301 --> 0.431038).  Saving model ...
Epoch:60,validate loss:0.42850133776664734
Validation loss decreased (0.431038 --> 0.428501).  Saving model ...
Epoch:61,validate loss:0.4363742470741272
Epoch:62,validate loss:0.4363274574279785
Epoch:63,validate loss:0.45054417848587036
Epoch:64,validate loss:0.4366627037525177
Epoch:65,validate loss:0.43614768981933594
Epoch:66,validate loss:0.437505841255188
Epoch:67,validate loss:0.4305467903614044
Epoch:68,validate loss:0.4479658305644989
Epoch:69,validate loss:0.42702868580818176
Validation loss decreased (0.428501 --> 0.427029).  Saving model ...
Epoch:70,validate loss:0.4435316324234009
Epoch:71,validate loss:0.4279896914958954
Epoch:72,validate loss:0.4367559552192688
Epoch:73,validate loss:0.42576566338539124
Validation loss decreased (0.427029 --> 0.425766).  Saving model ...
Epoch:74,validate loss:0.42942312359809875
Epoch:75,validate loss:0.4339304268360138
Epoch:76,validate loss:0.4281655251979828
Epoch:77,validate loss:0.4293564558029175
Epoch:78,validate loss:0.4261530041694641
Epoch:79,validate loss:0.42901211977005005
Epoch:80,validate loss:0.4391140639781952
Epoch:81,validate loss:0.4174727201461792
Validation loss decreased (0.425766 --> 0.417473).  Saving model ...
Epoch:82,validate loss:0.4206528067588806
Epoch:83,validate loss:0.4216202199459076
Epoch:84,validate loss:0.41995835304260254
Epoch:85,validate loss:0.4265414774417877
Epoch:86,validate loss:0.42039617896080017
Epoch:87,validate loss:0.4256173372268677
Epoch:88,validate loss:0.41627222299575806
Validation loss decreased (0.417473 --> 0.416272).  Saving model ...
Epoch:89,validate loss:0.41991376876831055
Epoch:90,validate loss:0.42313405871391296
Epoch:91,validate loss:0.41588014364242554
Validation loss decreased (0.416272 --> 0.415880).  Saving model ...
Epoch:92,validate loss:0.41501715779304504
Validation loss decreased (0.415880 --> 0.415017).  Saving model ...
Epoch:93,validate loss:0.4228259027004242
Epoch:94,validate loss:0.41487810015678406
Validation loss decreased (0.415017 --> 0.414878).  Saving model ...
Epoch:95,validate loss:0.41381728649139404
Validation loss decreased (0.414878 --> 0.413817).  Saving model ...
Epoch:96,validate loss:0.4127146005630493
Validation loss decreased (0.413817 --> 0.412715).  Saving model ...
Epoch:97,validate loss:0.42675942182540894
Epoch:98,validate loss:0.41946253180503845
Epoch:99,validate loss:0.4119165241718292
Validation loss decreased (0.412715 --> 0.411917).  Saving model ...
Epoch:100,validate loss:0.42309918999671936
Epoch:101,validate loss:0.41350045800209045
Epoch:102,validate loss:0.41456541419029236
Epoch:103,validate loss:0.42142337560653687
Epoch:104,validate loss:0.40824460983276367
Validation loss decreased (0.411917 --> 0.408245).  Saving model ...
Epoch:105,validate loss:0.40813905000686646
Validation loss decreased (0.408245 --> 0.408139).  Saving model ...
Epoch:106,validate loss:0.4049130976200104
Validation loss decreased (0.408139 --> 0.404913).  Saving model ...
Epoch:107,validate loss:0.4167218804359436
Epoch:108,validate loss:0.4073091745376587
Epoch:109,validate loss:0.4037066102027893
Validation loss decreased (0.404913 --> 0.403707).  Saving model ...
Epoch:110,validate loss:0.40207046270370483
Validation loss decreased (0.403707 --> 0.402070).  Saving model ...
Epoch:111,validate loss:0.4084901213645935
Epoch:112,validate loss:0.41315364837646484
Epoch:113,validate loss:0.4074500501155853
Epoch:114,validate loss:0.4033326506614685
Epoch:115,validate loss:0.4041535556316376
Epoch:116,validate loss:0.40665850043296814
Epoch:117,validate loss:0.401174396276474
Validation loss decreased (0.402070 --> 0.401174).  Saving model ...
Epoch:118,validate loss:0.4020233750343323
Epoch:119,validate loss:0.4133055508136749
Epoch:120,validate loss:0.41528868675231934
Epoch:121,validate loss:0.4087454080581665
Epoch:122,validate loss:0.4037092924118042
Epoch:123,validate loss:0.40834155678749084
Epoch:124,validate loss:0.4077218472957611
Epoch:125,validate loss:0.40917861461639404
Epoch:126,validate loss:0.40440356731414795
Epoch:127,validate loss:0.4124133288860321
Epoch:128,validate loss:0.40769439935684204
Epoch:129,validate loss:0.4031599164009094
Epoch:130,validate loss:0.4043978452682495
Epoch:131,validate loss:0.41573312878608704
Epoch:132,validate loss:0.40894579887390137
Epoch:133,validate loss:0.4066901206970215
Epoch:134,validate loss:0.39819690585136414
Validation loss decreased (0.401174 --> 0.398197).  Saving model ...
Epoch:135,validate loss:0.4107832908630371
Epoch:136,validate loss:0.4030274748802185
Epoch:137,validate loss:0.40303996205329895
Epoch:138,validate loss:0.4068985879421234
Epoch:139,validate loss:0.4073482155799866
Epoch:140,validate loss:0.40473654866218567
Epoch:141,validate loss:0.40372997522354126
Epoch:142,validate loss:0.40760892629623413
Epoch:143,validate loss:0.4091869592666626
Epoch:144,validate loss:0.40746188163757324
Epoch:145,validate loss:0.4128931760787964
Epoch:146,validate loss:0.3995025157928467
Epoch:147,validate loss:0.4019067883491516
Epoch:148,validate loss:0.4022223949432373
Epoch:149,validate loss:0.4104931354522705
Epoch:150,validate loss:0.39979395270347595
Epoch:151,validate loss:0.4058789908885956
Epoch:152,validate loss:0.4071904122829437
Epoch:153,validate loss:0.4078771770000458
Epoch:154,validate loss:0.401853084564209
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.800,avg=0.100
2.794557e-05,2.794557e-05,0.3312836,2.794557e-05,0.0007098342,0.0021340006,2.794557e-05,2.794557e-05,0.6634147,0.0023180603,
2.9095416e-05,2.9095416e-05,3.3909557e-05,2.9095416e-05,2.9095416e-05,4.6383975e-05,4.127849e-05,2.9095416e-05,0.53591883,0.46381414,
0.00050726614,0.00050726614,0.00050726614,0.60538334,0.00050726614,0.01504363,0.049126085,0.0009892597,0.00050726614,0.32692134,
0.008075581,0.09726399,0.7996576,0.005980075,0.031384606,0.005980075,0.005980075,0.005980075,0.033717863,0.005980075,
0.23605512,0.024042217,0.00046579054,0.00046579054,0.004451628,0.00046579054,0.0015530706,0.7182662,0.01376856,0.00046579054,
4.1439565e-05,0.33195314,0.63807523,0.00209259,0.02708209,4.1439565e-05,4.1439565e-05,4.1439565e-05,0.000114494935,0.00051663123,
4.8070724e-05,0.00023754945,4.357751e-05,0.18004566,0.4503892,0.29571322,0.0012897444,4.357751e-05,0.07214581,4.357751e-05,
0.014114795,0.014114795,0.014114795,0.014114795,0.014114795,0.014114795,0.67822975,0.20885187,0.014114795,0.014114795,
0.009228493,0.009228493,0.7184444,0.009228493,0.20772757,0.009228493,0.009228493,0.009228493,0.009228493,0.009228493,
0.00909311,0.00909311,0.6589403,0.00909311,0.032509953,0.21375936,0.040231686,0.00909311,0.00909311,0.00909311,
Evaluate model on site 1 , Test MAE: 0.2861, Test MAPE: 0.0315, Test RMSE: 0.5256
Evaluate model on site 2 , Test MAE: 0.4511, Test MAPE: 0.0588, Test RMSE: 0.7342
Evaluate model on site 3 , Test MAE: 0.2711, Test MAPE: 0.0889, Test RMSE: 0.5940
Evaluate model on site 4 , Test MAE: 0.4688, Test MAPE: 0.1032, Test RMSE: 0.7814
Evaluate model on site 5 , Test MAE: 0.3771, Test MAPE: 0.0859, Test RMSE: 0.6776
Evaluate model on site 6 , Test MAE: 0.6559, Test MAPE: 0.2002, Test RMSE: 1.1190
Evaluate model on site 7 , Test MAE: 0.4488, Test MAPE: 0.1165, Test RMSE: 0.7549
Evaluate model on site 8 , Test MAE: 0.4984, Test MAPE: 0.1011, Test RMSE: 1.0353
Evaluate model on site 9 , Test MAE: 0.4759, Test MAPE: 0.0912, Test RMSE: 0.8404
Evaluate model on site 10 , Test MAE: 0.3658, Test MAPE: 0.5379, Test RMSE: 0.6609
On average over all site, Test MAE: 0.4299, Test MAPE: 0.1415, Test RMSE: 0.7723
(0.42990477979183195, 0.14151210002601147, 0.7723374664783478)
data::data/water/shangban/singleFac/8,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/8', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.6689034700393677
Validation loss decreased (inf --> 0.668903).  Saving model ...
Epoch:2,validate loss:0.5291265249252319
Validation loss decreased (0.668903 --> 0.529127).  Saving model ...
Epoch:3,validate loss:0.5386203527450562
Epoch:4,validate loss:0.5259365439414978
Validation loss decreased (0.529127 --> 0.525937).  Saving model ...
Epoch:5,validate loss:0.48299193382263184
Validation loss decreased (0.525937 --> 0.482992).  Saving model ...
Epoch:6,validate loss:0.4814067780971527
Validation loss decreased (0.482992 --> 0.481407).  Saving model ...
Epoch:7,validate loss:0.47778093814849854
Validation loss decreased (0.481407 --> 0.477781).  Saving model ...
Epoch:8,validate loss:0.49574270844459534
Epoch:9,validate loss:0.4667307734489441
Validation loss decreased (0.477781 --> 0.466731).  Saving model ...
Epoch:10,validate loss:0.4644978642463684
Validation loss decreased (0.466731 --> 0.464498).  Saving model ...
Epoch:11,validate loss:0.46730005741119385
Epoch:12,validate loss:0.48695051670074463
Epoch:13,validate loss:0.4714311957359314
Epoch:14,validate loss:0.4897463619709015
Epoch:15,validate loss:0.45964357256889343
Validation loss decreased (0.464498 --> 0.459644).  Saving model ...
Epoch:16,validate loss:0.4606710374355316
Epoch:17,validate loss:0.4710802137851715
Epoch:18,validate loss:0.5213540196418762
Epoch:19,validate loss:0.46779298782348633
Epoch:20,validate loss:0.4758627116680145
Epoch:21,validate loss:0.4587686061859131
Validation loss decreased (0.459644 --> 0.458769).  Saving model ...
Epoch:22,validate loss:0.4674689769744873
Epoch:23,validate loss:0.4539886713027954
Validation loss decreased (0.458769 --> 0.453989).  Saving model ...
Epoch:24,validate loss:0.4574985206127167
Epoch:25,validate loss:0.4537651240825653
Validation loss decreased (0.453989 --> 0.453765).  Saving model ...
Epoch:26,validate loss:0.4617173671722412
Epoch:27,validate loss:0.4640509784221649
Epoch:28,validate loss:0.4632311463356018
Epoch:29,validate loss:0.4646734595298767
Epoch:30,validate loss:0.4603020250797272
Epoch:31,validate loss:0.47899025678634644
Epoch:32,validate loss:0.4864846169948578
Epoch:33,validate loss:0.49813616275787354
Epoch:34,validate loss:0.45253610610961914
Validation loss decreased (0.453765 --> 0.452536).  Saving model ...
Epoch:35,validate loss:0.4513718783855438
Validation loss decreased (0.452536 --> 0.451372).  Saving model ...
Epoch:36,validate loss:0.44880107045173645
Validation loss decreased (0.451372 --> 0.448801).  Saving model ...
Epoch:37,validate loss:0.45216676592826843
Epoch:38,validate loss:0.47355198860168457
Epoch:39,validate loss:0.46873992681503296
Epoch:40,validate loss:0.4527001976966858
Epoch:41,validate loss:0.45415201783180237
Epoch:42,validate loss:0.46859726309776306
Epoch:43,validate loss:0.4538818597793579
Epoch:44,validate loss:0.452553391456604
Epoch:45,validate loss:0.44794145226478577
Validation loss decreased (0.448801 --> 0.447941).  Saving model ...
Epoch:46,validate loss:0.46517667174339294
Epoch:47,validate loss:0.443103164434433
Validation loss decreased (0.447941 --> 0.443103).  Saving model ...
Epoch:48,validate loss:0.45322558283805847
Epoch:49,validate loss:0.44447821378707886
Epoch:50,validate loss:0.46499529480934143
Epoch:51,validate loss:0.44552868604660034
Epoch:52,validate loss:0.45765751600265503
Epoch:53,validate loss:0.43844738602638245
Validation loss decreased (0.443103 --> 0.438447).  Saving model ...
Epoch:54,validate loss:0.4536401927471161
Epoch:55,validate loss:0.4547712206840515
Epoch:56,validate loss:0.44010430574417114
Epoch:57,validate loss:0.4429062306880951
Epoch:58,validate loss:0.44172027707099915
Epoch:59,validate loss:0.4395345151424408
Epoch:60,validate loss:0.43452751636505127
Validation loss decreased (0.438447 --> 0.434528).  Saving model ...
Epoch:61,validate loss:0.43553614616394043
Epoch:62,validate loss:0.43817007541656494
Epoch:63,validate loss:0.4552016854286194
Epoch:64,validate loss:0.44559094309806824
Epoch:65,validate loss:0.4344339668750763
Validation loss decreased (0.434528 --> 0.434434).  Saving model ...
Epoch:66,validate loss:0.43330466747283936
Validation loss decreased (0.434434 --> 0.433305).  Saving model ...
Epoch:67,validate loss:0.4393927752971649
Epoch:68,validate loss:0.43405506014823914
Epoch:69,validate loss:0.43303409218788147
Validation loss decreased (0.433305 --> 0.433034).  Saving model ...
Epoch:70,validate loss:0.4261467754840851
Validation loss decreased (0.433034 --> 0.426147).  Saving model ...
Epoch:71,validate loss:0.4344862699508667
Epoch:72,validate loss:0.4395010471343994
Epoch:73,validate loss:0.4394436180591583
Epoch:74,validate loss:0.4269501864910126
Epoch:75,validate loss:0.4377468228340149
Epoch:76,validate loss:0.42950835824012756
Epoch:77,validate loss:0.4343888759613037
Epoch:78,validate loss:0.43271511793136597
Epoch:79,validate loss:0.4328688383102417
Epoch:80,validate loss:0.4295141398906708
Epoch:81,validate loss:0.43204936385154724
Epoch:82,validate loss:0.42865097522735596
Epoch:83,validate loss:0.4289439618587494
Epoch:84,validate loss:0.44187554717063904
Epoch:85,validate loss:0.43353432416915894
Epoch:86,validate loss:0.4609464108943939
Epoch:87,validate loss:0.42751339077949524
Epoch:88,validate loss:0.4371698200702667
Epoch:89,validate loss:0.4216509163379669
Validation loss decreased (0.426147 --> 0.421651).  Saving model ...
Epoch:90,validate loss:0.4232388436794281
Epoch:91,validate loss:0.43578413128852844
Epoch:92,validate loss:0.4266025722026825
Epoch:93,validate loss:0.428396999835968
Epoch:94,validate loss:0.4232242703437805
Epoch:95,validate loss:0.42502304911613464
Epoch:96,validate loss:0.4365715980529785
Epoch:97,validate loss:0.42443275451660156
Epoch:98,validate loss:0.4243847131729126
Epoch:99,validate loss:0.42821574211120605
Epoch:100,validate loss:0.44345152378082275
Epoch:101,validate loss:0.424850732088089
Epoch:102,validate loss:0.4262273609638214
Epoch:103,validate loss:0.4255884885787964
Epoch:104,validate loss:0.42093780636787415
Validation loss decreased (0.421651 --> 0.420938).  Saving model ...
Epoch:105,validate loss:0.42261508107185364
Epoch:106,validate loss:0.42749401926994324
Epoch:107,validate loss:0.424430251121521
Epoch:108,validate loss:0.42671123147010803
Epoch:109,validate loss:0.4295121133327484
Epoch:110,validate loss:0.43064427375793457
Epoch:111,validate loss:0.4193798303604126
Validation loss decreased (0.420938 --> 0.419380).  Saving model ...
Epoch:112,validate loss:0.4155253767967224
Validation loss decreased (0.419380 --> 0.415525).  Saving model ...
Epoch:113,validate loss:0.4182693660259247
Epoch:114,validate loss:0.41921478509902954
Epoch:115,validate loss:0.4146920144557953
Validation loss decreased (0.415525 --> 0.414692).  Saving model ...
Epoch:116,validate loss:0.41548797488212585
Epoch:117,validate loss:0.41896167397499084
Epoch:118,validate loss:0.4218439757823944
Epoch:119,validate loss:0.4354709982872009
Epoch:120,validate loss:0.419913649559021
Epoch:121,validate loss:0.41834351420402527
Epoch:122,validate loss:0.4138566553592682
Validation loss decreased (0.414692 --> 0.413857).  Saving model ...
Epoch:123,validate loss:0.41875147819519043
Epoch:124,validate loss:0.42656588554382324
Epoch:125,validate loss:0.41823244094848633
Epoch:126,validate loss:0.44086769223213196
Epoch:127,validate loss:0.4155854880809784
Epoch:128,validate loss:0.4165436625480652
Epoch:129,validate loss:0.42998093366622925
Epoch:130,validate loss:0.4155631959438324
Epoch:131,validate loss:0.4160824418067932
Epoch:132,validate loss:0.42363759875297546
Epoch:133,validate loss:0.4145614206790924
Epoch:134,validate loss:0.4132203757762909
Validation loss decreased (0.413857 --> 0.413220).  Saving model ...
Epoch:135,validate loss:0.4145468473434448
Epoch:136,validate loss:0.42340943217277527
Epoch:137,validate loss:0.43089255690574646
Epoch:138,validate loss:0.41374170780181885
Epoch:139,validate loss:0.41396811604499817
Epoch:140,validate loss:0.4295663833618164
Epoch:141,validate loss:0.4172789752483368
Epoch:142,validate loss:0.41490188241004944
Epoch:143,validate loss:0.41894787549972534
Epoch:144,validate loss:0.4145728051662445
Epoch:145,validate loss:0.4094216227531433
Validation loss decreased (0.413220 --> 0.409422).  Saving model ...
Epoch:146,validate loss:0.4203331172466278
Epoch:147,validate loss:0.4142819941043854
Epoch:148,validate loss:0.4197649359703064
Epoch:149,validate loss:0.430662602186203
Epoch:150,validate loss:0.41529250144958496
Epoch:151,validate loss:0.41351574659347534
Epoch:152,validate loss:0.41476500034332275
Epoch:153,validate loss:0.4125175178050995
Epoch:154,validate loss:0.4240023195743561
Epoch:155,validate loss:0.4177967309951782
Epoch:156,validate loss:0.41463351249694824
Epoch:157,validate loss:0.41645491123199463
Epoch:158,validate loss:0.41072317957878113
Epoch:159,validate loss:0.41208478808403015
Epoch:160,validate loss:0.42261984944343567
Epoch:161,validate loss:0.4190189838409424
Epoch:162,validate loss:0.43309271335601807
Epoch:163,validate loss:0.41564351320266724
Epoch:164,validate loss:0.40868449211120605
Validation loss decreased (0.409422 --> 0.408684).  Saving model ...
Epoch:165,validate loss:0.4094020426273346
Epoch:166,validate loss:0.4062926173210144
Validation loss decreased (0.408684 --> 0.406293).  Saving model ...
Epoch:167,validate loss:0.4225878119468689
Epoch:168,validate loss:0.41749244928359985
Epoch:169,validate loss:0.41794267296791077
Epoch:170,validate loss:0.4156476557254791
Epoch:171,validate loss:0.41713234782218933
Epoch:172,validate loss:0.413028359413147
Epoch:173,validate loss:0.40766453742980957
Epoch:174,validate loss:0.4122113883495331
Epoch:175,validate loss:0.4143226742744446
Epoch:176,validate loss:0.40711382031440735
Epoch:177,validate loss:0.41281747817993164
Epoch:178,validate loss:0.42113885283470154
Epoch:179,validate loss:0.4183303415775299
Epoch:180,validate loss:0.41228795051574707
Epoch:181,validate loss:0.4098067879676819
Epoch:182,validate loss:0.4206339716911316
Epoch:183,validate loss:0.415283739566803
Epoch:184,validate loss:0.41164469718933105
Epoch:185,validate loss:0.4169999659061432
Epoch:186,validate loss:0.4182405173778534
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.851,avg=0.100
0.0083540175,0.0083540175,0.0083540175,0.020977981,0.0083540175,0.019947806,0.15027125,0.0083540175,0.01369117,0.7533416,
0.017783258,0.017783258,0.21652153,0.017783258,0.017783258,0.017783258,0.46655768,0.017783258,0.19243807,0.017783258,
0.11588635,0.8016818,0.005289669,0.005289669,0.005289669,0.005289669,0.045404095,0.005289669,0.005289669,0.005289669,
0.08800672,0.6176804,0.0019309856,0.0005645842,0.28726363,0.0014332846,0.00062037195,0.0005645842,0.0005645842,0.0013709331,
0.0062563955,0.08588041,0.0062563955,0.41363692,0.19662072,0.0062563955,0.26632363,0.0062563955,0.0062563955,0.0062563955,
0.00038724748,0.24773736,0.00038724748,0.0067870556,0.722291,0.0017558885,0.01949247,0.00038724748,0.00038724748,0.00038724748,
0.004305764,0.00796723,0.047129292,0.046138786,0.004829273,0.013883174,0.01640065,0.004305764,0.004305764,0.85073435,
0.0033016908,0.01593137,0.0033016908,0.0033016908,0.0060628755,0.228479,0.0033016908,0.12848124,0.60453707,0.0033016908,
0.36295685,0.00015643865,3.903614e-05,3.903614e-05,0.63547695,7.39774e-05,0.0011405954,3.903614e-05,3.903614e-05,3.903614e-05,
0.0073672775,0.0073672775,0.0073672775,0.08869475,0.0073672775,0.8084754,0.0073672775,0.0073672775,0.0073672775,0.05125891,
Evaluate model on site 1 , Test MAE: 0.2978, Test MAPE: 0.0328, Test RMSE: 0.5288
Evaluate model on site 2 , Test MAE: 0.4785, Test MAPE: 0.0628, Test RMSE: 0.7428
Evaluate model on site 3 , Test MAE: 0.2648, Test MAPE: 0.0939, Test RMSE: 0.5984
Evaluate model on site 4 , Test MAE: 0.4878, Test MAPE: 0.1044, Test RMSE: 0.8126
Evaluate model on site 5 , Test MAE: 0.3893, Test MAPE: 0.0894, Test RMSE: 0.6769
Evaluate model on site 6 , Test MAE: 0.6482, Test MAPE: 0.1976, Test RMSE: 1.0554
Evaluate model on site 7 , Test MAE: 0.4443, Test MAPE: 0.1175, Test RMSE: 0.7372
Evaluate model on site 8 , Test MAE: 0.5151, Test MAPE: 0.0925, Test RMSE: 1.0677
Evaluate model on site 9 , Test MAE: 0.4966, Test MAPE: 0.0967, Test RMSE: 0.8653
Evaluate model on site 10 , Test MAE: 0.3733, Test MAPE: 0.5093, Test RMSE: 0.6368
On average over all site, Test MAE: 0.4396, Test MAPE: 0.1397, Test RMSE: 0.7722
(0.439571213722229, 0.1396718692034483, 0.7721854388713837)
data::data/water/shangban/singleFac/8,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/8', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.6464518308639526
Validation loss decreased (inf --> 0.646452).  Saving model ...
Epoch:2,validate loss:0.5404752492904663
Validation loss decreased (0.646452 --> 0.540475).  Saving model ...
Epoch:3,validate loss:0.5379145741462708
Validation loss decreased (0.540475 --> 0.537915).  Saving model ...
Epoch:4,validate loss:0.5159725546836853
Validation loss decreased (0.537915 --> 0.515973).  Saving model ...
Epoch:5,validate loss:0.5273030400276184
Epoch:6,validate loss:0.5626645088195801
Epoch:7,validate loss:0.4896388649940491
Validation loss decreased (0.515973 --> 0.489639).  Saving model ...
Epoch:8,validate loss:0.49534711241722107
Epoch:9,validate loss:0.4755150079727173
Validation loss decreased (0.489639 --> 0.475515).  Saving model ...
Epoch:10,validate loss:0.48486775159835815
Epoch:11,validate loss:0.4770893454551697
Epoch:12,validate loss:0.4892367124557495
Epoch:13,validate loss:0.5017845034599304
Epoch:14,validate loss:0.503910481929779
Epoch:15,validate loss:0.47432583570480347
Validation loss decreased (0.475515 --> 0.474326).  Saving model ...
Epoch:16,validate loss:0.4623929262161255
Validation loss decreased (0.474326 --> 0.462393).  Saving model ...
Epoch:17,validate loss:0.4607540965080261
Validation loss decreased (0.462393 --> 0.460754).  Saving model ...
Epoch:18,validate loss:0.4655225872993469
Epoch:19,validate loss:0.4709717333316803
Epoch:20,validate loss:0.46583348512649536
Epoch:21,validate loss:0.4691120386123657
Epoch:22,validate loss:0.454627126455307
Validation loss decreased (0.460754 --> 0.454627).  Saving model ...
Epoch:23,validate loss:0.46393731236457825
Epoch:24,validate loss:0.48390454053878784
Epoch:25,validate loss:0.4782696068286896
Epoch:26,validate loss:0.46283799409866333
Epoch:27,validate loss:0.459018349647522
Epoch:28,validate loss:0.47255653142929077
Epoch:29,validate loss:0.4564306437969208
Epoch:30,validate loss:0.45042508840560913
Validation loss decreased (0.454627 --> 0.450425).  Saving model ...
Epoch:31,validate loss:0.4562951624393463
Epoch:32,validate loss:0.4503188133239746
Validation loss decreased (0.450425 --> 0.450319).  Saving model ...
Epoch:33,validate loss:0.4568709433078766
Epoch:34,validate loss:0.4635317325592041
Epoch:35,validate loss:0.4588412940502167
Epoch:36,validate loss:0.4552153944969177
Epoch:37,validate loss:0.4433530867099762
Validation loss decreased (0.450319 --> 0.443353).  Saving model ...
Epoch:38,validate loss:0.46968889236450195
Epoch:39,validate loss:0.4483809769153595
Epoch:40,validate loss:0.44990721344947815
Epoch:41,validate loss:0.4442133903503418
Epoch:42,validate loss:0.44309327006340027
Validation loss decreased (0.443353 --> 0.443093).  Saving model ...
Epoch:43,validate loss:0.45966005325317383
Epoch:44,validate loss:0.45017358660697937
Epoch:45,validate loss:0.4404877722263336
Validation loss decreased (0.443093 --> 0.440488).  Saving model ...
Epoch:46,validate loss:0.4402713477611542
Validation loss decreased (0.440488 --> 0.440271).  Saving model ...
Epoch:47,validate loss:0.4438123106956482
Epoch:48,validate loss:0.4586733877658844
Epoch:49,validate loss:0.43561652302742004
Validation loss decreased (0.440271 --> 0.435617).  Saving model ...
Epoch:50,validate loss:0.43219372630119324
Validation loss decreased (0.435617 --> 0.432194).  Saving model ...
Epoch:51,validate loss:0.43870753049850464
Epoch:52,validate loss:0.43030232191085815
Validation loss decreased (0.432194 --> 0.430302).  Saving model ...
Epoch:53,validate loss:0.4304006099700928
Epoch:54,validate loss:0.4316519498825073
Epoch:55,validate loss:0.4332621991634369
Epoch:56,validate loss:0.43216708302497864
Epoch:57,validate loss:0.4300878345966339
Validation loss decreased (0.430302 --> 0.430088).  Saving model ...
Epoch:58,validate loss:0.4229815602302551
Validation loss decreased (0.430088 --> 0.422982).  Saving model ...
Epoch:59,validate loss:0.42834022641181946
Epoch:60,validate loss:0.43615883588790894
Epoch:61,validate loss:0.43168947100639343
Epoch:62,validate loss:0.4225795865058899
Validation loss decreased (0.422982 --> 0.422580).  Saving model ...
Epoch:63,validate loss:0.42420172691345215
Epoch:64,validate loss:0.42174258828163147
Validation loss decreased (0.422580 --> 0.421743).  Saving model ...
Epoch:65,validate loss:0.4192863404750824
Validation loss decreased (0.421743 --> 0.419286).  Saving model ...
Epoch:66,validate loss:0.4172228276729584
Validation loss decreased (0.419286 --> 0.417223).  Saving model ...
Epoch:67,validate loss:0.41959866881370544
Epoch:68,validate loss:0.416278213262558
Validation loss decreased (0.417223 --> 0.416278).  Saving model ...
Epoch:69,validate loss:0.4177161753177643
Epoch:70,validate loss:0.4184982180595398
Epoch:71,validate loss:0.4129209816455841
Validation loss decreased (0.416278 --> 0.412921).  Saving model ...
Epoch:72,validate loss:0.4122811257839203
Validation loss decreased (0.412921 --> 0.412281).  Saving model ...
Epoch:73,validate loss:0.41255518794059753
Epoch:74,validate loss:0.42244380712509155
Epoch:75,validate loss:0.40517255663871765
Validation loss decreased (0.412281 --> 0.405173).  Saving model ...
Epoch:76,validate loss:0.4106529951095581
Epoch:77,validate loss:0.4199828505516052
Epoch:78,validate loss:0.4142751395702362
Epoch:79,validate loss:0.4089829921722412
Epoch:80,validate loss:0.41470637917518616
Epoch:81,validate loss:0.40089151263237
Validation loss decreased (0.405173 --> 0.400892).  Saving model ...
Epoch:82,validate loss:0.399919331073761
Validation loss decreased (0.400892 --> 0.399919).  Saving model ...
Epoch:83,validate loss:0.40586021542549133
Epoch:84,validate loss:0.4001445174217224
Epoch:85,validate loss:0.4121617078781128
Epoch:86,validate loss:0.4040183424949646
Epoch:87,validate loss:0.40978720784187317
Epoch:88,validate loss:0.4168807566165924
Epoch:89,validate loss:0.4078018367290497
Epoch:90,validate loss:0.4232569634914398
Epoch:91,validate loss:0.40109074115753174
Epoch:92,validate loss:0.4061065912246704
Epoch:93,validate loss:0.4042236804962158
Epoch:94,validate loss:0.41412004828453064
Epoch:95,validate loss:0.4071100354194641
Epoch:96,validate loss:0.40077918767929077
Epoch:97,validate loss:0.40003904700279236
Epoch:98,validate loss:0.40991833806037903
Epoch:99,validate loss:0.4041861295700073
Epoch:100,validate loss:0.40320560336112976
Epoch:101,validate loss:0.40339145064353943
Epoch:102,validate loss:0.4032563865184784
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.892,avg=0.100
3.8133807e-05,3.8133807e-05,0.12718734,0.00040729222,3.8133807e-05,0.87179184,3.8133807e-05,3.8133807e-05,0.00038470648,3.8133807e-05,
0.0005788365,0.00400986,0.0005788365,0.0005788365,0.025791252,0.010439261,0.39725205,0.0005788365,0.16107425,0.39911792,
0.0016993233,0.0025058736,0.017167186,0.06406591,0.0016993233,0.50748736,0.0017853063,0.40019104,0.0016993233,0.0016993233,
0.045606308,0.8920721,0.001463374,0.026868468,0.001463374,0.001463374,0.001463374,0.001463374,0.026672842,0.001463374,
0.50332564,0.026888726,0.0839407,0.28835145,0.00651521,0.03000922,0.00651521,0.041423466,0.00651521,0.00651521,
0.004127701,0.004127701,0.004127701,0.5975468,0.32883412,0.004127701,0.012320695,0.036532212,0.004127701,0.004127701,
0.00036502132,0.00036502132,0.00036502132,0.00036502132,0.21477765,0.00036502132,0.0034442719,0.113726795,0.66586107,0.00036502132,
0.24574614,0.5956332,0.0070985113,0.077717334,0.0070985113,0.0070985113,0.038312264,0.0070985113,0.0070985113,0.0070985113,
0.14410377,0.109889366,0.0010275561,0.0039713206,0.0021520013,0.0010275561,0.09351698,0.6422564,0.0010275561,0.0010275561,
0.0027099552,0.019383622,0.0027099552,0.0027099552,0.0027099552,0.121653765,0.010545037,0.0027099552,0.0027099552,0.8321578,
Evaluate model on site 1 , Test MAE: 0.2868, Test MAPE: 0.0314, Test RMSE: 0.5186
Evaluate model on site 2 , Test MAE: 0.4804, Test MAPE: 0.0634, Test RMSE: 0.7501
Evaluate model on site 3 , Test MAE: 0.2668, Test MAPE: 0.0889, Test RMSE: 0.5993
Evaluate model on site 4 , Test MAE: 0.4872, Test MAPE: 0.1041, Test RMSE: 0.8193
Evaluate model on site 5 , Test MAE: 0.3722, Test MAPE: 0.0845, Test RMSE: 0.6710
Evaluate model on site 6 , Test MAE: 0.6564, Test MAPE: 0.2001, Test RMSE: 1.0813
Evaluate model on site 7 , Test MAE: 0.4495, Test MAPE: 0.1182, Test RMSE: 0.7460
Evaluate model on site 8 , Test MAE: 0.5011, Test MAPE: 0.0935, Test RMSE: 1.0344
Evaluate model on site 9 , Test MAE: 0.4879, Test MAPE: 0.0954, Test RMSE: 0.8584
Evaluate model on site 10 , Test MAE: 0.3688, Test MAPE: 0.5313, Test RMSE: 0.6344
On average over all site, Test MAE: 0.4357, Test MAPE: 0.1411, Test RMSE: 0.7713
(0.4357340782880783, 0.14106896258890628, 0.7712783217430115)
data::data/water/shangban/singleFac/8,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_all_one.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/8', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.6436737775802612
Validation loss decreased (inf --> 0.643674).  Saving model ...
Epoch:2,validate loss:0.5031871795654297
Validation loss decreased (0.643674 --> 0.503187).  Saving model ...
Epoch:3,validate loss:0.512984037399292
Epoch:4,validate loss:0.5104120969772339
Epoch:5,validate loss:0.4972899556159973
Validation loss decreased (0.503187 --> 0.497290).  Saving model ...
Epoch:6,validate loss:0.49576082825660706
Validation loss decreased (0.497290 --> 0.495761).  Saving model ...
Epoch:7,validate loss:0.47334539890289307
Validation loss decreased (0.495761 --> 0.473345).  Saving model ...
Epoch:8,validate loss:0.4645499885082245
Validation loss decreased (0.473345 --> 0.464550).  Saving model ...
Epoch:9,validate loss:0.49013686180114746
Epoch:10,validate loss:0.47870075702667236
Epoch:11,validate loss:0.4648968577384949
Epoch:12,validate loss:0.46560463309288025
Epoch:13,validate loss:0.521061360836029
Epoch:14,validate loss:0.4917565882205963
Epoch:15,validate loss:0.46511465311050415
Epoch:16,validate loss:0.4829675853252411
Epoch:17,validate loss:0.45621392130851746
Validation loss decreased (0.464550 --> 0.456214).  Saving model ...
Epoch:18,validate loss:0.4637441337108612
Epoch:19,validate loss:0.45651915669441223
Epoch:20,validate loss:0.466571182012558
Epoch:21,validate loss:0.46533459424972534
Epoch:22,validate loss:0.46603870391845703
Epoch:23,validate loss:0.47972914576530457
Epoch:24,validate loss:0.4557061195373535
Validation loss decreased (0.456214 --> 0.455706).  Saving model ...
Epoch:25,validate loss:0.4719565808773041
Epoch:26,validate loss:0.45744603872299194
Epoch:27,validate loss:0.45623138546943665
Epoch:28,validate loss:0.44886401295661926
Validation loss decreased (0.455706 --> 0.448864).  Saving model ...
Epoch:29,validate loss:0.4583776891231537
Epoch:30,validate loss:0.48381394147872925
Epoch:31,validate loss:0.4626229703426361
Epoch:32,validate loss:0.4599052667617798
Epoch:33,validate loss:0.44976115226745605
Epoch:34,validate loss:0.44921013712882996
Epoch:35,validate loss:0.46081963181495667
Epoch:36,validate loss:0.4514002501964569
Epoch:37,validate loss:0.48343947529792786
Epoch:38,validate loss:0.45549747347831726
Epoch:39,validate loss:0.4507391154766083
Epoch:40,validate loss:0.4392959475517273
Validation loss decreased (0.448864 --> 0.439296).  Saving model ...
Epoch:41,validate loss:0.44290727376937866
Epoch:42,validate loss:0.4378289580345154
Validation loss decreased (0.439296 --> 0.437829).  Saving model ...
Epoch:43,validate loss:0.43949460983276367
Epoch:44,validate loss:0.4647309184074402
Epoch:45,validate loss:0.43605196475982666
Validation loss decreased (0.437829 --> 0.436052).  Saving model ...
Epoch:46,validate loss:0.45024314522743225
Epoch:47,validate loss:0.4444481134414673
Epoch:48,validate loss:0.43150627613067627
Validation loss decreased (0.436052 --> 0.431506).  Saving model ...
Epoch:49,validate loss:0.43685582280158997
Epoch:50,validate loss:0.4517417550086975
Epoch:51,validate loss:0.43593546748161316
Epoch:52,validate loss:0.44247496128082275
Epoch:53,validate loss:0.44333091378211975
Epoch:54,validate loss:0.449211448431015
Epoch:55,validate loss:0.4282054305076599
Validation loss decreased (0.431506 --> 0.428205).  Saving model ...
Epoch:56,validate loss:0.431150883436203
Epoch:57,validate loss:0.43205711245536804
Epoch:58,validate loss:0.4291558265686035
Epoch:59,validate loss:0.42979538440704346
Epoch:60,validate loss:0.42431509494781494
Validation loss decreased (0.428205 --> 0.424315).  Saving model ...
Epoch:61,validate loss:0.425009548664093
Epoch:62,validate loss:0.4240312874317169
Validation loss decreased (0.424315 --> 0.424031).  Saving model ...
Epoch:63,validate loss:0.4257683753967285
Epoch:64,validate loss:0.43109679222106934
Epoch:65,validate loss:0.4240993857383728
Epoch:66,validate loss:0.4224955439567566
Validation loss decreased (0.424031 --> 0.422496).  Saving model ...
Epoch:67,validate loss:0.41816338896751404
Validation loss decreased (0.422496 --> 0.418163).  Saving model ...
Epoch:68,validate loss:0.41615259647369385
Validation loss decreased (0.418163 --> 0.416153).  Saving model ...
Epoch:69,validate loss:0.424609899520874
Epoch:70,validate loss:0.4184556305408478
Epoch:71,validate loss:0.42583805322647095
Epoch:72,validate loss:0.43206772208213806
Epoch:73,validate loss:0.4271652102470398
Epoch:74,validate loss:0.43802228569984436
Epoch:75,validate loss:0.4223586916923523
Epoch:76,validate loss:0.41272634267807007
Validation loss decreased (0.416153 --> 0.412726).  Saving model ...
Epoch:77,validate loss:0.4220678508281708
Epoch:78,validate loss:0.416996031999588
Epoch:79,validate loss:0.4147510528564453
Epoch:80,validate loss:0.4150879681110382
Epoch:81,validate loss:0.4092367887496948
Validation loss decreased (0.412726 --> 0.409237).  Saving model ...
Epoch:82,validate loss:0.42518264055252075
Epoch:83,validate loss:0.41605144739151
Epoch:84,validate loss:0.4153194725513458
Epoch:85,validate loss:0.4297547936439514
Epoch:86,validate loss:0.4189627766609192
Epoch:87,validate loss:0.41113975644111633
Epoch:88,validate loss:0.4197922646999359
Epoch:89,validate loss:0.4130035638809204
Epoch:90,validate loss:0.41353726387023926
Epoch:91,validate loss:0.4079052209854126
Validation loss decreased (0.409237 --> 0.407905).  Saving model ...
Epoch:92,validate loss:0.41605788469314575
Epoch:93,validate loss:0.40653255581855774
Validation loss decreased (0.407905 --> 0.406533).  Saving model ...
Epoch:94,validate loss:0.41060972213745117
Epoch:95,validate loss:0.4170646667480469
Epoch:96,validate loss:0.4147397577762604
Epoch:97,validate loss:0.413030207157135
Epoch:98,validate loss:0.409084290266037
Epoch:99,validate loss:0.4092366695404053
Epoch:100,validate loss:0.40974661707878113
Epoch:101,validate loss:0.41117942333221436
Epoch:102,validate loss:0.40852198004722595
Epoch:103,validate loss:0.40429025888442993
Validation loss decreased (0.406533 --> 0.404290).  Saving model ...
Epoch:104,validate loss:0.4177142381668091
Epoch:105,validate loss:0.4024539589881897
Validation loss decreased (0.404290 --> 0.402454).  Saving model ...
Epoch:106,validate loss:0.41323500871658325
Epoch:107,validate loss:0.41493648290634155
Epoch:108,validate loss:0.42570745944976807
Epoch:109,validate loss:0.4168173372745514
Epoch:110,validate loss:0.4032135307788849
Epoch:111,validate loss:0.4046441912651062
Epoch:112,validate loss:0.40717336535453796
Epoch:113,validate loss:0.4064655005931854
Epoch:114,validate loss:0.40219515562057495
Validation loss decreased (0.402454 --> 0.402195).  Saving model ...
Epoch:115,validate loss:0.4069046378135681
Epoch:116,validate loss:0.4188304543495178
Epoch:117,validate loss:0.40201085805892944
Validation loss decreased (0.402195 --> 0.402011).  Saving model ...
Epoch:118,validate loss:0.41084691882133484
Epoch:119,validate loss:0.40294262766838074
Epoch:120,validate loss:0.40485432744026184
Epoch:121,validate loss:0.4059940576553345
Epoch:122,validate loss:0.40169557929039
Validation loss decreased (0.402011 --> 0.401696).  Saving model ...
Epoch:123,validate loss:0.40358927845954895
Epoch:124,validate loss:0.40599775314331055
Epoch:125,validate loss:0.40880563855171204
Epoch:126,validate loss:0.41090771555900574
Epoch:127,validate loss:0.4199831485748291
Epoch:128,validate loss:0.3959920108318329
Validation loss decreased (0.401696 --> 0.395992).  Saving model ...
Epoch:129,validate loss:0.41002219915390015
Epoch:130,validate loss:0.399887353181839
Epoch:131,validate loss:0.4050123393535614
Epoch:132,validate loss:0.40341395139694214
Epoch:133,validate loss:0.4036889970302582
Epoch:134,validate loss:0.40219882130622864
Epoch:135,validate loss:0.4070541262626648
Epoch:136,validate loss:0.4014703035354614
Epoch:137,validate loss:0.4023037850856781
Epoch:138,validate loss:0.4045611321926117
Epoch:139,validate loss:0.4041450321674347
Epoch:140,validate loss:0.4019143879413605
Epoch:141,validate loss:0.40237534046173096
Epoch:142,validate loss:0.40176403522491455
Epoch:143,validate loss:0.4124567210674286
Epoch:144,validate loss:0.4136672616004944
Epoch:145,validate loss:0.4106523394584656
Epoch:146,validate loss:0.41037046909332275
Epoch:147,validate loss:0.4022212624549866
Epoch:148,validate loss:0.4041095972061157
Early stopping.
Training finished
邻接矩阵：min=0.001,max=0.913,avg=0.100
0.025559995,0.03129078,0.0068464745,0.12338508,0.7713131,0.0068464745,0.014218765,0.0068464745,0.0068464745,0.0068464745,
0.008946038,0.0073617687,0.77287656,0.0073617687,0.0073617687,0.0073617687,0.0073617687,0.0073617687,0.0073617687,0.16664499,
0.0068937275,0.0068937275,0.062403627,0.0068937275,0.0068937275,0.018630037,0.15433487,0.0068937275,0.72278,0.0073828213,
0.29491532,0.0065700314,0.00083588704,0.00083588704,0.00083588704,0.00083588704,0.27155894,0.02952911,0.00083588704,0.39324707,
0.005574498,0.0010004066,0.0010004066,0.34576833,0.0061550285,0.17558855,0.0010004066,0.0010004066,0.44576192,0.017150061,
0.018691033,0.35789666,0.060763292,0.018691033,0.018691033,0.018691033,0.028755214,0.36236745,0.096762314,0.018691033,
0.007912233,0.20766506,0.6513998,0.10661271,0.015826238,0.002116785,0.002116785,0.002116785,0.002116785,0.002116785,
0.24870421,0.46642673,0.013211884,0.013211884,0.050945584,0.014932067,0.15293196,0.013211884,0.013211884,0.013211884,
0.024182206,0.0024486948,0.0005668469,0.02890133,0.018513903,0.0015625583,0.010020302,0.9126705,0.0005668469,0.0005668469,
0.0065369755,0.014344706,0.8545092,0.0065369755,0.0065369755,0.008773356,0.015567193,0.017267616,0.06339009,0.0065369755,
Evaluate model on site 1 , Test MAE: 0.2886, Test MAPE: 0.0316, Test RMSE: 0.5281
Evaluate model on site 2 , Test MAE: 0.4694, Test MAPE: 0.0618, Test RMSE: 0.7516
Evaluate model on site 3 , Test MAE: 0.2695, Test MAPE: 0.0930, Test RMSE: 0.6021
Evaluate model on site 4 , Test MAE: 0.4751, Test MAPE: 0.1032, Test RMSE: 0.7909
Evaluate model on site 5 , Test MAE: 0.3739, Test MAPE: 0.0865, Test RMSE: 0.6597
Evaluate model on site 6 , Test MAE: 0.6635, Test MAPE: 0.2005, Test RMSE: 1.1179
Evaluate model on site 7 , Test MAE: 0.4535, Test MAPE: 0.1181, Test RMSE: 0.7536
Evaluate model on site 8 , Test MAE: 0.4905, Test MAPE: 0.0952, Test RMSE: 1.0112
Evaluate model on site 9 , Test MAE: 0.4676, Test MAPE: 0.0909, Test RMSE: 0.8198
Evaluate model on site 10 , Test MAE: 0.3817, Test MAPE: 0.5152, Test RMSE: 0.6858
On average over all site, Test MAE: 0.4333, Test MAPE: 0.1396, Test RMSE: 0.7721
(0.4333288311958313, 0.13959347531199456, 0.7720628917217255)
[0.43848517835140227, 0.42990477979183195, 0.439571213722229, 0.4357340782880783, 0.4333288311958313]
------------------finished-----------------------
data==data/water/shangban/singleFac/0,gcn=0,MAE=0.1394
data==data/water/shangban/singleFac/1,gcn=0,MAE=0.4969
data==data/water/shangban/singleFac/2,gcn=0,MAE=0.0462
data==data/water/shangban/singleFac/3,gcn=0,MAE=0.2973
data==data/water/shangban/singleFac/6,gcn=0,MAE=0.7870
data==data/water/shangban/singleFac/8,gcn=0,MAE=0.4354

Total time spent: 4297.2998

Process finished with exit code 0
