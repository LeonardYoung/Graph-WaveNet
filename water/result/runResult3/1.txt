打乱数据集后重新实验：6个因子有无GCN的对比实验
有GCN，使用节点嵌入自适应邻接矩阵，嵌入矩阵长度512


data==data/water/shangban/singleFac/0,gcn=0,MAE=0.1484
data==data/water/shangban/singleFac/0,gcn=1,MAE=0.1470
data==data/water/shangban/singleFac/1,gcn=0,MAE=0.5522
data==data/water/shangban/singleFac/1,gcn=1,MAE=0.5441
data==data/water/shangban/singleFac/2,gcn=0,MAE=0.0474
data==data/water/shangban/singleFac/2,gcn=1,MAE=0.0466
data==data/water/shangban/singleFac/3,gcn=0,MAE=0.3103
data==data/water/shangban/singleFac/3,gcn=1,MAE=0.3076
data==data/water/shangban/singleFac/6,gcn=0,MAE=0.8355
data==data/water/shangban/singleFac/6,gcn=1,MAE=0.8291
data==data/water/shangban/singleFac/8,gcn=0,MAE=0.4781
data==data/water/shangban/singleFac/8,gcn=1,MAE=0.4683



参数：
--aptonly
--gcn_bool
--addaptadj
--randomadj
--adjtype
doubletransition
--data
data/water/shangban/singleFac/1
--adjdata
data/water/shangban/adjs/adj_shangban2.pkl
--device
cuda:1
--in_dim
2
--epochs
200
--num_nodes
10
--seq_length
3




ssh://root@172.17.171.8:22/home/s304/miniconda3/envs/ysj_torch/bin/python -u /media/s304/Data/yangsj/project/waveNet2/water/waterTrainSingle.py --aptonly --gcn_bool --addaptadj --randomadj --adjtype doubletransition --data data/water/shangban/singleFac/1 --adjdata data/water/shangban/adjs/adj_shangban2.pkl --device cuda:1 --in_dim 2 --epochs 200 --num_nodes 10 --seq_length 3
data::data/water/shangban/singleFac/0,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/0', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.2812376618385315
Validation loss decreased (inf --> 0.281238).  Saving model ...
Epoch:2,validate loss:0.240232452750206
Validation loss decreased (0.281238 --> 0.240232).  Saving model ...
Epoch:3,validate loss:0.18478231132030487
Validation loss decreased (0.240232 --> 0.184782).  Saving model ...
Epoch:4,validate loss:0.18772673606872559
Epoch:5,validate loss:0.206028550863266
Epoch:6,validate loss:0.1820206195116043
Validation loss decreased (0.184782 --> 0.182021).  Saving model ...
Epoch:7,validate loss:0.18026724457740784
Validation loss decreased (0.182021 --> 0.180267).  Saving model ...
Epoch:8,validate loss:0.17683236300945282
Validation loss decreased (0.180267 --> 0.176832).  Saving model ...
Epoch:9,validate loss:0.1767214983701706
Validation loss decreased (0.176832 --> 0.176721).  Saving model ...
Epoch:10,validate loss:0.19123059511184692
Epoch:11,validate loss:0.17543061077594757
Validation loss decreased (0.176721 --> 0.175431).  Saving model ...
Epoch:12,validate loss:0.17901058495044708
Epoch:13,validate loss:0.16844356060028076
Validation loss decreased (0.175431 --> 0.168444).  Saving model ...
Epoch:14,validate loss:0.2124624401330948
Epoch:15,validate loss:0.16992464661598206
Epoch:16,validate loss:0.17462806403636932
Epoch:17,validate loss:0.17007657885551453
Epoch:18,validate loss:0.1680890917778015
Validation loss decreased (0.168444 --> 0.168089).  Saving model ...
Epoch:19,validate loss:0.16763746738433838
Validation loss decreased (0.168089 --> 0.167637).  Saving model ...
Epoch:20,validate loss:0.16912487149238586
Epoch:21,validate loss:0.17271262407302856
Epoch:22,validate loss:0.17114679515361786
Epoch:23,validate loss:0.16302038729190826
Validation loss decreased (0.167637 --> 0.163020).  Saving model ...
Epoch:24,validate loss:0.16258364915847778
Validation loss decreased (0.163020 --> 0.162584).  Saving model ...
Epoch:25,validate loss:0.16162243485450745
Validation loss decreased (0.162584 --> 0.161622).  Saving model ...
Epoch:26,validate loss:0.16612181067466736
Epoch:27,validate loss:0.16530272364616394
Epoch:28,validate loss:0.17040473222732544
Epoch:29,validate loss:0.16486792266368866
Epoch:30,validate loss:0.16263696551322937
Epoch:31,validate loss:0.16343583166599274
Epoch:32,validate loss:0.16760528087615967
Epoch:33,validate loss:0.16469208896160126
Epoch:34,validate loss:0.1605321168899536
Validation loss decreased (0.161622 --> 0.160532).  Saving model ...
Epoch:35,validate loss:0.16443988680839539
Epoch:36,validate loss:0.16031761467456818
Validation loss decreased (0.160532 --> 0.160318).  Saving model ...
Epoch:37,validate loss:0.17456857860088348
Epoch:38,validate loss:0.16123425960540771
Epoch:39,validate loss:0.16162726283073425
Epoch:40,validate loss:0.16660697758197784
Epoch:41,validate loss:0.16622225940227509
Epoch:42,validate loss:0.1657646894454956
Epoch:43,validate loss:0.16100971400737762
Epoch:44,validate loss:0.16292382776737213
Epoch:45,validate loss:0.16449198126792908
Epoch:46,validate loss:0.1594361960887909
Validation loss decreased (0.160318 --> 0.159436).  Saving model ...
Epoch:47,validate loss:0.16863778233528137
Epoch:48,validate loss:0.1624915599822998
Epoch:49,validate loss:0.17098312079906464
Epoch:50,validate loss:0.15910197794437408
Validation loss decreased (0.159436 --> 0.159102).  Saving model ...
Epoch:51,validate loss:0.16243115067481995
Epoch:52,validate loss:0.16302061080932617
Epoch:53,validate loss:0.16434456408023834
Epoch:54,validate loss:0.1610029935836792
Epoch:55,validate loss:0.1594053953886032
Epoch:56,validate loss:0.16010500490665436
Epoch:57,validate loss:0.1589493453502655
Validation loss decreased (0.159102 --> 0.158949).  Saving model ...
Epoch:58,validate loss:0.15984699130058289
Epoch:59,validate loss:0.1663312315940857
Epoch:60,validate loss:0.16188301146030426
Epoch:61,validate loss:0.15828962624073029
Validation loss decreased (0.158949 --> 0.158290).  Saving model ...
Epoch:62,validate loss:0.16070634126663208
Epoch:63,validate loss:0.16402511298656464
Epoch:64,validate loss:0.1600504070520401
Epoch:65,validate loss:0.16025611758232117
Epoch:66,validate loss:0.16002719104290009
Epoch:67,validate loss:0.16013562679290771
Epoch:68,validate loss:0.16119131445884705
Epoch:69,validate loss:0.15598620474338531
Validation loss decreased (0.158290 --> 0.155986).  Saving model ...
Epoch:70,validate loss:0.1680365353822708
Epoch:71,validate loss:0.15995042026042938
Epoch:72,validate loss:0.1601826697587967
Epoch:73,validate loss:0.16171850264072418
Epoch:74,validate loss:0.1588021218776703
Epoch:75,validate loss:0.16038469970226288
Epoch:76,validate loss:0.15886233747005463
Epoch:77,validate loss:0.15707813203334808
Epoch:78,validate loss:0.15658339858055115
Epoch:79,validate loss:0.15834049880504608
Epoch:80,validate loss:0.15862758457660675
Epoch:81,validate loss:0.15879635512828827
Epoch:82,validate loss:0.15999159216880798
Epoch:83,validate loss:0.1576116383075714
Epoch:84,validate loss:0.15756858885288239
Epoch:85,validate loss:0.15617692470550537
Epoch:86,validate loss:0.16057294607162476
Epoch:87,validate loss:0.15771286189556122
Epoch:88,validate loss:0.16237765550613403
Epoch:89,validate loss:0.15894672274589539
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.1202, Test MAPE: 0.0191, Test RMSE: 0.2310
Evaluate model on site 2 , Test MAE: 0.1372, Test MAPE: 0.0210, Test RMSE: 0.2281
Evaluate model on site 3 , Test MAE: 0.1719, Test MAPE: 0.0292, Test RMSE: 0.3651
Evaluate model on site 4 , Test MAE: 0.1589, Test MAPE: 0.0223, Test RMSE: 0.2791
Evaluate model on site 5 , Test MAE: 0.1646, Test MAPE: 0.0270, Test RMSE: 0.2544
Evaluate model on site 6 , Test MAE: 0.1401, Test MAPE: 0.0242, Test RMSE: 0.2530
Evaluate model on site 7 , Test MAE: 0.1973, Test MAPE: 0.0298, Test RMSE: 0.3157
Evaluate model on site 8 , Test MAE: 0.1679, Test MAPE: 0.0261, Test RMSE: 0.3425
Evaluate model on site 9 , Test MAE: 0.1179, Test MAPE: 0.0171, Test RMSE: 0.2187
Evaluate model on site 10 , Test MAE: 0.1139, Test MAPE: 0.0161, Test RMSE: 0.2091
On average over all site, Test MAE: 0.1490, Test MAPE: 0.0232, Test RMSE: 0.2697
(0.14899215400218963, 0.0231992419809103, 0.26966556161642075)
data::data/water/shangban/singleFac/0,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/0', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.2900421917438507
Validation loss decreased (inf --> 0.290042).  Saving model ...
Epoch:2,validate loss:0.19563020765781403
Validation loss decreased (0.290042 --> 0.195630).  Saving model ...
Epoch:3,validate loss:0.19939009845256805
Epoch:4,validate loss:0.18857181072235107
Validation loss decreased (0.195630 --> 0.188572).  Saving model ...
Epoch:5,validate loss:0.17854242026805878
Validation loss decreased (0.188572 --> 0.178542).  Saving model ...
Epoch:6,validate loss:0.1806444227695465
Epoch:7,validate loss:0.1742164045572281
Validation loss decreased (0.178542 --> 0.174216).  Saving model ...
Epoch:8,validate loss:0.17391757667064667
Validation loss decreased (0.174216 --> 0.173918).  Saving model ...
Epoch:9,validate loss:0.21138577163219452
Epoch:10,validate loss:0.17910118401050568
Epoch:11,validate loss:0.1727929264307022
Validation loss decreased (0.173918 --> 0.172793).  Saving model ...
Epoch:12,validate loss:0.18147414922714233
Epoch:13,validate loss:0.16694311797618866
Validation loss decreased (0.172793 --> 0.166943).  Saving model ...
Epoch:14,validate loss:0.16796019673347473
Epoch:15,validate loss:0.17860500514507294
Epoch:16,validate loss:0.16299033164978027
Validation loss decreased (0.166943 --> 0.162990).  Saving model ...
Epoch:17,validate loss:0.16724072396755219
Epoch:18,validate loss:0.16685155034065247
Epoch:19,validate loss:0.1838383972644806
Epoch:20,validate loss:0.19469241797924042
Epoch:21,validate loss:0.17617788910865784
Epoch:22,validate loss:0.16556772589683533
Epoch:23,validate loss:0.16388212144374847
Epoch:24,validate loss:0.16345496475696564
Epoch:25,validate loss:0.16467878222465515
Epoch:26,validate loss:0.16199065744876862
Validation loss decreased (0.162990 --> 0.161991).  Saving model ...
Epoch:27,validate loss:0.165300190448761
Epoch:28,validate loss:0.16746152937412262
Epoch:29,validate loss:0.1598629206418991
Validation loss decreased (0.161991 --> 0.159863).  Saving model ...
Epoch:30,validate loss:0.16493836045265198
Epoch:31,validate loss:0.16582240164279938
Epoch:32,validate loss:0.16849207878112793
Epoch:33,validate loss:0.1585996001958847
Validation loss decreased (0.159863 --> 0.158600).  Saving model ...
Epoch:34,validate loss:0.16085873544216156
Epoch:35,validate loss:0.16837795078754425
Epoch:36,validate loss:0.16190364956855774
Epoch:37,validate loss:0.17845706641674042
Epoch:38,validate loss:0.1626473218202591
Epoch:39,validate loss:0.16162995994091034
Epoch:40,validate loss:0.16939665377140045
Epoch:41,validate loss:0.16868801414966583
Epoch:42,validate loss:0.1588795781135559
Epoch:43,validate loss:0.1673310399055481
Epoch:44,validate loss:0.16051003336906433
Epoch:45,validate loss:0.168878972530365
Epoch:46,validate loss:0.1680448353290558
Epoch:47,validate loss:0.15990333259105682
Epoch:48,validate loss:0.1637904942035675
Epoch:49,validate loss:0.15913064777851105
Epoch:50,validate loss:0.16445520520210266
Epoch:51,validate loss:0.1575806438922882
Validation loss decreased (0.158600 --> 0.157581).  Saving model ...
Epoch:52,validate loss:0.15976963937282562
Epoch:53,validate loss:0.1606551706790924
Epoch:54,validate loss:0.16206277906894684
Epoch:55,validate loss:0.16773034632205963
Epoch:56,validate loss:0.16130349040031433
Epoch:57,validate loss:0.15952114760875702
Epoch:58,validate loss:0.16883376240730286
Epoch:59,validate loss:0.15975065529346466
Epoch:60,validate loss:0.1594105362892151
Epoch:61,validate loss:0.16639436781406403
Epoch:62,validate loss:0.1600153148174286
Epoch:63,validate loss:0.1611693948507309
Epoch:64,validate loss:0.16225653886795044
Epoch:65,validate loss:0.15956227481365204
Epoch:66,validate loss:0.16140899062156677
Epoch:67,validate loss:0.16433122754096985
Epoch:68,validate loss:0.16085655987262726
Epoch:69,validate loss:0.15796607732772827
Epoch:70,validate loss:0.15593348443508148
Validation loss decreased (0.157581 --> 0.155933).  Saving model ...
Epoch:71,validate loss:0.1570189744234085
Epoch:72,validate loss:0.15530002117156982
Validation loss decreased (0.155933 --> 0.155300).  Saving model ...
Epoch:73,validate loss:0.15671052038669586
Epoch:74,validate loss:0.1579791158437729
Epoch:75,validate loss:0.15814292430877686
Epoch:76,validate loss:0.16085313260555267
Epoch:77,validate loss:0.16124485433101654
Epoch:78,validate loss:0.16024073958396912
Epoch:79,validate loss:0.1569768637418747
Epoch:80,validate loss:0.15725429356098175
Epoch:81,validate loss:0.15594865381717682
Epoch:82,validate loss:0.16099362075328827
Epoch:83,validate loss:0.1594344526529312
Epoch:84,validate loss:0.15740682184696198
Epoch:85,validate loss:0.16908542811870575
Epoch:86,validate loss:0.16081848740577698
Epoch:87,validate loss:0.15601010620594025
Epoch:88,validate loss:0.15714439749717712
Epoch:89,validate loss:0.16109031438827515
Epoch:90,validate loss:0.1604669839143753
Epoch:91,validate loss:0.1570126712322235
Epoch:92,validate loss:0.1564958542585373
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.1211, Test MAPE: 0.0192, Test RMSE: 0.2316
Evaluate model on site 2 , Test MAE: 0.1341, Test MAPE: 0.0205, Test RMSE: 0.2286
Evaluate model on site 3 , Test MAE: 0.1728, Test MAPE: 0.0293, Test RMSE: 0.3642
Evaluate model on site 4 , Test MAE: 0.1605, Test MAPE: 0.0225, Test RMSE: 0.2838
Evaluate model on site 5 , Test MAE: 0.1688, Test MAPE: 0.0274, Test RMSE: 0.2590
Evaluate model on site 6 , Test MAE: 0.1414, Test MAPE: 0.0243, Test RMSE: 0.2568
Evaluate model on site 7 , Test MAE: 0.1972, Test MAPE: 0.0299, Test RMSE: 0.3170
Evaluate model on site 8 , Test MAE: 0.1690, Test MAPE: 0.0264, Test RMSE: 0.3406
Evaluate model on site 9 , Test MAE: 0.1172, Test MAPE: 0.0171, Test RMSE: 0.2204
Evaluate model on site 10 , Test MAE: 0.1114, Test MAPE: 0.0158, Test RMSE: 0.2064
On average over all site, Test MAE: 0.1493, Test MAPE: 0.0232, Test RMSE: 0.2708
(0.14934587776660918, 0.023242172971367835, 0.2708347350358963)
data::data/water/shangban/singleFac/0,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/0', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.29394716024398804
Validation loss decreased (inf --> 0.293947).  Saving model ...
Epoch:2,validate loss:0.20257025957107544
Validation loss decreased (0.293947 --> 0.202570).  Saving model ...
Epoch:3,validate loss:0.18410347402095795
Validation loss decreased (0.202570 --> 0.184103).  Saving model ...
Epoch:4,validate loss:0.20472575724124908
Epoch:5,validate loss:0.18957287073135376
Epoch:6,validate loss:0.18851245939731598
Epoch:7,validate loss:0.17984560132026672
Validation loss decreased (0.184103 --> 0.179846).  Saving model ...
Epoch:8,validate loss:0.17252373695373535
Validation loss decreased (0.179846 --> 0.172524).  Saving model ...
Epoch:9,validate loss:0.17145618796348572
Validation loss decreased (0.172524 --> 0.171456).  Saving model ...
Epoch:10,validate loss:0.17125874757766724
Validation loss decreased (0.171456 --> 0.171259).  Saving model ...
Epoch:11,validate loss:0.16722729802131653
Validation loss decreased (0.171259 --> 0.167227).  Saving model ...
Epoch:12,validate loss:0.17394492030143738
Epoch:13,validate loss:0.16521520912647247
Validation loss decreased (0.167227 --> 0.165215).  Saving model ...
Epoch:14,validate loss:0.17771852016448975
Epoch:15,validate loss:0.1724591702222824
Epoch:16,validate loss:0.1641429364681244
Validation loss decreased (0.165215 --> 0.164143).  Saving model ...
Epoch:17,validate loss:0.17353442311286926
Epoch:18,validate loss:0.1644837111234665
Epoch:19,validate loss:0.16229920089244843
Validation loss decreased (0.164143 --> 0.162299).  Saving model ...
Epoch:20,validate loss:0.16679540276527405
Epoch:21,validate loss:0.16981877386569977
Epoch:22,validate loss:0.16851487755775452
Epoch:23,validate loss:0.1678014099597931
Epoch:24,validate loss:0.17219193279743195
Epoch:25,validate loss:0.16427718102931976
Epoch:26,validate loss:0.1640968918800354
Epoch:27,validate loss:0.16129004955291748
Validation loss decreased (0.162299 --> 0.161290).  Saving model ...
Epoch:28,validate loss:0.17511248588562012
Epoch:29,validate loss:0.16488677263259888
Epoch:30,validate loss:0.17943617701530457
Epoch:31,validate loss:0.16264043748378754
Epoch:32,validate loss:0.16316618025302887
Epoch:33,validate loss:0.16452109813690186
Epoch:34,validate loss:0.16145388782024384
Epoch:35,validate loss:0.18080581724643707
Epoch:36,validate loss:0.16104449331760406
Validation loss decreased (0.161290 --> 0.161044).  Saving model ...
Epoch:37,validate loss:0.16031424701213837
Validation loss decreased (0.161044 --> 0.160314).  Saving model ...
Epoch:38,validate loss:0.160711869597435
Epoch:39,validate loss:0.16018465161323547
Validation loss decreased (0.160314 --> 0.160185).  Saving model ...
Epoch:40,validate loss:0.15999145805835724
Validation loss decreased (0.160185 --> 0.159991).  Saving model ...
Epoch:41,validate loss:0.16182610392570496
Epoch:42,validate loss:0.16002675890922546
Epoch:43,validate loss:0.16536888480186462
Epoch:44,validate loss:0.16446569561958313
Epoch:45,validate loss:0.1583300083875656
Validation loss decreased (0.159991 --> 0.158330).  Saving model ...
Epoch:46,validate loss:0.1590852439403534
Epoch:47,validate loss:0.1685633361339569
Epoch:48,validate loss:0.16268856823444366
Epoch:49,validate loss:0.16436131298542023
Epoch:50,validate loss:0.16360992193222046
Epoch:51,validate loss:0.1617337167263031
Epoch:52,validate loss:0.1644212156534195
Epoch:53,validate loss:0.165007546544075
Epoch:54,validate loss:0.16602389514446259
Epoch:55,validate loss:0.16050057113170624
Epoch:56,validate loss:0.15891215205192566
Epoch:57,validate loss:0.16157248616218567
Epoch:58,validate loss:0.16003859043121338
Epoch:59,validate loss:0.15809619426727295
Validation loss decreased (0.158330 --> 0.158096).  Saving model ...
Epoch:60,validate loss:0.1588187962770462
Epoch:61,validate loss:0.1619923710823059
Epoch:62,validate loss:0.1598561555147171
Epoch:63,validate loss:0.16418828070163727
Epoch:64,validate loss:0.15968504548072815
Epoch:65,validate loss:0.16291578114032745
Epoch:66,validate loss:0.15963056683540344
Epoch:67,validate loss:0.16295625269412994
Epoch:68,validate loss:0.16150549054145813
Epoch:69,validate loss:0.1612364947795868
Epoch:70,validate loss:0.1603722721338272
Epoch:71,validate loss:0.1584177166223526
Epoch:72,validate loss:0.1590627133846283
Epoch:73,validate loss:0.16298329830169678
Epoch:74,validate loss:0.16264231503009796
Epoch:75,validate loss:0.1631033718585968
Epoch:76,validate loss:0.16081349551677704
Epoch:77,validate loss:0.15812227129936218
Epoch:78,validate loss:0.1611422300338745
Epoch:79,validate loss:0.16271919012069702
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.1218, Test MAPE: 0.0191, Test RMSE: 0.2285
Evaluate model on site 2 , Test MAE: 0.1352, Test MAPE: 0.0206, Test RMSE: 0.2285
Evaluate model on site 3 , Test MAE: 0.1707, Test MAPE: 0.0288, Test RMSE: 0.3635
Evaluate model on site 4 , Test MAE: 0.1612, Test MAPE: 0.0225, Test RMSE: 0.2840
Evaluate model on site 5 , Test MAE: 0.1686, Test MAPE: 0.0274, Test RMSE: 0.2512
Evaluate model on site 6 , Test MAE: 0.1397, Test MAPE: 0.0240, Test RMSE: 0.2530
Evaluate model on site 7 , Test MAE: 0.1893, Test MAPE: 0.0285, Test RMSE: 0.2992
Evaluate model on site 8 , Test MAE: 0.1680, Test MAPE: 0.0260, Test RMSE: 0.3447
Evaluate model on site 9 , Test MAE: 0.1147, Test MAPE: 0.0167, Test RMSE: 0.2199
Evaluate model on site 10 , Test MAE: 0.1114, Test MAPE: 0.0158, Test RMSE: 0.2078
On average over all site, Test MAE: 0.1481, Test MAPE: 0.0229, Test RMSE: 0.2680
(0.14805324673652648, 0.022936662659049034, 0.2680217236280441)
data::data/water/shangban/singleFac/0,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/0', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.25380855798721313
Validation loss decreased (inf --> 0.253809).  Saving model ...
Epoch:2,validate loss:0.20665574073791504
Validation loss decreased (0.253809 --> 0.206656).  Saving model ...
Epoch:3,validate loss:0.19025209546089172
Validation loss decreased (0.206656 --> 0.190252).  Saving model ...
Epoch:4,validate loss:0.18475015461444855
Validation loss decreased (0.190252 --> 0.184750).  Saving model ...
Epoch:5,validate loss:0.23249273002147675
Epoch:6,validate loss:0.2081374078989029
Epoch:7,validate loss:0.1811949610710144
Validation loss decreased (0.184750 --> 0.181195).  Saving model ...
Epoch:8,validate loss:0.1749974638223648
Validation loss decreased (0.181195 --> 0.174997).  Saving model ...
Epoch:9,validate loss:0.17196550965309143
Validation loss decreased (0.174997 --> 0.171966).  Saving model ...
Epoch:10,validate loss:0.19184409081935883
Epoch:11,validate loss:0.19590362906455994
Epoch:12,validate loss:0.17966492474079132
Epoch:13,validate loss:0.18826596438884735
Epoch:14,validate loss:0.18250097334384918
Epoch:15,validate loss:0.16760298609733582
Validation loss decreased (0.171966 --> 0.167603).  Saving model ...
Epoch:16,validate loss:0.16645722091197968
Validation loss decreased (0.167603 --> 0.166457).  Saving model ...
Epoch:17,validate loss:0.16428768634796143
Validation loss decreased (0.166457 --> 0.164288).  Saving model ...
Epoch:18,validate loss:0.16638009250164032
Epoch:19,validate loss:0.18420487642288208
Epoch:20,validate loss:0.16316162049770355
Validation loss decreased (0.164288 --> 0.163162).  Saving model ...
Epoch:21,validate loss:0.16893774271011353
Epoch:22,validate loss:0.16678088903427124
Epoch:23,validate loss:0.16187141835689545
Validation loss decreased (0.163162 --> 0.161871).  Saving model ...
Epoch:24,validate loss:0.16335810720920563
Epoch:25,validate loss:0.16539663076400757
Epoch:26,validate loss:0.18478995561599731
Epoch:27,validate loss:0.16127516329288483
Validation loss decreased (0.161871 --> 0.161275).  Saving model ...
Epoch:28,validate loss:0.17342479526996613
Epoch:29,validate loss:0.1687665432691574
Epoch:30,validate loss:0.16159284114837646
Epoch:31,validate loss:0.1584540754556656
Validation loss decreased (0.161275 --> 0.158454).  Saving model ...
Epoch:32,validate loss:0.16744212806224823
Epoch:33,validate loss:0.1598832756280899
Epoch:34,validate loss:0.16063331067562103
Epoch:35,validate loss:0.16122859716415405
Epoch:36,validate loss:0.15819865465164185
Validation loss decreased (0.158454 --> 0.158199).  Saving model ...
Epoch:37,validate loss:0.15802976489067078
Validation loss decreased (0.158199 --> 0.158030).  Saving model ...
Epoch:38,validate loss:0.15835124254226685
Epoch:39,validate loss:0.16155262291431427
Epoch:40,validate loss:0.16384530067443848
Epoch:41,validate loss:0.16156700253486633
Epoch:42,validate loss:0.15939471125602722
Epoch:43,validate loss:0.15577644109725952
Validation loss decreased (0.158030 --> 0.155776).  Saving model ...
Epoch:44,validate loss:0.15979605913162231
Epoch:45,validate loss:0.16711635887622833
Epoch:46,validate loss:0.1604522317647934
Epoch:47,validate loss:0.15963128209114075
Epoch:48,validate loss:0.15947690606117249
Epoch:49,validate loss:0.15950419008731842
Epoch:50,validate loss:0.15697142481803894
Epoch:51,validate loss:0.15733544528484344
Epoch:52,validate loss:0.15953312814235687
Epoch:53,validate loss:0.1646956205368042
Epoch:54,validate loss:0.16441243886947632
Epoch:55,validate loss:0.16610753536224365
Epoch:56,validate loss:0.16217640042304993
Epoch:57,validate loss:0.1606832891702652
Epoch:58,validate loss:0.15995675325393677
Epoch:59,validate loss:0.1633640080690384
Epoch:60,validate loss:0.15936915576457977
Epoch:61,validate loss:0.15747271478176117
Epoch:62,validate loss:0.1641789823770523
Epoch:63,validate loss:0.1591242253780365
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.1202, Test MAPE: 0.0190, Test RMSE: 0.2297
Evaluate model on site 2 , Test MAE: 0.1333, Test MAPE: 0.0204, Test RMSE: 0.2228
Evaluate model on site 3 , Test MAE: 0.1680, Test MAPE: 0.0283, Test RMSE: 0.3556
Evaluate model on site 4 , Test MAE: 0.1626, Test MAPE: 0.0227, Test RMSE: 0.2845
Evaluate model on site 5 , Test MAE: 0.1647, Test MAPE: 0.0267, Test RMSE: 0.2481
Evaluate model on site 6 , Test MAE: 0.1406, Test MAPE: 0.0243, Test RMSE: 0.2540
Evaluate model on site 7 , Test MAE: 0.1927, Test MAPE: 0.0290, Test RMSE: 0.3035
Evaluate model on site 8 , Test MAE: 0.1707, Test MAPE: 0.0265, Test RMSE: 0.3483
Evaluate model on site 9 , Test MAE: 0.1175, Test MAPE: 0.0171, Test RMSE: 0.2232
Evaluate model on site 10 , Test MAE: 0.1106, Test MAPE: 0.0157, Test RMSE: 0.2077
On average over all site, Test MAE: 0.1481, Test MAPE: 0.0230, Test RMSE: 0.2677
(0.14809353798627853, 0.02296672761440277, 0.26773963272571566)
data::data/water/shangban/singleFac/0,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/0', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.2525807023048401
Validation loss decreased (inf --> 0.252581).  Saving model ...
Epoch:2,validate loss:0.19177603721618652
Validation loss decreased (0.252581 --> 0.191776).  Saving model ...
Epoch:3,validate loss:0.19451460242271423
Epoch:4,validate loss:0.18067947030067444
Validation loss decreased (0.191776 --> 0.180679).  Saving model ...
Epoch:5,validate loss:0.18205392360687256
Epoch:6,validate loss:0.19345623254776
Epoch:7,validate loss:0.2168622463941574
Epoch:8,validate loss:0.18361617624759674
Epoch:9,validate loss:0.16799838840961456
Validation loss decreased (0.180679 --> 0.167998).  Saving model ...
Epoch:10,validate loss:0.18270531296730042
Epoch:11,validate loss:0.168704554438591
Epoch:12,validate loss:0.2046714574098587
Epoch:13,validate loss:0.18391333520412445
Epoch:14,validate loss:0.17413191497325897
Epoch:15,validate loss:0.16870346665382385
Epoch:16,validate loss:0.1744133085012436
Epoch:17,validate loss:0.16328278183937073
Validation loss decreased (0.167998 --> 0.163283).  Saving model ...
Epoch:18,validate loss:0.17293943464756012
Epoch:19,validate loss:0.16531528532505035
Epoch:20,validate loss:0.16985249519348145
Epoch:21,validate loss:0.16884745657444
Epoch:22,validate loss:0.16563063859939575
Epoch:23,validate loss:0.17903703451156616
Epoch:24,validate loss:0.17958521842956543
Epoch:25,validate loss:0.1721312701702118
Epoch:26,validate loss:0.1737002730369568
Epoch:27,validate loss:0.16707739233970642
Epoch:28,validate loss:0.17072094976902008
Epoch:29,validate loss:0.16013900935649872
Validation loss decreased (0.163283 --> 0.160139).  Saving model ...
Epoch:30,validate loss:0.16360469162464142
Epoch:31,validate loss:0.16195231676101685
Epoch:32,validate loss:0.18552234768867493
Epoch:33,validate loss:0.17074963450431824
Epoch:34,validate loss:0.16615258157253265
Epoch:35,validate loss:0.16079913079738617
Epoch:36,validate loss:0.16011716425418854
Validation loss decreased (0.160139 --> 0.160117).  Saving model ...
Epoch:37,validate loss:0.16247941553592682
Epoch:38,validate loss:0.16100002825260162
Epoch:39,validate loss:0.16512246429920197
Epoch:40,validate loss:0.15968641638755798
Validation loss decreased (0.160117 --> 0.159686).  Saving model ...
Epoch:41,validate loss:0.15860815346240997
Validation loss decreased (0.159686 --> 0.158608).  Saving model ...
Epoch:42,validate loss:0.16649889945983887
Epoch:43,validate loss:0.15709441900253296
Validation loss decreased (0.158608 --> 0.157094).  Saving model ...
Epoch:44,validate loss:0.1581738293170929
Epoch:45,validate loss:0.16896149516105652
Epoch:46,validate loss:0.16036944091320038
Epoch:47,validate loss:0.1645568460226059
Epoch:48,validate loss:0.15848566591739655
Epoch:49,validate loss:0.158213809132576
Epoch:50,validate loss:0.16781164705753326
Epoch:51,validate loss:0.15744678676128387
Epoch:52,validate loss:0.16162656247615814
Epoch:53,validate loss:0.1590762883424759
Epoch:54,validate loss:0.15645666420459747
Validation loss decreased (0.157094 --> 0.156457).  Saving model ...
Epoch:55,validate loss:0.16606537997722626
Epoch:56,validate loss:0.1550026535987854
Validation loss decreased (0.156457 --> 0.155003).  Saving model ...
Epoch:57,validate loss:0.15568110346794128
Epoch:58,validate loss:0.16257250308990479
Epoch:59,validate loss:0.15951183438301086
Epoch:60,validate loss:0.1600569635629654
Epoch:61,validate loss:0.16894516348838806
Epoch:62,validate loss:0.15758684277534485
Epoch:63,validate loss:0.15777191519737244
Epoch:64,validate loss:0.16823135316371918
Epoch:65,validate loss:0.16135460138320923
Epoch:66,validate loss:0.15782557427883148
Epoch:67,validate loss:0.1598568707704544
Epoch:68,validate loss:0.16374874114990234
Epoch:69,validate loss:0.15682481229305267
Epoch:70,validate loss:0.15923136472702026
Epoch:71,validate loss:0.15909573435783386
Epoch:72,validate loss:0.15927989780902863
Epoch:73,validate loss:0.16034965217113495
Epoch:74,validate loss:0.15615855157375336
Epoch:75,validate loss:0.15762534737586975
Epoch:76,validate loss:0.15815824270248413
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.1218, Test MAPE: 0.0192, Test RMSE: 0.2317
Evaluate model on site 2 , Test MAE: 0.1381, Test MAPE: 0.0211, Test RMSE: 0.2294
Evaluate model on site 3 , Test MAE: 0.1670, Test MAPE: 0.0281, Test RMSE: 0.3573
Evaluate model on site 4 , Test MAE: 0.1599, Test MAPE: 0.0224, Test RMSE: 0.2821
Evaluate model on site 5 , Test MAE: 0.1616, Test MAPE: 0.0264, Test RMSE: 0.2480
Evaluate model on site 6 , Test MAE: 0.1392, Test MAPE: 0.0239, Test RMSE: 0.2533
Evaluate model on site 7 , Test MAE: 0.1909, Test MAPE: 0.0288, Test RMSE: 0.3070
Evaluate model on site 8 , Test MAE: 0.1680, Test MAPE: 0.0262, Test RMSE: 0.3417
Evaluate model on site 9 , Test MAE: 0.1159, Test MAPE: 0.0169, Test RMSE: 0.2183
Evaluate model on site 10 , Test MAE: 0.1117, Test MAPE: 0.0158, Test RMSE: 0.2081
On average over all site, Test MAE: 0.1474, Test MAPE: 0.0229, Test RMSE: 0.2677
(0.14740756005048752, 0.02288126349449158, 0.267683045566082)
[0.14899215400218963, 0.14934587776660918, 0.14805324673652648, 0.14809353798627853, 0.14740756005048752]
data::data/water/shangban/singleFac/0,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/0', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.24792629480361938
Validation loss decreased (inf --> 0.247926).  Saving model ...
Epoch:2,validate loss:0.18967002630233765
Validation loss decreased (0.247926 --> 0.189670).  Saving model ...
Epoch:3,validate loss:0.19817893207073212
Epoch:4,validate loss:0.20445659756660461
Epoch:5,validate loss:0.182112455368042
Validation loss decreased (0.189670 --> 0.182112).  Saving model ...
Epoch:6,validate loss:0.19453878700733185
Epoch:7,validate loss:0.21132995188236237
Epoch:8,validate loss:0.18266962468624115
Epoch:9,validate loss:0.17926917970180511
Validation loss decreased (0.182112 --> 0.179269).  Saving model ...
Epoch:10,validate loss:0.18703512847423553
Epoch:11,validate loss:0.17927297949790955
Epoch:12,validate loss:0.18220490217208862
Epoch:13,validate loss:0.18066278100013733
Epoch:14,validate loss:0.17655736207962036
Validation loss decreased (0.179269 --> 0.176557).  Saving model ...
Epoch:15,validate loss:0.17063583433628082
Validation loss decreased (0.176557 --> 0.170636).  Saving model ...
Epoch:16,validate loss:0.18811331689357758
Epoch:17,validate loss:0.17091943323612213
Epoch:18,validate loss:0.17557615041732788
Epoch:19,validate loss:0.17293795943260193
Epoch:20,validate loss:0.17729806900024414
Epoch:21,validate loss:0.1757878065109253
Epoch:22,validate loss:0.17109693586826324
Epoch:23,validate loss:0.1709921509027481
Epoch:24,validate loss:0.1658560186624527
Validation loss decreased (0.170636 --> 0.165856).  Saving model ...
Epoch:25,validate loss:0.1666407734155655
Epoch:26,validate loss:0.16510845720767975
Validation loss decreased (0.165856 --> 0.165108).  Saving model ...
Epoch:27,validate loss:0.16280438005924225
Validation loss decreased (0.165108 --> 0.162804).  Saving model ...
Epoch:28,validate loss:0.162862628698349
Epoch:29,validate loss:0.16213250160217285
Validation loss decreased (0.162804 --> 0.162133).  Saving model ...
Epoch:30,validate loss:0.17429059743881226
Epoch:31,validate loss:0.17078423500061035
Epoch:32,validate loss:0.17295652627944946
Epoch:33,validate loss:0.1613432615995407
Validation loss decreased (0.162133 --> 0.161343).  Saving model ...
Epoch:34,validate loss:0.16458286345005035
Epoch:35,validate loss:0.1650896966457367
Epoch:36,validate loss:0.16255569458007812
Epoch:37,validate loss:0.17300797998905182
Epoch:38,validate loss:0.16154569387435913
Epoch:39,validate loss:0.1621067076921463
Epoch:40,validate loss:0.16173836588859558
Epoch:41,validate loss:0.16569510102272034
Epoch:42,validate loss:0.17274345457553864
Epoch:43,validate loss:0.16550716757774353
Epoch:44,validate loss:0.16027988493442535
Validation loss decreased (0.161343 --> 0.160280).  Saving model ...
Epoch:45,validate loss:0.16320867836475372
Epoch:46,validate loss:0.1614718735218048
Epoch:47,validate loss:0.16929584741592407
Epoch:48,validate loss:0.159825399518013
Validation loss decreased (0.160280 --> 0.159825).  Saving model ...
Epoch:49,validate loss:0.16194401681423187
Epoch:50,validate loss:0.17484910786151886
Epoch:51,validate loss:0.15916046500205994
Validation loss decreased (0.159825 --> 0.159160).  Saving model ...
Epoch:52,validate loss:0.16085679829120636
Epoch:53,validate loss:0.1600612998008728
Epoch:54,validate loss:0.16020818054676056
Epoch:55,validate loss:0.16014748811721802
Epoch:56,validate loss:0.1607348620891571
Epoch:57,validate loss:0.15923099219799042
Epoch:58,validate loss:0.1622602641582489
Epoch:59,validate loss:0.15993796288967133
Epoch:60,validate loss:0.15747728943824768
Validation loss decreased (0.159160 --> 0.157477).  Saving model ...
Epoch:61,validate loss:0.16149142384529114
Epoch:62,validate loss:0.1600726693868637
Epoch:63,validate loss:0.16299636662006378
Epoch:64,validate loss:0.16118420660495758
Epoch:65,validate loss:0.15968863666057587
Epoch:66,validate loss:0.1568581908941269
Validation loss decreased (0.157477 --> 0.156858).  Saving model ...
Epoch:67,validate loss:0.16279427707195282
Epoch:68,validate loss:0.1644861102104187
Epoch:69,validate loss:0.1587439924478531
Epoch:70,validate loss:0.15973037481307983
Epoch:71,validate loss:0.1608656793832779
Epoch:72,validate loss:0.15823689103126526
Epoch:73,validate loss:0.1591121256351471
Epoch:74,validate loss:0.160483255982399
Epoch:75,validate loss:0.1590244024991989
Epoch:76,validate loss:0.16551442444324493
Epoch:77,validate loss:0.1568596512079239
Epoch:78,validate loss:0.15918052196502686
Epoch:79,validate loss:0.15905217826366425
Epoch:80,validate loss:0.1608048677444458
Epoch:81,validate loss:0.157207652926445
Epoch:82,validate loss:0.16638536751270294
Epoch:83,validate loss:0.158150777220726
Epoch:84,validate loss:0.16197288036346436
Epoch:85,validate loss:0.16093535721302032
Epoch:86,validate loss:0.1627376675605774
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.995,avg=0.100
2.4796416e-05,0.004401128,9.6126976e-05,2.4796416e-05,0.99085367,0.0008417987,0.002915354,2.4796416e-05,0.00078824686,2.9310559e-05,
0.0017540503,0.0017540503,0.0017540503,0.0017540503,0.0017540503,0.0017540503,0.0017540503,0.0017540503,0.98133415,0.0046334164,
0.87864894,9.768916e-07,0.000590008,9.768916e-07,9.768916e-07,4.8678678e-05,0.1207066,9.768916e-07,9.768916e-07,9.768916e-07,
0.00020255205,0.00020255205,0.00054513494,0.002381516,0.9855157,0.0030558864,0.0040901676,0.0010605896,0.0017781685,0.0011677918,
0.0028144242,0.030572785,0.0028144242,0.0048857224,0.0031383878,0.0028144242,0.0038846817,0.007097016,0.0028144242,0.93916374,
0.0028258625,0.00057862676,0.00032213196,0.00021099293,0.0002997745,0.00021099293,0.9949185,0.00021099293,0.00021099293,0.00021099293,
0.00044006592,0.98230064,0.0107043665,0.00044006592,0.00074168545,0.002664498,0.00044006592,0.00044006592,0.00044391028,0.0013846707,
0.0006778763,0.0038017093,2.054093e-06,0.97738045,2.054093e-06,2.3370076e-06,0.018060513,6.883501e-05,2.054093e-06,2.054093e-06,
0.000316602,0.0026033793,0.000316602,0.009804478,0.000316602,0.00068927807,0.000316602,0.010942047,0.9701118,0.00458261,
0.00016125843,0.00016125843,0.00018157715,0.99246746,0.00016125843,0.00024569707,0.005417042,0.0007565725,0.0002865439,0.00016125843,
Evaluate model on site 1 , Test MAE: 0.1271, Test MAPE: 0.0198, Test RMSE: 0.2265
Evaluate model on site 2 , Test MAE: 0.1316, Test MAPE: 0.0201, Test RMSE: 0.2181
Evaluate model on site 3 , Test MAE: 0.1671, Test MAPE: 0.0281, Test RMSE: 0.3636
Evaluate model on site 4 , Test MAE: 0.1598, Test MAPE: 0.0224, Test RMSE: 0.2759
Evaluate model on site 5 , Test MAE: 0.1632, Test MAPE: 0.0261, Test RMSE: 0.2343
Evaluate model on site 6 , Test MAE: 0.1382, Test MAPE: 0.0238, Test RMSE: 0.2550
Evaluate model on site 7 , Test MAE: 0.1910, Test MAPE: 0.0288, Test RMSE: 0.3065
Evaluate model on site 8 , Test MAE: 0.1691, Test MAPE: 0.0262, Test RMSE: 0.3467
Evaluate model on site 9 , Test MAE: 0.1267, Test MAPE: 0.0182, Test RMSE: 0.2241
Evaluate model on site 10 , Test MAE: 0.1097, Test MAPE: 0.0156, Test RMSE: 0.2016
On average over all site, Test MAE: 0.1484, Test MAPE: 0.0229, Test RMSE: 0.2652
(0.14835011959075928, 0.022912978660315275, 0.2652309000492096)
data::data/water/shangban/singleFac/0,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/0', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.2570701837539673
Validation loss decreased (inf --> 0.257070).  Saving model ...
Epoch:2,validate loss:0.18979544937610626
Validation loss decreased (0.257070 --> 0.189795).  Saving model ...
Epoch:3,validate loss:0.1914762705564499
Epoch:4,validate loss:0.18358071148395538
Validation loss decreased (0.189795 --> 0.183581).  Saving model ...
Epoch:5,validate loss:0.1870594173669815
Epoch:6,validate loss:0.18765877187252045
Epoch:7,validate loss:0.20431096851825714
Epoch:8,validate loss:0.1839301735162735
Epoch:9,validate loss:0.17518766224384308
Validation loss decreased (0.183581 --> 0.175188).  Saving model ...
Epoch:10,validate loss:0.17963925004005432
Epoch:11,validate loss:0.171983540058136
Validation loss decreased (0.175188 --> 0.171984).  Saving model ...
Epoch:12,validate loss:0.18303808569908142
Epoch:13,validate loss:0.18526458740234375
Epoch:14,validate loss:0.17883701622486115
Epoch:15,validate loss:0.17009130120277405
Validation loss decreased (0.171984 --> 0.170091).  Saving model ...
Epoch:16,validate loss:0.1714281439781189
Epoch:17,validate loss:0.1699734479188919
Validation loss decreased (0.170091 --> 0.169973).  Saving model ...
Epoch:18,validate loss:0.1770847588777542
Epoch:19,validate loss:0.17452919483184814
Epoch:20,validate loss:0.16688595712184906
Validation loss decreased (0.169973 --> 0.166886).  Saving model ...
Epoch:21,validate loss:0.19426287710666656
Epoch:22,validate loss:0.17629870772361755
Epoch:23,validate loss:0.16790086030960083
Epoch:24,validate loss:0.184426948428154
Epoch:25,validate loss:0.171519473195076
Epoch:26,validate loss:0.16216816008090973
Validation loss decreased (0.166886 --> 0.162168).  Saving model ...
Epoch:27,validate loss:0.17453652620315552
Epoch:28,validate loss:0.16199855506420135
Validation loss decreased (0.162168 --> 0.161999).  Saving model ...
Epoch:29,validate loss:0.1758389174938202
Epoch:30,validate loss:0.16931337118148804
Epoch:31,validate loss:0.1613042950630188
Validation loss decreased (0.161999 --> 0.161304).  Saving model ...
Epoch:32,validate loss:0.17000150680541992
Epoch:33,validate loss:0.16358283162117004
Epoch:34,validate loss:0.16126690804958344
Validation loss decreased (0.161304 --> 0.161267).  Saving model ...
Epoch:35,validate loss:0.16240741312503815
Epoch:36,validate loss:0.1647254079580307
Epoch:37,validate loss:0.17280220985412598
Epoch:38,validate loss:0.16723839938640594
Epoch:39,validate loss:0.16015669703483582
Validation loss decreased (0.161267 --> 0.160157).  Saving model ...
Epoch:40,validate loss:0.18757838010787964
Epoch:41,validate loss:0.16086289286613464
Epoch:42,validate loss:0.16352877020835876
Epoch:43,validate loss:0.17153728008270264
Epoch:44,validate loss:0.1656898707151413
Epoch:45,validate loss:0.16814248263835907
Epoch:46,validate loss:0.16937193274497986
Epoch:47,validate loss:0.15928985178470612
Validation loss decreased (0.160157 --> 0.159290).  Saving model ...
Epoch:48,validate loss:0.16438277065753937
Epoch:49,validate loss:0.16669923067092896
Epoch:50,validate loss:0.16054295003414154
Epoch:51,validate loss:0.1610504537820816
Epoch:52,validate loss:0.16131456196308136
Epoch:53,validate loss:0.1621054708957672
Epoch:54,validate loss:0.15679366886615753
Validation loss decreased (0.159290 --> 0.156794).  Saving model ...
Epoch:55,validate loss:0.16237832605838776
Epoch:56,validate loss:0.15994761884212494
Epoch:57,validate loss:0.16183774173259735
Epoch:58,validate loss:0.16090255975723267
Epoch:59,validate loss:0.1588735729455948
Epoch:60,validate loss:0.16527430713176727
Epoch:61,validate loss:0.16264256834983826
Epoch:62,validate loss:0.1593843251466751
Epoch:63,validate loss:0.16458404064178467
Epoch:64,validate loss:0.16625699400901794
Epoch:65,validate loss:0.1576875001192093
Epoch:66,validate loss:0.16993625462055206
Epoch:67,validate loss:0.16563963890075684
Epoch:68,validate loss:0.16713854670524597
Epoch:69,validate loss:0.16013820469379425
Epoch:70,validate loss:0.1628817319869995
Epoch:71,validate loss:0.15796564519405365
Epoch:72,validate loss:0.16444502770900726
Epoch:73,validate loss:0.1614164561033249
Epoch:74,validate loss:0.16216826438903809
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.993,avg=0.100
0.93611044,0.0029433933,0.008468529,0.0023376904,0.038451493,0.0023376904,0.0023376904,0.0023376904,0.0023376904,0.0023376904,
0.0005498388,0.0005498388,0.0005498388,0.0005498388,0.9918573,0.0005498388,0.0020569398,0.0005498388,0.002236898,0.0005498388,
2.3864344e-05,2.3864344e-05,2.3864344e-05,2.7396325e-05,2.3864344e-05,2.3864344e-05,0.013285106,0.9865204,2.3864344e-05,2.3864344e-05,
0.00037043984,0.00037043984,0.00037043984,0.00037043984,0.003293392,0.00551041,0.05701219,0.9319614,0.00037043984,0.00037043984,
1.8734921e-05,1.8734921e-05,0.99188775,1.8734921e-05,1.8734921e-05,1.8734921e-05,0.006873528,2.9535197e-05,0.0010967036,1.8734921e-05,
0.009584596,0.00020263658,0.008686738,0.00020263658,0.00023081721,0.00020263658,0.00020263658,0.00020263658,0.00020263658,0.98028207,
0.023102349,2.21432e-05,0.00084856735,0.00021895612,0.9755636,5.835325e-05,0.00015866732,1.24899025e-05,7.4171708e-06,7.4171708e-06,
0.0001116456,0.0001116456,0.0010608085,0.0001116456,0.001832241,0.00054624135,0.009260531,0.0040863804,0.9827672,0.0001116456,
0.00028900252,6.5348184e-05,0.0013294343,0.9927786,6.5348184e-05,6.5348184e-05,0.0030418462,6.5348184e-05,6.5348184e-05,0.0022344028,
0.0007623302,0.0007623302,0.0007623302,0.0007623302,0.9912246,0.0007623302,0.0007623302,0.0007623302,0.0026766686,0.0007623302,
Evaluate model on site 1 , Test MAE: 0.1198, Test MAPE: 0.0190, Test RMSE: 0.2337
Evaluate model on site 2 , Test MAE: 0.1345, Test MAPE: 0.0205, Test RMSE: 0.2253
Evaluate model on site 3 , Test MAE: 0.1684, Test MAPE: 0.0284, Test RMSE: 0.3569
Evaluate model on site 4 , Test MAE: 0.1544, Test MAPE: 0.0216, Test RMSE: 0.2755
Evaluate model on site 5 , Test MAE: 0.1586, Test MAPE: 0.0259, Test RMSE: 0.2394
Evaluate model on site 6 , Test MAE: 0.1402, Test MAPE: 0.0241, Test RMSE: 0.2540
Evaluate model on site 7 , Test MAE: 0.1922, Test MAPE: 0.0290, Test RMSE: 0.3032
Evaluate model on site 8 , Test MAE: 0.1670, Test MAPE: 0.0259, Test RMSE: 0.3371
Evaluate model on site 9 , Test MAE: 0.1153, Test MAPE: 0.0166, Test RMSE: 0.2222
Evaluate model on site 10 , Test MAE: 0.1079, Test MAPE: 0.0153, Test RMSE: 0.2044
On average over all site, Test MAE: 0.1458, Test MAPE: 0.0226, Test RMSE: 0.2652
(0.14582619369029998, 0.022641684766858815, 0.2651696100831032)
data::data/water/shangban/singleFac/0,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/0', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.2640438377857208
Validation loss decreased (inf --> 0.264044).  Saving model ...
Epoch:2,validate loss:0.19975686073303223
Validation loss decreased (0.264044 --> 0.199757).  Saving model ...
Epoch:3,validate loss:0.19747497141361237
Validation loss decreased (0.199757 --> 0.197475).  Saving model ...
Epoch:4,validate loss:0.187043234705925
Validation loss decreased (0.197475 --> 0.187043).  Saving model ...
Epoch:5,validate loss:0.1970834583044052
Epoch:6,validate loss:0.1809437870979309
Validation loss decreased (0.187043 --> 0.180944).  Saving model ...
Epoch:7,validate loss:0.18237251043319702
Epoch:8,validate loss:0.1763087511062622
Validation loss decreased (0.180944 --> 0.176309).  Saving model ...
Epoch:9,validate loss:0.1827595829963684
Epoch:10,validate loss:0.210508793592453
Epoch:11,validate loss:0.18087995052337646
Epoch:12,validate loss:0.18262791633605957
Epoch:13,validate loss:0.1717858463525772
Validation loss decreased (0.176309 --> 0.171786).  Saving model ...
Epoch:14,validate loss:0.1807355284690857
Epoch:15,validate loss:0.1703801453113556
Validation loss decreased (0.171786 --> 0.170380).  Saving model ...
Epoch:16,validate loss:0.17925342917442322
Epoch:17,validate loss:0.18058256804943085
Epoch:18,validate loss:0.174463152885437
Epoch:19,validate loss:0.17368701100349426
Epoch:20,validate loss:0.16367323696613312
Validation loss decreased (0.170380 --> 0.163673).  Saving model ...
Epoch:21,validate loss:0.16524812579154968
Epoch:22,validate loss:0.1679157018661499
Epoch:23,validate loss:0.1691131740808487
Epoch:24,validate loss:0.17020340263843536
Epoch:25,validate loss:0.16246551275253296
Validation loss decreased (0.163673 --> 0.162466).  Saving model ...
Epoch:26,validate loss:0.16758745908737183
Epoch:27,validate loss:0.16180828213691711
Validation loss decreased (0.162466 --> 0.161808).  Saving model ...
Epoch:28,validate loss:0.21045057475566864
Epoch:29,validate loss:0.1725873053073883
Epoch:30,validate loss:0.16280919313430786
Epoch:31,validate loss:0.16816158592700958
Epoch:32,validate loss:0.1611894816160202
Validation loss decreased (0.161808 --> 0.161189).  Saving model ...
Epoch:33,validate loss:0.16108378767967224
Validation loss decreased (0.161189 --> 0.161084).  Saving model ...
Epoch:34,validate loss:0.15951985120773315
Validation loss decreased (0.161084 --> 0.159520).  Saving model ...
Epoch:35,validate loss:0.16437944769859314
Epoch:36,validate loss:0.1664775013923645
Epoch:37,validate loss:0.16200923919677734
Epoch:38,validate loss:0.1650765985250473
Epoch:39,validate loss:0.15944936871528625
Validation loss decreased (0.159520 --> 0.159449).  Saving model ...
Epoch:40,validate loss:0.16419945657253265
Epoch:41,validate loss:0.16904844343662262
Epoch:42,validate loss:0.16080445051193237
Epoch:43,validate loss:0.16096903383731842
Epoch:44,validate loss:0.1620045006275177
Epoch:45,validate loss:0.1576143205165863
Validation loss decreased (0.159449 --> 0.157614).  Saving model ...
Epoch:46,validate loss:0.15853562951087952
Epoch:47,validate loss:0.15730848908424377
Validation loss decreased (0.157614 --> 0.157308).  Saving model ...
Epoch:48,validate loss:0.15707387030124664
Validation loss decreased (0.157308 --> 0.157074).  Saving model ...
Epoch:49,validate loss:0.1580534279346466
Epoch:50,validate loss:0.1620519459247589
Epoch:51,validate loss:0.15718863904476166
Epoch:52,validate loss:0.1718619465827942
Epoch:53,validate loss:0.15964047610759735
Epoch:54,validate loss:0.16127075254917145
Epoch:55,validate loss:0.16483590006828308
Epoch:56,validate loss:0.15514306724071503
Validation loss decreased (0.157074 --> 0.155143).  Saving model ...
Epoch:57,validate loss:0.15958628058433533
Epoch:58,validate loss:0.15692073106765747
Epoch:59,validate loss:0.16183368861675262
Epoch:60,validate loss:0.15931206941604614
Epoch:61,validate loss:0.1571444272994995
Epoch:62,validate loss:0.15577074885368347
Epoch:63,validate loss:0.15989813208580017
Epoch:64,validate loss:0.15933376550674438
Epoch:65,validate loss:0.16970090568065643
Epoch:66,validate loss:0.15738454461097717
Epoch:67,validate loss:0.163636714220047
Epoch:68,validate loss:0.15712039172649384
Epoch:69,validate loss:0.15840567648410797
Epoch:70,validate loss:0.160525843501091
Epoch:71,validate loss:0.1574745625257492
Epoch:72,validate loss:0.15730074048042297
Epoch:73,validate loss:0.1563611626625061
Epoch:74,validate loss:0.15979577600955963
Epoch:75,validate loss:0.160440132021904
Epoch:76,validate loss:0.15865199267864227
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.996,avg=0.100
0.00548482,0.0014122683,7.5733e-06,7.5733e-06,1.4269144e-05,7.5733e-06,7.5733e-06,0.24724475,2.9600575e-05,0.74578404,
0.0013889094,1.5786378e-06,1.5786378e-06,1.5786378e-06,0.9949768,1.5786378e-06,0.003623119,1.5786378e-06,1.5786378e-06,1.5786378e-06,
0.0002096342,0.9952114,5.3812488e-05,0.00024697106,4.344689e-05,4.344689e-05,4.344689e-05,4.344689e-05,0.0014740643,0.0026303574,
0.0042330483,0.0022764318,0.0022764318,0.0022764318,0.0049291775,0.0022764318,0.0022764318,0.97313786,0.003624371,0.0026934245,
0.0008392826,0.0003628736,0.995531,0.00021095456,0.00042640863,0.00042490914,0.00021095456,0.0007939801,0.0009886309,0.00021095456,
7.556428e-05,7.556428e-05,7.556428e-05,0.9851383,0.011586944,0.0012978197,7.556428e-05,0.0015236627,7.556428e-05,7.556428e-05,
0.004007668,0.028031286,0.00084615423,0.00084615423,0.0012874454,0.00084615423,0.009873032,0.00084615423,0.00084615423,0.95256984,
8.395664e-05,8.395664e-05,0.00010561569,8.395664e-05,0.021398248,0.00043440747,0.9770083,8.395664e-05,0.00063364586,8.395664e-05,
0.0011278559,0.00011439046,0.00011439046,0.00011439046,0.99514955,0.00026243864,0.0026472013,0.00011439046,0.00024108734,0.00011439046,
0.00012838753,0.03487212,0.00012838753,0.0013218548,0.00012838753,0.00031188398,0.0009771904,0.0050230986,0.00012838753,0.9569803,
Evaluate model on site 1 , Test MAE: 0.1206, Test MAPE: 0.0190, Test RMSE: 0.2315
Evaluate model on site 2 , Test MAE: 0.1341, Test MAPE: 0.0205, Test RMSE: 0.2201
Evaluate model on site 3 , Test MAE: 0.1671, Test MAPE: 0.0281, Test RMSE: 0.3609
Evaluate model on site 4 , Test MAE: 0.1589, Test MAPE: 0.0222, Test RMSE: 0.2779
Evaluate model on site 5 , Test MAE: 0.1564, Test MAPE: 0.0254, Test RMSE: 0.2322
Evaluate model on site 6 , Test MAE: 0.1400, Test MAPE: 0.0241, Test RMSE: 0.2519
Evaluate model on site 7 , Test MAE: 0.1876, Test MAPE: 0.0283, Test RMSE: 0.2987
Evaluate model on site 8 , Test MAE: 0.1651, Test MAPE: 0.0256, Test RMSE: 0.3431
Evaluate model on site 9 , Test MAE: 0.1162, Test MAPE: 0.0169, Test RMSE: 0.2213
Evaluate model on site 10 , Test MAE: 0.1121, Test MAPE: 0.0160, Test RMSE: 0.1996
On average over all site, Test MAE: 0.1458, Test MAPE: 0.0226, Test RMSE: 0.2637
(0.14579254016280174, 0.022616808675229548, 0.2637160837650299)
data::data/water/shangban/singleFac/0,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/0', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.2266150265932083
Validation loss decreased (inf --> 0.226615).  Saving model ...
Epoch:2,validate loss:0.19321149587631226
Validation loss decreased (0.226615 --> 0.193211).  Saving model ...
Epoch:3,validate loss:0.23466436564922333
Epoch:4,validate loss:0.19675090909004211
Epoch:5,validate loss:0.18256773054599762
Validation loss decreased (0.193211 --> 0.182568).  Saving model ...
Epoch:6,validate loss:0.18297074735164642
Epoch:7,validate loss:0.21191629767417908
Epoch:8,validate loss:0.1918872445821762
Epoch:9,validate loss:0.19318464398384094
Epoch:10,validate loss:0.18055522441864014
Validation loss decreased (0.182568 --> 0.180555).  Saving model ...
Epoch:11,validate loss:0.17754189670085907
Validation loss decreased (0.180555 --> 0.177542).  Saving model ...
Epoch:12,validate loss:0.1732093244791031
Validation loss decreased (0.177542 --> 0.173209).  Saving model ...
Epoch:13,validate loss:0.17199625074863434
Validation loss decreased (0.173209 --> 0.171996).  Saving model ...
Epoch:14,validate loss:0.18388517200946808
Epoch:15,validate loss:0.1735956221818924
Epoch:16,validate loss:0.19182705879211426
Epoch:17,validate loss:0.1793639212846756
Epoch:18,validate loss:0.1813162863254547
Epoch:19,validate loss:0.16921466588974
Validation loss decreased (0.171996 --> 0.169215).  Saving model ...
Epoch:20,validate loss:0.1792563796043396
Epoch:21,validate loss:0.17376558482646942
Epoch:22,validate loss:0.17346230149269104
Epoch:23,validate loss:0.16417987644672394
Validation loss decreased (0.169215 --> 0.164180).  Saving model ...
Epoch:24,validate loss:0.17149430513381958
Epoch:25,validate loss:0.1660926342010498
Epoch:26,validate loss:0.16912660002708435
Epoch:27,validate loss:0.16425934433937073
Epoch:28,validate loss:0.17849402129650116
Epoch:29,validate loss:0.16462507843971252
Epoch:30,validate loss:0.1816040724515915
Epoch:31,validate loss:0.1612531840801239
Validation loss decreased (0.164180 --> 0.161253).  Saving model ...
Epoch:32,validate loss:0.16221582889556885
Epoch:33,validate loss:0.163455531001091
Epoch:34,validate loss:0.16000069677829742
Validation loss decreased (0.161253 --> 0.160001).  Saving model ...
Epoch:35,validate loss:0.16059952974319458
Epoch:36,validate loss:0.16385149955749512
Epoch:37,validate loss:0.16199859976768494
Epoch:38,validate loss:0.15737222135066986
Validation loss decreased (0.160001 --> 0.157372).  Saving model ...
Epoch:39,validate loss:0.16032975912094116
Epoch:40,validate loss:0.16583390533924103
Epoch:41,validate loss:0.15697839856147766
Validation loss decreased (0.157372 --> 0.156978).  Saving model ...
Epoch:42,validate loss:0.15840256214141846
Epoch:43,validate loss:0.15630647540092468
Validation loss decreased (0.156978 --> 0.156306).  Saving model ...
Epoch:44,validate loss:0.15818382799625397
Epoch:45,validate loss:0.15979507565498352
Epoch:46,validate loss:0.16408893465995789
Epoch:47,validate loss:0.1562085747718811
Validation loss decreased (0.156306 --> 0.156209).  Saving model ...
Epoch:48,validate loss:0.1564100980758667
Epoch:49,validate loss:0.15441268682479858
Validation loss decreased (0.156209 --> 0.154413).  Saving model ...
Epoch:50,validate loss:0.15476062893867493
Epoch:51,validate loss:0.15820477902889252
Epoch:52,validate loss:0.1597098410129547
Epoch:53,validate loss:0.1565900593996048
Epoch:54,validate loss:0.15872453153133392
Epoch:55,validate loss:0.1604342758655548
Epoch:56,validate loss:0.15325547754764557
Validation loss decreased (0.154413 --> 0.153255).  Saving model ...
Epoch:57,validate loss:0.15687811374664307
Epoch:58,validate loss:0.15643469989299774
Epoch:59,validate loss:0.15756623446941376
Epoch:60,validate loss:0.16129904985427856
Epoch:61,validate loss:0.15430405735969543
Epoch:62,validate loss:0.15480998158454895
Epoch:63,validate loss:0.15535838901996613
Epoch:64,validate loss:0.15593251585960388
Epoch:65,validate loss:0.1563142091035843
Epoch:66,validate loss:0.1544857919216156
Epoch:67,validate loss:0.156507208943367
Epoch:68,validate loss:0.15468566119670868
Epoch:69,validate loss:0.15373758971691132
Epoch:70,validate loss:0.15833155810832977
Epoch:71,validate loss:0.16312861442565918
Epoch:72,validate loss:0.15602955222129822
Epoch:73,validate loss:0.1605469435453415
Epoch:74,validate loss:0.155043825507164
Epoch:75,validate loss:0.15748657286167145
Epoch:76,validate loss:0.15390755236148834
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
4.8271963e-06,0.0053164707,0.00044854023,7.5408834e-06,4.8271963e-06,0.00074897177,0.98963284,0.003812759,1.8424114e-05,4.8271963e-06,
0.00015472303,0.001009445,0.99773705,0.0003304024,1.8745903e-05,1.8745903e-05,1.8745903e-05,0.0006394904,1.8745903e-05,5.382731e-05,
3.8371083e-05,0.007920213,0.0032282171,3.8371083e-05,3.8371083e-05,3.8371083e-05,3.8371083e-05,0.98565084,3.8371083e-05,0.002970451,
0.0002402478,0.00446003,0.0002402478,0.0059584575,0.00040301692,0.0007012239,0.98061866,0.0068976316,0.0002402478,0.0002402478,
3.430046e-06,0.9999566,3.430046e-06,7.2045696e-06,3.430046e-06,3.430046e-06,3.430046e-06,3.430046e-06,1.2169968e-05,3.430046e-06,
3.6310466e-05,0.99864036,0.0005856541,3.6310466e-05,0.00011114489,0.00027059863,3.6310466e-05,3.6310466e-05,0.00021069357,3.6310466e-05,
0.0074858232,2.693136e-07,2.693136e-07,5.930629e-07,0.99250907,4.3109597e-07,2.693136e-07,6.3664294e-07,2.693136e-07,2.2747781e-06,
0.00014062603,0.99581945,0.00014062603,0.00014062603,0.00043301427,0.00014062603,0.00014062603,0.0027630734,0.00014062603,0.00014062603,
0.008698068,0.008698068,0.7065379,0.008698068,0.008698068,0.008698068,0.22387753,0.008698068,0.008698068,0.008698068,
6.237907e-05,1.9454366e-05,1.9454366e-05,1.9454366e-05,1.9454366e-05,1.9454366e-05,0.00406466,0.0037896698,0.9916946,0.000291261,
Evaluate model on site 1 , Test MAE: 0.1237, Test MAPE: 0.0197, Test RMSE: 0.2376
Evaluate model on site 2 , Test MAE: 0.1314, Test MAPE: 0.0201, Test RMSE: 0.2135
Evaluate model on site 3 , Test MAE: 0.1718, Test MAPE: 0.0292, Test RMSE: 0.3619
Evaluate model on site 4 , Test MAE: 0.1595, Test MAPE: 0.0223, Test RMSE: 0.2788
Evaluate model on site 5 , Test MAE: 0.1711, Test MAPE: 0.0286, Test RMSE: 0.2467
Evaluate model on site 6 , Test MAE: 0.1427, Test MAPE: 0.0248, Test RMSE: 0.2553
Evaluate model on site 7 , Test MAE: 0.1959, Test MAPE: 0.0296, Test RMSE: 0.3110
Evaluate model on site 8 , Test MAE: 0.1634, Test MAPE: 0.0256, Test RMSE: 0.3323
Evaluate model on site 9 , Test MAE: 0.1161, Test MAPE: 0.0168, Test RMSE: 0.2226
Evaluate model on site 10 , Test MAE: 0.1103, Test MAPE: 0.0156, Test RMSE: 0.2070
On average over all site, Test MAE: 0.1486, Test MAPE: 0.0233, Test RMSE: 0.2667
(0.14858740642666818, 0.02325161751359701, 0.26665950417518614)
data::data/water/shangban/singleFac/0,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/0', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.22689516842365265
Validation loss decreased (inf --> 0.226895).  Saving model ...
Epoch:2,validate loss:0.1973053514957428
Validation loss decreased (0.226895 --> 0.197305).  Saving model ...
Epoch:3,validate loss:0.18345613777637482
Validation loss decreased (0.197305 --> 0.183456).  Saving model ...
Epoch:4,validate loss:0.19823308289051056
Epoch:5,validate loss:0.21792930364608765
Epoch:6,validate loss:0.19507883489131927
Epoch:7,validate loss:0.18901406228542328
Epoch:8,validate loss:0.18618059158325195
Epoch:9,validate loss:0.17554537951946259
Validation loss decreased (0.183456 --> 0.175545).  Saving model ...
Epoch:10,validate loss:0.18564406037330627
Epoch:11,validate loss:0.19754476845264435
Epoch:12,validate loss:0.17569154500961304
Epoch:13,validate loss:0.17384372651576996
Validation loss decreased (0.175545 --> 0.173844).  Saving model ...
Epoch:14,validate loss:0.17116786539554596
Validation loss decreased (0.173844 --> 0.171168).  Saving model ...
Epoch:15,validate loss:0.17278462648391724
Epoch:16,validate loss:0.1783834844827652
Epoch:17,validate loss:0.17532746493816376
Epoch:18,validate loss:0.17580562829971313
Epoch:19,validate loss:0.1726451963186264
Epoch:20,validate loss:0.16914209723472595
Validation loss decreased (0.171168 --> 0.169142).  Saving model ...
Epoch:21,validate loss:0.17305323481559753
Epoch:22,validate loss:0.1649484783411026
Validation loss decreased (0.169142 --> 0.164948).  Saving model ...
Epoch:23,validate loss:0.1681160181760788
Epoch:24,validate loss:0.17200340330600739
Epoch:25,validate loss:0.178597092628479
Epoch:26,validate loss:0.1648547649383545
Validation loss decreased (0.164948 --> 0.164855).  Saving model ...
Epoch:27,validate loss:0.16727499663829803
Epoch:28,validate loss:0.1662856787443161
Epoch:29,validate loss:0.1855432242155075
Epoch:30,validate loss:0.17391705513000488
Epoch:31,validate loss:0.1662614643573761
Epoch:32,validate loss:0.16178828477859497
Validation loss decreased (0.164855 --> 0.161788).  Saving model ...
Epoch:33,validate loss:0.18754985928535461
Epoch:34,validate loss:0.17083005607128143
Epoch:35,validate loss:0.1638823300600052
Epoch:36,validate loss:0.16591587662696838
Epoch:37,validate loss:0.16841571033000946
Epoch:38,validate loss:0.16217844188213348
Epoch:39,validate loss:0.1661987453699112
Epoch:40,validate loss:0.16678234934806824
Epoch:41,validate loss:0.16699004173278809
Epoch:42,validate loss:0.1720580756664276
Epoch:43,validate loss:0.17031346261501312
Epoch:44,validate loss:0.17268258333206177
Epoch:45,validate loss:0.15969343483448029
Validation loss decreased (0.161788 --> 0.159693).  Saving model ...
Epoch:46,validate loss:0.15978054702281952
Epoch:47,validate loss:0.1573963761329651
Validation loss decreased (0.159693 --> 0.157396).  Saving model ...
Epoch:48,validate loss:0.16710908710956573
Epoch:49,validate loss:0.16631416976451874
Epoch:50,validate loss:0.15847785770893097
Epoch:51,validate loss:0.1607736200094223
Epoch:52,validate loss:0.161434605717659
Epoch:53,validate loss:0.15783046185970306
Epoch:54,validate loss:0.16186146438121796
Epoch:55,validate loss:0.15979529917240143
Epoch:56,validate loss:0.15827643871307373
Epoch:57,validate loss:0.16074791550636292
Epoch:58,validate loss:0.1562589555978775
Validation loss decreased (0.157396 --> 0.156259).  Saving model ...
Epoch:59,validate loss:0.15846678614616394
Epoch:60,validate loss:0.1599200963973999
Epoch:61,validate loss:0.15574918687343597
Validation loss decreased (0.156259 --> 0.155749).  Saving model ...
Epoch:62,validate loss:0.16071900725364685
Epoch:63,validate loss:0.15392936766147614
Validation loss decreased (0.155749 --> 0.153929).  Saving model ...
Epoch:64,validate loss:0.1584596186876297
Epoch:65,validate loss:0.15412648022174835
Epoch:66,validate loss:0.15596327185630798
Epoch:67,validate loss:0.15517933666706085
Epoch:68,validate loss:0.1569971740245819
Epoch:69,validate loss:0.15581494569778442
Epoch:70,validate loss:0.15608438849449158
Epoch:71,validate loss:0.16250836849212646
Epoch:72,validate loss:0.1568165421485901
Epoch:73,validate loss:0.15583692491054535
Epoch:74,validate loss:0.15489481389522552
Epoch:75,validate loss:0.1567464917898178
Epoch:76,validate loss:0.15591450035572052
Epoch:77,validate loss:0.16292399168014526
Epoch:78,validate loss:0.15680421888828278
Epoch:79,validate loss:0.15509024262428284
Epoch:80,validate loss:0.1549343317747116
Epoch:81,validate loss:0.1552790105342865
Epoch:82,validate loss:0.15403446555137634
Epoch:83,validate loss:0.15513011813163757
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.997,avg=0.100
0.0009797973,0.0009797973,0.0015748803,0.0009797973,0.0036386636,0.0038734847,0.010065186,0.0009797973,0.9759487,0.0009797973,
0.0007156731,0.0014046028,0.0007156731,0.0007156731,0.0062888367,0.0007156731,0.0007156731,0.0009387727,0.9870739,0.0007156731,
0.021908477,0.9687228,0.0005437892,0.0005437892,0.0035162994,0.0007630385,0.0011390295,0.0005849583,0.0017341239,0.0005437892,
0.0018741462,0.0016915442,0.0011392065,0.0032158068,0.0027402036,0.9846326,0.0012887534,0.0011392065,0.0011392065,0.0011392065,
0.0019257597,0.0019257597,0.030387748,0.011733085,0.021450788,0.9024912,0.0019257597,0.0019257597,0.02156435,0.004669763,
0.0019589413,0.0020512259,0.0019589413,0.0019589413,0.9822771,0.0019589413,0.0019589413,0.0019589413,0.0019589413,0.0019589413,
9.97737e-05,9.97737e-05,0.9962501,0.00013697955,9.97737e-05,9.97737e-05,0.0017592615,9.97737e-05,0.0012550694,9.97737e-05,
0.0002321828,0.0018686338,0.00046955835,0.9898157,0.0002321828,0.00042346606,0.0002321828,0.0059811734,0.0002321828,0.00051278115,
4.6884437e-05,4.6884437e-05,4.6884437e-05,4.6884437e-05,4.6884437e-05,4.6884437e-05,0.0009832651,0.9971699,5.5000135e-05,0.0015104715,
0.0055127153,0.0034550254,0.9657975,0.003550318,0.004409295,0.0034550254,0.0034550254,0.0034550254,0.0034550254,0.0034550254,
Evaluate model on site 1 , Test MAE: 0.1236, Test MAPE: 0.0195, Test RMSE: 0.2334
Evaluate model on site 2 , Test MAE: 0.1334, Test MAPE: 0.0205, Test RMSE: 0.2182
Evaluate model on site 3 , Test MAE: 0.1677, Test MAPE: 0.0284, Test RMSE: 0.3605
Evaluate model on site 4 , Test MAE: 0.1582, Test MAPE: 0.0222, Test RMSE: 0.2729
Evaluate model on site 5 , Test MAE: 0.1577, Test MAPE: 0.0258, Test RMSE: 0.2399
Evaluate model on site 6 , Test MAE: 0.1426, Test MAPE: 0.0248, Test RMSE: 0.2520
Evaluate model on site 7 , Test MAE: 0.1931, Test MAPE: 0.0291, Test RMSE: 0.3038
Evaluate model on site 8 , Test MAE: 0.1647, Test MAPE: 0.0256, Test RMSE: 0.3356
Evaluate model on site 9 , Test MAE: 0.1141, Test MAPE: 0.0166, Test RMSE: 0.2157
Evaluate model on site 10 , Test MAE: 0.1076, Test MAPE: 0.0153, Test RMSE: 0.2048
On average over all site, Test MAE: 0.1463, Test MAPE: 0.0228, Test RMSE: 0.2637
(0.14627791196107864, 0.0227757440879941, 0.2636802777647972)
[0.14835011959075928, 0.14582619369029998, 0.14579254016280174, 0.14858740642666818, 0.14627791196107864]
data::data/water/shangban/singleFac/1,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/1', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.80776447057724
Validation loss decreased (inf --> 0.807764).  Saving model ...
Epoch:2,validate loss:0.5114217400550842
Validation loss decreased (0.807764 --> 0.511422).  Saving model ...
Epoch:3,validate loss:0.5042141675949097
Validation loss decreased (0.511422 --> 0.504214).  Saving model ...
Epoch:4,validate loss:0.47381505370140076
Validation loss decreased (0.504214 --> 0.473815).  Saving model ...
Epoch:5,validate loss:0.4813142418861389
Epoch:6,validate loss:0.499440461397171
Epoch:7,validate loss:0.49609315395355225
Epoch:8,validate loss:0.5029497742652893
Epoch:9,validate loss:0.46476641297340393
Validation loss decreased (0.473815 --> 0.464766).  Saving model ...
Epoch:10,validate loss:0.505308210849762
Epoch:11,validate loss:0.5036759972572327
Epoch:12,validate loss:0.47130149602890015
Epoch:13,validate loss:0.4660358726978302
Epoch:14,validate loss:0.46304184198379517
Validation loss decreased (0.464766 --> 0.463042).  Saving model ...
Epoch:15,validate loss:0.5362207293510437
Epoch:16,validate loss:0.47701412439346313
Epoch:17,validate loss:0.5201208591461182
Epoch:18,validate loss:0.4679875075817108
Epoch:19,validate loss:0.4642511010169983
Epoch:20,validate loss:0.49953991174697876
Epoch:21,validate loss:0.4783197045326233
Epoch:22,validate loss:0.4853828549385071
Epoch:23,validate loss:0.4680202007293701
Epoch:24,validate loss:0.4668452739715576
Epoch:25,validate loss:0.46325016021728516
Epoch:26,validate loss:0.46264562010765076
Validation loss decreased (0.463042 --> 0.462646).  Saving model ...
Epoch:27,validate loss:0.5472476482391357
Epoch:28,validate loss:0.4740821421146393
Epoch:29,validate loss:0.46640849113464355
Epoch:30,validate loss:0.5034024119377136
Epoch:31,validate loss:0.46046921610832214
Validation loss decreased (0.462646 --> 0.460469).  Saving model ...
Epoch:32,validate loss:0.4601113200187683
Validation loss decreased (0.460469 --> 0.460111).  Saving model ...
Epoch:33,validate loss:0.45721814036369324
Validation loss decreased (0.460111 --> 0.457218).  Saving model ...
Epoch:34,validate loss:0.48586419224739075
Epoch:35,validate loss:0.4813615083694458
Epoch:36,validate loss:0.4732264578342438
Epoch:37,validate loss:0.4596051871776581
Epoch:38,validate loss:0.48557570576667786
Epoch:39,validate loss:0.48123642802238464
Epoch:40,validate loss:0.47242841124534607
Epoch:41,validate loss:0.45704811811447144
Validation loss decreased (0.457218 --> 0.457048).  Saving model ...
Epoch:42,validate loss:0.46759629249572754
Epoch:43,validate loss:0.49201375246047974
Epoch:44,validate loss:0.48101773858070374
Epoch:45,validate loss:0.486922949552536
Epoch:46,validate loss:0.48953479528427124
Epoch:47,validate loss:0.4691135585308075
Epoch:48,validate loss:0.47946324944496155
Epoch:49,validate loss:0.46921390295028687
Epoch:50,validate loss:0.48365598917007446
Epoch:51,validate loss:0.49083226919174194
Epoch:52,validate loss:0.4667372703552246
Epoch:53,validate loss:0.465787798166275
Epoch:54,validate loss:0.48224836587905884
Epoch:55,validate loss:0.4679470956325531
Epoch:56,validate loss:0.4670504927635193
Epoch:57,validate loss:0.490881085395813
Epoch:58,validate loss:0.46451812982559204
Epoch:59,validate loss:0.4679903984069824
Epoch:60,validate loss:0.4800354242324829
Epoch:61,validate loss:0.46538057923316956
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.6132, Test MAPE: 0.0736, Test RMSE: 0.9901
Evaluate model on site 2 , Test MAE: 0.9239, Test MAPE: 0.1809, Test RMSE: 1.5945
Evaluate model on site 3 , Test MAE: 0.3437, Test MAPE: 0.0608, Test RMSE: 0.6857
Evaluate model on site 4 , Test MAE: 0.7791, Test MAPE: 0.0939, Test RMSE: 1.1431
Evaluate model on site 5 , Test MAE: 0.3930, Test MAPE: 0.0535, Test RMSE: 0.6797
Evaluate model on site 6 , Test MAE: 0.6349, Test MAPE: 0.0908, Test RMSE: 1.2479
Evaluate model on site 7 , Test MAE: 0.3811, Test MAPE: 0.0578, Test RMSE: 0.7291
Evaluate model on site 8 , Test MAE: 0.4174, Test MAPE: 0.0872, Test RMSE: 0.7149
Evaluate model on site 9 , Test MAE: 0.7632, Test MAPE: 0.1153, Test RMSE: 1.2350
Evaluate model on site 10 , Test MAE: 0.2329, Test MAPE: 0.2186, Test RMSE: 0.4083
On average over all site, Test MAE: 0.5482, Test MAPE: 0.1032, Test RMSE: 0.9428
(0.5482247099280357, 0.1032392930239439, 0.9428369492292404)
data::data/water/shangban/singleFac/1,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/1', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.8520470261573792
Validation loss decreased (inf --> 0.852047).  Saving model ...
Epoch:2,validate loss:0.5312353372573853
Validation loss decreased (0.852047 --> 0.531235).  Saving model ...
Epoch:3,validate loss:0.47956812381744385
Validation loss decreased (0.531235 --> 0.479568).  Saving model ...
Epoch:4,validate loss:0.47288769483566284
Validation loss decreased (0.479568 --> 0.472888).  Saving model ...
Epoch:5,validate loss:0.49575090408325195
Epoch:6,validate loss:0.4806287884712219
Epoch:7,validate loss:0.4905274510383606
Epoch:8,validate loss:0.4834454655647278
Epoch:9,validate loss:0.466913640499115
Validation loss decreased (0.472888 --> 0.466914).  Saving model ...
Epoch:10,validate loss:0.4828321039676666
Epoch:11,validate loss:0.47548291087150574
Epoch:12,validate loss:0.4678950607776642
Epoch:13,validate loss:0.4873584508895874
Epoch:14,validate loss:0.5084967017173767
Epoch:15,validate loss:0.4718094766139984
Epoch:16,validate loss:0.45848017930984497
Validation loss decreased (0.466914 --> 0.458480).  Saving model ...
Epoch:17,validate loss:0.4562983512878418
Validation loss decreased (0.458480 --> 0.456298).  Saving model ...
Epoch:18,validate loss:0.5025537610054016
Epoch:19,validate loss:0.46723324060440063
Epoch:20,validate loss:0.4931181073188782
Epoch:21,validate loss:0.47781646251678467
Epoch:22,validate loss:0.4694843292236328
Epoch:23,validate loss:0.46515563130378723
Epoch:24,validate loss:0.4622204005718231
Epoch:25,validate loss:0.47613099217414856
Epoch:26,validate loss:0.4586501717567444
Epoch:27,validate loss:0.46744304895401
Epoch:28,validate loss:0.49526548385620117
Epoch:29,validate loss:0.47058629989624023
Epoch:30,validate loss:0.4768877923488617
Epoch:31,validate loss:0.4634433388710022
Epoch:32,validate loss:0.4991430640220642
Epoch:33,validate loss:0.4861084818840027
Epoch:34,validate loss:0.4584100544452667
Epoch:35,validate loss:0.4709872901439667
Epoch:36,validate loss:0.49994686245918274
Epoch:37,validate loss:0.480021208524704
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.6070, Test MAPE: 0.0735, Test RMSE: 0.9813
Evaluate model on site 2 , Test MAE: 0.9023, Test MAPE: 0.1793, Test RMSE: 1.5710
Evaluate model on site 3 , Test MAE: 0.3429, Test MAPE: 0.0590, Test RMSE: 0.6934
Evaluate model on site 4 , Test MAE: 0.7864, Test MAPE: 0.0955, Test RMSE: 1.1588
Evaluate model on site 5 , Test MAE: 0.4015, Test MAPE: 0.0559, Test RMSE: 0.6851
Evaluate model on site 6 , Test MAE: 0.6477, Test MAPE: 0.0940, Test RMSE: 1.2528
Evaluate model on site 7 , Test MAE: 0.3983, Test MAPE: 0.0606, Test RMSE: 0.7479
Evaluate model on site 8 , Test MAE: 0.4190, Test MAPE: 0.0882, Test RMSE: 0.7144
Evaluate model on site 9 , Test MAE: 0.7586, Test MAPE: 0.1148, Test RMSE: 1.2299
Evaluate model on site 10 , Test MAE: 0.2359, Test MAPE: 0.2165, Test RMSE: 0.4032
On average over all site, Test MAE: 0.5500, Test MAPE: 0.1037, Test RMSE: 0.9438
(0.5499629661440849, 0.1037360455840826, 0.9437881976366043)
data::data/water/shangban/singleFac/1,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/1', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.8232071995735168
Validation loss decreased (inf --> 0.823207).  Saving model ...
Epoch:2,validate loss:0.5233805179595947
Validation loss decreased (0.823207 --> 0.523381).  Saving model ...
Epoch:3,validate loss:0.5324779152870178
Epoch:4,validate loss:0.4826914370059967
Validation loss decreased (0.523381 --> 0.482691).  Saving model ...
Epoch:5,validate loss:0.48747718334198
Epoch:6,validate loss:0.4859362244606018
Epoch:7,validate loss:0.4665840268135071
Validation loss decreased (0.482691 --> 0.466584).  Saving model ...
Epoch:8,validate loss:0.5644032955169678
Epoch:9,validate loss:0.48024553060531616
Epoch:10,validate loss:0.4912551939487457
Epoch:11,validate loss:0.4582413136959076
Validation loss decreased (0.466584 --> 0.458241).  Saving model ...
Epoch:12,validate loss:0.5027613639831543
Epoch:13,validate loss:0.5114604234695435
Epoch:14,validate loss:0.4831039011478424
Epoch:15,validate loss:0.5087804794311523
Epoch:16,validate loss:0.4743061363697052
Epoch:17,validate loss:0.4639727771282196
Epoch:18,validate loss:0.4552459418773651
Validation loss decreased (0.458241 --> 0.455246).  Saving model ...
Epoch:19,validate loss:0.45785167813301086
Epoch:20,validate loss:0.46573978662490845
Epoch:21,validate loss:0.481581449508667
Epoch:22,validate loss:0.4583613872528076
Epoch:23,validate loss:0.47027620673179626
Epoch:24,validate loss:0.5085400342941284
Epoch:25,validate loss:0.49584123492240906
Epoch:26,validate loss:0.4584415555000305
Epoch:27,validate loss:0.4738711714744568
Epoch:28,validate loss:0.4515290856361389
Validation loss decreased (0.455246 --> 0.451529).  Saving model ...
Epoch:29,validate loss:0.4566771984100342
Epoch:30,validate loss:0.4759283661842346
Epoch:31,validate loss:0.4761817455291748
Epoch:32,validate loss:0.45510411262512207
Epoch:33,validate loss:0.5053560733795166
Epoch:34,validate loss:0.4575077295303345
Epoch:35,validate loss:0.4590970575809479
Epoch:36,validate loss:0.4731903374195099
Epoch:37,validate loss:0.4452349543571472
Validation loss decreased (0.451529 --> 0.445235).  Saving model ...
Epoch:38,validate loss:0.45717236399650574
Epoch:39,validate loss:0.45514559745788574
Epoch:40,validate loss:0.47763288021087646
Epoch:41,validate loss:0.4518873989582062
Epoch:42,validate loss:0.45546242594718933
Epoch:43,validate loss:0.4753372371196747
Epoch:44,validate loss:0.4654875099658966
Epoch:45,validate loss:0.451427161693573
Epoch:46,validate loss:0.4667401611804962
Epoch:47,validate loss:0.46767228841781616
Epoch:48,validate loss:0.45041608810424805
Epoch:49,validate loss:0.4643770158290863
Epoch:50,validate loss:0.47349652647972107
Epoch:51,validate loss:0.4758739173412323
Epoch:52,validate loss:0.46317732334136963
Epoch:53,validate loss:0.4523598551750183
Epoch:54,validate loss:0.45919468998908997
Epoch:55,validate loss:0.4763711988925934
Epoch:56,validate loss:0.4712897837162018
Epoch:57,validate loss:0.46354570984840393
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.6066, Test MAPE: 0.0739, Test RMSE: 0.9806
Evaluate model on site 2 , Test MAE: 0.9204, Test MAPE: 0.1855, Test RMSE: 1.5959
Evaluate model on site 3 , Test MAE: 0.3445, Test MAPE: 0.0613, Test RMSE: 0.7026
Evaluate model on site 4 , Test MAE: 0.7748, Test MAPE: 0.0950, Test RMSE: 1.1490
Evaluate model on site 5 , Test MAE: 0.4034, Test MAPE: 0.0557, Test RMSE: 0.6735
Evaluate model on site 6 , Test MAE: 0.6637, Test MAPE: 0.0961, Test RMSE: 1.2716
Evaluate model on site 7 , Test MAE: 0.3886, Test MAPE: 0.0590, Test RMSE: 0.7308
Evaluate model on site 8 , Test MAE: 0.4233, Test MAPE: 0.0885, Test RMSE: 0.7245
Evaluate model on site 9 , Test MAE: 0.7761, Test MAPE: 0.1182, Test RMSE: 1.2489
Evaluate model on site 10 , Test MAE: 0.2303, Test MAPE: 0.2181, Test RMSE: 0.3958
On average over all site, Test MAE: 0.5532, Test MAPE: 0.1051, Test RMSE: 0.9473
(0.5531663715839386, 0.10513040833175183, 0.9472933620214462)
data::data/water/shangban/singleFac/1,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/1', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.7847554683685303
Validation loss decreased (inf --> 0.784755).  Saving model ...
Epoch:2,validate loss:0.49599167704582214
Validation loss decreased (0.784755 --> 0.495992).  Saving model ...
Epoch:3,validate loss:0.5144374966621399
Epoch:4,validate loss:0.4905267357826233
Validation loss decreased (0.495992 --> 0.490527).  Saving model ...
Epoch:5,validate loss:0.4858429729938507
Validation loss decreased (0.490527 --> 0.485843).  Saving model ...
Epoch:6,validate loss:0.47856593132019043
Validation loss decreased (0.485843 --> 0.478566).  Saving model ...
Epoch:7,validate loss:0.48341912031173706
Epoch:8,validate loss:0.48722147941589355
Epoch:9,validate loss:0.47437554597854614
Validation loss decreased (0.478566 --> 0.474376).  Saving model ...
Epoch:10,validate loss:0.473214715719223
Validation loss decreased (0.474376 --> 0.473215).  Saving model ...
Epoch:11,validate loss:0.5180298686027527
Epoch:12,validate loss:0.49718916416168213
Epoch:13,validate loss:0.47985219955444336
Epoch:14,validate loss:0.46089425683021545
Validation loss decreased (0.473215 --> 0.460894).  Saving model ...
Epoch:15,validate loss:0.4772990345954895
Epoch:16,validate loss:0.47193971276283264
Epoch:17,validate loss:0.4848344922065735
Epoch:18,validate loss:0.4839739501476288
Epoch:19,validate loss:0.48382726311683655
Epoch:20,validate loss:0.47184038162231445
Epoch:21,validate loss:0.4938144385814667
Epoch:22,validate loss:0.4696829319000244
Epoch:23,validate loss:0.4763595163822174
Epoch:24,validate loss:0.46617674827575684
Epoch:25,validate loss:0.4681881070137024
Epoch:26,validate loss:0.48066097497940063
Epoch:27,validate loss:0.46565407514572144
Epoch:28,validate loss:0.4587857127189636
Validation loss decreased (0.460894 --> 0.458786).  Saving model ...
Epoch:29,validate loss:0.4644848704338074
Epoch:30,validate loss:0.46088913083076477
Epoch:31,validate loss:0.4619477689266205
Epoch:32,validate loss:0.46701329946517944
Epoch:33,validate loss:0.48256242275238037
Epoch:34,validate loss:0.46367114782333374
Epoch:35,validate loss:0.4651583731174469
Epoch:36,validate loss:0.4856773614883423
Epoch:37,validate loss:0.48690804839134216
Epoch:38,validate loss:0.46161362528800964
Epoch:39,validate loss:0.4969947934150696
Epoch:40,validate loss:0.46793070435523987
Epoch:41,validate loss:0.4659794867038727
Epoch:42,validate loss:0.47732114791870117
Epoch:43,validate loss:0.4737207591533661
Epoch:44,validate loss:0.5269207954406738
Epoch:45,validate loss:0.47138121724128723
Epoch:46,validate loss:0.49768081307411194
Epoch:47,validate loss:0.4713776111602783
Epoch:48,validate loss:0.4717901349067688
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.6064, Test MAPE: 0.0737, Test RMSE: 0.9811
Evaluate model on site 2 , Test MAE: 0.9172, Test MAPE: 0.1786, Test RMSE: 1.5863
Evaluate model on site 3 , Test MAE: 0.3449, Test MAPE: 0.0616, Test RMSE: 0.6917
Evaluate model on site 4 , Test MAE: 0.7911, Test MAPE: 0.0963, Test RMSE: 1.1648
Evaluate model on site 5 , Test MAE: 0.3999, Test MAPE: 0.0550, Test RMSE: 0.6821
Evaluate model on site 6 , Test MAE: 0.6516, Test MAPE: 0.0948, Test RMSE: 1.2621
Evaluate model on site 7 , Test MAE: 0.3967, Test MAPE: 0.0604, Test RMSE: 0.7493
Evaluate model on site 8 , Test MAE: 0.4268, Test MAPE: 0.0897, Test RMSE: 0.7212
Evaluate model on site 9 , Test MAE: 0.7622, Test MAPE: 0.1160, Test RMSE: 1.2220
Evaluate model on site 10 , Test MAE: 0.2372, Test MAPE: 0.2156, Test RMSE: 0.4068
On average over all site, Test MAE: 0.5534, Test MAPE: 0.1042, Test RMSE: 0.9467
(0.5534223064780235, 0.10418252423405647, 0.9467446595430374)
data::data/water/shangban/singleFac/1,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/1', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.8851721286773682
Validation loss decreased (inf --> 0.885172).  Saving model ...
Epoch:2,validate loss:0.5385431051254272
Validation loss decreased (0.885172 --> 0.538543).  Saving model ...
Epoch:3,validate loss:0.6074684262275696
Epoch:4,validate loss:0.4823818504810333
Validation loss decreased (0.538543 --> 0.482382).  Saving model ...
Epoch:5,validate loss:0.5307925343513489
Epoch:6,validate loss:0.534912645816803
Epoch:7,validate loss:0.49478983879089355
Epoch:8,validate loss:0.4806689918041229
Validation loss decreased (0.482382 --> 0.480669).  Saving model ...
Epoch:9,validate loss:0.48773735761642456
Epoch:10,validate loss:0.4911385178565979
Epoch:11,validate loss:0.4950600564479828
Epoch:12,validate loss:0.4674815833568573
Validation loss decreased (0.480669 --> 0.467482).  Saving model ...
Epoch:13,validate loss:0.4714888036251068
Epoch:14,validate loss:0.4886867105960846
Epoch:15,validate loss:0.47946202754974365
Epoch:16,validate loss:0.5260783433914185
Epoch:17,validate loss:0.47102436423301697
Epoch:18,validate loss:0.47275686264038086
Epoch:19,validate loss:0.4895249009132385
Epoch:20,validate loss:0.46510380506515503
Validation loss decreased (0.467482 --> 0.465104).  Saving model ...
Epoch:21,validate loss:0.4674921929836273
Epoch:22,validate loss:0.4681299030780792
Epoch:23,validate loss:0.4708847999572754
Epoch:24,validate loss:0.4661843180656433
Epoch:25,validate loss:0.4654105603694916
Epoch:26,validate loss:0.4679533839225769
Epoch:27,validate loss:0.48442572355270386
Epoch:28,validate loss:0.4621136486530304
Validation loss decreased (0.465104 --> 0.462114).  Saving model ...
Epoch:29,validate loss:0.4939442574977875
Epoch:30,validate loss:0.4931555688381195
Epoch:31,validate loss:0.4709777534008026
Epoch:32,validate loss:0.46790796518325806
Epoch:33,validate loss:0.46996811032295227
Epoch:34,validate loss:0.47459736466407776
Epoch:35,validate loss:0.48296332359313965
Epoch:36,validate loss:0.48784664273262024
Epoch:37,validate loss:0.4694393575191498
Epoch:38,validate loss:0.4998149871826172
Epoch:39,validate loss:0.47100701928138733
Epoch:40,validate loss:0.4699171185493469
Epoch:41,validate loss:0.46235302090644836
Epoch:42,validate loss:0.4671994149684906
Epoch:43,validate loss:0.47028034925460815
Epoch:44,validate loss:0.5026540160179138
Epoch:45,validate loss:0.48869001865386963
Epoch:46,validate loss:0.4907747507095337
Epoch:47,validate loss:0.4655001163482666
Epoch:48,validate loss:0.46136876940727234
Validation loss decreased (0.462114 --> 0.461369).  Saving model ...
Epoch:49,validate loss:0.46646222472190857
Epoch:50,validate loss:0.4664294719696045
Epoch:51,validate loss:0.467578649520874
Epoch:52,validate loss:0.471190869808197
Epoch:53,validate loss:0.4748857617378235
Epoch:54,validate loss:0.5022670030593872
Epoch:55,validate loss:0.49390268325805664
Epoch:56,validate loss:0.4758756160736084
Epoch:57,validate loss:0.5005638003349304
Epoch:58,validate loss:0.520979106426239
Epoch:59,validate loss:0.47756412625312805
Epoch:60,validate loss:0.4719426929950714
Epoch:61,validate loss:0.47668033838272095
Epoch:62,validate loss:0.4965726435184479
Epoch:63,validate loss:0.48141583800315857
Epoch:64,validate loss:0.4802766442298889
Epoch:65,validate loss:0.48519349098205566
Epoch:66,validate loss:0.47973909974098206
Epoch:67,validate loss:0.49110841751098633
Epoch:68,validate loss:0.4780154526233673
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.6235, Test MAPE: 0.0757, Test RMSE: 0.9929
Evaluate model on site 2 , Test MAE: 0.9372, Test MAPE: 0.1883, Test RMSE: 1.5908
Evaluate model on site 3 , Test MAE: 0.3387, Test MAPE: 0.0614, Test RMSE: 0.6700
Evaluate model on site 4 , Test MAE: 0.7925, Test MAPE: 0.0964, Test RMSE: 1.1652
Evaluate model on site 5 , Test MAE: 0.3984, Test MAPE: 0.0552, Test RMSE: 0.6728
Evaluate model on site 6 , Test MAE: 0.6312, Test MAPE: 0.0902, Test RMSE: 1.2364
Evaluate model on site 7 , Test MAE: 0.3924, Test MAPE: 0.0599, Test RMSE: 0.7350
Evaluate model on site 8 , Test MAE: 0.4267, Test MAPE: 0.0900, Test RMSE: 0.7221
Evaluate model on site 9 , Test MAE: 0.7852, Test MAPE: 0.1195, Test RMSE: 1.2644
Evaluate model on site 10 , Test MAE: 0.2362, Test MAPE: 0.2195, Test RMSE: 0.3996
On average over all site, Test MAE: 0.5562, Test MAPE: 0.1056, Test RMSE: 0.9449
(0.5562062561511993, 0.10560809224843978, 0.944907808303833)
[0.5482247099280357, 0.5499629661440849, 0.5531663715839386, 0.5534223064780235, 0.5562062561511993]
data::data/water/shangban/singleFac/1,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/1', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.6005252003669739
Validation loss decreased (inf --> 0.600525).  Saving model ...
Epoch:2,validate loss:0.5098612308502197
Validation loss decreased (0.600525 --> 0.509861).  Saving model ...
Epoch:3,validate loss:0.523334264755249
Epoch:4,validate loss:0.5134416818618774
Epoch:5,validate loss:0.4850688576698303
Validation loss decreased (0.509861 --> 0.485069).  Saving model ...
Epoch:6,validate loss:0.5179385542869568
Epoch:7,validate loss:0.49631398916244507
Epoch:8,validate loss:0.4898875057697296
Epoch:9,validate loss:0.500055193901062
Epoch:10,validate loss:0.47261521220207214
Validation loss decreased (0.485069 --> 0.472615).  Saving model ...
Epoch:11,validate loss:0.47131121158599854
Validation loss decreased (0.472615 --> 0.471311).  Saving model ...
Epoch:12,validate loss:0.5381985902786255
Epoch:13,validate loss:0.48880714178085327
Epoch:14,validate loss:0.4758997857570648
Epoch:15,validate loss:0.47092267870903015
Validation loss decreased (0.471311 --> 0.470923).  Saving model ...
Epoch:16,validate loss:0.4751017391681671
Epoch:17,validate loss:0.5041089653968811
Epoch:18,validate loss:0.4663016200065613
Validation loss decreased (0.470923 --> 0.466302).  Saving model ...
Epoch:19,validate loss:0.483979195356369
Epoch:20,validate loss:0.46763375401496887
Epoch:21,validate loss:0.47122958302497864
Epoch:22,validate loss:0.4886268675327301
Epoch:23,validate loss:0.4992581903934479
Epoch:24,validate loss:0.5033795833587646
Epoch:25,validate loss:0.47311392426490784
Epoch:26,validate loss:0.48263800144195557
Epoch:27,validate loss:0.4749194085597992
Epoch:28,validate loss:0.4954621493816376
Epoch:29,validate loss:0.49383559823036194
Epoch:30,validate loss:0.4626736044883728
Validation loss decreased (0.466302 --> 0.462674).  Saving model ...
Epoch:31,validate loss:0.4664554297924042
Epoch:32,validate loss:0.46454137563705444
Epoch:33,validate loss:0.4975658655166626
Epoch:34,validate loss:0.47050172090530396
Epoch:35,validate loss:0.4750254154205322
Epoch:36,validate loss:0.4572008550167084
Validation loss decreased (0.462674 --> 0.457201).  Saving model ...
Epoch:37,validate loss:0.46828946471214294
Epoch:38,validate loss:0.471017450094223
Epoch:39,validate loss:0.4613075256347656
Epoch:40,validate loss:0.4651471674442291
Epoch:41,validate loss:0.4847267270088196
Epoch:42,validate loss:0.4696490168571472
Epoch:43,validate loss:0.4834456741809845
Epoch:44,validate loss:0.4609844982624054
Epoch:45,validate loss:0.48987987637519836
Epoch:46,validate loss:0.4783102869987488
Epoch:47,validate loss:0.46104729175567627
Epoch:48,validate loss:0.47202157974243164
Epoch:49,validate loss:0.44771820306777954
Validation loss decreased (0.457201 --> 0.447718).  Saving model ...
Epoch:50,validate loss:0.4610294699668884
Epoch:51,validate loss:0.4845447242259979
Epoch:52,validate loss:0.47511664032936096
Epoch:53,validate loss:0.4702118933200836
Epoch:54,validate loss:0.46148988604545593
Epoch:55,validate loss:0.4641539454460144
Epoch:56,validate loss:0.4649050533771515
Epoch:57,validate loss:0.5050504207611084
Epoch:58,validate loss:0.46823975443840027
Epoch:59,validate loss:0.4623677730560303
Epoch:60,validate loss:0.47719430923461914
Epoch:61,validate loss:0.4980999827384949
Epoch:62,validate loss:0.4720461666584015
Epoch:63,validate loss:0.45983609557151794
Epoch:64,validate loss:0.4684513509273529
Epoch:65,validate loss:0.46339964866638184
Epoch:66,validate loss:0.47694796323776245
Epoch:67,validate loss:0.47595876455307007
Epoch:68,validate loss:0.46706050634384155
Epoch:69,validate loss:0.4753603935241699
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
0.01288454,0.0017671009,0.0017671009,0.0017671009,0.9729787,0.0017671009,0.0017671009,0.0017671009,0.0017671009,0.0017671009,
5.368553e-08,1.4265137e-08,0.9999976,1.4265137e-08,1.1417388e-06,1.5481763e-08,1.4265137e-08,1.4265137e-08,1.4265137e-08,1.1037201e-06,
6.544069e-07,4.9813866e-07,4.9813866e-07,0.99882656,4.9813866e-07,1.3070663e-05,4.9813866e-07,0.00041281572,4.9813866e-07,0.0007444859,
0.0018902557,4.644867e-06,9.621406e-06,4.644867e-06,0.00035810628,4.644867e-06,4.644867e-06,0.9976845,3.432138e-05,4.644867e-06,
1.7610883e-08,1.7610883e-08,1.7610883e-08,2.2929626e-07,2.779973e-07,1.7610883e-08,4.0200903e-05,0.9973628,1.7610883e-08,0.0025964193,
5.24588e-05,4.573668e-08,0.9999472,4.573668e-08,4.573668e-08,4.573668e-08,4.573668e-08,4.573668e-08,4.573668e-08,4.573668e-08,
0.99696547,1.9259794e-06,1.9143467e-07,0.0029947206,2.5198406e-07,3.451652e-05,1.1720388e-06,7.723051e-08,1.6720868e-06,1.2174816e-07,
1.1025865e-08,3.7483805e-12,0.99769944,9.5373995e-12,1.7117337e-08,3.7483805e-12,6.3550144e-11,3.7483805e-12,0.0023005896,3.7483805e-12,
0.00019182244,2.827548e-06,0.00074441184,0.0003015233,2.827548e-06,0.9987453,2.827548e-06,2.827548e-06,2.827548e-06,2.827548e-06,
7.923872e-08,7.923872e-08,7.923872e-08,7.923872e-08,0.0006184032,7.923872e-08,7.923872e-08,0.00015633355,0.99922466,7.923872e-08,
Evaluate model on site 1 , Test MAE: 0.6002, Test MAPE: 0.0728, Test RMSE: 0.9708
Evaluate model on site 2 , Test MAE: 0.9069, Test MAPE: 0.1831, Test RMSE: 1.5592
Evaluate model on site 3 , Test MAE: 0.3374, Test MAPE: 0.0580, Test RMSE: 0.6786
Evaluate model on site 4 , Test MAE: 0.7460, Test MAPE: 0.0937, Test RMSE: 1.0906
Evaluate model on site 5 , Test MAE: 0.3958, Test MAPE: 0.0565, Test RMSE: 0.6547
Evaluate model on site 6 , Test MAE: 0.6316, Test MAPE: 0.0903, Test RMSE: 1.2004
Evaluate model on site 7 , Test MAE: 0.3756, Test MAPE: 0.0571, Test RMSE: 0.7288
Evaluate model on site 8 , Test MAE: 0.4261, Test MAPE: 0.0897, Test RMSE: 0.7248
Evaluate model on site 9 , Test MAE: 0.7657, Test MAPE: 0.1164, Test RMSE: 1.2352
Evaluate model on site 10 , Test MAE: 0.2410, Test MAPE: 0.2216, Test RMSE: 0.4008
On average over all site, Test MAE: 0.5426, Test MAPE: 0.1039, Test RMSE: 0.9244
(0.5426377460360527, 0.10392593368887901, 0.924393019080162)
data::data/water/shangban/singleFac/1,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/1', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.6017082333564758
Validation loss decreased (inf --> 0.601708).  Saving model ...
Epoch:2,validate loss:0.5453319549560547
Validation loss decreased (0.601708 --> 0.545332).  Saving model ...
Epoch:3,validate loss:0.4904007911682129
Validation loss decreased (0.545332 --> 0.490401).  Saving model ...
Epoch:4,validate loss:0.4819052219390869
Validation loss decreased (0.490401 --> 0.481905).  Saving model ...
Epoch:5,validate loss:0.48726382851600647
Epoch:6,validate loss:0.4836815893650055
Epoch:7,validate loss:0.4754087030887604
Validation loss decreased (0.481905 --> 0.475409).  Saving model ...
Epoch:8,validate loss:0.49834051728248596
Epoch:9,validate loss:0.47377917170524597
Validation loss decreased (0.475409 --> 0.473779).  Saving model ...
Epoch:10,validate loss:0.5233396887779236
Epoch:11,validate loss:0.4851018488407135
Epoch:12,validate loss:0.4765926003456116
Epoch:13,validate loss:0.47246381640434265
Validation loss decreased (0.473779 --> 0.472464).  Saving model ...
Epoch:14,validate loss:0.4959228038787842
Epoch:15,validate loss:0.4617402255535126
Validation loss decreased (0.472464 --> 0.461740).  Saving model ...
Epoch:16,validate loss:0.48307955265045166
Epoch:17,validate loss:0.4628412425518036
Epoch:18,validate loss:0.5082532167434692
Epoch:19,validate loss:0.46379804611206055
Epoch:20,validate loss:0.47247812151908875
Epoch:21,validate loss:0.46159568428993225
Validation loss decreased (0.461740 --> 0.461596).  Saving model ...
Epoch:22,validate loss:0.5400342345237732
Epoch:23,validate loss:0.4693422019481659
Epoch:24,validate loss:0.48716413974761963
Epoch:25,validate loss:0.4609766900539398
Validation loss decreased (0.461596 --> 0.460977).  Saving model ...
Epoch:26,validate loss:0.5083546042442322
Epoch:27,validate loss:0.4571860730648041
Validation loss decreased (0.460977 --> 0.457186).  Saving model ...
Epoch:28,validate loss:0.48730960488319397
Epoch:29,validate loss:0.4782654941082001
Epoch:30,validate loss:0.4543662667274475
Validation loss decreased (0.457186 --> 0.454366).  Saving model ...
Epoch:31,validate loss:0.4780067801475525
Epoch:32,validate loss:0.4638421833515167
Epoch:33,validate loss:0.467883437871933
Epoch:34,validate loss:0.47210952639579773
Epoch:35,validate loss:0.47231772541999817
Epoch:36,validate loss:0.47147876024246216
Epoch:37,validate loss:0.46060672402381897
Epoch:38,validate loss:0.45642784237861633
Epoch:39,validate loss:0.4573413133621216
Epoch:40,validate loss:0.4562380015850067
Epoch:41,validate loss:0.4708000123500824
Epoch:42,validate loss:0.48569121956825256
Epoch:43,validate loss:0.4756529629230499
Epoch:44,validate loss:0.46327945590019226
Epoch:45,validate loss:0.468696653842926
Epoch:46,validate loss:0.4561360776424408
Epoch:47,validate loss:0.47834959626197815
Epoch:48,validate loss:0.4727461040019989
Epoch:49,validate loss:0.4611891806125641
Epoch:50,validate loss:0.4740343391895294
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
2.4445308e-08,0.99784064,0.00062981923,2.4445308e-08,2.4445308e-08,0.00018982714,8.774162e-08,0.0009040028,3.236381e-06,0.0004322339,
2.2046443e-05,2.2046443e-05,2.2046443e-05,2.2046443e-05,2.2046443e-05,2.2046443e-05,0.00047250258,2.2046443e-05,2.2046443e-05,0.9993512,
4.426426e-08,1.250939e-07,5.3834738e-05,0.9991289,4.426426e-08,4.426426e-08,2.4610406e-06,4.426426e-08,4.6594792e-05,0.0007679381,
6.890853e-08,6.890853e-08,0.9995407,6.890853e-08,6.890853e-08,0.00037748498,6.890853e-08,6.890853e-08,8.1382204e-05,6.890853e-08,
3.5955579e-12,2.2647403e-06,3.5955579e-12,3.690188e-08,3.5955579e-12,1.2924212e-06,3.0665418e-11,0.9999964,7.8912665e-10,3.959733e-12,
1.10029255e-13,4.595497e-05,6.249233e-14,0.999954,7.0794575e-18,7.0794575e-18,4.9974894e-12,9.307156e-18,7.0794575e-18,7.0794575e-18,
6.0087864e-09,6.190198e-05,5.450752e-07,0.0003608196,6.0087864e-09,7.1849195e-07,0.9995759,6.0087864e-09,1.4411828e-08,6.0087864e-09,
6.6448716e-05,6.6448716e-05,6.6448716e-05,6.6448716e-05,6.6448716e-05,0.41195023,6.6448716e-05,0.58605015,6.6448716e-05,0.0015345246,
0.0017073867,8.9536525e-06,9.623908e-07,9.623908e-07,0.9967308,9.623908e-07,0.0007346344,0.0007100324,9.623908e-07,0.000104265484,
4.323706e-08,6.673964e-08,6.3877376e-10,0.98095566,1.4980225e-08,6.3877376e-10,6.3877376e-10,0.018997906,4.156265e-09,4.627832e-05,
Evaluate model on site 1 , Test MAE: 0.5908, Test MAPE: 0.0724, Test RMSE: 0.9814
Evaluate model on site 2 , Test MAE: 0.9012, Test MAPE: 0.1788, Test RMSE: 1.5471
Evaluate model on site 3 , Test MAE: 0.3437, Test MAPE: 0.0584, Test RMSE: 0.6892
Evaluate model on site 4 , Test MAE: 0.7629, Test MAPE: 0.0937, Test RMSE: 1.0848
Evaluate model on site 5 , Test MAE: 0.3914, Test MAPE: 0.0555, Test RMSE: 0.6603
Evaluate model on site 6 , Test MAE: 0.6269, Test MAPE: 0.0901, Test RMSE: 1.2221
Evaluate model on site 7 , Test MAE: 0.3581, Test MAPE: 0.0541, Test RMSE: 0.6983
Evaluate model on site 8 , Test MAE: 0.4212, Test MAPE: 0.0888, Test RMSE: 0.7151
Evaluate model on site 9 , Test MAE: 0.7661, Test MAPE: 0.1169, Test RMSE: 1.2510
Evaluate model on site 10 , Test MAE: 0.2302, Test MAPE: 0.2157, Test RMSE: 0.3812
On average over all site, Test MAE: 0.5392, Test MAPE: 0.1024, Test RMSE: 0.9231
(0.5392474487423897, 0.10242460407316685, 0.9230532139539719)
data::data/water/shangban/singleFac/1,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/1', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.6405028104782104
Validation loss decreased (inf --> 0.640503).  Saving model ...
Epoch:2,validate loss:0.5362644195556641
Validation loss decreased (0.640503 --> 0.536264).  Saving model ...
Epoch:3,validate loss:0.5369995832443237
Epoch:4,validate loss:0.5197635889053345
Validation loss decreased (0.536264 --> 0.519764).  Saving model ...
Epoch:5,validate loss:0.5057947635650635
Validation loss decreased (0.519764 --> 0.505795).  Saving model ...
Epoch:6,validate loss:0.4837620258331299
Validation loss decreased (0.505795 --> 0.483762).  Saving model ...
Epoch:7,validate loss:0.48778069019317627
Epoch:8,validate loss:0.473254919052124
Validation loss decreased (0.483762 --> 0.473255).  Saving model ...
Epoch:9,validate loss:0.4894559681415558
Epoch:10,validate loss:0.47135597467422485
Validation loss decreased (0.473255 --> 0.471356).  Saving model ...
Epoch:11,validate loss:0.4721096158027649
Epoch:12,validate loss:0.47075310349464417
Validation loss decreased (0.471356 --> 0.470753).  Saving model ...
Epoch:13,validate loss:0.5003296136856079
Epoch:14,validate loss:0.483121395111084
Epoch:15,validate loss:0.4802490472793579
Epoch:16,validate loss:0.475460022687912
Epoch:17,validate loss:0.4823281764984131
Epoch:18,validate loss:0.4581257104873657
Validation loss decreased (0.470753 --> 0.458126).  Saving model ...
Epoch:19,validate loss:0.48554474115371704
Epoch:20,validate loss:0.46014368534088135
Epoch:21,validate loss:0.4977894723415375
Epoch:22,validate loss:0.4626220166683197
Epoch:23,validate loss:0.5095592737197876
Epoch:24,validate loss:0.4693910777568817
Epoch:25,validate loss:0.4576755166053772
Validation loss decreased (0.458126 --> 0.457676).  Saving model ...
Epoch:26,validate loss:0.4730776250362396
Epoch:27,validate loss:0.46390941739082336
Epoch:28,validate loss:0.46390244364738464
Epoch:29,validate loss:0.4880577325820923
Epoch:30,validate loss:0.4714677929878235
Epoch:31,validate loss:0.4758276045322418
Epoch:32,validate loss:0.465427964925766
Epoch:33,validate loss:0.46418532729148865
Epoch:34,validate loss:0.48169654607772827
Epoch:35,validate loss:0.4758022427558899
Epoch:36,validate loss:0.4626324474811554
Epoch:37,validate loss:0.4914645850658417
Epoch:38,validate loss:0.5057846903800964
Epoch:39,validate loss:0.4773843586444855
Epoch:40,validate loss:0.4655629098415375
Epoch:41,validate loss:0.4771459102630615
Epoch:42,validate loss:0.475027471780777
Epoch:43,validate loss:0.47683069109916687
Epoch:44,validate loss:0.46631157398223877
Epoch:45,validate loss:0.4593128561973572
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
5.7184934e-08,0.9999999,1.376291e-13,2.3785654e-10,1.7773075e-08,5.3246657e-11,1.4261276e-12,1.376291e-13,1.376291e-13,1.376291e-13,
1.10218025e-05,2.1237357e-11,0.00037401257,2.1237357e-11,2.1237357e-11,2.3916454e-11,2.1237357e-11,1.0878963e-05,0.99960417,2.1237357e-11,
1.0,2.8702485e-13,2.8702485e-13,1.1274862e-09,2.8702485e-13,5.8438406e-08,2.8702485e-13,1.5997644e-11,1.4018845e-09,2.8702485e-13,
1.2474737e-07,0.9992311,1.2474737e-07,1.2474737e-07,0.00076622795,1.2474737e-07,7.2753295e-07,1.2474737e-07,1.2474737e-07,1.210177e-06,
5.7305946e-14,9.631366e-16,1.3010343e-09,1.0878248e-12,9.2620345e-10,9.631366e-16,0.97736394,9.631366e-16,9.631366e-16,0.022636076,
4.008131e-05,8.2761304e-08,1.6785297e-12,1.6785297e-12,0.0022772767,2.3794278e-12,1.6785297e-12,0.99768245,1.1846656e-09,2.7994675e-08,
6.1824704e-13,3.8303285e-09,6.1824704e-13,6.1824704e-13,0.99855775,6.1824704e-13,6.1824704e-13,6.1824704e-13,1.6996615e-10,0.0014421947,
0.0004956576,0.99947923,8.503704e-09,8.503704e-09,9.254391e-06,8.503704e-09,1.1321725e-06,8.503704e-09,8.503704e-09,1.4761816e-05,
0.00033857385,6.6425563e-09,6.6425563e-09,6.6425563e-09,6.6425563e-09,6.6425563e-09,0.9996226,3.7542657e-05,1.2354618e-06,6.6425563e-09,
1.3546998e-09,1.3546998e-09,1.5407535e-07,1.3546998e-09,0.00060374365,0.999313,8.24101e-05,6.876867e-07,1.3546998e-09,1.3546998e-09,
Evaluate model on site 1 , Test MAE: 0.6025, Test MAPE: 0.0731, Test RMSE: 0.9901
Evaluate model on site 2 , Test MAE: 0.9011, Test MAPE: 0.1773, Test RMSE: 1.5145
Evaluate model on site 3 , Test MAE: 0.3315, Test MAPE: 0.0568, Test RMSE: 0.6725
Evaluate model on site 4 , Test MAE: 0.7814, Test MAPE: 0.0952, Test RMSE: 1.1558
Evaluate model on site 5 , Test MAE: 0.3844, Test MAPE: 0.0530, Test RMSE: 0.6578
Evaluate model on site 6 , Test MAE: 0.6200, Test MAPE: 0.0885, Test RMSE: 1.2115
Evaluate model on site 7 , Test MAE: 0.3771, Test MAPE: 0.0572, Test RMSE: 0.7026
Evaluate model on site 8 , Test MAE: 0.4190, Test MAPE: 0.0881, Test RMSE: 0.7054
Evaluate model on site 9 , Test MAE: 0.7601, Test MAPE: 0.1146, Test RMSE: 1.2381
Evaluate model on site 10 , Test MAE: 0.2376, Test MAPE: 0.2139, Test RMSE: 0.3996
On average over all site, Test MAE: 0.5415, Test MAPE: 0.1018, Test RMSE: 0.9248
(0.5414702534675598, 0.10176344700157643, 0.9248065829277039)
data::data/water/shangban/singleFac/1,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/1', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.6861114501953125
Validation loss decreased (inf --> 0.686111).  Saving model ...
Epoch:2,validate loss:0.5512160658836365
Validation loss decreased (0.686111 --> 0.551216).  Saving model ...
Epoch:3,validate loss:0.48346585035324097
Validation loss decreased (0.551216 --> 0.483466).  Saving model ...
Epoch:4,validate loss:0.48682332038879395
Epoch:5,validate loss:0.4709177017211914
Validation loss decreased (0.483466 --> 0.470918).  Saving model ...
Epoch:6,validate loss:0.47911855578422546
Epoch:7,validate loss:0.4887780547142029
Epoch:8,validate loss:0.47652769088745117
Epoch:9,validate loss:0.4967253506183624
Epoch:10,validate loss:0.46566441655158997
Validation loss decreased (0.470918 --> 0.465664).  Saving model ...
Epoch:11,validate loss:0.47876137495040894
Epoch:12,validate loss:0.4737831950187683
Epoch:13,validate loss:0.47971677780151367
Epoch:14,validate loss:0.4707152843475342
Epoch:15,validate loss:0.4808240532875061
Epoch:16,validate loss:0.46208637952804565
Validation loss decreased (0.465664 --> 0.462086).  Saving model ...
Epoch:17,validate loss:0.455325722694397
Validation loss decreased (0.462086 --> 0.455326).  Saving model ...
Epoch:18,validate loss:0.48951098322868347
Epoch:19,validate loss:0.4718090891838074
Epoch:20,validate loss:0.47708821296691895
Epoch:21,validate loss:0.47691911458969116
Epoch:22,validate loss:0.4658190608024597
Epoch:23,validate loss:0.4566551744937897
Epoch:24,validate loss:0.45844435691833496
Epoch:25,validate loss:0.4609527289867401
Epoch:26,validate loss:0.4681303799152374
Epoch:27,validate loss:0.508107602596283
Epoch:28,validate loss:0.48404553532600403
Epoch:29,validate loss:0.48363348841667175
Epoch:30,validate loss:0.4654330313205719
Epoch:31,validate loss:0.48225513100624084
Epoch:32,validate loss:0.4563368260860443
Epoch:33,validate loss:0.45497825741767883
Validation loss decreased (0.455326 --> 0.454978).  Saving model ...
Epoch:34,validate loss:0.4482772946357727
Validation loss decreased (0.454978 --> 0.448277).  Saving model ...
Epoch:35,validate loss:0.4717974066734314
Epoch:36,validate loss:0.4508846402168274
Epoch:37,validate loss:0.4828662872314453
Epoch:38,validate loss:0.49488961696624756
Epoch:39,validate loss:0.46161335706710815
Epoch:40,validate loss:0.452626496553421
Epoch:41,validate loss:0.4530182182788849
Epoch:42,validate loss:0.46094274520874023
Epoch:43,validate loss:0.4656198024749756
Epoch:44,validate loss:0.45377403497695923
Epoch:45,validate loss:0.44775596261024475
Validation loss decreased (0.448277 --> 0.447756).  Saving model ...
Epoch:46,validate loss:0.4594174921512604
Epoch:47,validate loss:0.4789060950279236
Epoch:48,validate loss:0.46745121479034424
Epoch:49,validate loss:0.47393515706062317
Epoch:50,validate loss:0.4512978494167328
Epoch:51,validate loss:0.4610656797885895
Epoch:52,validate loss:0.4639012813568115
Epoch:53,validate loss:0.4823732078075409
Epoch:54,validate loss:0.49079349637031555
Epoch:55,validate loss:0.4611159861087799
Epoch:56,validate loss:0.45682206749916077
Epoch:57,validate loss:0.4620923697948456
Epoch:58,validate loss:0.47412359714508057
Epoch:59,validate loss:0.4773799479007721
Epoch:60,validate loss:0.4596768617630005
Epoch:61,validate loss:0.465789258480072
Epoch:62,validate loss:0.46905532479286194
Epoch:63,validate loss:0.460513710975647
Epoch:64,validate loss:0.4599662721157074
Epoch:65,validate loss:0.46322837471961975
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
1.2262736e-08,0.0026460988,0.9956462,0.0007696813,5.3706617e-07,7.3278948e-06,2.8194433e-08,1.2262736e-08,0.00093004794,1.2262736e-08,
7.4470804e-06,0.0002849488,0.00032455547,0.99717855,1.0188081e-05,7.4470804e-06,7.4470804e-06,7.4470804e-06,0.0005741951,0.0015977276,
0.0009266094,1.4150005e-05,2.4226753e-07,2.4226753e-07,4.3521013e-06,6.7612274e-07,2.4226753e-07,0.00019811063,0.9988551,2.4226753e-07,
0.00013855693,1.6328952e-06,0.00044014677,0.0041673374,0.0018294443,1.6328952e-06,1.6328952e-06,1.6328952e-06,0.99330235,0.00011570893,
1.1937927e-14,0.0068699596,0.99313,1.1937927e-14,9.537979e-10,8.33903e-14,1.1937927e-14,3.2587e-13,1.1937927e-14,1.1937927e-14,
0.00010862816,0.9994993,3.935364e-06,0.00019864737,8.468365e-05,3.935364e-06,3.935364e-06,8.4171086e-05,3.935364e-06,8.7267e-06,
0.0001776109,0.0001776109,0.0001776109,0.0001776109,0.0001776109,0.99840146,0.0001776109,0.0001776109,0.0001776109,0.0001776109,
0.0001848603,0.007830756,0.00012618526,8.342755e-05,8.342755e-05,8.342755e-05,0.0008656155,0.99057555,8.342755e-05,8.342755e-05,
3.698758e-07,9.484863e-07,0.9999925,3.698758e-07,3.698758e-07,3.698758e-07,3.0761478e-06,3.698758e-07,1.2908001e-06,3.698758e-07,
0.9971951,2.8392882e-05,0.0007265134,2.8392882e-05,2.8392882e-05,2.8392882e-05,0.00015427812,2.8392882e-05,0.001753703,2.8392882e-05,
Evaluate model on site 1 , Test MAE: 0.6087, Test MAPE: 0.0741, Test RMSE: 0.9919
Evaluate model on site 2 , Test MAE: 0.9142, Test MAPE: 0.1830, Test RMSE: 1.5660
Evaluate model on site 3 , Test MAE: 0.3479, Test MAPE: 0.0616, Test RMSE: 0.6811
Evaluate model on site 4 , Test MAE: 0.7760, Test MAPE: 0.0964, Test RMSE: 1.1307
Evaluate model on site 5 , Test MAE: 0.3784, Test MAPE: 0.0527, Test RMSE: 0.6505
Evaluate model on site 6 , Test MAE: 0.6505, Test MAPE: 0.0938, Test RMSE: 1.2478
Evaluate model on site 7 , Test MAE: 0.3722, Test MAPE: 0.0564, Test RMSE: 0.7252
Evaluate model on site 8 , Test MAE: 0.4185, Test MAPE: 0.0884, Test RMSE: 0.7126
Evaluate model on site 9 , Test MAE: 0.7665, Test MAPE: 0.1172, Test RMSE: 1.2410
Evaluate model on site 10 , Test MAE: 0.2281, Test MAPE: 0.2177, Test RMSE: 0.3833
On average over all site, Test MAE: 0.5461, Test MAPE: 0.1041, Test RMSE: 0.9330
(0.5460929721593857, 0.10414726920425892, 0.9330047279596329)
data::data/water/shangban/singleFac/1,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/1', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.7363004088401794
Validation loss decreased (inf --> 0.736300).  Saving model ...
Epoch:2,validate loss:0.5425156950950623
Validation loss decreased (0.736300 --> 0.542516).  Saving model ...
Epoch:3,validate loss:0.5070419311523438
Validation loss decreased (0.542516 --> 0.507042).  Saving model ...
Epoch:4,validate loss:0.48394134640693665
Validation loss decreased (0.507042 --> 0.483941).  Saving model ...
Epoch:5,validate loss:0.4715362787246704
Validation loss decreased (0.483941 --> 0.471536).  Saving model ...
Epoch:6,validate loss:0.46960386633872986
Validation loss decreased (0.471536 --> 0.469604).  Saving model ...
Epoch:7,validate loss:0.4669000208377838
Validation loss decreased (0.469604 --> 0.466900).  Saving model ...
Epoch:8,validate loss:0.48235952854156494
Epoch:9,validate loss:0.5008968710899353
Epoch:10,validate loss:0.5320636034011841
Epoch:11,validate loss:0.503984808921814
Epoch:12,validate loss:0.5191807746887207
Epoch:13,validate loss:0.518004834651947
Epoch:14,validate loss:0.46422940492630005
Validation loss decreased (0.466900 --> 0.464229).  Saving model ...
Epoch:15,validate loss:0.5044805407524109
Epoch:16,validate loss:0.4659776985645294
Epoch:17,validate loss:0.47321540117263794
Epoch:18,validate loss:0.4642973840236664
Epoch:19,validate loss:0.5005732774734497
Epoch:20,validate loss:0.48723146319389343
Epoch:21,validate loss:0.4808294177055359
Epoch:22,validate loss:0.49292463064193726
Epoch:23,validate loss:0.46209314465522766
Validation loss decreased (0.464229 --> 0.462093).  Saving model ...
Epoch:24,validate loss:0.44876131415367126
Validation loss decreased (0.462093 --> 0.448761).  Saving model ...
Epoch:25,validate loss:0.4574684202671051
Epoch:26,validate loss:0.45912986993789673
Epoch:27,validate loss:0.4582313001155853
Epoch:28,validate loss:0.445732980966568
Validation loss decreased (0.448761 --> 0.445733).  Saving model ...
Epoch:29,validate loss:0.46938860416412354
Epoch:30,validate loss:0.44891905784606934
Epoch:31,validate loss:0.45913368463516235
Epoch:32,validate loss:0.45702242851257324
Epoch:33,validate loss:0.4560204744338989
Epoch:34,validate loss:0.4577265679836273
Epoch:35,validate loss:0.4473065435886383
Epoch:36,validate loss:0.47822582721710205
Epoch:37,validate loss:0.46690845489501953
Epoch:38,validate loss:0.45404163002967834
Epoch:39,validate loss:0.46442288160324097
Epoch:40,validate loss:0.5018394589424133
Epoch:41,validate loss:0.45801520347595215
Epoch:42,validate loss:0.4443064033985138
Validation loss decreased (0.445733 --> 0.444306).  Saving model ...
Epoch:43,validate loss:0.4527340829372406
Epoch:44,validate loss:0.4441280961036682
Validation loss decreased (0.444306 --> 0.444128).  Saving model ...
Epoch:45,validate loss:0.46778517961502075
Epoch:46,validate loss:0.4561968147754669
Epoch:47,validate loss:0.45019426941871643
Epoch:48,validate loss:0.4449782967567444
Epoch:49,validate loss:0.4548652172088623
Epoch:50,validate loss:0.4767388701438904
Epoch:51,validate loss:0.4704356789588928
Epoch:52,validate loss:0.4607304632663727
Epoch:53,validate loss:0.45215243101119995
Epoch:54,validate loss:0.4580673575401306
Epoch:55,validate loss:0.44810813665390015
Epoch:56,validate loss:0.4548949599266052
Epoch:57,validate loss:0.4683248698711395
Epoch:58,validate loss:0.4723663926124573
Epoch:59,validate loss:0.47292715311050415
Epoch:60,validate loss:0.4702479839324951
Epoch:61,validate loss:0.4642835557460785
Epoch:62,validate loss:0.46623045206069946
Epoch:63,validate loss:0.4523564279079437
Epoch:64,validate loss:0.4674956500530243
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
0.9937391,7.248096e-06,0.0062536476,7.214471e-13,4.8780635e-10,9.635294e-11,1.533617e-09,7.214471e-13,6.7086875e-10,1.4602584e-10,
0.0009395952,0.9986914,0.00036214569,9.947587e-07,9.947587e-07,9.947587e-07,9.947587e-07,9.947587e-07,9.947587e-07,9.947587e-07,
0.09708447,0.09708447,0.09708447,0.09708447,0.09708447,0.09708447,0.09708447,0.09708447,0.12623975,0.09708447,
1.2300495e-05,0.0008121158,1.2300495e-05,1.2300495e-05,1.2300495e-05,1.2300495e-05,0.9989305,1.2300495e-05,1.2300495e-05,0.00017124474,
4.4395483e-06,0.010056598,4.4395483e-06,4.4395483e-06,4.4395483e-06,0.0155343665,4.1858973e-05,0.9742766,4.4395483e-06,6.841007e-05,
0.0011707296,1.3041425e-06,0.00015475649,1.3041425e-06,0.000115463416,1.3041425e-06,0.00011806411,1.3041425e-06,0.9984345,1.3041425e-06,
7.1192396e-08,7.1192396e-08,2.5041282e-07,8.749741e-07,3.7334365e-05,2.0919624e-05,7.1192396e-08,0.9999126,7.5328103e-06,2.0219688e-05,
3.1750074e-07,0.0011825458,0.9978289,4.4160893e-07,3.1750074e-07,0.000742341,3.46028e-05,0.0002098981,3.1750074e-07,3.1750074e-07,
3.3564304e-10,0.00012459248,3.3564304e-10,8.873133e-08,7.1125866e-10,0.9964539,9.2574474e-08,3.3564304e-10,5.9262975e-06,0.0034153254,
1.2799133e-05,0.0017136537,0.99601895,1.2799133e-05,1.2799133e-05,1.2799133e-05,0.00032073143,0.0018699886,1.2799133e-05,1.2799133e-05,
Evaluate model on site 1 , Test MAE: 0.6116, Test MAPE: 0.0740, Test RMSE: 0.9826
Evaluate model on site 2 , Test MAE: 0.8998, Test MAPE: 0.1861, Test RMSE: 1.5327
Evaluate model on site 3 , Test MAE: 0.3363, Test MAPE: 0.0579, Test RMSE: 0.6807
Evaluate model on site 4 , Test MAE: 0.7861, Test MAPE: 0.0960, Test RMSE: 1.1537
Evaluate model on site 5 , Test MAE: 0.3843, Test MAPE: 0.0538, Test RMSE: 0.6588
Evaluate model on site 6 , Test MAE: 0.6502, Test MAPE: 0.0918, Test RMSE: 1.2308
Evaluate model on site 7 , Test MAE: 0.3735, Test MAPE: 0.0565, Test RMSE: 0.7107
Evaluate model on site 8 , Test MAE: 0.4285, Test MAPE: 0.0900, Test RMSE: 0.7253
Evaluate model on site 9 , Test MAE: 0.8082, Test MAPE: 0.1220, Test RMSE: 1.2839
Evaluate model on site 10 , Test MAE: 0.2317, Test MAPE: 0.2166, Test RMSE: 0.3899
On average over all site, Test MAE: 0.5510, Test MAPE: 0.1045, Test RMSE: 0.9349
(0.5510080173611641, 0.10446159578859807, 0.9349176466464997)
[0.5426377460360527, 0.5392474487423897, 0.5414702534675598, 0.5460929721593857, 0.5510080173611641]
data::data/water/shangban/singleFac/2,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/2', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.09225038439035416
Validation loss decreased (inf --> 0.092250).  Saving model ...
Epoch:2,validate loss:0.05495414882898331
Validation loss decreased (0.092250 --> 0.054954).  Saving model ...
Epoch:3,validate loss:0.05233561620116234
Validation loss decreased (0.054954 --> 0.052336).  Saving model ...
Epoch:4,validate loss:0.05646144971251488
Epoch:5,validate loss:0.04773901402950287
Validation loss decreased (0.052336 --> 0.047739).  Saving model ...
Epoch:6,validate loss:0.04967445135116577
Epoch:7,validate loss:0.04769665747880936
Validation loss decreased (0.047739 --> 0.047697).  Saving model ...
Epoch:8,validate loss:0.047125935554504395
Validation loss decreased (0.047697 --> 0.047126).  Saving model ...
Epoch:9,validate loss:0.049519579857587814
Epoch:10,validate loss:0.050691165030002594
Epoch:11,validate loss:0.05632556602358818
Epoch:12,validate loss:0.05578973516821861
Epoch:13,validate loss:0.05911846458911896
Epoch:14,validate loss:0.04925227165222168
Epoch:15,validate loss:0.048847757279872894
Epoch:16,validate loss:0.046598173677921295
Validation loss decreased (0.047126 --> 0.046598).  Saving model ...
Epoch:17,validate loss:0.051667071878910065
Epoch:18,validate loss:0.047479208558797836
Epoch:19,validate loss:0.04654109850525856
Validation loss decreased (0.046598 --> 0.046541).  Saving model ...
Epoch:20,validate loss:0.05121641978621483
Epoch:21,validate loss:0.04756451025605202
Epoch:22,validate loss:0.04878213629126549
Epoch:23,validate loss:0.05273253470659256
Epoch:24,validate loss:0.05046912282705307
Epoch:25,validate loss:0.046518392860889435
Validation loss decreased (0.046541 --> 0.046518).  Saving model ...
Epoch:26,validate loss:0.04953569173812866
Epoch:27,validate loss:0.04898109659552574
Epoch:28,validate loss:0.051936741918325424
Epoch:29,validate loss:0.04862355813384056
Epoch:30,validate loss:0.04738296940922737
Epoch:31,validate loss:0.048747312277555466
Epoch:32,validate loss:0.0462176613509655
Validation loss decreased (0.046518 --> 0.046218).  Saving model ...
Epoch:33,validate loss:0.04660214111208916
Epoch:34,validate loss:0.05020612105727196
Epoch:35,validate loss:0.049622103571891785
Epoch:36,validate loss:0.0466851182281971
Epoch:37,validate loss:0.05123044177889824
Epoch:38,validate loss:0.04848244786262512
Epoch:39,validate loss:0.047855522483587265
Epoch:40,validate loss:0.04876071959733963
Epoch:41,validate loss:0.04750474914908409
Epoch:42,validate loss:0.048438653349876404
Epoch:43,validate loss:0.0504162572324276
Epoch:44,validate loss:0.046550601720809937
Epoch:45,validate loss:0.046128228306770325
Validation loss decreased (0.046218 --> 0.046128).  Saving model ...
Epoch:46,validate loss:0.0470980666577816
Epoch:47,validate loss:0.04788869619369507
Epoch:48,validate loss:0.04873215779662132
Epoch:49,validate loss:0.04778818413615227
Epoch:50,validate loss:0.04666370898485184
Epoch:51,validate loss:0.046469446271657944
Epoch:52,validate loss:0.047318462282419205
Epoch:53,validate loss:0.04959859699010849
Epoch:54,validate loss:0.04658649116754532
Epoch:55,validate loss:0.04638548940420151
Epoch:56,validate loss:0.04762490466237068
Epoch:57,validate loss:0.04803982749581337
Epoch:58,validate loss:0.047910671681165695
Epoch:59,validate loss:0.04698266461491585
Epoch:60,validate loss:0.048546526581048965
Epoch:61,validate loss:0.046237554401159286
Epoch:62,validate loss:0.04774824157357216
Epoch:63,validate loss:0.04663960263133049
Epoch:64,validate loss:0.04875774309039116
Epoch:65,validate loss:0.04736220836639404
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.0510, Test MAPE: 0.0615, Test RMSE: 0.0911
Evaluate model on site 2 , Test MAE: 0.0691, Test MAPE: 0.0983, Test RMSE: 0.1171
Evaluate model on site 3 , Test MAE: 0.0328, Test MAPE: 0.1356, Test RMSE: 0.0873
Evaluate model on site 4 , Test MAE: 0.0605, Test MAPE: 0.2023, Test RMSE: 0.1077
Evaluate model on site 5 , Test MAE: 0.0393, Test MAPE: 0.0969, Test RMSE: 0.0768
Evaluate model on site 6 , Test MAE: 0.0616, Test MAPE: 0.1090, Test RMSE: 0.1068
Evaluate model on site 7 , Test MAE: 0.0374, Test MAPE: 0.1008, Test RMSE: 0.0774
Evaluate model on site 8 , Test MAE: 0.0461, Test MAPE: 0.0692, Test RMSE: 0.0877
Evaluate model on site 9 , Test MAE: 0.0573, Test MAPE: 0.1148, Test RMSE: 0.0976
Evaluate model on site 10 , Test MAE: 0.0155, Test MAPE: 0.1156, Test RMSE: 0.0248
On average over all site, Test MAE: 0.0471, Test MAPE: 0.1104, Test RMSE: 0.0874
(0.04705779533833265, 0.11040733531117439, 0.08744893055409193)
data::data/water/shangban/singleFac/2,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/2', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.07329365611076355
Validation loss decreased (inf --> 0.073294).  Saving model ...
Epoch:2,validate loss:0.052958227694034576
Validation loss decreased (0.073294 --> 0.052958).  Saving model ...
Epoch:3,validate loss:0.05043361335992813
Validation loss decreased (0.052958 --> 0.050434).  Saving model ...
Epoch:4,validate loss:0.04753485694527626
Validation loss decreased (0.050434 --> 0.047535).  Saving model ...
Epoch:5,validate loss:0.053636666387319565
Epoch:6,validate loss:0.05054629221558571
Epoch:7,validate loss:0.046930912882089615
Validation loss decreased (0.047535 --> 0.046931).  Saving model ...
Epoch:8,validate loss:0.05138559639453888
Epoch:9,validate loss:0.04730124771595001
Epoch:10,validate loss:0.05003667622804642
Epoch:11,validate loss:0.04820570349693298
Epoch:12,validate loss:0.053933631628751755
Epoch:13,validate loss:0.0492616705596447
Epoch:14,validate loss:0.04861089587211609
Epoch:15,validate loss:0.04727078229188919
Epoch:16,validate loss:0.057887692004442215
Epoch:17,validate loss:0.052193839102983475
Epoch:18,validate loss:0.04761383309960365
Epoch:19,validate loss:0.04862158000469208
Epoch:20,validate loss:0.05453670397400856
Epoch:21,validate loss:0.047276683151721954
Epoch:22,validate loss:0.04925970360636711
Epoch:23,validate loss:0.04792655631899834
Epoch:24,validate loss:0.04711178317666054
Epoch:25,validate loss:0.04973052442073822
Epoch:26,validate loss:0.047848451882600784
Epoch:27,validate loss:0.04850592836737633
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.0533, Test MAPE: 0.0642, Test RMSE: 0.0923
Evaluate model on site 2 , Test MAE: 0.0711, Test MAPE: 0.0999, Test RMSE: 0.1180
Evaluate model on site 3 , Test MAE: 0.0319, Test MAPE: 0.1297, Test RMSE: 0.0865
Evaluate model on site 4 , Test MAE: 0.0599, Test MAPE: 0.1973, Test RMSE: 0.1080
Evaluate model on site 5 , Test MAE: 0.0386, Test MAPE: 0.0935, Test RMSE: 0.0769
Evaluate model on site 6 , Test MAE: 0.0659, Test MAPE: 0.1154, Test RMSE: 0.1120
Evaluate model on site 7 , Test MAE: 0.0375, Test MAPE: 0.0995, Test RMSE: 0.0775
Evaluate model on site 8 , Test MAE: 0.0468, Test MAPE: 0.0699, Test RMSE: 0.0881
Evaluate model on site 9 , Test MAE: 0.0573, Test MAPE: 0.1126, Test RMSE: 0.0991
Evaluate model on site 10 , Test MAE: 0.0153, Test MAPE: 0.1111, Test RMSE: 0.0247
On average over all site, Test MAE: 0.0478, Test MAPE: 0.1093, Test RMSE: 0.0883
(0.04776930371299386, 0.10932155773043632, 0.08831263408064842)
data::data/water/shangban/singleFac/2,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/2', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.10629443824291229
Validation loss decreased (inf --> 0.106294).  Saving model ...
Epoch:2,validate loss:0.05910163372755051
Validation loss decreased (0.106294 --> 0.059102).  Saving model ...
Epoch:3,validate loss:0.05264192819595337
Validation loss decreased (0.059102 --> 0.052642).  Saving model ...
Epoch:4,validate loss:0.05273967608809471
Epoch:5,validate loss:0.0493372343480587
Validation loss decreased (0.052642 --> 0.049337).  Saving model ...
Epoch:6,validate loss:0.049384478479623795
Epoch:7,validate loss:0.049946390092372894
Epoch:8,validate loss:0.04965933412313461
Epoch:9,validate loss:0.04846814647316933
Validation loss decreased (0.049337 --> 0.048468).  Saving model ...
Epoch:10,validate loss:0.04963092505931854
Epoch:11,validate loss:0.05375773087143898
Epoch:12,validate loss:0.04661070182919502
Validation loss decreased (0.048468 --> 0.046611).  Saving model ...
Epoch:13,validate loss:0.049969594925642014
Epoch:14,validate loss:0.04754146933555603
Epoch:15,validate loss:0.04790953919291496
Epoch:16,validate loss:0.05095987766981125
Epoch:17,validate loss:0.0509643517434597
Epoch:18,validate loss:0.0479145273566246
Epoch:19,validate loss:0.05247041955590248
Epoch:20,validate loss:0.04896696284413338
Epoch:21,validate loss:0.04615477845072746
Validation loss decreased (0.046611 --> 0.046155).  Saving model ...
Epoch:22,validate loss:0.050597455352544785
Epoch:23,validate loss:0.05116632208228111
Epoch:24,validate loss:0.0496634840965271
Epoch:25,validate loss:0.04768327251076698
Epoch:26,validate loss:0.04925122484564781
Epoch:27,validate loss:0.054394762963056564
Epoch:28,validate loss:0.04890501871705055
Epoch:29,validate loss:0.046653863042593
Epoch:30,validate loss:0.050941113382577896
Epoch:31,validate loss:0.0468033030629158
Epoch:32,validate loss:0.04643876850605011
Epoch:33,validate loss:0.046635664999485016
Epoch:34,validate loss:0.047345831990242004
Epoch:35,validate loss:0.05118411406874657
Epoch:36,validate loss:0.046497881412506104
Epoch:37,validate loss:0.04983446002006531
Epoch:38,validate loss:0.04739546403288841
Epoch:39,validate loss:0.05408983677625656
Epoch:40,validate loss:0.047240015119314194
Epoch:41,validate loss:0.04634938761591911
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.0528, Test MAPE: 0.0636, Test RMSE: 0.0914
Evaluate model on site 2 , Test MAE: 0.0702, Test MAPE: 0.0995, Test RMSE: 0.1166
Evaluate model on site 3 , Test MAE: 0.0336, Test MAPE: 0.1438, Test RMSE: 0.0865
Evaluate model on site 4 , Test MAE: 0.0603, Test MAPE: 0.2011, Test RMSE: 0.1070
Evaluate model on site 5 , Test MAE: 0.0387, Test MAPE: 0.0944, Test RMSE: 0.0770
Evaluate model on site 6 , Test MAE: 0.0617, Test MAPE: 0.1080, Test RMSE: 0.1078
Evaluate model on site 7 , Test MAE: 0.0380, Test MAPE: 0.1018, Test RMSE: 0.0784
Evaluate model on site 8 , Test MAE: 0.0464, Test MAPE: 0.0700, Test RMSE: 0.0872
Evaluate model on site 9 , Test MAE: 0.0584, Test MAPE: 0.1160, Test RMSE: 0.0986
Evaluate model on site 10 , Test MAE: 0.0170, Test MAPE: 0.1287, Test RMSE: 0.0256
On average over all site, Test MAE: 0.0477, Test MAPE: 0.1127, Test RMSE: 0.0876
(0.04771034326404333, 0.11268245056271553, 0.0876080309972167)
data::data/water/shangban/singleFac/2,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/2', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.09033991396427155
Validation loss decreased (inf --> 0.090340).  Saving model ...
Epoch:2,validate loss:0.05238266661763191
Validation loss decreased (0.090340 --> 0.052383).  Saving model ...
Epoch:3,validate loss:0.050869401544332504
Validation loss decreased (0.052383 --> 0.050869).  Saving model ...
Epoch:4,validate loss:0.05022069439291954
Validation loss decreased (0.050869 --> 0.050221).  Saving model ...
Epoch:5,validate loss:0.047908078879117966
Validation loss decreased (0.050221 --> 0.047908).  Saving model ...
Epoch:6,validate loss:0.05235930159687996
Epoch:7,validate loss:0.05040150508284569
Epoch:8,validate loss:0.051370151340961456
Epoch:9,validate loss:0.04833521321415901
Epoch:10,validate loss:0.049711208790540695
Epoch:11,validate loss:0.04811324179172516
Epoch:12,validate loss:0.04877936467528343
Epoch:13,validate loss:0.04800219088792801
Epoch:14,validate loss:0.049270711839199066
Epoch:15,validate loss:0.048956163227558136
Epoch:16,validate loss:0.047339897602796555
Validation loss decreased (0.047908 --> 0.047340).  Saving model ...
Epoch:17,validate loss:0.049140218645334244
Epoch:18,validate loss:0.046302296221256256
Validation loss decreased (0.047340 --> 0.046302).  Saving model ...
Epoch:19,validate loss:0.047832392156124115
Epoch:20,validate loss:0.048714786767959595
Epoch:21,validate loss:0.049666550010442734
Epoch:22,validate loss:0.04732237756252289
Epoch:23,validate loss:0.04975154623389244
Epoch:24,validate loss:0.04885677620768547
Epoch:25,validate loss:0.048677414655685425
Epoch:26,validate loss:0.04617536440491676
Validation loss decreased (0.046302 --> 0.046175).  Saving model ...
Epoch:27,validate loss:0.04702802747488022
Epoch:28,validate loss:0.0465603731572628
Epoch:29,validate loss:0.04777108132839203
Epoch:30,validate loss:0.0463692732155323
Epoch:31,validate loss:0.0473392978310585
Epoch:32,validate loss:0.05212109535932541
Epoch:33,validate loss:0.05021584406495094
Epoch:34,validate loss:0.0492812842130661
Epoch:35,validate loss:0.04838162660598755
Epoch:36,validate loss:0.049618661403656006
Epoch:37,validate loss:0.04758531600236893
Epoch:38,validate loss:0.0464349240064621
Epoch:39,validate loss:0.05255794897675514
Epoch:40,validate loss:0.04707786440849304
Epoch:41,validate loss:0.050361279398202896
Epoch:42,validate loss:0.049514543265104294
Epoch:43,validate loss:0.046376582235097885
Epoch:44,validate loss:0.04623981565237045
Epoch:45,validate loss:0.04882302135229111
Epoch:46,validate loss:0.049123119562864304
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.0518, Test MAPE: 0.0624, Test RMSE: 0.0922
Evaluate model on site 2 , Test MAE: 0.0701, Test MAPE: 0.0988, Test RMSE: 0.1186
Evaluate model on site 3 , Test MAE: 0.0326, Test MAPE: 0.1342, Test RMSE: 0.0867
Evaluate model on site 4 , Test MAE: 0.0601, Test MAPE: 0.2007, Test RMSE: 0.1073
Evaluate model on site 5 , Test MAE: 0.0393, Test MAPE: 0.0973, Test RMSE: 0.0761
Evaluate model on site 6 , Test MAE: 0.0625, Test MAPE: 0.1104, Test RMSE: 0.1081
Evaluate model on site 7 , Test MAE: 0.0368, Test MAPE: 0.0991, Test RMSE: 0.0766
Evaluate model on site 8 , Test MAE: 0.0463, Test MAPE: 0.0691, Test RMSE: 0.0879
Evaluate model on site 9 , Test MAE: 0.0572, Test MAPE: 0.1144, Test RMSE: 0.0972
Evaluate model on site 10 , Test MAE: 0.0155, Test MAPE: 0.1144, Test RMSE: 0.0249
On average over all site, Test MAE: 0.0472, Test MAPE: 0.1101, Test RMSE: 0.0876
(0.04721258385106921, 0.11006762906908989, 0.08755949046462774)
data::data/water/shangban/singleFac/2,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/2', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.09616091102361679
Validation loss decreased (inf --> 0.096161).  Saving model ...
Epoch:2,validate loss:0.05652668699622154
Validation loss decreased (0.096161 --> 0.056527).  Saving model ...
Epoch:3,validate loss:0.0536385178565979
Validation loss decreased (0.056527 --> 0.053639).  Saving model ...
Epoch:4,validate loss:0.05032111331820488
Validation loss decreased (0.053639 --> 0.050321).  Saving model ...
Epoch:5,validate loss:0.04872136935591698
Validation loss decreased (0.050321 --> 0.048721).  Saving model ...
Epoch:6,validate loss:0.04831043258309364
Validation loss decreased (0.048721 --> 0.048310).  Saving model ...
Epoch:7,validate loss:0.04716222360730171
Validation loss decreased (0.048310 --> 0.047162).  Saving model ...
Epoch:8,validate loss:0.049564070999622345
Epoch:9,validate loss:0.048227764666080475
Epoch:10,validate loss:0.04909493774175644
Epoch:11,validate loss:0.04962771013379097
Epoch:12,validate loss:0.04945523291826248
Epoch:13,validate loss:0.049561310559511185
Epoch:14,validate loss:0.0492728166282177
Epoch:15,validate loss:0.0474138967692852
Epoch:16,validate loss:0.04712263122200966
Validation loss decreased (0.047162 --> 0.047123).  Saving model ...
Epoch:17,validate loss:0.04646800458431244
Validation loss decreased (0.047123 --> 0.046468).  Saving model ...
Epoch:18,validate loss:0.047754496335983276
Epoch:19,validate loss:0.04709312319755554
Epoch:20,validate loss:0.05011450871825218
Epoch:21,validate loss:0.05149248614907265
Epoch:22,validate loss:0.04634300246834755
Validation loss decreased (0.046468 --> 0.046343).  Saving model ...
Epoch:23,validate loss:0.05059688538312912
Epoch:24,validate loss:0.046882808208465576
Epoch:25,validate loss:0.04688143730163574
Epoch:26,validate loss:0.04680066183209419
Epoch:27,validate loss:0.0473511703312397
Epoch:28,validate loss:0.049658484756946564
Epoch:29,validate loss:0.048790086060762405
Epoch:30,validate loss:0.04937151446938515
Epoch:31,validate loss:0.04895342141389847
Epoch:32,validate loss:0.050318703055381775
Epoch:33,validate loss:0.04685775935649872
Epoch:34,validate loss:0.04787660762667656
Epoch:35,validate loss:0.04686468839645386
Epoch:36,validate loss:0.047222647815942764
Epoch:37,validate loss:0.049643345177173615
Epoch:38,validate loss:0.04704461991786957
Epoch:39,validate loss:0.0462358184158802
Validation loss decreased (0.046343 --> 0.046236).  Saving model ...
Epoch:40,validate loss:0.048780668526887894
Epoch:41,validate loss:0.05197852849960327
Epoch:42,validate loss:0.05009353160858154
Epoch:43,validate loss:0.05168244615197182
Epoch:44,validate loss:0.04874277859926224
Epoch:45,validate loss:0.04727498069405556
Epoch:46,validate loss:0.0480334609746933
Epoch:47,validate loss:0.046349141746759415
Epoch:48,validate loss:0.04726368561387062
Epoch:49,validate loss:0.04835125431418419
Epoch:50,validate loss:0.0468914769589901
Epoch:51,validate loss:0.04940981790423393
Epoch:52,validate loss:0.05029752478003502
Epoch:53,validate loss:0.047621261328458786
Epoch:54,validate loss:0.048094216734170914
Epoch:55,validate loss:0.04713551327586174
Epoch:56,validate loss:0.04764077812433243
Epoch:57,validate loss:0.049325596541166306
Epoch:58,validate loss:0.051264237612485886
Epoch:59,validate loss:0.046768348664045334
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.0521, Test MAPE: 0.0624, Test RMSE: 0.0920
Evaluate model on site 2 , Test MAE: 0.0699, Test MAPE: 0.0985, Test RMSE: 0.1177
Evaluate model on site 3 , Test MAE: 0.0319, Test MAPE: 0.1256, Test RMSE: 0.0875
Evaluate model on site 4 , Test MAE: 0.0602, Test MAPE: 0.1953, Test RMSE: 0.1087
Evaluate model on site 5 , Test MAE: 0.0388, Test MAPE: 0.0946, Test RMSE: 0.0770
Evaluate model on site 6 , Test MAE: 0.0618, Test MAPE: 0.1083, Test RMSE: 0.1081
Evaluate model on site 7 , Test MAE: 0.0374, Test MAPE: 0.0995, Test RMSE: 0.0780
Evaluate model on site 8 , Test MAE: 0.0456, Test MAPE: 0.0679, Test RMSE: 0.0872
Evaluate model on site 9 , Test MAE: 0.0573, Test MAPE: 0.1134, Test RMSE: 0.0984
Evaluate model on site 10 , Test MAE: 0.0154, Test MAPE: 0.1066, Test RMSE: 0.0255
On average over all site, Test MAE: 0.0471, Test MAPE: 0.1072, Test RMSE: 0.0880
(0.04705328848212957, 0.10721791721880436, 0.08801395259797573)
[0.04705779533833265, 0.04776930371299386, 0.04771034326404333, 0.04721258385106921, 0.04705328848212957]
data::data/water/shangban/singleFac/2,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/2', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.06958125531673431
Validation loss decreased (inf --> 0.069581).  Saving model ...
Epoch:2,validate loss:0.05372660607099533
Validation loss decreased (0.069581 --> 0.053727).  Saving model ...
Epoch:3,validate loss:0.04941428080201149
Validation loss decreased (0.053727 --> 0.049414).  Saving model ...
Epoch:4,validate loss:0.05373101681470871
Epoch:5,validate loss:0.048933062702417374
Validation loss decreased (0.049414 --> 0.048933).  Saving model ...
Epoch:6,validate loss:0.048907674849033356
Validation loss decreased (0.048933 --> 0.048908).  Saving model ...
Epoch:7,validate loss:0.05282873660326004
Epoch:8,validate loss:0.05134237930178642
Epoch:9,validate loss:0.04768970236182213
Validation loss decreased (0.048908 --> 0.047690).  Saving model ...
Epoch:10,validate loss:0.047696396708488464
Epoch:11,validate loss:0.04837821051478386
Epoch:12,validate loss:0.047647908329963684
Validation loss decreased (0.047690 --> 0.047648).  Saving model ...
Epoch:13,validate loss:0.04779399558901787
Epoch:14,validate loss:0.0514662079513073
Epoch:15,validate loss:0.05089564621448517
Epoch:16,validate loss:0.04800527170300484
Epoch:17,validate loss:0.048120271414518356
Epoch:18,validate loss:0.052224051207304
Epoch:19,validate loss:0.04727039486169815
Validation loss decreased (0.047648 --> 0.047270).  Saving model ...
Epoch:20,validate loss:0.04880071058869362
Epoch:21,validate loss:0.04713994264602661
Validation loss decreased (0.047270 --> 0.047140).  Saving model ...
Epoch:22,validate loss:0.05225888267159462
Epoch:23,validate loss:0.047165874391794205
Epoch:24,validate loss:0.04904000833630562
Epoch:25,validate loss:0.04775827005505562
Epoch:26,validate loss:0.04638909921050072
Validation loss decreased (0.047140 --> 0.046389).  Saving model ...
Epoch:27,validate loss:0.0473538413643837
Epoch:28,validate loss:0.04716178774833679
Epoch:29,validate loss:0.0481225848197937
Epoch:30,validate loss:0.04727809131145477
Epoch:31,validate loss:0.04592497646808624
Validation loss decreased (0.046389 --> 0.045925).  Saving model ...
Epoch:32,validate loss:0.050055913627147675
Epoch:33,validate loss:0.046811286360025406
Epoch:34,validate loss:0.04694896936416626
Epoch:35,validate loss:0.049802638590335846
Epoch:36,validate loss:0.04914914444088936
Epoch:37,validate loss:0.04677752032876015
Epoch:38,validate loss:0.04919229447841644
Epoch:39,validate loss:0.046217065304517746
Epoch:40,validate loss:0.046127207577228546
Epoch:41,validate loss:0.05034442991018295
Epoch:42,validate loss:0.048118483275175095
Epoch:43,validate loss:0.04896514490246773
Epoch:44,validate loss:0.048663221299648285
Epoch:45,validate loss:0.04698118567466736
Epoch:46,validate loss:0.05093441531062126
Epoch:47,validate loss:0.04650464281439781
Epoch:48,validate loss:0.04571959376335144
Validation loss decreased (0.045925 --> 0.045720).  Saving model ...
Epoch:49,validate loss:0.046792127192020416
Epoch:50,validate loss:0.04577958956360817
Epoch:51,validate loss:0.05055467411875725
Epoch:52,validate loss:0.048480235040187836
Epoch:53,validate loss:0.04796583950519562
Epoch:54,validate loss:0.048294514417648315
Epoch:55,validate loss:0.04974725469946861
Epoch:56,validate loss:0.045819807797670364
Epoch:57,validate loss:0.04716131091117859
Epoch:58,validate loss:0.04852984473109245
Epoch:59,validate loss:0.045465368777513504
Validation loss decreased (0.045720 --> 0.045465).  Saving model ...
Epoch:60,validate loss:0.04742090031504631
Epoch:61,validate loss:0.04701688513159752
Epoch:62,validate loss:0.051327940076589584
Epoch:63,validate loss:0.04534904286265373
Validation loss decreased (0.045465 --> 0.045349).  Saving model ...
Epoch:64,validate loss:0.04645155370235443
Epoch:65,validate loss:0.047436684370040894
Epoch:66,validate loss:0.04673037678003311
Epoch:67,validate loss:0.04885127767920494
Epoch:68,validate loss:0.04628578945994377
Epoch:69,validate loss:0.047109659761190414
Epoch:70,validate loss:0.048095740377902985
Epoch:71,validate loss:0.0478704534471035
Epoch:72,validate loss:0.046094466000795364
Epoch:73,validate loss:0.04762660339474678
Epoch:74,validate loss:0.04550383239984512
Epoch:75,validate loss:0.04507925733923912
Validation loss decreased (0.045349 --> 0.045079).  Saving model ...
Epoch:76,validate loss:0.04942621663212776
Epoch:77,validate loss:0.047669682651758194
Epoch:78,validate loss:0.047029878944158554
Epoch:79,validate loss:0.047313448041677475
Epoch:80,validate loss:0.0469929538667202
Epoch:81,validate loss:0.048176880925893784
Epoch:82,validate loss:0.047689780592918396
Epoch:83,validate loss:0.04721852391958237
Epoch:84,validate loss:0.046539291739463806
Epoch:85,validate loss:0.047568682581186295
Epoch:86,validate loss:0.046882640570402145
Epoch:87,validate loss:0.04555711895227432
Epoch:88,validate loss:0.04642752557992935
Epoch:89,validate loss:0.04659053683280945
Epoch:90,validate loss:0.04945582151412964
Epoch:91,validate loss:0.0473446324467659
Epoch:92,validate loss:0.04798317328095436
Epoch:93,validate loss:0.05028921738266945
Epoch:94,validate loss:0.04659824073314667
Epoch:95,validate loss:0.045949388295412064
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.985,avg=0.100
0.064876445,0.064876445,0.38869447,0.064876445,0.09229393,0.064876445,0.064876445,0.064876445,0.064876445,0.064876445,
0.009259447,0.009259447,0.009259447,0.009259447,0.04876197,0.014981973,0.048293497,0.03705058,0.009259447,0.8046148,
0.035348784,0.13924244,0.31872436,0.06470293,0.020050121,0.020050121,0.020050121,0.020050121,0.020102527,0.3416785,
0.001656634,0.001656634,0.1880747,0.019767104,0.036992174,0.7383565,0.001656634,0.001656634,0.008526368,0.001656634,
0.025873214,0.8775497,0.0031276168,0.05238226,0.010234162,0.017896635,0.0031276168,0.0031276168,0.0031276168,0.0035535623,
0.0016832821,0.0009876837,0.0058613103,0.0009876837,0.0009876837,0.9854844,0.0009876837,0.0010448621,0.0009876837,0.0009876837,
0.069662265,0.79797,0.012172121,0.023577297,0.012172121,0.012172121,0.012172121,0.012172121,0.035757624,0.012172121,
0.006766359,0.0002215187,0.0005699261,0.00044391054,0.000309112,0.4840345,0.4951234,0.012088296,0.0002215187,0.0002215187,
0.027539495,0.039350785,0.06452582,0.07718337,0.118086755,0.027539495,0.3170721,0.027539495,0.27362317,0.027539495,
0.0290109,0.017901476,0.017901476,0.017901476,0.017901476,0.088311814,0.017901476,0.75736696,0.017901476,0.017901476,
Evaluate model on site 1 , Test MAE: 0.0528, Test MAPE: 0.0636, Test RMSE: 0.0921
Evaluate model on site 2 , Test MAE: 0.0693, Test MAPE: 0.0998, Test RMSE: 0.1152
Evaluate model on site 3 , Test MAE: 0.0320, Test MAPE: 0.1317, Test RMSE: 0.0861
Evaluate model on site 4 , Test MAE: 0.0604, Test MAPE: 0.2042, Test RMSE: 0.1068
Evaluate model on site 5 , Test MAE: 0.0382, Test MAPE: 0.0939, Test RMSE: 0.0760
Evaluate model on site 6 , Test MAE: 0.0625, Test MAPE: 0.1097, Test RMSE: 0.1075
Evaluate model on site 7 , Test MAE: 0.0362, Test MAPE: 0.0980, Test RMSE: 0.0757
Evaluate model on site 8 , Test MAE: 0.0461, Test MAPE: 0.0682, Test RMSE: 0.0887
Evaluate model on site 9 , Test MAE: 0.0565, Test MAPE: 0.1114, Test RMSE: 0.0975
Evaluate model on site 10 , Test MAE: 0.0155, Test MAPE: 0.1168, Test RMSE: 0.0243
On average over all site, Test MAE: 0.0469, Test MAPE: 0.1097, Test RMSE: 0.0870
(0.04694866435602307, 0.10972767174243928, 0.08699190374463797)
data::data/water/shangban/singleFac/2,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/2', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.0629788190126419
Validation loss decreased (inf --> 0.062979).  Saving model ...
Epoch:2,validate loss:0.05735288932919502
Validation loss decreased (0.062979 --> 0.057353).  Saving model ...
Epoch:3,validate loss:0.05086115375161171
Validation loss decreased (0.057353 --> 0.050861).  Saving model ...
Epoch:4,validate loss:0.050406314432621
Validation loss decreased (0.050861 --> 0.050406).  Saving model ...
Epoch:5,validate loss:0.048593323677778244
Validation loss decreased (0.050406 --> 0.048593).  Saving model ...
Epoch:6,validate loss:0.051049571484327316
Epoch:7,validate loss:0.047096338123083115
Validation loss decreased (0.048593 --> 0.047096).  Saving model ...
Epoch:8,validate loss:0.04690778627991676
Validation loss decreased (0.047096 --> 0.046908).  Saving model ...
Epoch:9,validate loss:0.049365464597940445
Epoch:10,validate loss:0.05309569463133812
Epoch:11,validate loss:0.04739837348461151
Epoch:12,validate loss:0.046735525131225586
Validation loss decreased (0.046908 --> 0.046736).  Saving model ...
Epoch:13,validate loss:0.048082754015922546
Epoch:14,validate loss:0.05285388231277466
Epoch:15,validate loss:0.046177636831998825
Validation loss decreased (0.046736 --> 0.046178).  Saving model ...
Epoch:16,validate loss:0.05562855675816536
Epoch:17,validate loss:0.047561559826135635
Epoch:18,validate loss:0.04596719890832901
Validation loss decreased (0.046178 --> 0.045967).  Saving model ...
Epoch:19,validate loss:0.04885513335466385
Epoch:20,validate loss:0.05033722147345543
Epoch:21,validate loss:0.04538925737142563
Validation loss decreased (0.045967 --> 0.045389).  Saving model ...
Epoch:22,validate loss:0.046128254383802414
Epoch:23,validate loss:0.04711379483342171
Epoch:24,validate loss:0.04570090398192406
Epoch:25,validate loss:0.0458751805126667
Epoch:26,validate loss:0.04761822521686554
Epoch:27,validate loss:0.048870574682950974
Epoch:28,validate loss:0.04999549686908722
Epoch:29,validate loss:0.05010152980685234
Epoch:30,validate loss:0.04635647311806679
Epoch:31,validate loss:0.04700659215450287
Epoch:32,validate loss:0.046540144830942154
Epoch:33,validate loss:0.04893837124109268
Epoch:34,validate loss:0.0473039336502552
Epoch:35,validate loss:0.04609465226531029
Epoch:36,validate loss:0.04691039025783539
Epoch:37,validate loss:0.04866386950016022
Epoch:38,validate loss:0.046323783695697784
Epoch:39,validate loss:0.045442208647727966
Epoch:40,validate loss:0.046119533479213715
Epoch:41,validate loss:0.04533905163407326
Validation loss decreased (0.045389 --> 0.045339).  Saving model ...
Epoch:42,validate loss:0.046067673712968826
Epoch:43,validate loss:0.04617786034941673
Epoch:44,validate loss:0.047750841826200485
Epoch:45,validate loss:0.04957261309027672
Epoch:46,validate loss:0.04675407335162163
Epoch:47,validate loss:0.0452277809381485
Validation loss decreased (0.045339 --> 0.045228).  Saving model ...
Epoch:48,validate loss:0.05042260140180588
Epoch:49,validate loss:0.04761825129389763
Epoch:50,validate loss:0.04617353528738022
Epoch:51,validate loss:0.045603763312101364
Epoch:52,validate loss:0.047580424696207047
Epoch:53,validate loss:0.04922644793987274
Epoch:54,validate loss:0.0491325668990612
Epoch:55,validate loss:0.04886510595679283
Epoch:56,validate loss:0.04669807478785515
Epoch:57,validate loss:0.04591596871614456
Epoch:58,validate loss:0.04607982560992241
Epoch:59,validate loss:0.04793711006641388
Epoch:60,validate loss:0.04492143914103508
Validation loss decreased (0.045228 --> 0.044921).  Saving model ...
Epoch:61,validate loss:0.046512067317962646
Epoch:62,validate loss:0.04609254002571106
Epoch:63,validate loss:0.04480136185884476
Validation loss decreased (0.044921 --> 0.044801).  Saving model ...
Epoch:64,validate loss:0.045906439423561096
Epoch:65,validate loss:0.04632198438048363
Epoch:66,validate loss:0.048058535903692245
Epoch:67,validate loss:0.047635842114686966
Epoch:68,validate loss:0.04592933878302574
Epoch:69,validate loss:0.04548892751336098
Epoch:70,validate loss:0.04946399852633476
Epoch:71,validate loss:0.0453183688223362
Epoch:72,validate loss:0.0450872927904129
Epoch:73,validate loss:0.04540612921118736
Epoch:74,validate loss:0.04754827171564102
Epoch:75,validate loss:0.04503175616264343
Epoch:76,validate loss:0.045107401907444
Epoch:77,validate loss:0.04571811854839325
Epoch:78,validate loss:0.04890354722738266
Epoch:79,validate loss:0.045170098543167114
Epoch:80,validate loss:0.04630202054977417
Epoch:81,validate loss:0.04533469304442406
Epoch:82,validate loss:0.04661605507135391
Epoch:83,validate loss:0.046104468405246735
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.991,avg=0.100
0.015700087,0.0016688755,0.0016688755,0.0016688755,0.95263356,0.0035605698,0.010113427,0.0016688755,0.009648083,0.0016688755,
0.37758002,0.02053821,0.02053821,0.02053821,0.02053821,0.02053821,0.02053821,0.02053821,0.02053821,0.4581143,
0.0011126883,0.00030153006,0.014251724,0.0002661296,0.98009914,0.0029043306,0.0002661296,0.0002661296,0.0002661296,0.0002661296,
0.00035701622,0.00035701622,0.1722043,0.00035701622,0.00035701622,0.00035701622,0.00035701622,0.0021101888,0.06587222,0.7576711,
2.945619e-05,0.9907498,0.000629648,0.00517398,0.0010017765,0.0019204068,2.945619e-05,2.945619e-05,0.00040631215,2.9769155e-05,
0.0034780083,0.0034780083,0.0034780083,0.009731839,0.0036326959,0.00403062,0.0034780083,0.0034780083,0.9458897,0.019325038,
0.009911331,0.009911331,0.009911331,0.009911331,0.009911331,0.009911331,0.8987303,0.021979101,0.009911331,0.009911331,
0.007648394,0.0040283357,0.0041184938,0.0040283357,0.009750415,0.0044427086,0.0040283357,0.9311571,0.0040283357,0.026769627,
0.0015073748,0.0024511565,0.0015073748,0.983029,0.0015073748,0.003968331,0.0015073748,0.0015073748,0.0015073748,0.0015073748,
0.008511264,0.008511264,0.89315516,0.016029097,0.009252833,0.008511264,0.008511264,0.008511264,0.0304953,0.008511264,
Evaluate model on site 1 , Test MAE: 0.0529, Test MAPE: 0.0636, Test RMSE: 0.0910
Evaluate model on site 2 , Test MAE: 0.0691, Test MAPE: 0.0988, Test RMSE: 0.1149
Evaluate model on site 3 , Test MAE: 0.0312, Test MAPE: 0.1240, Test RMSE: 0.0860
Evaluate model on site 4 , Test MAE: 0.0591, Test MAPE: 0.1946, Test RMSE: 0.1067
Evaluate model on site 5 , Test MAE: 0.0374, Test MAPE: 0.0912, Test RMSE: 0.0755
Evaluate model on site 6 , Test MAE: 0.0617, Test MAPE: 0.1078, Test RMSE: 0.1069
Evaluate model on site 7 , Test MAE: 0.0360, Test MAPE: 0.0957, Test RMSE: 0.0758
Evaluate model on site 8 , Test MAE: 0.0451, Test MAPE: 0.0650, Test RMSE: 0.0878
Evaluate model on site 9 , Test MAE: 0.0553, Test MAPE: 0.1093, Test RMSE: 0.0957
Evaluate model on site 10 , Test MAE: 0.0150, Test MAPE: 0.1107, Test RMSE: 0.0244
On average over all site, Test MAE: 0.0463, Test MAPE: 0.1061, Test RMSE: 0.0865
(0.046277709491550925, 0.10607587695121765, 0.08646095115691424)
data::data/water/shangban/singleFac/2,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/2', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.06908033788204193
Validation loss decreased (inf --> 0.069080).  Saving model ...
Epoch:2,validate loss:0.05606580153107643
Validation loss decreased (0.069080 --> 0.056066).  Saving model ...
Epoch:3,validate loss:0.05058617889881134
Validation loss decreased (0.056066 --> 0.050586).  Saving model ...
Epoch:4,validate loss:0.053670767694711685
Epoch:5,validate loss:0.050253815948963165
Validation loss decreased (0.050586 --> 0.050254).  Saving model ...
Epoch:6,validate loss:0.0520758181810379
Epoch:7,validate loss:0.05231788754463196
Epoch:8,validate loss:0.04880597069859505
Validation loss decreased (0.050254 --> 0.048806).  Saving model ...
Epoch:9,validate loss:0.04834314435720444
Validation loss decreased (0.048806 --> 0.048343).  Saving model ...
Epoch:10,validate loss:0.05337313190102577
Epoch:11,validate loss:0.04899505153298378
Epoch:12,validate loss:0.04839186742901802
Epoch:13,validate loss:0.0471205934882164
Validation loss decreased (0.048343 --> 0.047121).  Saving model ...
Epoch:14,validate loss:0.05105822533369064
Epoch:15,validate loss:0.049690574407577515
Epoch:16,validate loss:0.04855131730437279
Epoch:17,validate loss:0.04801169037818909
Epoch:18,validate loss:0.046560920774936676
Validation loss decreased (0.047121 --> 0.046561).  Saving model ...
Epoch:19,validate loss:0.04818839952349663
Epoch:20,validate loss:0.04789145290851593
Epoch:21,validate loss:0.048566676676273346
Epoch:22,validate loss:0.04606938734650612
Validation loss decreased (0.046561 --> 0.046069).  Saving model ...
Epoch:23,validate loss:0.04821000620722771
Epoch:24,validate loss:0.046735502779483795
Epoch:25,validate loss:0.04653528705239296
Epoch:26,validate loss:0.046859998255968094
Epoch:27,validate loss:0.0471467562019825
Epoch:28,validate loss:0.049520883709192276
Epoch:29,validate loss:0.04603724181652069
Validation loss decreased (0.046069 --> 0.046037).  Saving model ...
Epoch:30,validate loss:0.04918666183948517
Epoch:31,validate loss:0.0473012812435627
Epoch:32,validate loss:0.04810250177979469
Epoch:33,validate loss:0.04931338131427765
Epoch:34,validate loss:0.04654533416032791
Epoch:35,validate loss:0.04713089391589165
Epoch:36,validate loss:0.046727217733860016
Epoch:37,validate loss:0.04661041870713234
Epoch:38,validate loss:0.04580940678715706
Validation loss decreased (0.046037 --> 0.045809).  Saving model ...
Epoch:39,validate loss:0.048672258853912354
Epoch:40,validate loss:0.046067334711551666
Epoch:41,validate loss:0.04937374219298363
Epoch:42,validate loss:0.048015296459198
Epoch:43,validate loss:0.049527112394571304
Epoch:44,validate loss:0.04630769416689873
Epoch:45,validate loss:0.04796072095632553
Epoch:46,validate loss:0.04711171239614487
Epoch:47,validate loss:0.04641330614686012
Epoch:48,validate loss:0.045918356627225876
Epoch:49,validate loss:0.04627005383372307
Epoch:50,validate loss:0.04586603865027428
Epoch:51,validate loss:0.0489271841943264
Epoch:52,validate loss:0.045490920543670654
Validation loss decreased (0.045809 --> 0.045491).  Saving model ...
Epoch:53,validate loss:0.04835764318704605
Epoch:54,validate loss:0.04570770636200905
Epoch:55,validate loss:0.05353069305419922
Epoch:56,validate loss:0.04547521099448204
Validation loss decreased (0.045491 --> 0.045475).  Saving model ...
Epoch:57,validate loss:0.04607558622956276
Epoch:58,validate loss:0.04550236091017723
Epoch:59,validate loss:0.04681810364127159
Epoch:60,validate loss:0.04979190230369568
Epoch:61,validate loss:0.04912916198372841
Epoch:62,validate loss:0.0480363555252552
Epoch:63,validate loss:0.0479944571852684
Epoch:64,validate loss:0.045525580644607544
Epoch:65,validate loss:0.04542352631688118
Validation loss decreased (0.045475 --> 0.045424).  Saving model ...
Epoch:66,validate loss:0.046444814652204514
Epoch:67,validate loss:0.04577825218439102
Epoch:68,validate loss:0.04768691584467888
Epoch:69,validate loss:0.04975331202149391
Epoch:70,validate loss:0.04603726416826248
Epoch:71,validate loss:0.04693886637687683
Epoch:72,validate loss:0.04665602743625641
Epoch:73,validate loss:0.04642771556973457
Epoch:74,validate loss:0.046565745025873184
Epoch:75,validate loss:0.048008840531110764
Epoch:76,validate loss:0.048611119389534
Epoch:77,validate loss:0.047672998160123825
Epoch:78,validate loss:0.04702728986740112
Epoch:79,validate loss:0.04700220003724098
Epoch:80,validate loss:0.04797079414129257
Epoch:81,validate loss:0.04511188343167305
Validation loss decreased (0.045424 --> 0.045112).  Saving model ...
Epoch:82,validate loss:0.0458325557410717
Epoch:83,validate loss:0.04701961204409599
Epoch:84,validate loss:0.04747335985302925
Epoch:85,validate loss:0.04868258908390999
Epoch:86,validate loss:0.046985432505607605
Epoch:87,validate loss:0.04615817591547966
Epoch:88,validate loss:0.0463845431804657
Epoch:89,validate loss:0.05158933997154236
Epoch:90,validate loss:0.04610596224665642
Epoch:91,validate loss:0.045789141207933426
Epoch:92,validate loss:0.04785890877246857
Epoch:93,validate loss:0.04642254486680031
Epoch:94,validate loss:0.04689229279756546
Epoch:95,validate loss:0.04766117036342621
Epoch:96,validate loss:0.046141333878040314
Epoch:97,validate loss:0.04629628732800484
Epoch:98,validate loss:0.04674295708537102
Epoch:99,validate loss:0.04496194049715996
Validation loss decreased (0.045112 --> 0.044962).  Saving model ...
Epoch:100,validate loss:0.04538146033883095
Epoch:101,validate loss:0.04636915773153305
Epoch:102,validate loss:0.04829152673482895
Epoch:103,validate loss:0.046061933040618896
Epoch:104,validate loss:0.04683610051870346
Epoch:105,validate loss:0.04689311981201172
Epoch:106,validate loss:0.045694004744291306
Epoch:107,validate loss:0.04764358326792717
Epoch:108,validate loss:0.04582621529698372
Epoch:109,validate loss:0.04566317796707153
Epoch:110,validate loss:0.044943422079086304
Validation loss decreased (0.044962 --> 0.044943).  Saving model ...
Epoch:111,validate loss:0.04634152352809906
Epoch:112,validate loss:0.04572309926152229
Epoch:113,validate loss:0.045943621546030045
Epoch:114,validate loss:0.04658713564276695
Epoch:115,validate loss:0.04736747592687607
Epoch:116,validate loss:0.04696706682443619
Epoch:117,validate loss:0.04643149673938751
Epoch:118,validate loss:0.04636869952082634
Epoch:119,validate loss:0.047029003500938416
Epoch:120,validate loss:0.04583090543746948
Epoch:121,validate loss:0.04492732137441635
Validation loss decreased (0.044943 --> 0.044927).  Saving model ...
Epoch:122,validate loss:0.04756144434213638
Epoch:123,validate loss:0.0466398224234581
Epoch:124,validate loss:0.047811154276132584
Epoch:125,validate loss:0.04565773159265518
Epoch:126,validate loss:0.04560999944806099
Epoch:127,validate loss:0.04536885768175125
Epoch:128,validate loss:0.04612702131271362
Epoch:129,validate loss:0.04513584449887276
Epoch:130,validate loss:0.04613994061946869
Epoch:131,validate loss:0.04535685479640961
Epoch:132,validate loss:0.047680020332336426
Epoch:133,validate loss:0.04587125405669212
Epoch:134,validate loss:0.045194968581199646
Epoch:135,validate loss:0.04544176906347275
Epoch:136,validate loss:0.0457928292453289
Epoch:137,validate loss:0.04483921080827713
Validation loss decreased (0.044927 --> 0.044839).  Saving model ...
Epoch:138,validate loss:0.04531371593475342
Epoch:139,validate loss:0.04635653644800186
Epoch:140,validate loss:0.04557754099369049
Epoch:141,validate loss:0.04492536559700966
Epoch:142,validate loss:0.0457773394882679
Epoch:143,validate loss:0.04735199734568596
Epoch:144,validate loss:0.04681174084544182
Epoch:145,validate loss:0.04646476358175278
Epoch:146,validate loss:0.04514531418681145
Epoch:147,validate loss:0.047053657472133636
Epoch:148,validate loss:0.044717900454998016
Validation loss decreased (0.044839 --> 0.044718).  Saving model ...
Epoch:149,validate loss:0.045878276228904724
Epoch:150,validate loss:0.04618889465928078
Epoch:151,validate loss:0.04535211622714996
Epoch:152,validate loss:0.04848663881421089
Epoch:153,validate loss:0.04530744627118111
Epoch:154,validate loss:0.04682428389787674
Epoch:155,validate loss:0.04558480530977249
Epoch:156,validate loss:0.044687602669000626
Validation loss decreased (0.044718 --> 0.044688).  Saving model ...
Epoch:157,validate loss:0.04488891735672951
Epoch:158,validate loss:0.0450223870575428
Epoch:159,validate loss:0.04587115719914436
Epoch:160,validate loss:0.04471172019839287
Epoch:161,validate loss:0.04702206701040268
Epoch:162,validate loss:0.04575276002287865
Epoch:163,validate loss:0.04690494015812874
Epoch:164,validate loss:0.04588225111365318
Epoch:165,validate loss:0.04744604602456093
Epoch:166,validate loss:0.04673433676362038
Epoch:167,validate loss:0.047216907143592834
Epoch:168,validate loss:0.044698573648929596
Epoch:169,validate loss:0.04523799195885658
Epoch:170,validate loss:0.045462701469659805
Epoch:171,validate loss:0.04666075110435486
Epoch:172,validate loss:0.045535504817962646
Epoch:173,validate loss:0.04557094722986221
Epoch:174,validate loss:0.04549027234315872
Epoch:175,validate loss:0.04594049230217934
Epoch:176,validate loss:0.04943665862083435
Early stopping.
Training finished
邻接矩阵：min=0.039,max=0.629,avg=0.100
0.055765096,0.066252664,0.45846793,0.057987995,0.082700856,0.055765096,0.055765096,0.055765096,0.055765096,0.055765096,
0.055361375,0.055361375,0.055361375,0.055361375,0.055361375,0.055361375,0.05918056,0.09014638,0.055361375,0.4631434,
0.039484344,0.039484344,0.039484344,0.039484344,0.039484344,0.039484344,0.62873286,0.0490457,0.039688442,0.04562688,
0.045720186,0.045720186,0.045720186,0.5885183,0.045720186,0.045720186,0.045720186,0.045720186,0.045720186,0.045720186,
0.057055794,0.060424305,0.0993123,0.057055794,0.43549493,0.057055794,0.06243374,0.057055794,0.057055794,0.057055794,
0.06722726,0.40799078,0.05949865,0.05949865,0.07244037,0.05949865,0.05949865,0.095349714,0.05949865,0.05949865,
0.2793214,0.29816866,0.052813742,0.052813742,0.052813742,0.052813742,0.052813742,0.052813742,0.052813742,0.052813742,
0.06683123,0.26538315,0.11313663,0.06683123,0.07907355,0.06683123,0.06683123,0.14141929,0.06683123,0.06683123,
0.05656469,0.05656469,0.060676333,0.43499738,0.05656469,0.05656469,0.05656469,0.05656469,0.10837337,0.05656469,
0.045855664,0.045855664,0.045855664,0.045855664,0.062372204,0.045855664,0.06535806,0.04654828,0.5505874,0.045855664,
Evaluate model on site 1 , Test MAE: 0.0527, Test MAPE: 0.0637, Test RMSE: 0.0910
Evaluate model on site 2 , Test MAE: 0.0680, Test MAPE: 0.0963, Test RMSE: 0.1137
Evaluate model on site 3 , Test MAE: 0.0317, Test MAPE: 0.1295, Test RMSE: 0.0864
Evaluate model on site 4 , Test MAE: 0.0591, Test MAPE: 0.1988, Test RMSE: 0.1046
Evaluate model on site 5 , Test MAE: 0.0377, Test MAPE: 0.0925, Test RMSE: 0.0749
Evaluate model on site 6 , Test MAE: 0.0625, Test MAPE: 0.1096, Test RMSE: 0.1072
Evaluate model on site 7 , Test MAE: 0.0357, Test MAPE: 0.0950, Test RMSE: 0.0763
Evaluate model on site 8 , Test MAE: 0.0452, Test MAPE: 0.0662, Test RMSE: 0.0882
Evaluate model on site 9 , Test MAE: 0.0560, Test MAPE: 0.1108, Test RMSE: 0.0976
Evaluate model on site 10 , Test MAE: 0.0152, Test MAPE: 0.1133, Test RMSE: 0.0243
On average over all site, Test MAE: 0.0464, Test MAPE: 0.1076, Test RMSE: 0.0864
(0.046381269861012694, 0.10757774710655213, 0.0864267947152257)
data::data/water/shangban/singleFac/2,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/2', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.07530083507299423
Validation loss decreased (inf --> 0.075301).  Saving model ...
Epoch:2,validate loss:0.05826840549707413
Validation loss decreased (0.075301 --> 0.058268).  Saving model ...
Epoch:3,validate loss:0.053238071501255035
Validation loss decreased (0.058268 --> 0.053238).  Saving model ...
Epoch:4,validate loss:0.04955682530999184
Validation loss decreased (0.053238 --> 0.049557).  Saving model ...
Epoch:5,validate loss:0.05002642795443535
Epoch:6,validate loss:0.04787176847457886
Validation loss decreased (0.049557 --> 0.047872).  Saving model ...
Epoch:7,validate loss:0.047825887799263
Validation loss decreased (0.047872 --> 0.047826).  Saving model ...
Epoch:8,validate loss:0.048187948763370514
Epoch:9,validate loss:0.04963468015193939
Epoch:10,validate loss:0.048101287335157394
Epoch:11,validate loss:0.04862511530518532
Epoch:12,validate loss:0.049348846077919006
Epoch:13,validate loss:0.0547906756401062
Epoch:14,validate loss:0.04845587536692619
Epoch:15,validate loss:0.05268799886107445
Epoch:16,validate loss:0.0498664528131485
Epoch:17,validate loss:0.05479520931839943
Epoch:18,validate loss:0.04742340371012688
Validation loss decreased (0.047826 --> 0.047423).  Saving model ...
Epoch:19,validate loss:0.050945524126291275
Epoch:20,validate loss:0.04640750214457512
Validation loss decreased (0.047423 --> 0.046408).  Saving model ...
Epoch:21,validate loss:0.047646284103393555
Epoch:22,validate loss:0.045503076165914536
Validation loss decreased (0.046408 --> 0.045503).  Saving model ...
Epoch:23,validate loss:0.046832263469696045
Epoch:24,validate loss:0.04795975610613823
Epoch:25,validate loss:0.047064293175935745
Epoch:26,validate loss:0.0475555919110775
Epoch:27,validate loss:0.04687132686376572
Epoch:28,validate loss:0.04926776885986328
Epoch:29,validate loss:0.050831254571676254
Epoch:30,validate loss:0.04804597049951553
Epoch:31,validate loss:0.0482679083943367
Epoch:32,validate loss:0.04666706919670105
Epoch:33,validate loss:0.047802332788705826
Epoch:34,validate loss:0.046051234006881714
Epoch:35,validate loss:0.046447813510894775
Epoch:36,validate loss:0.048787303268909454
Epoch:37,validate loss:0.047088801860809326
Epoch:38,validate loss:0.046018581837415695
Epoch:39,validate loss:0.046738334000110626
Epoch:40,validate loss:0.04654344916343689
Epoch:41,validate loss:0.047648925334215164
Epoch:42,validate loss:0.04584062471985817
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.995,avg=0.100
7.750512e-09,7.750512e-09,7.750512e-09,3.1981674e-08,1.17107334e-07,0.062435526,3.4586494e-05,7.750512e-09,5.816361e-08,0.9375297,
2.2619906e-08,0.0050356784,2.2619906e-08,2.2619906e-08,2.2619906e-08,2.2619906e-08,0.9948704,9.371413e-05,2.2619906e-08,2.2619906e-08,
5.7724956e-06,0.025771724,0.00066066644,3.954379e-10,0.9735617,3.954379e-10,4.0762488e-10,3.954379e-10,1.0533634e-09,4.4443027e-08,
1.030968e-07,0.010690901,8.070043e-06,0.0004962562,1.030968e-07,0.9717649,0.01672931,6.449601e-05,1.030968e-07,0.0002457537,
3.7275365e-07,0.83150035,3.7275365e-07,3.7275365e-07,3.7275365e-07,3.7275365e-07,3.7275365e-07,0.16849656,3.7275365e-07,3.7275365e-07,
3.9535976e-07,1.388512e-07,1.2178484e-12,0.989181,1.2178484e-12,1.2178484e-12,1.2178484e-12,0.0068385713,1.6251176e-11,0.0039798673,
1.0955776e-09,0.00017264194,1.0955776e-09,1.0955776e-09,1.0955776e-09,0.02119953,1.0955776e-09,6.5575496e-09,1.0955776e-09,0.97862786,
0.048999824,1.0661845e-05,3.0184947e-06,2.0495989e-07,0.9506064,3.490822e-08,4.7302038e-08,0.00017806419,0.00020174835,3.490822e-08,
0.8494313,0.14160942,6.7427045e-08,6.7427045e-08,2.0310781e-05,0.008938534,6.7427045e-08,6.7427045e-08,6.7427045e-08,6.7427045e-08,
0.000110074,0.000110074,0.000110074,0.07507537,0.000110074,0.8231342,0.000110074,0.1010199,0.000110074,0.000110074,
Evaluate model on site 1 , Test MAE: 0.0540, Test MAPE: 0.0652, Test RMSE: 0.0927
Evaluate model on site 2 , Test MAE: 0.0705, Test MAPE: 0.1006, Test RMSE: 0.1176
Evaluate model on site 3 , Test MAE: 0.0313, Test MAPE: 0.1252, Test RMSE: 0.0867
Evaluate model on site 4 , Test MAE: 0.0597, Test MAPE: 0.2034, Test RMSE: 0.1059
Evaluate model on site 5 , Test MAE: 0.0377, Test MAPE: 0.0918, Test RMSE: 0.0758
Evaluate model on site 6 , Test MAE: 0.0636, Test MAPE: 0.1110, Test RMSE: 0.1087
Evaluate model on site 7 , Test MAE: 0.0358, Test MAPE: 0.0961, Test RMSE: 0.0759
Evaluate model on site 8 , Test MAE: 0.0451, Test MAPE: 0.0662, Test RMSE: 0.0873
Evaluate model on site 9 , Test MAE: 0.0562, Test MAPE: 0.1108, Test RMSE: 0.0971
Evaluate model on site 10 , Test MAE: 0.0148, Test MAPE: 0.1048, Test RMSE: 0.0245
On average over all site, Test MAE: 0.0469, Test MAPE: 0.1075, Test RMSE: 0.0872
(0.046860919985920194, 0.10751320496201515, 0.08721534740179777)
data::data/water/shangban/singleFac/2,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/2', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.07249816507101059
Validation loss decreased (inf --> 0.072498).  Saving model ...
Epoch:2,validate loss:0.05920393019914627
Validation loss decreased (0.072498 --> 0.059204).  Saving model ...
Epoch:3,validate loss:0.05167343094944954
Validation loss decreased (0.059204 --> 0.051673).  Saving model ...
Epoch:4,validate loss:0.054118357598781586
Epoch:5,validate loss:0.05227363482117653
Epoch:6,validate loss:0.05077747628092766
Validation loss decreased (0.051673 --> 0.050777).  Saving model ...
Epoch:7,validate loss:0.04808998852968216
Validation loss decreased (0.050777 --> 0.048090).  Saving model ...
Epoch:8,validate loss:0.053693950176239014
Epoch:9,validate loss:0.0521506667137146
Epoch:10,validate loss:0.05109191685914993
Epoch:11,validate loss:0.050908807665109634
Epoch:12,validate loss:0.04750692844390869
Validation loss decreased (0.048090 --> 0.047507).  Saving model ...
Epoch:13,validate loss:0.050518251955509186
Epoch:14,validate loss:0.05511929467320442
Epoch:15,validate loss:0.04991128668189049
Epoch:16,validate loss:0.04885397106409073
Epoch:17,validate loss:0.047183357179164886
Validation loss decreased (0.047507 --> 0.047183).  Saving model ...
Epoch:18,validate loss:0.049363743513822556
Epoch:19,validate loss:0.04707082360982895
Validation loss decreased (0.047183 --> 0.047071).  Saving model ...
Epoch:20,validate loss:0.046745993196964264
Validation loss decreased (0.047071 --> 0.046746).  Saving model ...
Epoch:21,validate loss:0.0482366681098938
Epoch:22,validate loss:0.04640745744109154
Validation loss decreased (0.046746 --> 0.046407).  Saving model ...
Epoch:23,validate loss:0.04986967891454697
Epoch:24,validate loss:0.04870797321200371
Epoch:25,validate loss:0.046520061790943146
Epoch:26,validate loss:0.04676959291100502
Epoch:27,validate loss:0.048459120094776154
Epoch:28,validate loss:0.04613615944981575
Validation loss decreased (0.046407 --> 0.046136).  Saving model ...
Epoch:29,validate loss:0.04598240181803703
Validation loss decreased (0.046136 --> 0.045982).  Saving model ...
Epoch:30,validate loss:0.04631888493895531
Epoch:31,validate loss:0.04702676832675934
Epoch:32,validate loss:0.04695698991417885
Epoch:33,validate loss:0.04944458231329918
Epoch:34,validate loss:0.046677831560373306
Epoch:35,validate loss:0.04663112387061119
Epoch:36,validate loss:0.04984921216964722
Epoch:37,validate loss:0.04618465527892113
Epoch:38,validate loss:0.0474499873816967
Epoch:39,validate loss:0.04901064559817314
Epoch:40,validate loss:0.04716746509075165
Epoch:41,validate loss:0.045770298689603806
Validation loss decreased (0.045982 --> 0.045770).  Saving model ...
Epoch:42,validate loss:0.047719068825244904
Epoch:43,validate loss:0.047399792820215225
Epoch:44,validate loss:0.046197157353162766
Epoch:45,validate loss:0.049598004668951035
Epoch:46,validate loss:0.04689320549368858
Epoch:47,validate loss:0.04739576205611229
Epoch:48,validate loss:0.04792178049683571
Epoch:49,validate loss:0.044905610382556915
Validation loss decreased (0.045770 --> 0.044906).  Saving model ...
Epoch:50,validate loss:0.04565557837486267
Epoch:51,validate loss:0.04849172383546829
Epoch:52,validate loss:0.04528774693608284
Epoch:53,validate loss:0.04931274428963661
Epoch:54,validate loss:0.05240023881196976
Epoch:55,validate loss:0.04523641616106033
Epoch:56,validate loss:0.045607443898916245
Epoch:57,validate loss:0.04506911709904671
Epoch:58,validate loss:0.04551754891872406
Epoch:59,validate loss:0.04955896735191345
Epoch:60,validate loss:0.044733691960573196
Validation loss decreased (0.044906 --> 0.044734).  Saving model ...
Epoch:61,validate loss:0.04527471959590912
Epoch:62,validate loss:0.04637383297085762
Epoch:63,validate loss:0.04513179138302803
Epoch:64,validate loss:0.04550282284617424
Epoch:65,validate loss:0.04773971438407898
Epoch:66,validate loss:0.04547805339097977
Epoch:67,validate loss:0.04641984775662422
Epoch:68,validate loss:0.046371251344680786
Epoch:69,validate loss:0.04784158989787102
Epoch:70,validate loss:0.04690365120768547
Epoch:71,validate loss:0.04710622876882553
Epoch:72,validate loss:0.04887137934565544
Epoch:73,validate loss:0.0469481386244297
Epoch:74,validate loss:0.04638463258743286
Epoch:75,validate loss:0.0478157140314579
Epoch:76,validate loss:0.045486994087696075
Epoch:77,validate loss:0.04572508484125137
Epoch:78,validate loss:0.04480160400271416
Epoch:79,validate loss:0.047812920063734055
Epoch:80,validate loss:0.04619709029793739
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.969,avg=0.100
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,
0.0022598475,0.0022598475,0.11617012,0.0022598475,0.0022598475,0.0022598475,0.0022598475,0.003307686,0.84322786,0.023735367,
0.0011226431,0.0020985168,0.0011226431,0.009100255,0.0011226431,0.012361347,0.0011226431,0.0014285026,0.0011226431,0.9693982,
4.5731507e-05,0.9238654,4.2949932e-06,4.2949932e-06,4.2949932e-06,4.2949932e-06,0.075986505,5.6716774e-05,2.4240935e-05,4.2949932e-06,
0.005586037,0.005586037,0.005586037,0.044083152,0.15665813,0.0057836026,0.1320029,0.005586037,0.010968757,0.62815934,
0.9108774,0.0047326977,0.0076822885,0.025463756,0.0047326977,0.0047326977,0.027580367,0.0047326977,0.0047326977,0.0047326977,
0.0077537973,0.10492068,0.0016716064,0.0026427805,0.0040249387,0.0016716064,0.8722998,0.0016716064,0.0016716064,0.0016716064,
0.12732224,0.002975577,0.002975577,0.72397196,0.11158031,0.018061647,0.002975577,0.002975577,0.004185934,0.002975577,
0.019903686,0.010302593,0.31830117,0.589677,0.010302593,0.010302593,0.010302593,0.010302593,0.010302593,0.010302593,
0.0005202174,0.0052043702,0.0042742607,0.0027646385,0.6972019,0.0005202174,0.0042065727,0.2626567,0.0005202174,0.022130929,
Evaluate model on site 1 , Test MAE: 0.0522, Test MAPE: 0.0632, Test RMSE: 0.0910
Evaluate model on site 2 , Test MAE: 0.0702, Test MAPE: 0.0977, Test RMSE: 0.1185
Evaluate model on site 3 , Test MAE: 0.0317, Test MAPE: 0.1317, Test RMSE: 0.0855
Evaluate model on site 4 , Test MAE: 0.0596, Test MAPE: 0.1988, Test RMSE: 0.1065
Evaluate model on site 5 , Test MAE: 0.0376, Test MAPE: 0.0904, Test RMSE: 0.0764
Evaluate model on site 6 , Test MAE: 0.0612, Test MAPE: 0.1054, Test RMSE: 0.1080
Evaluate model on site 7 , Test MAE: 0.0357, Test MAPE: 0.0939, Test RMSE: 0.0769
Evaluate model on site 8 , Test MAE: 0.0462, Test MAPE: 0.0676, Test RMSE: 0.0885
Evaluate model on site 9 , Test MAE: 0.0553, Test MAPE: 0.1078, Test RMSE: 0.0980
Evaluate model on site 10 , Test MAE: 0.0147, Test MAPE: 0.1084, Test RMSE: 0.0243
On average over all site, Test MAE: 0.0464, Test MAPE: 0.1065, Test RMSE: 0.0874
(0.046444995794445276, 0.10648478120565415, 0.08735197074711323)
[0.04694866435602307, 0.046277709491550925, 0.046381269861012694, 0.046860919985920194, 0.046444995794445276]
data::data/water/shangban/singleFac/3,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/3', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.5138648748397827
Validation loss decreased (inf --> 0.513865).  Saving model ...
Epoch:2,validate loss:0.3548090159893036
Validation loss decreased (0.513865 --> 0.354809).  Saving model ...
Epoch:3,validate loss:0.34162238240242004
Validation loss decreased (0.354809 --> 0.341622).  Saving model ...
Epoch:4,validate loss:0.35106906294822693
Epoch:5,validate loss:0.34616613388061523
Epoch:6,validate loss:0.3361709713935852
Validation loss decreased (0.341622 --> 0.336171).  Saving model ...
Epoch:7,validate loss:0.34733322262763977
Epoch:8,validate loss:0.3093593120574951
Validation loss decreased (0.336171 --> 0.309359).  Saving model ...
Epoch:9,validate loss:0.3248922526836395
Epoch:10,validate loss:0.31485050916671753
Epoch:11,validate loss:0.32015272974967957
Epoch:12,validate loss:0.32147955894470215
Epoch:13,validate loss:0.32599833607673645
Epoch:14,validate loss:0.3054135739803314
Validation loss decreased (0.309359 --> 0.305414).  Saving model ...
Epoch:15,validate loss:0.3408816456794739
Epoch:16,validate loss:0.31498396396636963
Epoch:17,validate loss:0.31305772066116333
Epoch:18,validate loss:0.3217802941799164
Epoch:19,validate loss:0.3340684473514557
Epoch:20,validate loss:0.30932924151420593
Epoch:21,validate loss:0.3097854256629944
Epoch:22,validate loss:0.3033931255340576
Validation loss decreased (0.305414 --> 0.303393).  Saving model ...
Epoch:23,validate loss:0.3066788613796234
Epoch:24,validate loss:0.3104040324687958
Epoch:25,validate loss:0.3210439085960388
Epoch:26,validate loss:0.31067782640457153
Epoch:27,validate loss:0.3041134774684906
Epoch:28,validate loss:0.31448885798454285
Epoch:29,validate loss:0.3247535228729248
Epoch:30,validate loss:0.3115660548210144
Epoch:31,validate loss:0.3103996813297272
Epoch:32,validate loss:0.30680856108665466
Epoch:33,validate loss:0.3050871193408966
Epoch:34,validate loss:0.29968923330307007
Validation loss decreased (0.303393 --> 0.299689).  Saving model ...
Epoch:35,validate loss:0.3087644875049591
Epoch:36,validate loss:0.31066057085990906
Epoch:37,validate loss:0.324040949344635
Epoch:38,validate loss:0.3372909128665924
Epoch:39,validate loss:0.3035871982574463
Epoch:40,validate loss:0.3038754165172577
Epoch:41,validate loss:0.30367210507392883
Epoch:42,validate loss:0.30550387501716614
Epoch:43,validate loss:0.3117041289806366
Epoch:44,validate loss:0.30647069215774536
Epoch:45,validate loss:0.3282812535762787
Epoch:46,validate loss:0.32257694005966187
Epoch:47,validate loss:0.3066790699958801
Epoch:48,validate loss:0.30287501215934753
Epoch:49,validate loss:0.3138609230518341
Epoch:50,validate loss:0.31537577509880066
Epoch:51,validate loss:0.3124941289424896
Epoch:52,validate loss:0.3127596378326416
Epoch:53,validate loss:0.3202836513519287
Epoch:54,validate loss:0.31220823526382446
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.3321, Test MAPE: 0.0944, Test RMSE: 0.5528
Evaluate model on site 2 , Test MAE: 0.4176, Test MAPE: 0.4548, Test RMSE: 0.7604
Evaluate model on site 3 , Test MAE: 0.1420, Test MAPE: 0.3669, Test RMSE: 0.3157
Evaluate model on site 4 , Test MAE: 0.3187, Test MAPE: 0.4027, Test RMSE: 0.6153
Evaluate model on site 5 , Test MAE: 0.2605, Test MAPE: 0.1643, Test RMSE: 0.4369
Evaluate model on site 6 , Test MAE: 0.4787, Test MAPE: 0.1826, Test RMSE: 0.7399
Evaluate model on site 7 , Test MAE: 0.2889, Test MAPE: 0.3191, Test RMSE: 0.5745
Evaluate model on site 8 , Test MAE: 0.2006, Test MAPE: 0.6380, Test RMSE: 0.3511
Evaluate model on site 9 , Test MAE: 0.4513, Test MAPE: 0.2084, Test RMSE: 0.7345
Evaluate model on site 10 , Test MAE: 0.2134, Test MAPE: 0.8110, Test RMSE: 0.3323
On average over all site, Test MAE: 0.3104, Test MAPE: 0.3642, Test RMSE: 0.5413
(0.310391803085804, 0.36424305737018586, 0.5413390606641769)
data::data/water/shangban/singleFac/3,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/3', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.5413351058959961
Validation loss decreased (inf --> 0.541335).  Saving model ...
Epoch:2,validate loss:0.37638330459594727
Validation loss decreased (0.541335 --> 0.376383).  Saving model ...
Epoch:3,validate loss:0.3495688736438751
Validation loss decreased (0.376383 --> 0.349569).  Saving model ...
Epoch:4,validate loss:0.3316662609577179
Validation loss decreased (0.349569 --> 0.331666).  Saving model ...
Epoch:5,validate loss:0.32348376512527466
Validation loss decreased (0.331666 --> 0.323484).  Saving model ...
Epoch:6,validate loss:0.3689377009868622
Epoch:7,validate loss:0.32534223794937134
Epoch:8,validate loss:0.31574690341949463
Validation loss decreased (0.323484 --> 0.315747).  Saving model ...
Epoch:9,validate loss:0.3414318561553955
Epoch:10,validate loss:0.3391795754432678
Epoch:11,validate loss:0.3297373652458191
Epoch:12,validate loss:0.34373441338539124
Epoch:13,validate loss:0.3115086257457733
Validation loss decreased (0.315747 --> 0.311509).  Saving model ...
Epoch:14,validate loss:0.30843284726142883
Validation loss decreased (0.311509 --> 0.308433).  Saving model ...
Epoch:15,validate loss:0.3087991178035736
Epoch:16,validate loss:0.30865591764450073
Epoch:17,validate loss:0.32946187257766724
Epoch:18,validate loss:0.3116699457168579
Epoch:19,validate loss:0.3026791512966156
Validation loss decreased (0.308433 --> 0.302679).  Saving model ...
Epoch:20,validate loss:0.31386488676071167
Epoch:21,validate loss:0.3099254071712494
Epoch:22,validate loss:0.3282439410686493
Epoch:23,validate loss:0.3259717524051666
Epoch:24,validate loss:0.31613293290138245
Epoch:25,validate loss:0.32502031326293945
Epoch:26,validate loss:0.3356197774410248
Epoch:27,validate loss:0.31772300601005554
Epoch:28,validate loss:0.31648439168930054
Epoch:29,validate loss:0.30986320972442627
Epoch:30,validate loss:0.31676527857780457
Epoch:31,validate loss:0.3037671446800232
Epoch:32,validate loss:0.3040883541107178
Epoch:33,validate loss:0.3240300714969635
Epoch:34,validate loss:0.3278277814388275
Epoch:35,validate loss:0.3327636122703552
Epoch:36,validate loss:0.3126363158226013
Epoch:37,validate loss:0.3080987334251404
Epoch:38,validate loss:0.3049425482749939
Epoch:39,validate loss:0.32593297958374023
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.3362, Test MAPE: 0.0952, Test RMSE: 0.5565
Evaluate model on site 2 , Test MAE: 0.4241, Test MAPE: 0.4466, Test RMSE: 0.7661
Evaluate model on site 3 , Test MAE: 0.1333, Test MAPE: 0.2865, Test RMSE: 0.3227
Evaluate model on site 4 , Test MAE: 0.3101, Test MAPE: 0.3816, Test RMSE: 0.6050
Evaluate model on site 5 , Test MAE: 0.2623, Test MAPE: 0.1664, Test RMSE: 0.4317
Evaluate model on site 6 , Test MAE: 0.4699, Test MAPE: 0.1740, Test RMSE: 0.7382
Evaluate model on site 7 , Test MAE: 0.3024, Test MAPE: 0.3202, Test RMSE: 0.5913
Evaluate model on site 8 , Test MAE: 0.1919, Test MAPE: 0.3841, Test RMSE: 0.3443
Evaluate model on site 9 , Test MAE: 0.4569, Test MAPE: 0.2066, Test RMSE: 0.7380
Evaluate model on site 10 , Test MAE: 0.2163, Test MAPE: 0.7025, Test RMSE: 0.3387
On average over all site, Test MAE: 0.3103, Test MAPE: 0.3164, Test RMSE: 0.5433
(0.31033309549093246, 0.3163769692182541, 0.5432547569274903)
data::data/water/shangban/singleFac/3,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/3', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.46948307752609253
Validation loss decreased (inf --> 0.469483).  Saving model ...
Epoch:2,validate loss:0.36787688732147217
Validation loss decreased (0.469483 --> 0.367877).  Saving model ...
Epoch:3,validate loss:0.3306439220905304
Validation loss decreased (0.367877 --> 0.330644).  Saving model ...
Epoch:4,validate loss:0.32329997420310974
Validation loss decreased (0.330644 --> 0.323300).  Saving model ...
Epoch:5,validate loss:0.3500607907772064
Epoch:6,validate loss:0.3094904124736786
Validation loss decreased (0.323300 --> 0.309490).  Saving model ...
Epoch:7,validate loss:0.3086118996143341
Validation loss decreased (0.309490 --> 0.308612).  Saving model ...
Epoch:8,validate loss:0.3140471875667572
Epoch:9,validate loss:0.31173175573349
Epoch:10,validate loss:0.3066082298755646
Validation loss decreased (0.308612 --> 0.306608).  Saving model ...
Epoch:11,validate loss:0.3233383595943451
Epoch:12,validate loss:0.31696760654449463
Epoch:13,validate loss:0.32886677980422974
Epoch:14,validate loss:0.31839805841445923
Epoch:15,validate loss:0.3172247111797333
Epoch:16,validate loss:0.3248026669025421
Epoch:17,validate loss:0.31923362612724304
Epoch:18,validate loss:0.3313210904598236
Epoch:19,validate loss:0.30381903052330017
Validation loss decreased (0.306608 --> 0.303819).  Saving model ...
Epoch:20,validate loss:0.3347501754760742
Epoch:21,validate loss:0.3252798318862915
Epoch:22,validate loss:0.3363064229488373
Epoch:23,validate loss:0.30300456285476685
Validation loss decreased (0.303819 --> 0.303005).  Saving model ...
Epoch:24,validate loss:0.31492331624031067
Epoch:25,validate loss:0.3160589635372162
Epoch:26,validate loss:0.31845298409461975
Epoch:27,validate loss:0.31011971831321716
Epoch:28,validate loss:0.3096587657928467
Epoch:29,validate loss:0.3126685619354248
Epoch:30,validate loss:0.3054399788379669
Epoch:31,validate loss:0.30109745264053345
Validation loss decreased (0.303005 --> 0.301097).  Saving model ...
Epoch:32,validate loss:0.30141013860702515
Epoch:33,validate loss:0.3112253248691559
Epoch:34,validate loss:0.3074399530887604
Epoch:35,validate loss:0.31100401282310486
Epoch:36,validate loss:0.3471957743167877
Epoch:37,validate loss:0.30374807119369507
Epoch:38,validate loss:0.30939993262290955
Epoch:39,validate loss:0.31020137667655945
Epoch:40,validate loss:0.31866103410720825
Epoch:41,validate loss:0.302018940448761
Epoch:42,validate loss:0.3054896891117096
Epoch:43,validate loss:0.3108798563480377
Epoch:44,validate loss:0.3197146952152252
Epoch:45,validate loss:0.32223403453826904
Epoch:46,validate loss:0.31138092279434204
Epoch:47,validate loss:0.3330870270729065
Epoch:48,validate loss:0.310213178396225
Epoch:49,validate loss:0.31980234384536743
Epoch:50,validate loss:0.30647018551826477
Epoch:51,validate loss:0.30962881445884705
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.3498, Test MAPE: 0.0996, Test RMSE: 0.5605
Evaluate model on site 2 , Test MAE: 0.4176, Test MAPE: 0.4555, Test RMSE: 0.7577
Evaluate model on site 3 , Test MAE: 0.1380, Test MAPE: 0.3509, Test RMSE: 0.3154
Evaluate model on site 4 , Test MAE: 0.3136, Test MAPE: 0.3920, Test RMSE: 0.6106
Evaluate model on site 5 , Test MAE: 0.2644, Test MAPE: 0.1649, Test RMSE: 0.4425
Evaluate model on site 6 , Test MAE: 0.4899, Test MAPE: 0.1887, Test RMSE: 0.7554
Evaluate model on site 7 , Test MAE: 0.2912, Test MAPE: 0.3189, Test RMSE: 0.5804
Evaluate model on site 8 , Test MAE: 0.1992, Test MAPE: 0.6271, Test RMSE: 0.3488
Evaluate model on site 9 , Test MAE: 0.4481, Test MAPE: 0.2079, Test RMSE: 0.7370
Evaluate model on site 10 , Test MAE: 0.2129, Test MAPE: 0.7916, Test RMSE: 0.3350
On average over all site, Test MAE: 0.3125, Test MAPE: 0.3597, Test RMSE: 0.5443
(0.3124592795968056, 0.3597011886537075, 0.54432572722435)
data::data/water/shangban/singleFac/3,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/3', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.539658784866333
Validation loss decreased (inf --> 0.539659).  Saving model ...
Epoch:2,validate loss:0.3510466516017914
Validation loss decreased (0.539659 --> 0.351047).  Saving model ...
Epoch:3,validate loss:0.33623015880584717
Validation loss decreased (0.351047 --> 0.336230).  Saving model ...
Epoch:4,validate loss:0.3340591490268707
Validation loss decreased (0.336230 --> 0.334059).  Saving model ...
Epoch:5,validate loss:0.3266776502132416
Validation loss decreased (0.334059 --> 0.326678).  Saving model ...
Epoch:6,validate loss:0.33182138204574585
Epoch:7,validate loss:0.3371146023273468
Epoch:8,validate loss:0.3217521905899048
Validation loss decreased (0.326678 --> 0.321752).  Saving model ...
Epoch:9,validate loss:0.3135527968406677
Validation loss decreased (0.321752 --> 0.313553).  Saving model ...
Epoch:10,validate loss:0.3229641020298004
Epoch:11,validate loss:0.31632259488105774
Epoch:12,validate loss:0.3164961040019989
Epoch:13,validate loss:0.30920910835266113
Validation loss decreased (0.313553 --> 0.309209).  Saving model ...
Epoch:14,validate loss:0.30053484439849854
Validation loss decreased (0.309209 --> 0.300535).  Saving model ...
Epoch:15,validate loss:0.31785914301872253
Epoch:16,validate loss:0.3066699504852295
Epoch:17,validate loss:0.31369540095329285
Epoch:18,validate loss:0.3066824674606323
Epoch:19,validate loss:0.3067554533481598
Epoch:20,validate loss:0.3030613362789154
Epoch:21,validate loss:0.3081117868423462
Epoch:22,validate loss:0.3205008804798126
Epoch:23,validate loss:0.30928224325180054
Epoch:24,validate loss:0.3051236867904663
Epoch:25,validate loss:0.3245404064655304
Epoch:26,validate loss:0.3049367666244507
Epoch:27,validate loss:0.3185955882072449
Epoch:28,validate loss:0.30398041009902954
Epoch:29,validate loss:0.317067414522171
Epoch:30,validate loss:0.3155386745929718
Epoch:31,validate loss:0.3144032955169678
Epoch:32,validate loss:0.3032386898994446
Epoch:33,validate loss:0.3122851550579071
Epoch:34,validate loss:0.30339962244033813
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.3358, Test MAPE: 0.0952, Test RMSE: 0.5522
Evaluate model on site 2 , Test MAE: 0.4233, Test MAPE: 0.4471, Test RMSE: 0.7675
Evaluate model on site 3 , Test MAE: 0.1359, Test MAPE: 0.3173, Test RMSE: 0.3228
Evaluate model on site 4 , Test MAE: 0.3102, Test MAPE: 0.3826, Test RMSE: 0.6085
Evaluate model on site 5 , Test MAE: 0.2647, Test MAPE: 0.1685, Test RMSE: 0.4373
Evaluate model on site 6 , Test MAE: 0.4726, Test MAPE: 0.1737, Test RMSE: 0.7429
Evaluate model on site 7 , Test MAE: 0.3024, Test MAPE: 0.3281, Test RMSE: 0.5837
Evaluate model on site 8 , Test MAE: 0.1954, Test MAPE: 0.5008, Test RMSE: 0.3500
Evaluate model on site 9 , Test MAE: 0.4489, Test MAPE: 0.2050, Test RMSE: 0.7312
Evaluate model on site 10 , Test MAE: 0.2134, Test MAPE: 0.7533, Test RMSE: 0.3356
On average over all site, Test MAE: 0.3103, Test MAPE: 0.3371, Test RMSE: 0.5432
(0.31025211662054064, 0.3371494606137276, 0.5431561291217804)
data::data/water/shangban/singleFac/3,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/3', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.5344065427780151
Validation loss decreased (inf --> 0.534407).  Saving model ...
Epoch:2,validate loss:0.3517606854438782
Validation loss decreased (0.534407 --> 0.351761).  Saving model ...
Epoch:3,validate loss:0.34736770391464233
Validation loss decreased (0.351761 --> 0.347368).  Saving model ...
Epoch:4,validate loss:0.3344043791294098
Validation loss decreased (0.347368 --> 0.334404).  Saving model ...
Epoch:5,validate loss:0.32174333930015564
Validation loss decreased (0.334404 --> 0.321743).  Saving model ...
Epoch:6,validate loss:0.3245971202850342
Epoch:7,validate loss:0.3160610795021057
Validation loss decreased (0.321743 --> 0.316061).  Saving model ...
Epoch:8,validate loss:0.32532262802124023
Epoch:9,validate loss:0.3209890127182007
Epoch:10,validate loss:0.3169218897819519
Epoch:11,validate loss:0.3222771883010864
Epoch:12,validate loss:0.3196278214454651
Epoch:13,validate loss:0.31550759077072144
Validation loss decreased (0.316061 --> 0.315508).  Saving model ...
Epoch:14,validate loss:0.31271442770957947
Validation loss decreased (0.315508 --> 0.312714).  Saving model ...
Epoch:15,validate loss:0.3085562288761139
Validation loss decreased (0.312714 --> 0.308556).  Saving model ...
Epoch:16,validate loss:0.3208061456680298
Epoch:17,validate loss:0.3277788460254669
Epoch:18,validate loss:0.31698501110076904
Epoch:19,validate loss:0.3201057016849518
Epoch:20,validate loss:0.3040781319141388
Validation loss decreased (0.308556 --> 0.304078).  Saving model ...
Epoch:21,validate loss:0.3075440526008606
Epoch:22,validate loss:0.31636282801628113
Epoch:23,validate loss:0.3077923059463501
Epoch:24,validate loss:0.3310818076133728
Epoch:25,validate loss:0.3043520152568817
Epoch:26,validate loss:0.32338449358940125
Epoch:27,validate loss:0.3195103108882904
Epoch:28,validate loss:0.3185068964958191
Epoch:29,validate loss:0.33583584427833557
Epoch:30,validate loss:0.31576672196388245
Epoch:31,validate loss:0.3058191239833832
Epoch:32,validate loss:0.300425261259079
Validation loss decreased (0.304078 --> 0.300425).  Saving model ...
Epoch:33,validate loss:0.3274657726287842
Epoch:34,validate loss:0.3117119073867798
Epoch:35,validate loss:0.3179071247577667
Epoch:36,validate loss:0.30857014656066895
Epoch:37,validate loss:0.32421138882637024
Epoch:38,validate loss:0.3213038742542267
Epoch:39,validate loss:0.3145688474178314
Epoch:40,validate loss:0.3057354986667633
Epoch:41,validate loss:0.31058770418167114
Epoch:42,validate loss:0.32831355929374695
Epoch:43,validate loss:0.3150639235973358
Epoch:44,validate loss:0.30558711290359497
Epoch:45,validate loss:0.3096868693828583
Epoch:46,validate loss:0.30484551191329956
Epoch:47,validate loss:0.3111725151538849
Epoch:48,validate loss:0.30124062299728394
Epoch:49,validate loss:0.323830246925354
Epoch:50,validate loss:0.3047531247138977
Epoch:51,validate loss:0.3242102563381195
Epoch:52,validate loss:0.3077123761177063
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.3217, Test MAPE: 0.0917, Test RMSE: 0.5410
Evaluate model on site 2 , Test MAE: 0.4125, Test MAPE: 0.4426, Test RMSE: 0.7544
Evaluate model on site 3 , Test MAE: 0.1339, Test MAPE: 0.3008, Test RMSE: 0.3177
Evaluate model on site 4 , Test MAE: 0.3170, Test MAPE: 0.3844, Test RMSE: 0.6154
Evaluate model on site 5 , Test MAE: 0.2630, Test MAPE: 0.1641, Test RMSE: 0.4420
Evaluate model on site 6 , Test MAE: 0.4801, Test MAPE: 0.1832, Test RMSE: 0.7494
Evaluate model on site 7 , Test MAE: 0.2878, Test MAPE: 0.3118, Test RMSE: 0.5793
Evaluate model on site 8 , Test MAE: 0.2008, Test MAPE: 0.5383, Test RMSE: 0.3552
Evaluate model on site 9 , Test MAE: 0.4534, Test MAPE: 0.2103, Test RMSE: 0.7463
Evaluate model on site 10 , Test MAE: 0.2102, Test MAPE: 0.6823, Test RMSE: 0.3357
On average over all site, Test MAE: 0.3080, Test MAPE: 0.3309, Test RMSE: 0.5436
(0.30803999304771423, 0.3309488996863365, 0.5436322808265686)
[0.310391803085804, 0.31033309549093246, 0.3124592795968056, 0.31025211662054064, 0.30803999304771423]
data::data/water/shangban/singleFac/3,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/3', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.43209388852119446
Validation loss decreased (inf --> 0.432094).  Saving model ...
Epoch:2,validate loss:0.3792968690395355
Validation loss decreased (0.432094 --> 0.379297).  Saving model ...
Epoch:3,validate loss:0.3419334292411804
Validation loss decreased (0.379297 --> 0.341933).  Saving model ...
Epoch:4,validate loss:0.35842424631118774
Epoch:5,validate loss:0.35208389163017273
Epoch:6,validate loss:0.34137392044067383
Validation loss decreased (0.341933 --> 0.341374).  Saving model ...
Epoch:7,validate loss:0.32016459107398987
Validation loss decreased (0.341374 --> 0.320165).  Saving model ...
Epoch:8,validate loss:0.3164963126182556
Validation loss decreased (0.320165 --> 0.316496).  Saving model ...
Epoch:9,validate loss:0.32780778408050537
Epoch:10,validate loss:0.31275221705436707
Validation loss decreased (0.316496 --> 0.312752).  Saving model ...
Epoch:11,validate loss:0.3247452676296234
Epoch:12,validate loss:0.3131170868873596
Epoch:13,validate loss:0.30790022015571594
Validation loss decreased (0.312752 --> 0.307900).  Saving model ...
Epoch:14,validate loss:0.30710020661354065
Validation loss decreased (0.307900 --> 0.307100).  Saving model ...
Epoch:15,validate loss:0.30670493841171265
Validation loss decreased (0.307100 --> 0.306705).  Saving model ...
Epoch:16,validate loss:0.30066102743148804
Validation loss decreased (0.306705 --> 0.300661).  Saving model ...
Epoch:17,validate loss:0.3015424311161041
Epoch:18,validate loss:0.3096492886543274
Epoch:19,validate loss:0.3057493567466736
Epoch:20,validate loss:0.3218717873096466
Epoch:21,validate loss:0.3141012489795685
Epoch:22,validate loss:0.31332555413246155
Epoch:23,validate loss:0.30183145403862
Epoch:24,validate loss:0.30099526047706604
Epoch:25,validate loss:0.3102791905403137
Epoch:26,validate loss:0.29792267084121704
Validation loss decreased (0.300661 --> 0.297923).  Saving model ...
Epoch:27,validate loss:0.33330783247947693
Epoch:28,validate loss:0.3055596947669983
Epoch:29,validate loss:0.3139486610889435
Epoch:30,validate loss:0.3014582395553589
Epoch:31,validate loss:0.3247108459472656
Epoch:32,validate loss:0.3046291470527649
Epoch:33,validate loss:0.30657845735549927
Epoch:34,validate loss:0.33020439743995667
Epoch:35,validate loss:0.3238268792629242
Epoch:36,validate loss:0.30772048234939575
Epoch:37,validate loss:0.29990631341934204
Epoch:38,validate loss:0.31070977449417114
Epoch:39,validate loss:0.3013536334037781
Epoch:40,validate loss:0.30803635716438293
Epoch:41,validate loss:0.2984899878501892
Epoch:42,validate loss:0.309410035610199
Epoch:43,validate loss:0.3017353117465973
Epoch:44,validate loss:0.3223908245563507
Epoch:45,validate loss:0.3172014057636261
Epoch:46,validate loss:0.30483654141426086
Early stopping.
Training finished
邻接矩阵：min=0.000,max=0.998,avg=0.100
2.9592492e-10,0.09117358,0.905316,2.4044227e-09,2.9592492e-10,2.9592492e-10,3.3534212e-05,2.9592492e-10,2.9592492e-10,0.0034768656,
1.3111847e-06,6.8510964e-08,3.1416045e-09,0.061464813,0.9385078,1.06952575e-05,3.1416045e-09,3.1416045e-09,1.5247939e-05,3.1416045e-09,
9.2012386e-05,1.9331046e-06,2.3493585e-06,1.9331046e-06,0.99651694,0.002971929,1.9331046e-06,0.00040705004,1.9331046e-06,1.9331046e-06,
1.6485511e-06,0.00167405,3.1470936e-06,0.998321,1.4428291e-11,1.4428291e-11,1.1102888e-07,2.4878918e-08,2.1459264e-10,1.1352659e-08,
2.9777073e-06,3.5255536e-05,3.3135386e-06,0.003204199,0.00028351176,0.9937935,2.9777073e-06,0.00014203294,8.173033e-06,0.0025240923,
1.8675516e-06,7.440398e-09,0.0016929861,3.1656377e-06,3.3284134e-10,0.0005783086,0.9977076,3.3284134e-10,3.3284134e-10,1.6094e-05,
0.0048495177,3.1560772e-05,1.2143522e-07,1.1522336e-07,1.6055939e-08,3.9436298e-07,0.99511814,1.6055939e-08,1.6055939e-08,1.6055939e-08,
0.00022572983,8.649132e-08,8.649132e-08,8.649132e-08,0.002313006,0.9974606,8.649132e-08,8.649132e-08,8.649132e-08,1.4793272e-07,
4.6309043e-07,0.003147074,4.6309043e-07,4.6309043e-07,4.9139394e-06,0.0023504077,6.4297856e-05,4.6309043e-07,1.7371864e-06,0.99442977,
1.0823514e-06,0.002660564,5.4076895e-07,5.4076895e-07,5.4076895e-07,5.4076895e-07,5.4076895e-07,0.003564356,9.612339e-07,0.9937703,
Evaluate model on site 1 , Test MAE: 0.3223, Test MAPE: 0.0913, Test RMSE: 0.5323
Evaluate model on site 2 , Test MAE: 0.4141, Test MAPE: 0.4633, Test RMSE: 0.7559
Evaluate model on site 3 , Test MAE: 0.1390, Test MAPE: 0.3570, Test RMSE: 0.3248
Evaluate model on site 4 , Test MAE: 0.3092, Test MAPE: 0.3827, Test RMSE: 0.6040
Evaluate model on site 5 , Test MAE: 0.2555, Test MAPE: 0.1705, Test RMSE: 0.4112
Evaluate model on site 6 , Test MAE: 0.4670, Test MAPE: 0.1808, Test RMSE: 0.7152
Evaluate model on site 7 , Test MAE: 0.2933, Test MAPE: 0.3361, Test RMSE: 0.5672
Evaluate model on site 8 , Test MAE: 0.2032, Test MAPE: 0.7478, Test RMSE: 0.3497
Evaluate model on site 9 , Test MAE: 0.4438, Test MAPE: 0.2030, Test RMSE: 0.7124
Evaluate model on site 10 , Test MAE: 0.2090, Test MAPE: 0.7924, Test RMSE: 0.3259
On average over all site, Test MAE: 0.3056, Test MAPE: 0.3725, Test RMSE: 0.5299
(0.30564654171466826, 0.372491554915905, 0.5298531979322434)
data::data/water/shangban/singleFac/3,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/3', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.41026636958122253
Validation loss decreased (inf --> 0.410266).  Saving model ...
Epoch:2,validate loss:0.36350584030151367
Validation loss decreased (0.410266 --> 0.363506).  Saving model ...
Epoch:3,validate loss:0.3579556345939636
Validation loss decreased (0.363506 --> 0.357956).  Saving model ...
Epoch:4,validate loss:0.34071943163871765
Validation loss decreased (0.357956 --> 0.340719).  Saving model ...
Epoch:5,validate loss:0.33335772156715393
Validation loss decreased (0.340719 --> 0.333358).  Saving model ...
Epoch:6,validate loss:0.32355576753616333
Validation loss decreased (0.333358 --> 0.323556).  Saving model ...
Epoch:7,validate loss:0.32643747329711914
Epoch:8,validate loss:0.3371856212615967
Epoch:9,validate loss:0.3456520438194275
Epoch:10,validate loss:0.31980663537979126
Validation loss decreased (0.323556 --> 0.319807).  Saving model ...
Epoch:11,validate loss:0.316802054643631
Validation loss decreased (0.319807 --> 0.316802).  Saving model ...
Epoch:12,validate loss:0.3128982484340668
Validation loss decreased (0.316802 --> 0.312898).  Saving model ...
Epoch:13,validate loss:0.32279086112976074
Epoch:14,validate loss:0.32048171758651733
Epoch:15,validate loss:0.3189944326877594
Epoch:16,validate loss:0.31806713342666626
Epoch:17,validate loss:0.32249051332473755
Epoch:18,validate loss:0.3125309646129608
Validation loss decreased (0.312898 --> 0.312531).  Saving model ...
Epoch:19,validate loss:0.32603079080581665
Epoch:20,validate loss:0.31733348965644836
Epoch:21,validate loss:0.302765429019928
Validation loss decreased (0.312531 --> 0.302765).  Saving model ...
Epoch:22,validate loss:0.3176068365573883
Epoch:23,validate loss:0.32399237155914307
Epoch:24,validate loss:0.3155971169471741
Epoch:25,validate loss:0.3111627697944641
Epoch:26,validate loss:0.3177863657474518
Epoch:27,validate loss:0.3258203864097595
Epoch:28,validate loss:0.3178566098213196
Epoch:29,validate loss:0.3177497088909149
Epoch:30,validate loss:0.3349669873714447
Epoch:31,validate loss:0.32771754264831543
Epoch:32,validate loss:0.30946579575538635
Epoch:33,validate loss:0.31651169061660767
Epoch:34,validate loss:0.3090885877609253
Epoch:35,validate loss:0.31037238240242004
Epoch:36,validate loss:0.3141842782497406
Epoch:37,validate loss:0.312456339597702
Epoch:38,validate loss:0.3106599450111389
Epoch:39,validate loss:0.3093888461589813
Epoch:40,validate loss:0.3124005198478699
Epoch:41,validate loss:0.32168421149253845
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
5.7354056e-05,5.7354056e-05,5.7354056e-05,5.7354056e-05,0.9994784,6.2733925e-05,5.7354056e-05,5.7354056e-05,5.7354056e-05,5.7354056e-05,
2.2246705e-07,2.2246705e-07,2.2246705e-07,2.2246705e-07,2.2246705e-07,2.2246705e-07,0.9998287,2.2246705e-07,2.2246705e-07,0.00016947005,
2.9862175e-11,2.9862175e-11,1.2144199e-09,1.0,2.9862175e-11,4.4024375e-08,2.9862175e-11,2.9862175e-11,5.818576e-10,2.9862175e-11,
1.4385798e-12,3.6443773e-12,1.2453807e-09,1.4856231e-14,1.5573663e-05,0.0001582061,1.4856231e-14,2.5746271e-12,0.99982625,1.4856231e-14,
1.2203781e-13,0.9991555,9.3756356e-17,9.3756356e-17,9.3756356e-17,9.3756356e-17,0.00084442506,6.392193e-16,9.3756356e-17,2.9832103e-16,
6.9460065e-10,7.829087e-09,6.9460065e-10,8.3028856e-10,0.00096403953,6.9460065e-10,6.9460065e-10,0.99903595,6.9460065e-10,6.9460065e-10,
2.705247e-14,2.705247e-14,5.4491767e-07,2.705247e-14,4.8095927e-09,2.705247e-14,2.705247e-14,6.664737e-08,0.9999993,2.705247e-14,
3.4118113e-08,0.006167906,3.4118113e-08,3.4118113e-08,0.99228436,0.0015452254,2.3587781e-06,3.4118113e-08,3.4118113e-08,3.4118113e-08,
1.6087858e-08,1.2061883e-10,0.999997,1.2061883e-10,1.2061883e-10,8.73965e-08,1.2061883e-10,1.4442368e-08,1.2061883e-10,2.8601619e-06,
0.9979938,1.2022057e-05,0.0005814624,3.4672274e-07,1.3295127e-05,0.00035236645,3.4672274e-07,3.4672274e-07,3.4672274e-07,0.0010456207,
Evaluate model on site 1 , Test MAE: 0.3272, Test MAPE: 0.0945, Test RMSE: 0.5383
Evaluate model on site 2 , Test MAE: 0.4085, Test MAPE: 0.4422, Test RMSE: 0.7466
Evaluate model on site 3 , Test MAE: 0.1340, Test MAPE: 0.2715, Test RMSE: 0.3251
Evaluate model on site 4 , Test MAE: 0.3112, Test MAPE: 0.3637, Test RMSE: 0.6092
Evaluate model on site 5 , Test MAE: 0.2752, Test MAPE: 0.1828, Test RMSE: 0.4403
Evaluate model on site 6 , Test MAE: 0.4580, Test MAPE: 0.1696, Test RMSE: 0.7150
Evaluate model on site 7 , Test MAE: 0.2921, Test MAPE: 0.3367, Test RMSE: 0.5694
Evaluate model on site 8 , Test MAE: 0.1984, Test MAPE: 0.4894, Test RMSE: 0.3421
Evaluate model on site 9 , Test MAE: 0.4397, Test MAPE: 0.1971, Test RMSE: 0.7128
Evaluate model on site 10 , Test MAE: 0.2128, Test MAPE: 0.6935, Test RMSE: 0.3358
On average over all site, Test MAE: 0.3057, Test MAPE: 0.3241, Test RMSE: 0.5335
(0.3057000443339348, 0.3241160050034523, 0.533451446890831)
data::data/water/shangban/singleFac/3,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/3', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.4258676767349243
Validation loss decreased (inf --> 0.425868).  Saving model ...
Epoch:2,validate loss:0.36782562732696533
Validation loss decreased (0.425868 --> 0.367826).  Saving model ...
Epoch:3,validate loss:0.33429330587387085
Validation loss decreased (0.367826 --> 0.334293).  Saving model ...
Epoch:4,validate loss:0.3332267999649048
Validation loss decreased (0.334293 --> 0.333227).  Saving model ...
Epoch:5,validate loss:0.3337869644165039
Epoch:6,validate loss:0.31906822323799133
Validation loss decreased (0.333227 --> 0.319068).  Saving model ...
Epoch:7,validate loss:0.3194850981235504
Epoch:8,validate loss:0.33194082975387573
Epoch:9,validate loss:0.32528388500213623
Epoch:10,validate loss:0.3330462872982025
Epoch:11,validate loss:0.3077849745750427
Validation loss decreased (0.319068 --> 0.307785).  Saving model ...
Epoch:12,validate loss:0.333222895860672
Epoch:13,validate loss:0.3066026270389557
Validation loss decreased (0.307785 --> 0.306603).  Saving model ...
Epoch:14,validate loss:0.34018880128860474
Epoch:15,validate loss:0.30810463428497314
Epoch:16,validate loss:0.32087329030036926
Epoch:17,validate loss:0.30455470085144043
Validation loss decreased (0.306603 --> 0.304555).  Saving model ...
Epoch:18,validate loss:0.3236941397190094
Epoch:19,validate loss:0.3149248957633972
Epoch:20,validate loss:0.317876398563385
Epoch:21,validate loss:0.3030541241168976
Validation loss decreased (0.304555 --> 0.303054).  Saving model ...
Epoch:22,validate loss:0.31074607372283936
Epoch:23,validate loss:0.3024860620498657
Validation loss decreased (0.303054 --> 0.302486).  Saving model ...
Epoch:24,validate loss:0.29922598600387573
Validation loss decreased (0.302486 --> 0.299226).  Saving model ...
Epoch:25,validate loss:0.30310362577438354
Epoch:26,validate loss:0.2967498004436493
Validation loss decreased (0.299226 --> 0.296750).  Saving model ...
Epoch:27,validate loss:0.3141404688358307
Epoch:28,validate loss:0.3114927411079407
Epoch:29,validate loss:0.29998326301574707
Epoch:30,validate loss:0.31358858942985535
Epoch:31,validate loss:0.30122098326683044
Epoch:32,validate loss:0.3184155225753784
Epoch:33,validate loss:0.31156185269355774
Epoch:34,validate loss:0.3267291188240051
Epoch:35,validate loss:0.30580782890319824
Epoch:36,validate loss:0.30891963839530945
Epoch:37,validate loss:0.3193649351596832
Epoch:38,validate loss:0.3100437521934509
Epoch:39,validate loss:0.30639126896858215
Epoch:40,validate loss:0.29754266142845154
Epoch:41,validate loss:0.30512192845344543
Epoch:42,validate loss:0.3069644570350647
Epoch:43,validate loss:0.3088115155696869
Epoch:44,validate loss:0.3051038980484009
Epoch:45,validate loss:0.3216165006160736
Epoch:46,validate loss:0.32843711972236633
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
5.4602883e-06,5.4602883e-06,0.9991246,0.00024921517,5.4602883e-06,5.4602883e-06,5.4602883e-06,0.00058792066,5.4602883e-06,5.4602883e-06,
7.30108e-14,1.0,2.0969008e-13,4.6204273e-11,7.30108e-14,7.30108e-14,8.348949e-14,5.4233826e-11,7.30108e-14,2.1449303e-08,
0.0033022894,3.8935455e-06,3.8935455e-06,3.8935455e-06,3.8935455e-06,3.8935455e-06,3.8935455e-06,3.8935455e-06,3.8935455e-06,0.9966665,
2.5347762e-11,3.132615e-12,8.310215e-14,1.0,3.7102987e-13,9.185847e-13,8.310215e-14,5.0891732e-11,8.310215e-14,8.310215e-14,
2.4565147e-10,2.4565147e-10,2.4565147e-10,2.4565147e-10,2.4565147e-10,2.4565147e-10,9.897762e-08,0.000962449,2.4565147e-10,0.9990375,
0.0014320723,3.2684266e-06,5.4662e-07,5.4662e-07,0.99856085,5.4662e-07,5.4662e-07,5.4662e-07,5.4662e-07,5.4662e-07,
7.923837e-09,5.109212e-07,7.923837e-09,0.019158864,7.923837e-09,7.923837e-09,7.923837e-09,0.0131085925,0.967732,7.923837e-09,
6.225673e-07,0.9999994,1.2051886e-10,3.6808284e-08,3.067078e-11,3.067078e-11,3.067078e-11,3.067078e-11,3.067078e-11,2.4536995e-09,
0.040318575,2.2436306e-09,4.520597e-08,4.3649843e-06,1.6673923e-08,2.2436306e-09,0.95967704,1.5992425e-08,2.2436306e-09,1.1182157e-08,
2.5378341e-08,2.5378341e-08,0.0016341491,2.0279618e-05,9.2361915e-08,0.99731296,3.78619e-08,2.5378341e-08,0.0010323714,2.5378341e-08,
Evaluate model on site 1 , Test MAE: 0.3361, Test MAPE: 0.0942, Test RMSE: 0.5380
Evaluate model on site 2 , Test MAE: 0.4067, Test MAPE: 0.4433, Test RMSE: 0.7413
Evaluate model on site 3 , Test MAE: 0.1362, Test MAPE: 0.3178, Test RMSE: 0.3265
Evaluate model on site 4 , Test MAE: 0.3076, Test MAPE: 0.3673, Test RMSE: 0.6098
Evaluate model on site 5 , Test MAE: 0.2605, Test MAPE: 0.1629, Test RMSE: 0.4234
Evaluate model on site 6 , Test MAE: 0.4611, Test MAPE: 0.1763, Test RMSE: 0.7141
Evaluate model on site 7 , Test MAE: 0.3004, Test MAPE: 0.3319, Test RMSE: 0.5885
Evaluate model on site 8 , Test MAE: 0.1921, Test MAPE: 0.5873, Test RMSE: 0.3401
Evaluate model on site 9 , Test MAE: 0.4475, Test MAPE: 0.1991, Test RMSE: 0.7303
Evaluate model on site 10 , Test MAE: 0.2108, Test MAPE: 0.7795, Test RMSE: 0.3268
On average over all site, Test MAE: 0.3059, Test MAPE: 0.3460, Test RMSE: 0.5339
(0.3059099793434143, 0.34596190974116325, 0.5338769078254699)
data::data/water/shangban/singleFac/3,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/3', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.4176899194717407
Validation loss decreased (inf --> 0.417690).  Saving model ...
Epoch:2,validate loss:0.3600059747695923
Validation loss decreased (0.417690 --> 0.360006).  Saving model ...
Epoch:3,validate loss:0.34473785758018494
Validation loss decreased (0.360006 --> 0.344738).  Saving model ...
Epoch:4,validate loss:0.367610901594162
Epoch:5,validate loss:0.35129520297050476
Epoch:6,validate loss:0.3446364998817444
Validation loss decreased (0.344738 --> 0.344636).  Saving model ...
Epoch:7,validate loss:0.32177767157554626
Validation loss decreased (0.344636 --> 0.321778).  Saving model ...
Epoch:8,validate loss:0.3412206172943115
Epoch:9,validate loss:0.33053234219551086
Epoch:10,validate loss:0.3270641565322876
Epoch:11,validate loss:0.3101115822792053
Validation loss decreased (0.321778 --> 0.310112).  Saving model ...
Epoch:12,validate loss:0.32367491722106934
Epoch:13,validate loss:0.31066107749938965
Epoch:14,validate loss:0.3111051619052887
Epoch:15,validate loss:0.30605244636535645
Validation loss decreased (0.310112 --> 0.306052).  Saving model ...
Epoch:16,validate loss:0.3142789602279663
Epoch:17,validate loss:0.31355974078178406
Epoch:18,validate loss:0.32063761353492737
Epoch:19,validate loss:0.323920339345932
Epoch:20,validate loss:0.3121872842311859
Epoch:21,validate loss:0.307491272687912
Epoch:22,validate loss:0.2984830439090729
Validation loss decreased (0.306052 --> 0.298483).  Saving model ...
Epoch:23,validate loss:0.3063185513019562
Epoch:24,validate loss:0.3059152364730835
Epoch:25,validate loss:0.3006085753440857
Epoch:26,validate loss:0.3044118583202362
Epoch:27,validate loss:0.30322012305259705
Epoch:28,validate loss:0.29876622557640076
Epoch:29,validate loss:0.3075500726699829
Epoch:30,validate loss:0.2983585000038147
Validation loss decreased (0.298483 --> 0.298359).  Saving model ...
Epoch:31,validate loss:0.3135942816734314
Epoch:32,validate loss:0.31741276383399963
Epoch:33,validate loss:0.3004361093044281
Epoch:34,validate loss:0.308660089969635
Epoch:35,validate loss:0.30616623163223267
Epoch:36,validate loss:0.3000492453575134
Epoch:37,validate loss:0.30333468317985535
Epoch:38,validate loss:0.3114203214645386
Epoch:39,validate loss:0.32597264647483826
Epoch:40,validate loss:0.30876657366752625
Epoch:41,validate loss:0.3101179599761963
Epoch:42,validate loss:0.3063919246196747
Epoch:43,validate loss:0.29424434900283813
Validation loss decreased (0.298359 --> 0.294244).  Saving model ...
Epoch:44,validate loss:0.29863879084587097
Epoch:45,validate loss:0.3037159740924835
Epoch:46,validate loss:0.3006437122821808
Epoch:47,validate loss:0.3165966868400574
Epoch:48,validate loss:0.3003717064857483
Epoch:49,validate loss:0.3085971474647522
Epoch:50,validate loss:0.2977934777736664
Epoch:51,validate loss:0.30165836215019226
Epoch:52,validate loss:0.30352747440338135
Epoch:53,validate loss:0.3030083179473877
Epoch:54,validate loss:0.29957640171051025
Epoch:55,validate loss:0.3089410960674286
Epoch:56,validate loss:0.3099062442779541
Epoch:57,validate loss:0.3045900762081146
Epoch:58,validate loss:0.31117919087409973
Epoch:59,validate loss:0.3141039311885834
Epoch:60,validate loss:0.3145790994167328
Epoch:61,validate loss:0.30084502696990967
Epoch:62,validate loss:0.30155640840530396
Epoch:63,validate loss:0.30302557349205017
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
0.99682707,7.7735296e-10,1.7325548e-10,1.7325548e-10,1.7325548e-10,1.0480737e-09,1.7325548e-10,0.0031729362,1.7325548e-10,1.7325548e-10,
0.00033637477,0.00033637477,0.00033637477,0.9969727,0.00033637477,0.00033637477,0.00033637477,0.00033637477,0.00033637477,0.00033637477,
0.00024882058,0.99620783,0.00024882058,0.00024882058,0.0017517145,0.00024882058,0.00024882058,0.00024882058,0.0002988123,0.00024882058,
0.00048063957,4.9862133e-06,4.9862133e-06,4.9862133e-06,4.9862133e-06,3.1254647e-05,0.00061907305,4.9862133e-06,0.9988391,4.9862133e-06,
2.4302958e-07,1.9914582e-06,0.04200923,2.4302958e-07,0.00055604434,2.4302958e-07,0.95743054,1.0566331e-06,2.4302958e-07,2.4302958e-07,
0.0056832395,0.00024855515,0.031590432,0.00024855515,0.00024855515,0.00024855515,0.00024855515,0.0011033287,0.96013165,0.00024855515,
0.9999504,1.8251415e-08,2.3832125e-09,1.15338805e-08,2.2024085e-06,2.7527203e-09,2.3832125e-09,4.4387207e-07,4.7022884e-05,2.3832125e-09,
7.436302e-05,1.4476244e-05,1.4476244e-05,3.5495614e-05,1.4476244e-05,0.99598926,0.002229706,0.0015568677,1.4476244e-05,5.6317946e-05,
0.92139685,2.5841404e-08,0.07835607,2.5841404e-08,1.1838914e-06,2.5841404e-08,0.00024556383,2.5841404e-08,2.5841404e-08,2.429596e-07,
1.8481774e-06,0.00046084344,0.0011647776,0.004120477,1.8481774e-06,1.8481774e-06,1.8481774e-06,0.0004410177,0.0039629755,0.9898425,
Evaluate model on site 1 , Test MAE: 0.3475, Test MAPE: 0.0990, Test RMSE: 0.5474
Evaluate model on site 2 , Test MAE: 0.4224, Test MAPE: 0.4722, Test RMSE: 0.7650
Evaluate model on site 3 , Test MAE: 0.1329, Test MAPE: 0.2715, Test RMSE: 0.3210
Evaluate model on site 4 , Test MAE: 0.3146, Test MAPE: 0.3747, Test RMSE: 0.6050
Evaluate model on site 5 , Test MAE: 0.2593, Test MAPE: 0.1660, Test RMSE: 0.4283
Evaluate model on site 6 , Test MAE: 0.4685, Test MAPE: 0.1756, Test RMSE: 0.7310
Evaluate model on site 7 , Test MAE: 0.3019, Test MAPE: 0.3364, Test RMSE: 0.5972
Evaluate model on site 8 , Test MAE: 0.1884, Test MAPE: 0.3540, Test RMSE: 0.3378
Evaluate model on site 9 , Test MAE: 0.4569, Test MAPE: 0.2078, Test RMSE: 0.7425
Evaluate model on site 10 , Test MAE: 0.2086, Test MAPE: 0.6063, Test RMSE: 0.3296
On average over all site, Test MAE: 0.3101, Test MAPE: 0.3064, Test RMSE: 0.5405
(0.3100947767496109, 0.30635500997304915, 0.5404840052127838)
data::data/water/shangban/singleFac/3,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/3', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.4289422035217285
Validation loss decreased (inf --> 0.428942).  Saving model ...
Epoch:2,validate loss:0.35246899724006653
Validation loss decreased (0.428942 --> 0.352469).  Saving model ...
Epoch:3,validate loss:0.35189172625541687
Validation loss decreased (0.352469 --> 0.351892).  Saving model ...
Epoch:4,validate loss:0.34027284383773804
Validation loss decreased (0.351892 --> 0.340273).  Saving model ...
Epoch:5,validate loss:0.3267671465873718
Validation loss decreased (0.340273 --> 0.326767).  Saving model ...
Epoch:6,validate loss:0.32910457253456116
Epoch:7,validate loss:0.32992133498191833
Epoch:8,validate loss:0.3446151912212372
Epoch:9,validate loss:0.3269864320755005
Epoch:10,validate loss:0.3276424705982208
Epoch:11,validate loss:0.31460222601890564
Validation loss decreased (0.326767 --> 0.314602).  Saving model ...
Epoch:12,validate loss:0.35359370708465576
Epoch:13,validate loss:0.31398454308509827
Validation loss decreased (0.314602 --> 0.313985).  Saving model ...
Epoch:14,validate loss:0.30540335178375244
Validation loss decreased (0.313985 --> 0.305403).  Saving model ...
Epoch:15,validate loss:0.3104051947593689
Epoch:16,validate loss:0.3193603754043579
Epoch:17,validate loss:0.3160598874092102
Epoch:18,validate loss:0.31505969166755676
Epoch:19,validate loss:0.3134077191352844
Epoch:20,validate loss:0.30933985114097595
Epoch:21,validate loss:0.3251354992389679
Epoch:22,validate loss:0.31474775075912476
Epoch:23,validate loss:0.3094276189804077
Epoch:24,validate loss:0.30584070086479187
Epoch:25,validate loss:0.3042065501213074
Validation loss decreased (0.305403 --> 0.304207).  Saving model ...
Epoch:26,validate loss:0.3143596053123474
Epoch:27,validate loss:0.3102722465991974
Epoch:28,validate loss:0.30808112025260925
Epoch:29,validate loss:0.31617990136146545
Epoch:30,validate loss:0.315089613199234
Epoch:31,validate loss:0.3368738293647766
Epoch:32,validate loss:0.3358067274093628
Epoch:33,validate loss:0.3136357069015503
Epoch:34,validate loss:0.3350484371185303
Epoch:35,validate loss:0.30510765314102173
Epoch:36,validate loss:0.3239566385746002
Epoch:37,validate loss:0.31083738803863525
Epoch:38,validate loss:0.3616834282875061
Epoch:39,validate loss:0.3114842176437378
Epoch:40,validate loss:0.3224852979183197
Epoch:41,validate loss:0.3107735514640808
Epoch:42,validate loss:0.3149067759513855
Epoch:43,validate loss:0.3145926296710968
Epoch:44,validate loss:0.33120524883270264
Epoch:45,validate loss:0.3077378571033478
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
3.415289e-09,7.678471e-08,3.415289e-09,3.415289e-09,0.9979184,3.415289e-09,3.0803893e-08,3.415289e-09,0.0019413191,0.0001401594,
0.0015979077,2.7525107e-06,0.99837106,2.7525107e-06,2.7525107e-06,1.1859515e-05,2.7525107e-06,2.7525107e-06,2.7525107e-06,2.7525107e-06,
2.393881e-09,3.106252e-11,0.0003150862,2.9124516e-09,3.106252e-11,1.4889712e-09,3.106252e-11,0.00059464504,0.9990426,4.7594036e-05,
1.368786e-10,1.368786e-10,3.4632863e-09,1.368786e-10,1.3920231e-05,1.368786e-10,4.828583e-08,0.00013407572,0.99985194,3.1533323e-10,
1.0168066e-07,0.99674404,2.0648264e-12,5.2006056e-12,1.1957406e-09,2.0577664e-07,2.0648264e-12,2.0648264e-12,0.0032556378,2.0648264e-12,
0.9981669,0.0013391009,3.0843644e-06,3.0843644e-06,3.0843644e-06,0.00013027964,0.0003307358,4.906879e-06,1.5759499e-05,3.0843644e-06,
0.99910337,1.0927846e-06,1.4323693e-05,1.0927846e-06,1.0927846e-06,1.0927846e-06,0.0008746442,1.0927846e-06,1.0927846e-06,1.0927846e-06,
0.00032336856,6.4564506e-07,0.0022435293,6.4564506e-07,6.4564506e-07,6.4564506e-07,0.997428,6.4564506e-07,6.4564506e-07,1.2617594e-06,
1.23577685e-11,0.9999516,3.3776725e-08,4.579545e-12,3.6901336e-05,2.3354229e-12,2.3354229e-12,2.3354229e-12,2.3354229e-12,1.14687155e-05,
1.0040741e-06,0.99686015,1.0040741e-06,0.0012016936,1.0040741e-06,4.3682253e-06,0.00036953393,1.0040741e-06,1.0329143e-06,0.0015591194,
Evaluate model on site 1 , Test MAE: 0.3448, Test MAPE: 0.0963, Test RMSE: 0.5311
Evaluate model on site 2 , Test MAE: 0.4077, Test MAPE: 0.4452, Test RMSE: 0.7304
Evaluate model on site 3 , Test MAE: 0.1442, Test MAPE: 0.2977, Test RMSE: 0.3313
Evaluate model on site 4 , Test MAE: 0.3161, Test MAPE: 0.3800, Test RMSE: 0.6119
Evaluate model on site 5 , Test MAE: 0.2669, Test MAPE: 0.1713, Test RMSE: 0.4283
Evaluate model on site 6 , Test MAE: 0.4707, Test MAPE: 0.1723, Test RMSE: 0.7243
Evaluate model on site 7 , Test MAE: 0.3010, Test MAPE: 0.3211, Test RMSE: 0.5877
Evaluate model on site 8 , Test MAE: 0.1988, Test MAPE: 0.3954, Test RMSE: 0.3492
Evaluate model on site 9 , Test MAE: 0.4413, Test MAPE: 0.1969, Test RMSE: 0.7143
Evaluate model on site 10 , Test MAE: 0.2172, Test MAPE: 0.6279, Test RMSE: 0.3400
On average over all site, Test MAE: 0.3109, Test MAPE: 0.3104, Test RMSE: 0.5348
(0.310870985686779, 0.3104171805083752, 0.5348436146974563)
[0.30564654171466826, 0.3057000443339348, 0.3059099793434143, 0.3100947767496109, 0.310870985686779]
data::data/water/shangban/singleFac/6,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/6', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:1.0547326803207397
Validation loss decreased (inf --> 1.054733).  Saving model ...
Epoch:2,validate loss:0.8395065069198608
Validation loss decreased (1.054733 --> 0.839507).  Saving model ...
Epoch:3,validate loss:0.8347778916358948
Validation loss decreased (0.839507 --> 0.834778).  Saving model ...
Epoch:4,validate loss:0.8179082274436951
Validation loss decreased (0.834778 --> 0.817908).  Saving model ...
Epoch:5,validate loss:0.842042863368988
Epoch:6,validate loss:0.8512211441993713
Epoch:7,validate loss:0.8128798007965088
Validation loss decreased (0.817908 --> 0.812880).  Saving model ...
Epoch:8,validate loss:0.8291777968406677
Epoch:9,validate loss:0.7964320182800293
Validation loss decreased (0.812880 --> 0.796432).  Saving model ...
Epoch:10,validate loss:0.8458669185638428
Epoch:11,validate loss:0.7989807724952698
Epoch:12,validate loss:0.8297702670097351
Epoch:13,validate loss:0.8115772604942322
Epoch:14,validate loss:0.843281090259552
Epoch:15,validate loss:0.8178656697273254
Epoch:16,validate loss:0.8002895712852478
Epoch:17,validate loss:0.7972731590270996
Epoch:18,validate loss:0.8101088404655457
Epoch:19,validate loss:0.8210049271583557
Epoch:20,validate loss:0.8550295233726501
Epoch:21,validate loss:0.8115670680999756
Epoch:22,validate loss:0.8063039779663086
Epoch:23,validate loss:0.8092920780181885
Epoch:24,validate loss:0.8067829608917236
Epoch:25,validate loss:0.797822117805481
Epoch:26,validate loss:0.8076112270355225
Epoch:27,validate loss:0.8091036677360535
Epoch:28,validate loss:0.786692202091217
Validation loss decreased (0.796432 --> 0.786692).  Saving model ...
Epoch:29,validate loss:0.8521490097045898
Epoch:30,validate loss:0.8002944588661194
Epoch:31,validate loss:0.8106415271759033
Epoch:32,validate loss:0.8136448860168457
Epoch:33,validate loss:0.8114039301872253
Epoch:34,validate loss:0.7991575598716736
Epoch:35,validate loss:0.8069380521774292
Epoch:36,validate loss:0.8054500818252563
Epoch:37,validate loss:0.8252472281455994
Epoch:38,validate loss:0.8494721055030823
Epoch:39,validate loss:0.8119366765022278
Epoch:40,validate loss:0.8304362893104553
Epoch:41,validate loss:0.814319908618927
Epoch:42,validate loss:0.8457291722297668
Epoch:43,validate loss:0.81007981300354
Epoch:44,validate loss:0.8274436593055725
Epoch:45,validate loss:0.8400580286979675
Epoch:46,validate loss:0.8212308883666992
Epoch:47,validate loss:0.8237099647521973
Epoch:48,validate loss:0.8239787817001343
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.8408, Test MAPE: 1.2338, Test RMSE: 1.2830
Evaluate model on site 2 , Test MAE: 0.7819, Test MAPE: 0.3321, Test RMSE: 1.2677
Evaluate model on site 3 , Test MAE: 0.8406, Test MAPE: 0.1859, Test RMSE: 1.2872
Evaluate model on site 4 , Test MAE: 0.6465, Test MAPE: 0.3978, Test RMSE: 1.0587
Evaluate model on site 5 , Test MAE: 0.6290, Test MAPE: 1.8537, Test RMSE: 1.1645
Evaluate model on site 6 , Test MAE: 0.7660, Test MAPE: 2.3427, Test RMSE: 1.2733
Evaluate model on site 7 , Test MAE: 0.9964, Test MAPE: 0.7769, Test RMSE: 1.7762
Evaluate model on site 8 , Test MAE: 0.7427, Test MAPE: 0.2796, Test RMSE: 1.2941
Evaluate model on site 9 , Test MAE: 1.1109, Test MAPE: 1.4359, Test RMSE: 1.6770
Evaluate model on site 10 , Test MAE: 0.9857, Test MAPE: 0.2064, Test RMSE: 1.4491
On average over all site, Test MAE: 0.8341, Test MAPE: 0.9045, Test RMSE: 1.3531
(0.8340604126453399, 0.9044741034507752, 1.3530755043029785)
data::data/water/shangban/singleFac/6,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/6', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:1.029738426208496
Validation loss decreased (inf --> 1.029738).  Saving model ...
Epoch:2,validate loss:0.8786897659301758
Validation loss decreased (1.029738 --> 0.878690).  Saving model ...
Epoch:3,validate loss:0.9077978134155273
Epoch:4,validate loss:0.8608860373497009
Validation loss decreased (0.878690 --> 0.860886).  Saving model ...
Epoch:5,validate loss:0.8372860550880432
Validation loss decreased (0.860886 --> 0.837286).  Saving model ...
Epoch:6,validate loss:0.8308579921722412
Validation loss decreased (0.837286 --> 0.830858).  Saving model ...
Epoch:7,validate loss:0.8566701412200928
Epoch:8,validate loss:0.809820830821991
Validation loss decreased (0.830858 --> 0.809821).  Saving model ...
Epoch:9,validate loss:0.8376107811927795
Epoch:10,validate loss:0.801864743232727
Validation loss decreased (0.809821 --> 0.801865).  Saving model ...
Epoch:11,validate loss:0.8101393580436707
Epoch:12,validate loss:0.809147834777832
Epoch:13,validate loss:0.8416133522987366
Epoch:14,validate loss:0.8061836957931519
Epoch:15,validate loss:0.8091124296188354
Epoch:16,validate loss:0.8000234365463257
Validation loss decreased (0.801865 --> 0.800023).  Saving model ...
Epoch:17,validate loss:0.8324877619743347
Epoch:18,validate loss:0.8266946077346802
Epoch:19,validate loss:0.7999815940856934
Validation loss decreased (0.800023 --> 0.799982).  Saving model ...
Epoch:20,validate loss:0.7931286096572876
Validation loss decreased (0.799982 --> 0.793129).  Saving model ...
Epoch:21,validate loss:0.817096471786499
Epoch:22,validate loss:0.804667592048645
Epoch:23,validate loss:0.804904043674469
Epoch:24,validate loss:0.8548898696899414
Epoch:25,validate loss:0.8132537007331848
Epoch:26,validate loss:0.7947985529899597
Epoch:27,validate loss:0.8194373250007629
Epoch:28,validate loss:0.803657591342926
Epoch:29,validate loss:0.8171629905700684
Epoch:30,validate loss:0.8019746541976929
Epoch:31,validate loss:0.8182650208473206
Epoch:32,validate loss:0.8038434982299805
Epoch:33,validate loss:0.8109349608421326
Epoch:34,validate loss:0.8130030632019043
Epoch:35,validate loss:0.8128783106803894
Epoch:36,validate loss:0.8058294057846069
Epoch:37,validate loss:0.8232603073120117
Epoch:38,validate loss:0.8036013841629028
Epoch:39,validate loss:0.8104403614997864
Epoch:40,validate loss:0.8222483992576599
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.8433, Test MAPE: 1.2170, Test RMSE: 1.2770
Evaluate model on site 2 , Test MAE: 0.8062, Test MAPE: 0.3452, Test RMSE: 1.2991
Evaluate model on site 3 , Test MAE: 0.8293, Test MAPE: 0.1882, Test RMSE: 1.2778
Evaluate model on site 4 , Test MAE: 0.6389, Test MAPE: 0.3941, Test RMSE: 1.0540
Evaluate model on site 5 , Test MAE: 0.6389, Test MAPE: 2.5840, Test RMSE: 1.1513
Evaluate model on site 6 , Test MAE: 0.7888, Test MAPE: 2.4874, Test RMSE: 1.2826
Evaluate model on site 7 , Test MAE: 1.0121, Test MAPE: 0.7631, Test RMSE: 1.7766
Evaluate model on site 8 , Test MAE: 0.7561, Test MAPE: 0.3208, Test RMSE: 1.2951
Evaluate model on site 9 , Test MAE: 1.1067, Test MAPE: 1.4175, Test RMSE: 1.6611
Evaluate model on site 10 , Test MAE: 0.9838, Test MAPE: 0.2082, Test RMSE: 1.4388
On average over all site, Test MAE: 0.8404, Test MAPE: 0.9925, Test RMSE: 1.3513
(0.8404219567775726, 0.9925324693322182, 1.3513434648513794)
data::data/water/shangban/singleFac/6,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/6', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:1.0469175577163696
Validation loss decreased (inf --> 1.046918).  Saving model ...
Epoch:2,validate loss:0.8701667785644531
Validation loss decreased (1.046918 --> 0.870167).  Saving model ...
Epoch:3,validate loss:0.8269469141960144
Validation loss decreased (0.870167 --> 0.826947).  Saving model ...
Epoch:4,validate loss:0.8147060871124268
Validation loss decreased (0.826947 --> 0.814706).  Saving model ...
Epoch:5,validate loss:0.8268007636070251
Epoch:6,validate loss:0.8310558795928955
Epoch:7,validate loss:0.8205859065055847
Epoch:8,validate loss:0.814711332321167
Epoch:9,validate loss:0.8273499608039856
Epoch:10,validate loss:0.8177499175071716
Epoch:11,validate loss:0.8216269612312317
Epoch:12,validate loss:0.7964672446250916
Validation loss decreased (0.814706 --> 0.796467).  Saving model ...
Epoch:13,validate loss:0.8015770316123962
Epoch:14,validate loss:0.8198492527008057
Epoch:15,validate loss:0.8155606985092163
Epoch:16,validate loss:0.8410067558288574
Epoch:17,validate loss:0.8162069320678711
Epoch:18,validate loss:0.7987563014030457
Epoch:19,validate loss:0.8115864396095276
Epoch:20,validate loss:0.8034909963607788
Epoch:21,validate loss:0.8130688667297363
Epoch:22,validate loss:0.8126508593559265
Epoch:23,validate loss:0.8116401433944702
Epoch:24,validate loss:0.8024120926856995
Epoch:25,validate loss:0.8183361887931824
Epoch:26,validate loss:0.813184380531311
Epoch:27,validate loss:0.8333380818367004
Epoch:28,validate loss:0.802409291267395
Epoch:29,validate loss:0.811028242111206
Epoch:30,validate loss:0.8235858082771301
Epoch:31,validate loss:0.824812114238739
Epoch:32,validate loss:0.8535997271537781
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.8602, Test MAPE: 1.2487, Test RMSE: 1.3107
Evaluate model on site 2 , Test MAE: 0.8079, Test MAPE: 0.3211, Test RMSE: 1.3104
Evaluate model on site 3 , Test MAE: 0.8343, Test MAPE: 0.1880, Test RMSE: 1.2728
Evaluate model on site 4 , Test MAE: 0.6391, Test MAPE: 0.4367, Test RMSE: 1.0477
Evaluate model on site 5 , Test MAE: 0.6193, Test MAPE: 1.7985, Test RMSE: 1.1513
Evaluate model on site 6 , Test MAE: 0.7706, Test MAPE: 2.2070, Test RMSE: 1.2688
Evaluate model on site 7 , Test MAE: 1.0069, Test MAPE: 0.7312, Test RMSE: 1.7877
Evaluate model on site 8 , Test MAE: 0.7518, Test MAPE: 0.2805, Test RMSE: 1.2898
Evaluate model on site 9 , Test MAE: 1.0913, Test MAPE: 1.2994, Test RMSE: 1.6523
Evaluate model on site 10 , Test MAE: 0.9889, Test MAPE: 0.2091, Test RMSE: 1.4440
On average over all site, Test MAE: 0.8370, Test MAPE: 0.8720, Test RMSE: 1.3535
(0.83704514503479, 0.8720369786024094, 1.353535544872284)
data::data/water/shangban/singleFac/6,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/6', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:1.1352506875991821
Validation loss decreased (inf --> 1.135251).  Saving model ...
Epoch:2,validate loss:0.8385648727416992
Validation loss decreased (1.135251 --> 0.838565).  Saving model ...
Epoch:3,validate loss:0.8539908528327942
Epoch:4,validate loss:0.8213155269622803
Validation loss decreased (0.838565 --> 0.821316).  Saving model ...
Epoch:5,validate loss:0.8184967637062073
Validation loss decreased (0.821316 --> 0.818497).  Saving model ...
Epoch:6,validate loss:0.8473389148712158
Epoch:7,validate loss:0.8813291192054749
Epoch:8,validate loss:0.8431740999221802
Epoch:9,validate loss:0.8416540026664734
Epoch:10,validate loss:0.8162280917167664
Validation loss decreased (0.818497 --> 0.816228).  Saving model ...
Epoch:11,validate loss:0.8142303824424744
Validation loss decreased (0.816228 --> 0.814230).  Saving model ...
Epoch:12,validate loss:0.8081365823745728
Validation loss decreased (0.814230 --> 0.808137).  Saving model ...
Epoch:13,validate loss:0.8040710687637329
Validation loss decreased (0.808137 --> 0.804071).  Saving model ...
Epoch:14,validate loss:0.8063341379165649
Epoch:15,validate loss:0.8330556750297546
Epoch:16,validate loss:0.8005947470664978
Validation loss decreased (0.804071 --> 0.800595).  Saving model ...
Epoch:17,validate loss:0.7942278385162354
Validation loss decreased (0.800595 --> 0.794228).  Saving model ...
Epoch:18,validate loss:0.8210541009902954
Epoch:19,validate loss:0.7967039346694946
Epoch:20,validate loss:0.8103573322296143
Epoch:21,validate loss:0.8020707964897156
Epoch:22,validate loss:0.8183354139328003
Epoch:23,validate loss:0.8152908682823181
Epoch:24,validate loss:0.7897689938545227
Validation loss decreased (0.794228 --> 0.789769).  Saving model ...
Epoch:25,validate loss:0.8096468448638916
Epoch:26,validate loss:0.8028829097747803
Epoch:27,validate loss:0.8030046224594116
Epoch:28,validate loss:0.8157626390457153
Epoch:29,validate loss:0.7910187244415283
Epoch:30,validate loss:0.8039230704307556
Epoch:31,validate loss:0.7946813702583313
Epoch:32,validate loss:0.7963906526565552
Epoch:33,validate loss:0.8072082996368408
Epoch:34,validate loss:0.8353725075721741
Epoch:35,validate loss:0.7963219881057739
Epoch:36,validate loss:0.795238196849823
Epoch:37,validate loss:0.8196974992752075
Epoch:38,validate loss:0.8277710676193237
Epoch:39,validate loss:0.8028280138969421
Epoch:40,validate loss:0.8022937178611755
Epoch:41,validate loss:0.8115533590316772
Epoch:42,validate loss:0.821213960647583
Epoch:43,validate loss:0.8183009028434753
Epoch:44,validate loss:0.8195363879203796
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.8518, Test MAPE: 1.2985, Test RMSE: 1.3000
Evaluate model on site 2 , Test MAE: 0.7829, Test MAPE: 0.3507, Test RMSE: 1.2755
Evaluate model on site 3 , Test MAE: 0.8361, Test MAPE: 0.1871, Test RMSE: 1.2757
Evaluate model on site 4 , Test MAE: 0.6346, Test MAPE: 0.3619, Test RMSE: 1.0466
Evaluate model on site 5 , Test MAE: 0.6337, Test MAPE: 2.1889, Test RMSE: 1.1566
Evaluate model on site 6 , Test MAE: 0.7635, Test MAPE: 2.4583, Test RMSE: 1.2606
Evaluate model on site 7 , Test MAE: 0.9874, Test MAPE: 0.7621, Test RMSE: 1.7712
Evaluate model on site 8 , Test MAE: 0.7391, Test MAPE: 0.3047, Test RMSE: 1.2869
Evaluate model on site 9 , Test MAE: 1.0878, Test MAPE: 1.3338, Test RMSE: 1.6562
Evaluate model on site 10 , Test MAE: 1.0023, Test MAPE: 0.2116, Test RMSE: 1.4678
On average over all site, Test MAE: 0.8319, Test MAPE: 0.9458, Test RMSE: 1.3497
(0.831923508644104, 0.9457687646150589, 1.3497132658958435)
data::data/water/shangban/singleFac/6,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/6', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:1.049878716468811
Validation loss decreased (inf --> 1.049879).  Saving model ...
Epoch:2,validate loss:0.8628198504447937
Validation loss decreased (1.049879 --> 0.862820).  Saving model ...
Epoch:3,validate loss:0.848823070526123
Validation loss decreased (0.862820 --> 0.848823).  Saving model ...
Epoch:4,validate loss:0.8205902576446533
Validation loss decreased (0.848823 --> 0.820590).  Saving model ...
Epoch:5,validate loss:0.8289494514465332
Epoch:6,validate loss:0.8091508746147156
Validation loss decreased (0.820590 --> 0.809151).  Saving model ...
Epoch:7,validate loss:0.8068379163742065
Validation loss decreased (0.809151 --> 0.806838).  Saving model ...
Epoch:8,validate loss:0.815456748008728
Epoch:9,validate loss:0.8073263168334961
Epoch:10,validate loss:0.8032988905906677
Validation loss decreased (0.806838 --> 0.803299).  Saving model ...
Epoch:11,validate loss:0.792777955532074
Validation loss decreased (0.803299 --> 0.792778).  Saving model ...
Epoch:12,validate loss:0.8086188435554504
Epoch:13,validate loss:0.8189888596534729
Epoch:14,validate loss:0.8264325857162476
Epoch:15,validate loss:0.8028233051300049
Epoch:16,validate loss:0.8297334313392639
Epoch:17,validate loss:0.8213993310928345
Epoch:18,validate loss:0.8077389001846313
Epoch:19,validate loss:0.8214723467826843
Epoch:20,validate loss:0.803318977355957
Epoch:21,validate loss:0.800458550453186
Epoch:22,validate loss:0.8240118026733398
Epoch:23,validate loss:0.80748051404953
Epoch:24,validate loss:0.7972744107246399
Epoch:25,validate loss:0.8005852103233337
Epoch:26,validate loss:0.820716381072998
Epoch:27,validate loss:0.8060638904571533
Epoch:28,validate loss:0.7978401780128479
Epoch:29,validate loss:0.8071883320808411
Epoch:30,validate loss:0.8213300704956055
Epoch:31,validate loss:0.8015226125717163
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.8605, Test MAPE: 1.2681, Test RMSE: 1.2977
Evaluate model on site 2 , Test MAE: 0.8085, Test MAPE: 0.3369, Test RMSE: 1.2971
Evaluate model on site 3 , Test MAE: 0.8218, Test MAPE: 0.1815, Test RMSE: 1.2488
Evaluate model on site 4 , Test MAE: 0.6395, Test MAPE: 0.4715, Test RMSE: 1.0335
Evaluate model on site 5 , Test MAE: 0.6222, Test MAPE: 1.7616, Test RMSE: 1.1299
Evaluate model on site 6 , Test MAE: 0.7689, Test MAPE: 2.2848, Test RMSE: 1.2646
Evaluate model on site 7 , Test MAE: 1.0079, Test MAPE: 0.8042, Test RMSE: 1.7452
Evaluate model on site 8 , Test MAE: 0.7549, Test MAPE: 0.2851, Test RMSE: 1.2735
Evaluate model on site 9 , Test MAE: 1.0832, Test MAPE: 1.3765, Test RMSE: 1.6328
Evaluate model on site 10 , Test MAE: 0.9718, Test MAPE: 0.2060, Test RMSE: 1.4156
On average over all site, Test MAE: 0.8339, Test MAPE: 0.8976, Test RMSE: 1.3339
(0.8339112281799317, 0.897623011469841, 1.3338585138320922)
[0.8340604126453399, 0.8404219567775726, 0.83704514503479, 0.831923508644104, 0.8339112281799317]
data::data/water/shangban/singleFac/6,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/6', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.9863449335098267
Validation loss decreased (inf --> 0.986345).  Saving model ...
Epoch:2,validate loss:0.8495234251022339
Validation loss decreased (0.986345 --> 0.849523).  Saving model ...
Epoch:3,validate loss:0.848237931728363
Validation loss decreased (0.849523 --> 0.848238).  Saving model ...
Epoch:4,validate loss:0.8799460530281067
Epoch:5,validate loss:0.8451433777809143
Validation loss decreased (0.848238 --> 0.845143).  Saving model ...
Epoch:6,validate loss:0.835402250289917
Validation loss decreased (0.845143 --> 0.835402).  Saving model ...
Epoch:7,validate loss:0.8175841569900513
Validation loss decreased (0.835402 --> 0.817584).  Saving model ...
Epoch:8,validate loss:0.8122689127922058
Validation loss decreased (0.817584 --> 0.812269).  Saving model ...
Epoch:9,validate loss:0.8246533274650574
Epoch:10,validate loss:0.8147263526916504
Epoch:11,validate loss:0.8189813494682312
Epoch:12,validate loss:0.8244137167930603
Epoch:13,validate loss:0.7978082895278931
Validation loss decreased (0.812269 --> 0.797808).  Saving model ...
Epoch:14,validate loss:0.8288360834121704
Epoch:15,validate loss:0.8023881912231445
Epoch:16,validate loss:0.8010647892951965
Epoch:17,validate loss:0.7999244928359985
Epoch:18,validate loss:0.8143071532249451
Epoch:19,validate loss:0.8079904317855835
Epoch:20,validate loss:0.8194988965988159
Epoch:21,validate loss:0.7959614396095276
Validation loss decreased (0.797808 --> 0.795961).  Saving model ...
Epoch:22,validate loss:0.8129493594169617
Epoch:23,validate loss:0.8088588118553162
Epoch:24,validate loss:0.8299171328544617
Epoch:25,validate loss:0.802903413772583
Epoch:26,validate loss:0.8067749738693237
Epoch:27,validate loss:0.7952215075492859
Validation loss decreased (0.795961 --> 0.795222).  Saving model ...
Epoch:28,validate loss:0.825202226638794
Epoch:29,validate loss:0.8458679914474487
Epoch:30,validate loss:0.7991706728935242
Epoch:31,validate loss:0.8020033240318298
Epoch:32,validate loss:0.8081105947494507
Epoch:33,validate loss:0.8347650170326233
Epoch:34,validate loss:0.8087993860244751
Epoch:35,validate loss:0.862955629825592
Epoch:36,validate loss:0.8010181784629822
Epoch:37,validate loss:0.8281881213188171
Epoch:38,validate loss:0.8153561353683472
Epoch:39,validate loss:0.8239780068397522
Epoch:40,validate loss:0.8207583427429199
Epoch:41,validate loss:0.8083590865135193
Epoch:42,validate loss:0.8209819197654724
Epoch:43,validate loss:0.8066810965538025
Epoch:44,validate loss:0.8258985280990601
Epoch:45,validate loss:0.8257668018341064
Epoch:46,validate loss:0.814171314239502
Epoch:47,validate loss:0.814245879650116
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
2.4553923e-10,6.318698e-10,2.0159685e-09,0.0016680628,0.0005200416,0.99781185,2.4553923e-10,6.845737e-09,2.4553923e-10,1.1935245e-07,
7.691149e-15,3.740804e-18,0.9994704,4.2369958e-10,4.318601e-18,3.740804e-18,7.549803e-14,3.740804e-18,6.184957e-06,0.00052336446,
1.7392805e-09,6.418542e-05,4.173495e-09,1.7392805e-09,1.7392805e-09,0.0006517683,1.7392805e-09,0.9990294,0.00025405711,6.1966506e-07,
2.4451838e-13,2.4451838e-13,2.4451838e-13,2.4451838e-13,8.84426e-09,2.5243393e-08,1.0,2.4451838e-13,2.4451838e-13,9.941294e-12,
7.7329446e-08,7.4349805e-07,7.7329446e-08,7.7329446e-08,7.7329446e-08,0.9991418,0.00054191303,7.7329446e-08,7.7329446e-08,0.0003151782,
2.8187374e-06,2.7199545e-15,0.001193116,1.6248596e-07,0.99880385,5.018528e-16,5.018528e-16,9.218888e-13,5.018528e-16,3.4369905e-13,
6.475046e-11,0.99887866,0.0011210946,1.5614272e-07,6.475046e-11,6.475046e-11,6.475046e-11,7.989774e-08,1.6923305e-09,6.475046e-11,
1.12934415e-13,0.0003642568,4.3647548e-13,1.12934415e-13,1.12934415e-13,0.0065204776,0.0004640956,9.392227e-07,0.9926502,5.3150058e-09,
2.8190708e-08,0.9982412,0.000113375165,9.233034e-06,1.4258012e-05,2.8190708e-08,2.8190708e-08,8.368538e-08,0.0008120678,0.00080977107,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,
Evaluate model on site 1 , Test MAE: 0.8433, Test MAPE: 1.4404, Test RMSE: 1.2628
Evaluate model on site 2 , Test MAE: 0.8200, Test MAPE: 0.3542, Test RMSE: 1.3146
Evaluate model on site 3 , Test MAE: 0.8251, Test MAPE: 0.2108, Test RMSE: 1.2355
Evaluate model on site 4 , Test MAE: 0.6425, Test MAPE: 0.6108, Test RMSE: 1.0606
Evaluate model on site 5 , Test MAE: 0.6251, Test MAPE: 2.4902, Test RMSE: 1.1451
Evaluate model on site 6 , Test MAE: 0.7439, Test MAPE: 2.2487, Test RMSE: 1.2492
Evaluate model on site 7 , Test MAE: 0.9703, Test MAPE: 0.7271, Test RMSE: 1.7581
Evaluate model on site 8 , Test MAE: 0.7427, Test MAPE: 0.2840, Test RMSE: 1.2566
Evaluate model on site 9 , Test MAE: 1.0737, Test MAPE: 1.3695, Test RMSE: 1.6257
Evaluate model on site 10 , Test MAE: 0.9842, Test MAPE: 0.2183, Test RMSE: 1.4232
On average over all site, Test MAE: 0.8271, Test MAPE: 0.9954, Test RMSE: 1.3331
(0.8270861864089966, 0.9954006895422935, 1.3331388711929322)
data::data/water/shangban/singleFac/6,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/6', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.9975098371505737
Validation loss decreased (inf --> 0.997510).  Saving model ...
Epoch:2,validate loss:0.85179203748703
Validation loss decreased (0.997510 --> 0.851792).  Saving model ...
Epoch:3,validate loss:0.8337669968605042
Validation loss decreased (0.851792 --> 0.833767).  Saving model ...
Epoch:4,validate loss:0.8293840289115906
Validation loss decreased (0.833767 --> 0.829384).  Saving model ...
Epoch:5,validate loss:0.8185258507728577
Validation loss decreased (0.829384 --> 0.818526).  Saving model ...
Epoch:6,validate loss:0.8268516063690186
Epoch:7,validate loss:0.832129716873169
Epoch:8,validate loss:0.8364353179931641
Epoch:9,validate loss:0.8113040328025818
Validation loss decreased (0.818526 --> 0.811304).  Saving model ...
Epoch:10,validate loss:0.8416102528572083
Epoch:11,validate loss:0.8121695518493652
Epoch:12,validate loss:0.8107325434684753
Validation loss decreased (0.811304 --> 0.810733).  Saving model ...
Epoch:13,validate loss:0.7997277975082397
Validation loss decreased (0.810733 --> 0.799728).  Saving model ...
Epoch:14,validate loss:0.8627773523330688
Epoch:15,validate loss:0.8229820728302002
Epoch:16,validate loss:0.8257776498794556
Epoch:17,validate loss:0.7980432510375977
Validation loss decreased (0.799728 --> 0.798043).  Saving model ...
Epoch:18,validate loss:0.8137859106063843
Epoch:19,validate loss:0.8015081286430359
Epoch:20,validate loss:0.8322510719299316
Epoch:21,validate loss:0.801271378993988
Epoch:22,validate loss:0.8019759654998779
Epoch:23,validate loss:0.8062613606452942
Epoch:24,validate loss:0.8010572791099548
Epoch:25,validate loss:0.7946776747703552
Validation loss decreased (0.798043 --> 0.794678).  Saving model ...
Epoch:26,validate loss:0.815083384513855
Epoch:27,validate loss:0.7933616042137146
Validation loss decreased (0.794678 --> 0.793362).  Saving model ...
Epoch:28,validate loss:0.8207635879516602
Epoch:29,validate loss:0.8067761063575745
Epoch:30,validate loss:0.8142669200897217
Epoch:31,validate loss:0.7989969253540039
Epoch:32,validate loss:0.8021106719970703
Epoch:33,validate loss:0.8137980699539185
Epoch:34,validate loss:0.7971821427345276
Epoch:35,validate loss:0.786154568195343
Validation loss decreased (0.793362 --> 0.786155).  Saving model ...
Epoch:36,validate loss:0.8046952486038208
Epoch:37,validate loss:0.8058984279632568
Epoch:38,validate loss:0.7877604365348816
Epoch:39,validate loss:0.7981305122375488
Epoch:40,validate loss:0.8110182285308838
Epoch:41,validate loss:0.8080558180809021
Epoch:42,validate loss:0.806510865688324
Epoch:43,validate loss:0.8023304343223572
Epoch:44,validate loss:0.8159897327423096
Epoch:45,validate loss:0.798633337020874
Epoch:46,validate loss:0.8167329430580139
Epoch:47,validate loss:0.8024279475212097
Epoch:48,validate loss:0.8195455074310303
Epoch:49,validate loss:0.8161576986312866
Epoch:50,validate loss:0.8444131016731262
Epoch:51,validate loss:0.8152293562889099
Epoch:52,validate loss:0.8134033679962158
Epoch:53,validate loss:0.808243453502655
Epoch:54,validate loss:0.8113781213760376
Epoch:55,validate loss:0.8117644190788269
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
6.372736e-05,8.951814e-09,5.9604424e-09,0.9991351,3.5172783e-07,5.9604424e-09,1.5228632e-07,5.9604424e-09,5.9604424e-09,0.00080076634,
0.9994273,4.2909072e-08,0.0005633868,4.2909072e-08,2.152911e-06,3.2841578e-07,4.2909072e-08,4.2909072e-08,8.8611154e-07,5.8449464e-06,
0.0041592508,3.1386164e-06,0.00038740708,3.1386164e-06,3.1386164e-06,0.0011084109,3.1386164e-06,0.98742515,0.0069039892,3.1386164e-06,
3.858726e-06,7.9693586e-05,0.9997943,3.7666097e-05,3.7982804e-07,3.7982804e-07,3.2106288e-06,4.0624076e-05,3.9450173e-05,3.7982804e-07,
3.436888e-13,0.99306023,0.0015424185,3.436888e-13,0.005397367,3.436888e-13,7.203117e-11,3.436888e-13,3.436888e-13,1.0113548e-12,
6.996818e-11,4.515082e-07,6.996818e-11,6.996818e-11,0.00051971286,6.996818e-11,1.1982559e-09,0.00071140245,0.9987684,6.996818e-11,
0.99993527,1.7718501e-06,2.6927444e-07,2.6927444e-07,2.6927444e-07,2.6927444e-07,5.591007e-05,5.4686343e-06,2.6927444e-07,2.6927444e-07,
6.683181e-13,6.683181e-13,0.99979573,6.683181e-13,0.00020433989,1.3629191e-12,1.3014582e-10,6.683181e-13,6.683181e-13,2.1175289e-11,
1.8111774e-06,3.6959103e-05,0.99899477,8.893224e-06,0.00013951983,0.0008023723,1.8111774e-06,1.02780805e-05,1.8111774e-06,1.8111774e-06,
1.3545164e-12,1.3545164e-12,0.0129499985,0.0002005997,0.0073117614,1.2121393e-09,1.3545164e-12,1.3545164e-12,0.9795376,1.3545164e-12,
Evaluate model on site 1 , Test MAE: 0.8437, Test MAPE: 1.2580, Test RMSE: 1.2667
Evaluate model on site 2 , Test MAE: 0.8094, Test MAPE: 0.3538, Test RMSE: 1.2986
Evaluate model on site 3 , Test MAE: 0.8243, Test MAPE: 0.2249, Test RMSE: 1.2326
Evaluate model on site 4 , Test MAE: 0.6302, Test MAPE: 0.4423, Test RMSE: 1.0115
Evaluate model on site 5 , Test MAE: 0.6332, Test MAPE: 1.8717, Test RMSE: 1.1762
Evaluate model on site 6 , Test MAE: 0.7793, Test MAPE: 2.0164, Test RMSE: 1.2888
Evaluate model on site 7 , Test MAE: 0.9870, Test MAPE: 0.6886, Test RMSE: 1.7523
Evaluate model on site 8 , Test MAE: 0.7525, Test MAPE: 0.4320, Test RMSE: 1.2791
Evaluate model on site 9 , Test MAE: 1.0998, Test MAPE: 1.3117, Test RMSE: 1.6528
Evaluate model on site 10 , Test MAE: 0.9792, Test MAPE: 0.2089, Test RMSE: 1.4405
On average over all site, Test MAE: 0.8338, Test MAPE: 0.8808, Test RMSE: 1.3399
(0.833847028017044, 0.8808367237448692, 1.33990877866745)
data::data/water/shangban/singleFac/6,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/6', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.9945334792137146
Validation loss decreased (inf --> 0.994533).  Saving model ...
Epoch:2,validate loss:0.8649274706840515
Validation loss decreased (0.994533 --> 0.864927).  Saving model ...
Epoch:3,validate loss:0.8619189262390137
Validation loss decreased (0.864927 --> 0.861919).  Saving model ...
Epoch:4,validate loss:0.8477755784988403
Validation loss decreased (0.861919 --> 0.847776).  Saving model ...
Epoch:5,validate loss:0.8203824758529663
Validation loss decreased (0.847776 --> 0.820382).  Saving model ...
Epoch:6,validate loss:0.8327326774597168
Epoch:7,validate loss:0.8160505294799805
Validation loss decreased (0.820382 --> 0.816051).  Saving model ...
Epoch:8,validate loss:0.8068892359733582
Validation loss decreased (0.816051 --> 0.806889).  Saving model ...
Epoch:9,validate loss:0.802659273147583
Validation loss decreased (0.806889 --> 0.802659).  Saving model ...
Epoch:10,validate loss:0.7984343767166138
Validation loss decreased (0.802659 --> 0.798434).  Saving model ...
Epoch:11,validate loss:0.8051290512084961
Epoch:12,validate loss:0.8515610694885254
Epoch:13,validate loss:0.8090483546257019
Epoch:14,validate loss:0.8073021769523621
Epoch:15,validate loss:0.7928180694580078
Validation loss decreased (0.798434 --> 0.792818).  Saving model ...
Epoch:16,validate loss:0.8379918932914734
Epoch:17,validate loss:0.8114293813705444
Epoch:18,validate loss:0.8565554022789001
Epoch:19,validate loss:0.8099283576011658
Epoch:20,validate loss:0.8121240139007568
Epoch:21,validate loss:0.8234132528305054
Epoch:22,validate loss:0.8031158447265625
Epoch:23,validate loss:0.8084248304367065
Epoch:24,validate loss:0.8230491280555725
Epoch:25,validate loss:0.8033356070518494
Epoch:26,validate loss:0.8052401542663574
Epoch:27,validate loss:0.8352136611938477
Epoch:28,validate loss:0.8442717790603638
Epoch:29,validate loss:0.792550802230835
Validation loss decreased (0.792818 --> 0.792551).  Saving model ...
Epoch:30,validate loss:0.8009445071220398
Epoch:31,validate loss:0.8042991161346436
Epoch:32,validate loss:0.810213029384613
Epoch:33,validate loss:0.7972074747085571
Epoch:34,validate loss:0.8114487528800964
Epoch:35,validate loss:0.814168393611908
Epoch:36,validate loss:0.8179830312728882
Epoch:37,validate loss:0.8169907331466675
Epoch:38,validate loss:0.8107680678367615
Epoch:39,validate loss:0.833049476146698
Epoch:40,validate loss:0.8259395956993103
Epoch:41,validate loss:0.8120681047439575
Epoch:42,validate loss:0.8157882690429688
Epoch:43,validate loss:0.8327120542526245
Epoch:44,validate loss:0.8074449896812439
Epoch:45,validate loss:0.8347657918930054
Epoch:46,validate loss:0.8175786733627319
Epoch:47,validate loss:0.8418025970458984
Epoch:48,validate loss:0.8119930624961853
Epoch:49,validate loss:0.8293177485466003
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
6.20581e-07,6.20581e-07,0.99865,6.20581e-07,0.0003785789,7.3095366e-06,0.0009329401,2.726015e-05,1.3443391e-06,6.20581e-07,
6.538526e-09,6.538526e-09,6.538526e-09,0.99958843,2.5762097e-07,0.0002120136,6.538526e-09,6.538526e-09,6.538526e-09,0.00019932435,
2.3247035e-09,0.00041982596,3.0169534e-08,2.3247035e-09,0.9995802,3.98534e-09,2.3247035e-09,2.3247035e-09,2.3247035e-09,2.3247035e-09,
4.818373e-13,0.02775442,2.9230193e-10,4.818373e-13,4.818373e-13,0.97224563,6.1179366e-13,5.2021118e-08,2.2596078e-11,4.818373e-13,
8.37907e-12,3.1147145e-05,8.37907e-12,0.9995377,0.0002642382,2.6845395e-05,0.00014007457,8.37907e-12,8.37907e-12,8.37907e-12,
6.3613015e-07,0.9864377,0.013557182,6.3613015e-07,6.3613015e-07,6.3613015e-07,6.3613015e-07,6.3613015e-07,7.827608e-07,6.3613015e-07,
3.2665357e-11,0.99822277,3.2665357e-11,4.8283802e-08,5.9630974e-11,5.1882307e-09,0.0017772762,3.2665357e-11,3.2665357e-11,2.2086633e-08,
3.6039953e-06,0.00050109444,1.1521768e-07,1.5404904e-08,1.5404904e-08,1.5404904e-08,2.6622468e-08,1.5404904e-08,0.9993925,0.00010270437,
0.99894005,4.0102412e-07,4.0102412e-07,4.0102412e-07,0.0010510978,4.0102412e-07,4.0102412e-07,4.0102412e-07,5.9640747e-06,4.0102412e-07,
4.0396173e-10,0.00046623105,8.3102214e-10,4.0396173e-10,4.0396173e-10,1.857556e-07,4.0396173e-10,0.9995334,4.0396173e-10,1.3243222e-07,
Evaluate model on site 1 , Test MAE: 0.8443, Test MAPE: 1.3112, Test RMSE: 1.2892
Evaluate model on site 2 , Test MAE: 0.7982, Test MAPE: 0.3442, Test RMSE: 1.3009
Evaluate model on site 3 , Test MAE: 0.8296, Test MAPE: 0.2041, Test RMSE: 1.2626
Evaluate model on site 4 , Test MAE: 0.6230, Test MAPE: 0.4551, Test RMSE: 1.0030
Evaluate model on site 5 , Test MAE: 0.6317, Test MAPE: 2.4679, Test RMSE: 1.1588
Evaluate model on site 6 , Test MAE: 0.7555, Test MAPE: 2.9129, Test RMSE: 1.2794
Evaluate model on site 7 , Test MAE: 1.0022, Test MAPE: 0.6954, Test RMSE: 1.7979
Evaluate model on site 8 , Test MAE: 0.7456, Test MAPE: 0.2900, Test RMSE: 1.2736
Evaluate model on site 9 , Test MAE: 1.0921, Test MAPE: 1.3310, Test RMSE: 1.6572
Evaluate model on site 10 , Test MAE: 0.9651, Test MAPE: 0.2024, Test RMSE: 1.4354
On average over all site, Test MAE: 0.8287, Test MAPE: 1.0214, Test RMSE: 1.3458
(0.8287289023399353, 1.0214145332574844, 1.3458045721054077)
data::data/water/shangban/singleFac/6,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/6', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.9888127446174622
Validation loss decreased (inf --> 0.988813).  Saving model ...
Epoch:2,validate loss:0.9292277097702026
Validation loss decreased (0.988813 --> 0.929228).  Saving model ...
Epoch:3,validate loss:0.8289612531661987
Validation loss decreased (0.929228 --> 0.828961).  Saving model ...
Epoch:4,validate loss:0.8507542014122009
Epoch:5,validate loss:0.8441386222839355
Epoch:6,validate loss:0.8406063318252563
Epoch:7,validate loss:0.8115169405937195
Validation loss decreased (0.828961 --> 0.811517).  Saving model ...
Epoch:8,validate loss:0.8111741542816162
Validation loss decreased (0.811517 --> 0.811174).  Saving model ...
Epoch:9,validate loss:0.8196036219596863
Epoch:10,validate loss:0.8168687224388123
Epoch:11,validate loss:0.8274980187416077
Epoch:12,validate loss:0.8141870498657227
Epoch:13,validate loss:0.8089607954025269
Validation loss decreased (0.811174 --> 0.808961).  Saving model ...
Epoch:14,validate loss:0.8081924915313721
Validation loss decreased (0.808961 --> 0.808192).  Saving model ...
Epoch:15,validate loss:0.822047233581543
Epoch:16,validate loss:0.813514769077301
Epoch:17,validate loss:0.7989493608474731
Validation loss decreased (0.808192 --> 0.798949).  Saving model ...
Epoch:18,validate loss:0.8310898542404175
Epoch:19,validate loss:0.8042032122612
Epoch:20,validate loss:0.8046606779098511
Epoch:21,validate loss:0.8005661368370056
Epoch:22,validate loss:0.7944630980491638
Validation loss decreased (0.798949 --> 0.794463).  Saving model ...
Epoch:23,validate loss:0.805884063243866
Epoch:24,validate loss:0.8089827299118042
Epoch:25,validate loss:0.8274746537208557
Epoch:26,validate loss:0.8055937886238098
Epoch:27,validate loss:0.8009120225906372
Epoch:28,validate loss:0.7949205040931702
Epoch:29,validate loss:0.7974608540534973
Epoch:30,validate loss:0.7987573146820068
Epoch:31,validate loss:0.8169699311256409
Epoch:32,validate loss:0.8096850514411926
Epoch:33,validate loss:0.80096834897995
Epoch:34,validate loss:0.8025421500205994
Epoch:35,validate loss:0.8284227848052979
Epoch:36,validate loss:0.8050028681755066
Epoch:37,validate loss:0.7974708676338196
Epoch:38,validate loss:0.79686039686203
Epoch:39,validate loss:0.8183070421218872
Epoch:40,validate loss:0.8161759376525879
Epoch:41,validate loss:0.8248868584632874
Epoch:42,validate loss:0.8121150135993958
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
0.99239516,0.0076048295,5.773502e-17,5.773502e-17,5.773502e-17,5.773502e-17,5.773502e-17,4.428574e-09,3.5297983e-16,5.773502e-17,
1.3607705e-08,4.6395476e-07,1.0019664e-06,1.3607705e-08,1.3607705e-08,0.9995912,0.0004071641,1.18019685e-07,1.3607705e-08,1.3607705e-08,
1.9896568e-14,1.9896568e-14,0.0044682655,1.9896568e-14,1.2486095e-08,1.9896568e-14,3.7056607e-09,0.9955317,7.3187326e-14,4.923737e-13,
3.38621e-10,0.9999937,9.294018e-16,5.909875e-10,9.294018e-16,9.294018e-16,9.294018e-16,1.2523882e-13,6.3630505e-06,9.449781e-16,
4.056495e-07,1.5838668e-06,0.9999695,6.025964e-08,1.4930207e-10,1.4930207e-10,3.0493968e-07,1.4930207e-10,1.4930207e-10,2.8173143e-05,
5.6955804e-07,6.071271e-14,6.545958e-13,6.071271e-14,3.3902518e-07,6.151163e-14,6.487983e-06,6.071271e-14,0.0009214699,0.9990711,
1.247202e-06,8.726629e-06,2.7749755e-07,2.7749755e-07,0.0007260539,3.6352325e-05,2.7749755e-07,2.7749755e-07,0.99922633,2.7749755e-07,
1.7417218e-10,1.7417218e-10,0.0004362446,2.2261904e-08,2.5182974e-06,4.9046704e-08,5.537311e-07,1.7417218e-10,0.99956053,4.873626e-08,
0.9945832,1.1859547e-11,1.1859547e-11,1.1859547e-11,2.718187e-06,1.1859547e-11,1.1859547e-11,0.004382437,1.1859547e-11,0.0010316992,
3.7716063e-07,2.611123e-07,4.781677e-09,4.781677e-09,5.5217826e-09,0.9999994,6.727469e-09,5.5988933e-09,4.781677e-09,4.781677e-09,
Evaluate model on site 1 , Test MAE: 0.8707, Test MAPE: 1.0499, Test RMSE: 1.2957
Evaluate model on site 2 , Test MAE: 0.7918, Test MAPE: 0.3377, Test RMSE: 1.2828
Evaluate model on site 3 , Test MAE: 0.8179, Test MAPE: 0.1872, Test RMSE: 1.2447
Evaluate model on site 4 , Test MAE: 0.6306, Test MAPE: 0.4137, Test RMSE: 1.0298
Evaluate model on site 5 , Test MAE: 0.6240, Test MAPE: 1.9464, Test RMSE: 1.1574
Evaluate model on site 6 , Test MAE: 0.7635, Test MAPE: 2.4214, Test RMSE: 1.2431
Evaluate model on site 7 , Test MAE: 0.9975, Test MAPE: 0.6574, Test RMSE: 1.7734
Evaluate model on site 8 , Test MAE: 0.7436, Test MAPE: 0.3079, Test RMSE: 1.2676
Evaluate model on site 9 , Test MAE: 1.0589, Test MAPE: 1.2462, Test RMSE: 1.6127
Evaluate model on site 10 , Test MAE: 0.9677, Test MAPE: 0.1980, Test RMSE: 1.4172
On average over all site, Test MAE: 0.8266, Test MAPE: 0.8766, Test RMSE: 1.3325
(0.8266085624694824, 0.8765835896134376, 1.3324555516242982)
data::data/water/shangban/singleFac/6,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/6', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:1.0142792463302612
Validation loss decreased (inf --> 1.014279).  Saving model ...
Epoch:2,validate loss:0.8647918105125427
Validation loss decreased (1.014279 --> 0.864792).  Saving model ...
Epoch:3,validate loss:0.8487380146980286
Validation loss decreased (0.864792 --> 0.848738).  Saving model ...
Epoch:4,validate loss:0.8428004384040833
Validation loss decreased (0.848738 --> 0.842800).  Saving model ...
Epoch:5,validate loss:0.8651076555252075
Epoch:6,validate loss:0.8526579141616821
Epoch:7,validate loss:0.8650683760643005
Epoch:8,validate loss:0.8312642574310303
Validation loss decreased (0.842800 --> 0.831264).  Saving model ...
Epoch:9,validate loss:0.8508906364440918
Epoch:10,validate loss:0.827928900718689
Validation loss decreased (0.831264 --> 0.827929).  Saving model ...
Epoch:11,validate loss:0.8175505995750427
Validation loss decreased (0.827929 --> 0.817551).  Saving model ...
Epoch:12,validate loss:0.8114635944366455
Validation loss decreased (0.817551 --> 0.811464).  Saving model ...
Epoch:13,validate loss:0.8261274099349976
Epoch:14,validate loss:0.817628026008606
Epoch:15,validate loss:0.813087522983551
Epoch:16,validate loss:0.8080741763114929
Validation loss decreased (0.811464 --> 0.808074).  Saving model ...
Epoch:17,validate loss:0.8046707510948181
Validation loss decreased (0.808074 --> 0.804671).  Saving model ...
Epoch:18,validate loss:0.8327534198760986
Epoch:19,validate loss:0.8274471759796143
Epoch:20,validate loss:0.8160985708236694
Epoch:21,validate loss:0.8095892667770386
Epoch:22,validate loss:0.8258373737335205
Epoch:23,validate loss:0.8124252557754517
Epoch:24,validate loss:0.8017035722732544
Validation loss decreased (0.804671 --> 0.801704).  Saving model ...
Epoch:25,validate loss:0.8038334250450134
Epoch:26,validate loss:0.838478147983551
Epoch:27,validate loss:0.821474015712738
Epoch:28,validate loss:0.8232625126838684
Epoch:29,validate loss:0.8166506886482239
Epoch:30,validate loss:0.8111726641654968
Epoch:31,validate loss:0.8328181505203247
Epoch:32,validate loss:0.8304798007011414
Epoch:33,validate loss:0.811195969581604
Epoch:34,validate loss:0.8163036704063416
Epoch:35,validate loss:0.8086991906166077
Epoch:36,validate loss:0.808983325958252
Epoch:37,validate loss:0.8036069869995117
Epoch:38,validate loss:0.8235629796981812
Epoch:39,validate loss:0.8043946027755737
Epoch:40,validate loss:0.8182929158210754
Epoch:41,validate loss:0.8164506554603577
Epoch:42,validate loss:0.829533576965332
Epoch:43,validate loss:0.8099761009216309
Epoch:44,validate loss:0.8247238397598267
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
1.0084964e-10,8.497131e-09,5.8270194e-11,2.1138085e-09,0.004620009,5.8270194e-11,0.9953577,2.2334725e-05,5.8270194e-11,5.8270194e-11,
8.006923e-12,3.2737284e-09,8.006923e-12,1.0,8.006923e-12,8.006923e-12,3.260062e-10,8.006923e-12,1.8314123e-11,8.006923e-12,
5.0844356e-08,0.9018596,0.093383685,9.671756e-09,0.0002481473,7.9002543e-10,0.0045061787,7.9002543e-10,1.40711665e-08,2.3845093e-06,
0.0006415188,1.6745273e-07,0.0009769808,1.6745273e-07,0.0010372776,1.3172383e-06,1.6745273e-07,1.6745273e-07,0.99734193,1.6745273e-07,
2.961848e-11,0.9999999,6.375231e-08,3.308231e-10,2.139104e-08,2.961848e-11,2.961848e-11,3.9856556e-11,2.961848e-11,2.961848e-11,
3.4234574e-10,3.4234574e-10,0.00030053884,3.4234574e-10,0.000111555,0.0007103873,0.00034078676,0.9985366,3.4234574e-10,1.005881e-07,
0.0010218448,2.1567082e-06,2.1567082e-06,0.9966382,2.1567082e-06,2.1567082e-06,0.0012819892,0.00059988146,2.1567082e-06,0.0004473321,
6.872777e-11,1.4543473e-11,4.5958964e-10,1.4543473e-11,5.38346e-07,1.4543473e-11,0.99886346,0.0011360223,1.4543473e-11,1.4543473e-11,
0.9983448,2.3239881e-09,0.0016476639,4.6016413e-09,2.3239881e-09,2.3239881e-09,2.3239881e-09,7.5168255e-06,5.784635e-09,2.3239881e-09,
0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,
Evaluate model on site 1 , Test MAE: 0.8534, Test MAPE: 1.0441, Test RMSE: 1.2963
Evaluate model on site 2 , Test MAE: 0.7897, Test MAPE: 0.3389, Test RMSE: 1.2976
Evaluate model on site 3 , Test MAE: 0.8299, Test MAPE: 0.1855, Test RMSE: 1.2752
Evaluate model on site 4 , Test MAE: 0.6048, Test MAPE: 0.3106, Test RMSE: 0.9844
Evaluate model on site 5 , Test MAE: 0.6368, Test MAPE: 1.9738, Test RMSE: 1.1733
Evaluate model on site 6 , Test MAE: 0.7668, Test MAPE: 1.9807, Test RMSE: 1.2637
Evaluate model on site 7 , Test MAE: 0.9903, Test MAPE: 0.8915, Test RMSE: 1.7459
Evaluate model on site 8 , Test MAE: 0.7467, Test MAPE: 0.2825, Test RMSE: 1.2983
Evaluate model on site 9 , Test MAE: 1.0921, Test MAPE: 1.3508, Test RMSE: 1.6522
Evaluate model on site 10 , Test MAE: 0.9814, Test MAPE: 0.2064, Test RMSE: 1.4427
On average over all site, Test MAE: 0.8292, Test MAPE: 0.8565, Test RMSE: 1.3430
(0.8291918098926544, 0.8564658716320992, 1.3429726660251617)
[0.8270861864089966, 0.833847028017044, 0.8287289023399353, 0.8266085624694824, 0.8291918098926544]
data::data/water/shangban/singleFac/8,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/8', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.8696891069412231
Validation loss decreased (inf --> 0.869689).  Saving model ...
Epoch:2,validate loss:0.5367439389228821
Validation loss decreased (0.869689 --> 0.536744).  Saving model ...
Epoch:3,validate loss:0.46994075179100037
Validation loss decreased (0.536744 --> 0.469941).  Saving model ...
Epoch:4,validate loss:0.468703955411911
Validation loss decreased (0.469941 --> 0.468704).  Saving model ...
Epoch:5,validate loss:0.4738161563873291
Epoch:6,validate loss:0.46345940232276917
Validation loss decreased (0.468704 --> 0.463459).  Saving model ...
Epoch:7,validate loss:0.48892486095428467
Epoch:8,validate loss:0.46854162216186523
Epoch:9,validate loss:0.45177900791168213
Validation loss decreased (0.463459 --> 0.451779).  Saving model ...
Epoch:10,validate loss:0.46521997451782227
Epoch:11,validate loss:0.4788074195384979
Epoch:12,validate loss:0.4546568989753723
Epoch:13,validate loss:0.4811064600944519
Epoch:14,validate loss:0.4796244204044342
Epoch:15,validate loss:0.462958425283432
Epoch:16,validate loss:0.4926004707813263
Epoch:17,validate loss:0.4550870358943939
Epoch:18,validate loss:0.4524669647216797
Epoch:19,validate loss:0.5117460489273071
Epoch:20,validate loss:0.4641626477241516
Epoch:21,validate loss:0.47057655453681946
Epoch:22,validate loss:0.5056524872779846
Epoch:23,validate loss:0.5162281394004822
Epoch:24,validate loss:0.47515028715133667
Epoch:25,validate loss:0.45978233218193054
Epoch:26,validate loss:0.46131280064582825
Epoch:27,validate loss:0.4619670808315277
Epoch:28,validate loss:0.464804083108902
Epoch:29,validate loss:0.46551522612571716
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.3317, Test MAPE: 0.0362, Test RMSE: 0.5659
Evaluate model on site 2 , Test MAE: 0.5419, Test MAPE: 0.0701, Test RMSE: 0.8708
Evaluate model on site 3 , Test MAE: 0.2965, Test MAPE: 0.1019, Test RMSE: 0.6025
Evaluate model on site 4 , Test MAE: 0.5056, Test MAPE: 0.1071, Test RMSE: 0.8988
Evaluate model on site 5 , Test MAE: 0.4204, Test MAPE: 0.0945, Test RMSE: 0.7658
Evaluate model on site 6 , Test MAE: 0.6879, Test MAPE: 0.2104, Test RMSE: 1.1609
Evaluate model on site 7 , Test MAE: 0.4752, Test MAPE: 0.1235, Test RMSE: 0.7844
Evaluate model on site 8 , Test MAE: 0.5572, Test MAPE: 0.1187, Test RMSE: 1.0983
Evaluate model on site 9 , Test MAE: 0.5671, Test MAPE: 0.1096, Test RMSE: 0.9818
Evaluate model on site 10 , Test MAE: 0.4165, Test MAPE: 0.5761, Test RMSE: 0.7171
On average over all site, Test MAE: 0.4800, Test MAPE: 0.1548, Test RMSE: 0.8446
(0.480004745721817, 0.1548073899000883, 0.8446390628814697)
data::data/water/shangban/singleFac/8,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/8', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.6986187696456909
Validation loss decreased (inf --> 0.698619).  Saving model ...
Epoch:2,validate loss:0.5055281519889832
Validation loss decreased (0.698619 --> 0.505528).  Saving model ...
Epoch:3,validate loss:0.4793992340564728
Validation loss decreased (0.505528 --> 0.479399).  Saving model ...
Epoch:4,validate loss:0.4650364816188812
Validation loss decreased (0.479399 --> 0.465036).  Saving model ...
Epoch:5,validate loss:0.46709978580474854
Epoch:6,validate loss:0.4704432487487793
Epoch:7,validate loss:0.4592634439468384
Validation loss decreased (0.465036 --> 0.459263).  Saving model ...
Epoch:8,validate loss:0.45624616742134094
Validation loss decreased (0.459263 --> 0.456246).  Saving model ...
Epoch:9,validate loss:0.5390823483467102
Epoch:10,validate loss:0.5199084281921387
Epoch:11,validate loss:0.5204371809959412
Epoch:12,validate loss:0.5225330591201782
Epoch:13,validate loss:0.4708125591278076
Epoch:14,validate loss:0.5479549765586853
Epoch:15,validate loss:0.49550479650497437
Epoch:16,validate loss:0.46213942766189575
Epoch:17,validate loss:0.4628256857395172
Epoch:18,validate loss:0.4740787148475647
Epoch:19,validate loss:0.4743002951145172
Epoch:20,validate loss:0.5176167488098145
Epoch:21,validate loss:0.49552229046821594
Epoch:22,validate loss:0.4617370665073395
Epoch:23,validate loss:0.5061996579170227
Epoch:24,validate loss:0.47538480162620544
Epoch:25,validate loss:0.4665617346763611
Epoch:26,validate loss:0.49231740832328796
Epoch:27,validate loss:0.4739685356616974
Epoch:28,validate loss:0.46581804752349854
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.3488, Test MAPE: 0.0380, Test RMSE: 0.5759
Evaluate model on site 2 , Test MAE: 0.5405, Test MAPE: 0.0695, Test RMSE: 0.8662
Evaluate model on site 3 , Test MAE: 0.2985, Test MAPE: 0.1028, Test RMSE: 0.6036
Evaluate model on site 4 , Test MAE: 0.5069, Test MAPE: 0.1072, Test RMSE: 0.9011
Evaluate model on site 5 , Test MAE: 0.4191, Test MAPE: 0.0939, Test RMSE: 0.7630
Evaluate model on site 6 , Test MAE: 0.6898, Test MAPE: 0.2105, Test RMSE: 1.1632
Evaluate model on site 7 , Test MAE: 0.4800, Test MAPE: 0.1247, Test RMSE: 0.7920
Evaluate model on site 8 , Test MAE: 0.5525, Test MAPE: 0.1158, Test RMSE: 1.0937
Evaluate model on site 9 , Test MAE: 0.5728, Test MAPE: 0.1106, Test RMSE: 0.9887
Evaluate model on site 10 , Test MAE: 0.4100, Test MAPE: 0.5779, Test RMSE: 0.7132
On average over all site, Test MAE: 0.4819, Test MAPE: 0.1551, Test RMSE: 0.8461
(0.48187865912914274, 0.15509234108030795, 0.8460542142391205)
data::data/water/shangban/singleFac/8,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/8', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.7008243203163147
Validation loss decreased (inf --> 0.700824).  Saving model ...
Epoch:2,validate loss:0.5618558526039124
Validation loss decreased (0.700824 --> 0.561856).  Saving model ...
Epoch:3,validate loss:0.4722195565700531
Validation loss decreased (0.561856 --> 0.472220).  Saving model ...
Epoch:4,validate loss:0.4617106318473816
Validation loss decreased (0.472220 --> 0.461711).  Saving model ...
Epoch:5,validate loss:0.4970656931400299
Epoch:6,validate loss:0.5192440152168274
Epoch:7,validate loss:0.5041881203651428
Epoch:8,validate loss:0.4526660144329071
Validation loss decreased (0.461711 --> 0.452666).  Saving model ...
Epoch:9,validate loss:0.49561432003974915
Epoch:10,validate loss:0.4591882824897766
Epoch:11,validate loss:0.45620405673980713
Epoch:12,validate loss:0.4681188762187958
Epoch:13,validate loss:0.45476406812667847
Epoch:14,validate loss:0.5118296146392822
Epoch:15,validate loss:0.4835486114025116
Epoch:16,validate loss:0.45791366696357727
Epoch:17,validate loss:0.45978498458862305
Epoch:18,validate loss:0.45387282967567444
Epoch:19,validate loss:0.47182539105415344
Epoch:20,validate loss:0.4713011682033539
Epoch:21,validate loss:0.4867998957633972
Epoch:22,validate loss:0.4618156850337982
Epoch:23,validate loss:0.49359631538391113
Epoch:24,validate loss:0.4556639790534973
Epoch:25,validate loss:0.4648888111114502
Epoch:26,validate loss:0.473870187997818
Epoch:27,validate loss:0.5004549026489258
Epoch:28,validate loss:0.4608113169670105
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.3323, Test MAPE: 0.0367, Test RMSE: 0.5822
Evaluate model on site 2 , Test MAE: 0.5389, Test MAPE: 0.0695, Test RMSE: 0.8694
Evaluate model on site 3 , Test MAE: 0.2865, Test MAPE: 0.0953, Test RMSE: 0.6062
Evaluate model on site 4 , Test MAE: 0.5100, Test MAPE: 0.1067, Test RMSE: 0.9046
Evaluate model on site 5 , Test MAE: 0.4271, Test MAPE: 0.0946, Test RMSE: 0.7713
Evaluate model on site 6 , Test MAE: 0.6943, Test MAPE: 0.2077, Test RMSE: 1.1690
Evaluate model on site 7 , Test MAE: 0.4884, Test MAPE: 0.1246, Test RMSE: 0.7983
Evaluate model on site 8 , Test MAE: 0.5542, Test MAPE: 0.1127, Test RMSE: 1.1050
Evaluate model on site 9 , Test MAE: 0.5711, Test MAPE: 0.1088, Test RMSE: 1.0010
Evaluate model on site 10 , Test MAE: 0.4057, Test MAPE: 0.5439, Test RMSE: 0.7128
On average over all site, Test MAE: 0.4808, Test MAPE: 0.1500, Test RMSE: 0.8520
(0.4808449983596802, 0.1500327929854393, 0.8519931674003601)
data::data/water/shangban/singleFac/8,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/8', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.8097680807113647
Validation loss decreased (inf --> 0.809768).  Saving model ...
Epoch:2,validate loss:0.5741434693336487
Validation loss decreased (0.809768 --> 0.574143).  Saving model ...
Epoch:3,validate loss:0.4647146165370941
Validation loss decreased (0.574143 --> 0.464715).  Saving model ...
Epoch:4,validate loss:0.460011750459671
Validation loss decreased (0.464715 --> 0.460012).  Saving model ...
Epoch:5,validate loss:0.4715951383113861
Epoch:6,validate loss:0.5328221321105957
Epoch:7,validate loss:0.4980185329914093
Epoch:8,validate loss:0.471587598323822
Epoch:9,validate loss:0.494402140378952
Epoch:10,validate loss:0.48003554344177246
Epoch:11,validate loss:0.4590955972671509
Validation loss decreased (0.460012 --> 0.459096).  Saving model ...
Epoch:12,validate loss:0.5092226266860962
Epoch:13,validate loss:0.454990416765213
Validation loss decreased (0.459096 --> 0.454990).  Saving model ...
Epoch:14,validate loss:0.5113933682441711
Epoch:15,validate loss:0.4710705578327179
Epoch:16,validate loss:0.5027496218681335
Epoch:17,validate loss:0.4599994122982025
Epoch:18,validate loss:0.4532904326915741
Validation loss decreased (0.454990 --> 0.453290).  Saving model ...
Epoch:19,validate loss:0.4562261402606964
Epoch:20,validate loss:0.46013814210891724
Epoch:21,validate loss:0.4611310064792633
Epoch:22,validate loss:0.4543079733848572
Epoch:23,validate loss:0.4646663963794708
Epoch:24,validate loss:0.460320383310318
Epoch:25,validate loss:0.4490277171134949
Validation loss decreased (0.453290 --> 0.449028).  Saving model ...
Epoch:26,validate loss:0.45791006088256836
Epoch:27,validate loss:0.4563782513141632
Epoch:28,validate loss:0.49068084359169006
Epoch:29,validate loss:0.48042237758636475
Epoch:30,validate loss:0.4536421000957489
Epoch:31,validate loss:0.4795999228954315
Epoch:32,validate loss:0.45320913195610046
Epoch:33,validate loss:0.4525214731693268
Epoch:34,validate loss:0.4725877642631531
Epoch:35,validate loss:0.45345085859298706
Epoch:36,validate loss:0.4798201620578766
Epoch:37,validate loss:0.4779873788356781
Epoch:38,validate loss:0.448548287153244
Validation loss decreased (0.449028 --> 0.448548).  Saving model ...
Epoch:39,validate loss:0.48365575075149536
Epoch:40,validate loss:0.4614622890949249
Epoch:41,validate loss:0.4617120325565338
Epoch:42,validate loss:0.4626157879829407
Epoch:43,validate loss:0.4653915464878082
Epoch:44,validate loss:0.4414399564266205
Validation loss decreased (0.448548 --> 0.441440).  Saving model ...
Epoch:45,validate loss:0.4524870216846466
Epoch:46,validate loss:0.5102565288543701
Epoch:47,validate loss:0.450938880443573
Epoch:48,validate loss:0.47938159108161926
Epoch:49,validate loss:0.46786025166511536
Epoch:50,validate loss:0.4704771041870117
Epoch:51,validate loss:0.47605541348457336
Epoch:52,validate loss:0.4797602593898773
Epoch:53,validate loss:0.51717209815979
Epoch:54,validate loss:0.46456027030944824
Epoch:55,validate loss:0.44488343596458435
Epoch:56,validate loss:0.44766101241111755
Epoch:57,validate loss:0.5024468302726746
Epoch:58,validate loss:0.4733254313468933
Epoch:59,validate loss:0.47981226444244385
Epoch:60,validate loss:0.4739449918270111
Epoch:61,validate loss:0.4702988564968109
Epoch:62,validate loss:0.4537275433540344
Epoch:63,validate loss:0.4572838246822357
Epoch:64,validate loss:0.45645105838775635
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.3267, Test MAPE: 0.0356, Test RMSE: 0.5709
Evaluate model on site 2 , Test MAE: 0.5202, Test MAPE: 0.0674, Test RMSE: 0.8487
Evaluate model on site 3 , Test MAE: 0.2768, Test MAPE: 0.0886, Test RMSE: 0.6065
Evaluate model on site 4 , Test MAE: 0.5148, Test MAPE: 0.1083, Test RMSE: 0.9020
Evaluate model on site 5 , Test MAE: 0.4176, Test MAPE: 0.0933, Test RMSE: 0.7644
Evaluate model on site 6 , Test MAE: 0.6823, Test MAPE: 0.2088, Test RMSE: 1.1597
Evaluate model on site 7 , Test MAE: 0.4805, Test MAPE: 0.1239, Test RMSE: 0.7989
Evaluate model on site 8 , Test MAE: 0.5427, Test MAPE: 0.0982, Test RMSE: 1.1077
Evaluate model on site 9 , Test MAE: 0.5567, Test MAPE: 0.1069, Test RMSE: 0.9787
Evaluate model on site 10 , Test MAE: 0.4059, Test MAPE: 0.5182, Test RMSE: 0.7348
On average over all site, Test MAE: 0.4724, Test MAPE: 0.1449, Test RMSE: 0.8472
(0.4724140852689743, 0.144929975643754, 0.8472315073013306)
data::data/water/shangban/singleFac/8,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/8', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=False, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.7992992997169495
Validation loss decreased (inf --> 0.799299).  Saving model ...
Epoch:2,validate loss:0.5254628658294678
Validation loss decreased (0.799299 --> 0.525463).  Saving model ...
Epoch:3,validate loss:0.47087982296943665
Validation loss decreased (0.525463 --> 0.470880).  Saving model ...
Epoch:4,validate loss:0.5139880180358887
Epoch:5,validate loss:0.4807155728340149
Epoch:6,validate loss:0.49316146969795227
Epoch:7,validate loss:0.467119425535202
Validation loss decreased (0.470880 --> 0.467119).  Saving model ...
Epoch:8,validate loss:0.46921688318252563
Epoch:9,validate loss:0.45546460151672363
Validation loss decreased (0.467119 --> 0.455465).  Saving model ...
Epoch:10,validate loss:0.4706387519836426
Epoch:11,validate loss:0.4815370738506317
Epoch:12,validate loss:0.49402907490730286
Epoch:13,validate loss:0.5148988962173462
Epoch:14,validate loss:0.4703473746776581
Epoch:15,validate loss:0.45268481969833374
Validation loss decreased (0.455465 --> 0.452685).  Saving model ...
Epoch:16,validate loss:0.4564010202884674
Epoch:17,validate loss:0.46452441811561584
Epoch:18,validate loss:0.4506259560585022
Validation loss decreased (0.452685 --> 0.450626).  Saving model ...
Epoch:19,validate loss:0.4753938317298889
Epoch:20,validate loss:0.474895715713501
Epoch:21,validate loss:0.4621163308620453
Epoch:22,validate loss:0.4770820140838623
Epoch:23,validate loss:0.4767628014087677
Epoch:24,validate loss:0.468574196100235
Epoch:25,validate loss:0.45763516426086426
Epoch:26,validate loss:0.4711216986179352
Epoch:27,validate loss:0.47772032022476196
Epoch:28,validate loss:0.4556824564933777
Epoch:29,validate loss:0.45227551460266113
Epoch:30,validate loss:0.4741160273551941
Epoch:31,validate loss:0.45314955711364746
Epoch:32,validate loss:0.47441816329956055
Epoch:33,validate loss:0.45850303769111633
Epoch:34,validate loss:0.474653959274292
Epoch:35,validate loss:0.4741464853286743
Epoch:36,validate loss:0.48560646176338196
Epoch:37,validate loss:0.45738670229911804
Epoch:38,validate loss:0.516581118106842
Early stopping.
Training finished
Evaluate model on site 1 , Test MAE: 0.3369, Test MAPE: 0.0366, Test RMSE: 0.5772
Evaluate model on site 2 , Test MAE: 0.5287, Test MAPE: 0.0680, Test RMSE: 0.8599
Evaluate model on site 3 , Test MAE: 0.2937, Test MAPE: 0.0981, Test RMSE: 0.6119
Evaluate model on site 4 , Test MAE: 0.5108, Test MAPE: 0.1068, Test RMSE: 0.9087
Evaluate model on site 5 , Test MAE: 0.4197, Test MAPE: 0.0941, Test RMSE: 0.7645
Evaluate model on site 6 , Test MAE: 0.6857, Test MAPE: 0.2101, Test RMSE: 1.1577
Evaluate model on site 7 , Test MAE: 0.4761, Test MAPE: 0.1242, Test RMSE: 0.7881
Evaluate model on site 8 , Test MAE: 0.5409, Test MAPE: 0.1031, Test RMSE: 1.0856
Evaluate model on site 9 , Test MAE: 0.5642, Test MAPE: 0.1090, Test RMSE: 0.9779
Evaluate model on site 10 , Test MAE: 0.3991, Test MAPE: 0.5297, Test RMSE: 0.7182
On average over all site, Test MAE: 0.4756, Test MAPE: 0.1480, Test RMSE: 0.8450
(0.4755811750888824, 0.14798447974026202, 0.8449647068977356)
[0.480004745721817, 0.48187865912914274, 0.4808449983596802, 0.4724140852689743, 0.4755811750888824]
data::data/water/shangban/singleFac/8,running 1 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/8', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.7287149429321289
Validation loss decreased (inf --> 0.728715).  Saving model ...
Epoch:2,validate loss:0.5461018085479736
Validation loss decreased (0.728715 --> 0.546102).  Saving model ...
Epoch:3,validate loss:0.4788229167461395
Validation loss decreased (0.546102 --> 0.478823).  Saving model ...
Epoch:4,validate loss:0.4800722897052765
Epoch:5,validate loss:0.519433319568634
Epoch:6,validate loss:0.47048959136009216
Validation loss decreased (0.478823 --> 0.470490).  Saving model ...
Epoch:7,validate loss:0.5496063232421875
Epoch:8,validate loss:0.5197891592979431
Epoch:9,validate loss:0.5188668370246887
Epoch:10,validate loss:0.4705050587654114
Epoch:11,validate loss:0.484361469745636
Epoch:12,validate loss:0.48629292845726013
Epoch:13,validate loss:0.46758225560188293
Validation loss decreased (0.470490 --> 0.467582).  Saving model ...
Epoch:14,validate loss:0.44780853390693665
Validation loss decreased (0.467582 --> 0.447809).  Saving model ...
Epoch:15,validate loss:0.5259618163108826
Epoch:16,validate loss:0.4742741882801056
Epoch:17,validate loss:0.5257394909858704
Epoch:18,validate loss:0.4641231596469879
Epoch:19,validate loss:0.45209524035453796
Epoch:20,validate loss:0.46676257252693176
Epoch:21,validate loss:0.4660354256629944
Epoch:22,validate loss:0.45465734601020813
Epoch:23,validate loss:0.4738861918449402
Epoch:24,validate loss:0.5310872197151184
Epoch:25,validate loss:0.48298966884613037
Epoch:26,validate loss:0.4779745936393738
Epoch:27,validate loss:0.45580586791038513
Epoch:28,validate loss:0.45502322912216187
Epoch:29,validate loss:0.46424299478530884
Epoch:30,validate loss:0.45978468656539917
Epoch:31,validate loss:0.44548818469047546
Validation loss decreased (0.447809 --> 0.445488).  Saving model ...
Epoch:32,validate loss:0.44223347306251526
Validation loss decreased (0.445488 --> 0.442233).  Saving model ...
Epoch:33,validate loss:0.45379114151000977
Epoch:34,validate loss:0.49561941623687744
Epoch:35,validate loss:0.4577866792678833
Epoch:36,validate loss:0.4547337591648102
Epoch:37,validate loss:0.468688040971756
Epoch:38,validate loss:0.4619111120700836
Epoch:39,validate loss:0.446694016456604
Epoch:40,validate loss:0.4482455253601074
Epoch:41,validate loss:0.45806971192359924
Epoch:42,validate loss:0.4741986095905304
Epoch:43,validate loss:0.4712241291999817
Epoch:44,validate loss:0.4705488979816437
Epoch:45,validate loss:0.44155097007751465
Validation loss decreased (0.442233 --> 0.441551).  Saving model ...
Epoch:46,validate loss:0.4493976831436157
Epoch:47,validate loss:0.4571509063243866
Epoch:48,validate loss:0.4995259940624237
Epoch:49,validate loss:0.4671289920806885
Epoch:50,validate loss:0.4614982306957245
Epoch:51,validate loss:0.45140454173088074
Epoch:52,validate loss:0.4700666069984436
Epoch:53,validate loss:0.44446685910224915
Epoch:54,validate loss:0.4484127163887024
Epoch:55,validate loss:0.4810510277748108
Epoch:56,validate loss:0.4468148350715637
Epoch:57,validate loss:0.46477070450782776
Epoch:58,validate loss:0.4764539301395416
Epoch:59,validate loss:0.4789343774318695
Epoch:60,validate loss:0.46091267466545105
Epoch:61,validate loss:0.4759959876537323
Epoch:62,validate loss:0.49237996339797974
Epoch:63,validate loss:0.45415136218070984
Epoch:64,validate loss:0.45399731397628784
Epoch:65,validate loss:0.46314603090286255
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
5.898142e-10,5.898142e-10,5.898142e-10,0.0047111874,1.5984575e-08,5.898142e-10,2.7193778e-09,5.898142e-10,0.98602194,0.009266945,
4.844068e-05,4.844068e-05,0.98819274,4.844068e-05,4.844068e-05,4.844068e-05,0.0005680872,0.010900152,4.844068e-05,4.844068e-05,
6.2272953e-10,5.9617726e-08,0.0012882466,8.851868e-10,1.3431487e-09,7.69535e-09,6.2272953e-10,1.728134e-09,6.2272953e-10,0.9987116,
1.358238e-06,1.358238e-06,1.358238e-06,3.0332424e-06,5.3353283e-06,1.358238e-06,1.3292282e-05,1.358238e-06,1.358238e-06,0.9999703,
0.0003161777,0.0003161777,0.0003161777,0.0003161777,0.0003161777,0.99715436,0.0003161777,0.0003161777,0.0003161777,0.0003161777,
4.9993282e-08,0.9904891,7.806499e-06,4.699871e-06,4.9993282e-08,2.7702336e-06,0.002082869,0.0074125296,4.9993282e-08,4.9993282e-08,
9.8469094e-08,9.8469094e-08,9.8469094e-08,9.8469094e-08,9.8469094e-08,4.1966047e-07,0.99966526,9.8469094e-08,9.8469094e-08,0.000333672,
8.575119e-07,0.00011326167,5.378815e-08,7.0309696e-08,5.378815e-08,5.378815e-08,5.378815e-08,0.99988544,5.378815e-08,5.378815e-08,
2.6850757e-06,2.6850757e-06,5.007742e-05,2.6850757e-06,0.9974503,2.8202985e-05,2.6850757e-06,0.00245525,2.6850757e-06,2.6850757e-06,
3.8104164e-09,3.9809737e-07,1.024119e-09,1.024119e-09,4.6513584e-09,1.024119e-09,8.476565e-06,2.4258765e-05,1.024119e-09,0.99996686,
Evaluate model on site 1 , Test MAE: 0.3155, Test MAPE: 0.0348, Test RMSE: 0.5607
Evaluate model on site 2 , Test MAE: 0.5071, Test MAPE: 0.0660, Test RMSE: 0.8034
Evaluate model on site 3 , Test MAE: 0.2777, Test MAPE: 0.0959, Test RMSE: 0.5961
Evaluate model on site 4 , Test MAE: 0.5075, Test MAPE: 0.1068, Test RMSE: 0.9156
Evaluate model on site 5 , Test MAE: 0.4137, Test MAPE: 0.0915, Test RMSE: 0.7603
Evaluate model on site 6 , Test MAE: 0.6790, Test MAPE: 0.2064, Test RMSE: 1.1486
Evaluate model on site 7 , Test MAE: 0.4705, Test MAPE: 0.1228, Test RMSE: 0.7732
Evaluate model on site 8 , Test MAE: 0.5357, Test MAPE: 0.0986, Test RMSE: 1.1000
Evaluate model on site 9 , Test MAE: 0.5510, Test MAPE: 0.1073, Test RMSE: 0.9655
Evaluate model on site 10 , Test MAE: 0.3868, Test MAPE: 0.5256, Test RMSE: 0.6939
On average over all site, Test MAE: 0.4645, Test MAPE: 0.1456, Test RMSE: 0.8317
(0.46445582509040834, 0.14556314535439013, 0.8317263126373291)
data::data/water/shangban/singleFac/8,running 2 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/8', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.6337133049964905
Validation loss decreased (inf --> 0.633713).  Saving model ...
Epoch:2,validate loss:0.4808819591999054
Validation loss decreased (0.633713 --> 0.480882).  Saving model ...
Epoch:3,validate loss:0.49458131194114685
Epoch:4,validate loss:0.5019001960754395
Epoch:5,validate loss:0.4643842279911041
Validation loss decreased (0.480882 --> 0.464384).  Saving model ...
Epoch:6,validate loss:0.46708807349205017
Epoch:7,validate loss:0.4624761939048767
Validation loss decreased (0.464384 --> 0.462476).  Saving model ...
Epoch:8,validate loss:0.4553874433040619
Validation loss decreased (0.462476 --> 0.455387).  Saving model ...
Epoch:9,validate loss:0.4855077862739563
Epoch:10,validate loss:0.47278472781181335
Epoch:11,validate loss:0.4742228090763092
Epoch:12,validate loss:0.4759764075279236
Epoch:13,validate loss:0.48959389328956604
Epoch:14,validate loss:0.476279079914093
Epoch:15,validate loss:0.4586735665798187
Epoch:16,validate loss:0.5383874773979187
Epoch:17,validate loss:0.4596159756183624
Epoch:18,validate loss:0.45242801308631897
Validation loss decreased (0.455387 --> 0.452428).  Saving model ...
Epoch:19,validate loss:0.47032251954078674
Epoch:20,validate loss:0.4818912744522095
Epoch:21,validate loss:0.4639091193675995
Epoch:22,validate loss:0.4728761315345764
Epoch:23,validate loss:0.4556231200695038
Epoch:24,validate loss:0.4527466297149658
Epoch:25,validate loss:0.4580336809158325
Epoch:26,validate loss:0.5255270600318909
Epoch:27,validate loss:0.5133239030838013
Epoch:28,validate loss:0.45168325304985046
Validation loss decreased (0.452428 --> 0.451683).  Saving model ...
Epoch:29,validate loss:0.4771237373352051
Epoch:30,validate loss:0.4520588219165802
Epoch:31,validate loss:0.45595335960388184
Epoch:32,validate loss:0.45698896050453186
Epoch:33,validate loss:0.44660329818725586
Validation loss decreased (0.451683 --> 0.446603).  Saving model ...
Epoch:34,validate loss:0.45710134506225586
Epoch:35,validate loss:0.4730594754219055
Epoch:36,validate loss:0.48102325201034546
Epoch:37,validate loss:0.4813312888145447
Epoch:38,validate loss:0.4640612304210663
Epoch:39,validate loss:0.4635196924209595
Epoch:40,validate loss:0.4580745995044708
Epoch:41,validate loss:0.47458529472351074
Epoch:42,validate loss:0.46720996499061584
Epoch:43,validate loss:0.4558609127998352
Epoch:44,validate loss:0.457623690366745
Epoch:45,validate loss:0.4753779470920563
Epoch:46,validate loss:0.4608656167984009
Epoch:47,validate loss:0.4884704351425171
Epoch:48,validate loss:0.4754880368709564
Epoch:49,validate loss:0.45578017830848694
Epoch:50,validate loss:0.45592278242111206
Epoch:51,validate loss:0.4561934173107147
Epoch:52,validate loss:0.45350518822669983
Epoch:53,validate loss:0.4545688331127167
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
1.5438522e-05,1.5438522e-05,0.00046717905,0.9991116,1.5438522e-05,1.5438522e-05,1.5438522e-05,1.5438522e-05,8.8541696e-05,0.00024002069,
5.091162e-11,1.1969835e-09,4.701605e-09,5.091162e-11,0.9989588,2.6841144e-06,1.30514355e-08,2.2464139e-08,0.0010382304,3.081877e-07,
0.0022650496,0.9971867,3.6678226e-12,7.9504903e-13,7.9504903e-13,2.598283e-08,3.3821406e-09,1.5811507e-11,7.9504903e-13,0.0005482665,
1.1339853e-08,4.875703e-09,4.875703e-09,0.0007635428,0.00044801942,4.875703e-09,0.9987251,4.1433184e-05,4.875703e-09,2.1845002e-05,
2.0176267e-06,0.0031934364,2.4584386e-09,0.9959234,0.00088111014,2.4584386e-09,2.4584386e-09,2.4584386e-09,2.4584386e-09,2.4584386e-09,
4.8281356e-14,7.587678e-05,8.154779e-13,3.3065248e-06,1.375261e-13,4.8281356e-14,4.8281356e-14,4.8281356e-14,1.3986751e-13,0.9999207,
0.00097152643,0.00061560265,0.99735487,2.0345315e-06,9.473996e-06,2.0345315e-06,2.0345315e-06,0.0010048524,1.5474572e-05,2.2112145e-05,
1.7335933e-05,4.349626e-06,4.349626e-06,4.349626e-06,0.0016444214,4.349626e-06,4.349626e-06,0.99828416,2.7801621e-05,4.349626e-06,
2.4476874e-11,2.4476874e-11,1.0,2.4476874e-11,2.4476874e-11,2.4476874e-11,1.0180196e-10,2.4476874e-11,2.4476874e-11,2.4476874e-11,
0.00035772705,1.5704804e-06,1.5704804e-06,0.99849737,1.5704804e-06,0.0010955199,3.9989376e-05,1.5704804e-06,1.5704804e-06,1.5704804e-06,
Evaluate model on site 1 , Test MAE: 0.3304, Test MAPE: 0.0364, Test RMSE: 0.5639
Evaluate model on site 2 , Test MAE: 0.5082, Test MAPE: 0.0665, Test RMSE: 0.7988
Evaluate model on site 3 , Test MAE: 0.2705, Test MAPE: 0.0884, Test RMSE: 0.6003
Evaluate model on site 4 , Test MAE: 0.5158, Test MAPE: 0.1081, Test RMSE: 0.9069
Evaluate model on site 5 , Test MAE: 0.4105, Test MAPE: 0.0916, Test RMSE: 0.7418
Evaluate model on site 6 , Test MAE: 0.6817, Test MAPE: 0.2069, Test RMSE: 1.1610
Evaluate model on site 7 , Test MAE: 0.4777, Test MAPE: 0.1238, Test RMSE: 0.7736
Evaluate model on site 8 , Test MAE: 0.5339, Test MAPE: 0.0994, Test RMSE: 1.0937
Evaluate model on site 9 , Test MAE: 0.5640, Test MAPE: 0.1084, Test RMSE: 0.9993
Evaluate model on site 10 , Test MAE: 0.4072, Test MAPE: 0.5205, Test RMSE: 0.7342
On average over all site, Test MAE: 0.4700, Test MAPE: 0.1450, Test RMSE: 0.8374
(0.4699820101261139, 0.14501142241060733, 0.8373641729354858)
data::data/water/shangban/singleFac/8,running 3 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/8', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.6185476183891296
Validation loss decreased (inf --> 0.618548).  Saving model ...
Epoch:2,validate loss:0.5157368779182434
Validation loss decreased (0.618548 --> 0.515737).  Saving model ...
Epoch:3,validate loss:0.4919772148132324
Validation loss decreased (0.515737 --> 0.491977).  Saving model ...
Epoch:4,validate loss:0.492188423871994
Epoch:5,validate loss:0.5101610422134399
Epoch:6,validate loss:0.4918375611305237
Validation loss decreased (0.491977 --> 0.491838).  Saving model ...
Epoch:7,validate loss:0.47727978229522705
Validation loss decreased (0.491838 --> 0.477280).  Saving model ...
Epoch:8,validate loss:0.499237984418869
Epoch:9,validate loss:0.4821878671646118
Epoch:10,validate loss:0.4746165871620178
Validation loss decreased (0.477280 --> 0.474617).  Saving model ...
Epoch:11,validate loss:0.4627209007740021
Validation loss decreased (0.474617 --> 0.462721).  Saving model ...
Epoch:12,validate loss:0.46849676966667175
Epoch:13,validate loss:0.583976149559021
Epoch:14,validate loss:0.46156245470046997
Validation loss decreased (0.462721 --> 0.461562).  Saving model ...
Epoch:15,validate loss:0.47910064458847046
Epoch:16,validate loss:0.45751720666885376
Validation loss decreased (0.461562 --> 0.457517).  Saving model ...
Epoch:17,validate loss:0.5083377361297607
Epoch:18,validate loss:0.46039146184921265
Epoch:19,validate loss:0.49989402294158936
Epoch:20,validate loss:0.5156996846199036
Epoch:21,validate loss:0.5229704976081848
Epoch:22,validate loss:0.5217565894126892
Epoch:23,validate loss:0.490325391292572
Epoch:24,validate loss:0.4696950614452362
Epoch:25,validate loss:0.4555692970752716
Validation loss decreased (0.457517 --> 0.455569).  Saving model ...
Epoch:26,validate loss:0.45148196816444397
Validation loss decreased (0.455569 --> 0.451482).  Saving model ...
Epoch:27,validate loss:0.4695775806903839
Epoch:28,validate loss:0.4944937527179718
Epoch:29,validate loss:0.48133790493011475
Epoch:30,validate loss:0.46051111817359924
Epoch:31,validate loss:0.5556804537773132
Epoch:32,validate loss:0.48260369896888733
Epoch:33,validate loss:0.4916616678237915
Epoch:34,validate loss:0.46444088220596313
Epoch:35,validate loss:0.4678958058357239
Epoch:36,validate loss:0.4633483588695526
Epoch:37,validate loss:0.48400822281837463
Epoch:38,validate loss:0.5187416076660156
Epoch:39,validate loss:0.46240130066871643
Epoch:40,validate loss:0.4896986186504364
Epoch:41,validate loss:0.5018278360366821
Epoch:42,validate loss:0.4643050730228424
Epoch:43,validate loss:0.5513452887535095
Epoch:44,validate loss:0.4599057137966156
Epoch:45,validate loss:0.47288909554481506
Epoch:46,validate loss:0.4908839166164398
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
0.99999845,2.2401467e-12,4.0110745e-12,2.318352e-08,2.2401467e-12,1.5686443e-06,2.1226474e-09,2.2401467e-12,1.2863081e-11,3.1332426e-09,
0.001123832,0.99887604,1.5602484e-13,7.437232e-08,1.5602484e-13,1.5602484e-13,1.5602484e-13,1.5602484e-13,1.0778484e-12,3.0654107e-10,
1.9857385e-11,1.9857385e-11,1.9857385e-11,1.9857385e-11,1.9857385e-11,1.9857385e-11,0.014420481,3.3187368e-06,0.9855762,1.9857385e-11,
8.300582e-06,0.0014852583,1.275621e-06,1.9705535e-06,0.000937511,1.275621e-06,0.0004285931,0.011891889,6.878694e-06,0.98523694,
1.0734878e-08,0.9999999,1.0734878e-08,1.0734878e-08,1.0734878e-08,1.0734878e-08,1.0734878e-08,1.3523189e-07,1.0734878e-08,1.0734878e-08,
2.027093e-06,3.3058934e-16,3.3058934e-16,3.3058934e-16,3.3058934e-16,3.3058934e-16,0.999998,3.3058934e-16,2.247807e-12,3.3006187e-09,
2.4364604e-07,0.0007726926,7.133114e-18,7.133114e-18,5.308493e-13,1.570637e-09,0.99922705,7.133114e-18,7.133114e-18,7.397625e-11,
5.4663964e-11,5.4663964e-11,5.4663964e-11,0.9849318,1.7337846e-06,0.015066458,5.4663964e-11,5.4663964e-11,4.6184281e-10,5.4663964e-11,
0.0001275739,0.999821,2.5883402e-09,2.5883402e-09,2.5883402e-09,2.5883402e-09,2.5883402e-09,9.956104e-07,2.5883402e-09,5.0514398e-05,
5.768745e-05,1.0671787e-07,2.6167493e-09,0.9999356,2.6167493e-09,2.6167493e-09,2.6167493e-09,6.4976352e-06,2.6167493e-09,6.035143e-09,
Evaluate model on site 1 , Test MAE: 0.3217, Test MAPE: 0.0353, Test RMSE: 0.5624
Evaluate model on site 2 , Test MAE: 0.5311, Test MAPE: 0.0681, Test RMSE: 0.8335
Evaluate model on site 3 , Test MAE: 0.2805, Test MAPE: 0.0926, Test RMSE: 0.6057
Evaluate model on site 4 , Test MAE: 0.5003, Test MAPE: 0.1043, Test RMSE: 0.8814
Evaluate model on site 5 , Test MAE: 0.4144, Test MAPE: 0.0928, Test RMSE: 0.7565
Evaluate model on site 6 , Test MAE: 0.6780, Test MAPE: 0.2066, Test RMSE: 1.1461
Evaluate model on site 7 , Test MAE: 0.4781, Test MAPE: 0.1231, Test RMSE: 0.7905
Evaluate model on site 8 , Test MAE: 0.5465, Test MAPE: 0.1046, Test RMSE: 1.1002
Evaluate model on site 9 , Test MAE: 0.5476, Test MAPE: 0.1047, Test RMSE: 0.9649
Evaluate model on site 10 , Test MAE: 0.3921, Test MAPE: 0.5094, Test RMSE: 0.7165
On average over all site, Test MAE: 0.4690, Test MAPE: 0.1442, Test RMSE: 0.8358
(0.46903621554374697, 0.14415428936481475, 0.8357882797718048)
data::data/water/shangban/singleFac/8,running 4 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/8', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.5954166054725647
Validation loss decreased (inf --> 0.595417).  Saving model ...
Epoch:2,validate loss:0.5071638822555542
Validation loss decreased (0.595417 --> 0.507164).  Saving model ...
Epoch:3,validate loss:0.4763159155845642
Validation loss decreased (0.507164 --> 0.476316).  Saving model ...
Epoch:4,validate loss:0.4806347191333771
Epoch:5,validate loss:0.4982776343822479
Epoch:6,validate loss:0.4914622902870178
Epoch:7,validate loss:0.5453317165374756
Epoch:8,validate loss:0.4668842852115631
Validation loss decreased (0.476316 --> 0.466884).  Saving model ...
Epoch:9,validate loss:0.4639798700809479
Validation loss decreased (0.466884 --> 0.463980).  Saving model ...
Epoch:10,validate loss:0.49492889642715454
Epoch:11,validate loss:0.4761914610862732
Epoch:12,validate loss:0.45839110016822815
Validation loss decreased (0.463980 --> 0.458391).  Saving model ...
Epoch:13,validate loss:0.5014669895172119
Epoch:14,validate loss:0.47957170009613037
Epoch:15,validate loss:0.4790925085544586
Epoch:16,validate loss:0.5021011829376221
Epoch:17,validate loss:0.4894084930419922
Epoch:18,validate loss:0.48137110471725464
Epoch:19,validate loss:0.4548038840293884
Validation loss decreased (0.458391 --> 0.454804).  Saving model ...
Epoch:20,validate loss:0.46461519598960876
Epoch:21,validate loss:0.44835835695266724
Validation loss decreased (0.454804 --> 0.448358).  Saving model ...
Epoch:22,validate loss:0.4685859978199005
Epoch:23,validate loss:0.47297403216362
Epoch:24,validate loss:0.4470705986022949
Validation loss decreased (0.448358 --> 0.447071).  Saving model ...
Epoch:25,validate loss:0.4891195595264435
Epoch:26,validate loss:0.4752020835876465
Epoch:27,validate loss:0.558137059211731
Epoch:28,validate loss:0.5709431767463684
Epoch:29,validate loss:0.4713350534439087
Epoch:30,validate loss:0.5022657513618469
Epoch:31,validate loss:0.4615040719509125
Epoch:32,validate loss:0.47626444697380066
Epoch:33,validate loss:0.4811711311340332
Epoch:34,validate loss:0.4904501140117645
Epoch:35,validate loss:0.4502793252468109
Epoch:36,validate loss:0.45159846544265747
Epoch:37,validate loss:0.4515129625797272
Epoch:38,validate loss:0.46211549639701843
Epoch:39,validate loss:0.45525285601615906
Epoch:40,validate loss:0.4482841193675995
Epoch:41,validate loss:0.4526478052139282
Epoch:42,validate loss:0.4566512703895569
Epoch:43,validate loss:0.4797321557998657
Epoch:44,validate loss:0.495922327041626
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
4.1780734e-10,4.1780734e-10,4.1780734e-10,4.1780734e-10,4.1780734e-10,4.1780734e-10,1.0,4.1780734e-10,4.1780734e-10,4.1780734e-10,
7.694613e-08,0.0040044333,7.694613e-08,7.694613e-08,3.4665492e-05,7.694613e-08,0.9936697,7.694613e-08,7.694613e-08,0.0022907206,
1.5171555e-09,7.575628e-05,6.584804e-10,2.1832677e-06,0.99992204,4.506809e-10,4.506809e-10,4.506809e-10,4.506809e-10,4.506809e-10,
0.9999999,2.7486877e-11,6.628509e-08,1.6555934e-08,2.0579624e-10,2.4099323e-11,2.4099323e-11,2.4099323e-11,2.877255e-08,2.4099323e-11,
2.0139905e-10,0.9999393,3.4048673e-09,6.1767757e-13,3.960113e-11,1.534751e-11,6.1767757e-13,1.420257e-08,6.068004e-05,6.1767757e-13,
0.00011524904,7.9960535e-12,7.9960535e-12,1.0524979e-07,0.0027592243,0.99712545,7.9960535e-12,7.9960535e-12,7.9960535e-12,7.9960535e-12,
3.5838244e-07,1.7798862e-06,3.5838244e-07,0.99999535,3.5838244e-07,3.5838244e-07,3.5838244e-07,3.5838244e-07,3.5838244e-07,3.5838244e-07,
3.7082362e-08,0.98784107,3.1241104e-10,5.0834613e-05,3.1241104e-10,0.011099278,3.1241104e-10,3.1241104e-10,7.189479e-07,0.0010079918,
5.350152e-09,5.350152e-09,5.350152e-09,0.99952877,5.350152e-09,5.350152e-09,4.7059048e-06,5.350152e-09,1.0859551e-06,0.00046545276,
3.3075929e-09,7.560062e-12,7.560062e-12,0.99997437,2.0209186e-06,7.560062e-12,7.560062e-12,2.364696e-05,7.560062e-12,6.082845e-11,
Evaluate model on site 1 , Test MAE: 0.3287, Test MAPE: 0.0359, Test RMSE: 0.5456
Evaluate model on site 2 , Test MAE: 0.5171, Test MAPE: 0.0660, Test RMSE: 0.8116
Evaluate model on site 3 , Test MAE: 0.2825, Test MAPE: 0.0943, Test RMSE: 0.5958
Evaluate model on site 4 , Test MAE: 0.5152, Test MAPE: 0.1092, Test RMSE: 0.8869
Evaluate model on site 5 , Test MAE: 0.4107, Test MAPE: 0.0913, Test RMSE: 0.7537
Evaluate model on site 6 , Test MAE: 0.6809, Test MAPE: 0.2043, Test RMSE: 1.1555
Evaluate model on site 7 , Test MAE: 0.4760, Test MAPE: 0.1232, Test RMSE: 0.7687
Evaluate model on site 8 , Test MAE: 0.5466, Test MAPE: 0.1048, Test RMSE: 1.0996
Evaluate model on site 9 , Test MAE: 0.5565, Test MAPE: 0.1063, Test RMSE: 0.9732
Evaluate model on site 10 , Test MAE: 0.3997, Test MAPE: 0.5212, Test RMSE: 0.7158
On average over all site, Test MAE: 0.4714, Test MAPE: 0.1456, Test RMSE: 0.8306
(0.47138906419277193, 0.14564548209309577, 0.8306426048278809)
data::data/water/shangban/singleFac/8,running 5 st
Namespace(addaptadj=True, adjdata='data/water/shangban/adjs/adj_shangban2.pkl', adjtype='doubletransition', aptonly=True, batch_size=64, data='data/water/shangban/singleFac/8', device='cuda:1', dropout=0.3, epochs=200, expid=1, gcn_bool=True, in_dim=2, learning_rate=0.001, nhid=32, num_nodes=10, print_every=50, randomadj=True, save='./garage/metr', seq_length=3, weight_decay=0.0001)
start training...
Epoch:1,validate loss:0.6671806573867798
Validation loss decreased (inf --> 0.667181).  Saving model ...
Epoch:2,validate loss:0.4976652264595032
Validation loss decreased (0.667181 --> 0.497665).  Saving model ...
Epoch:3,validate loss:0.5143475532531738
Epoch:4,validate loss:0.4690418839454651
Validation loss decreased (0.497665 --> 0.469042).  Saving model ...
Epoch:5,validate loss:0.5349382162094116
Epoch:6,validate loss:0.506603479385376
Epoch:7,validate loss:0.47595852613449097
Epoch:8,validate loss:0.49690911173820496
Epoch:9,validate loss:0.4735424220561981
Epoch:10,validate loss:0.4579853117465973
Validation loss decreased (0.469042 --> 0.457985).  Saving model ...
Epoch:11,validate loss:0.5402089357376099
Epoch:12,validate loss:0.4857757091522217
Epoch:13,validate loss:0.48334768414497375
Epoch:14,validate loss:0.5511672496795654
Epoch:15,validate loss:0.46976181864738464
Epoch:16,validate loss:0.4518217444419861
Validation loss decreased (0.457985 --> 0.451822).  Saving model ...
Epoch:17,validate loss:0.4584774971008301
Epoch:18,validate loss:0.4825490713119507
Epoch:19,validate loss:0.48611509799957275
Epoch:20,validate loss:0.4547017514705658
Epoch:21,validate loss:0.4703776240348816
Epoch:22,validate loss:0.45804741978645325
Epoch:23,validate loss:0.45242685079574585
Epoch:24,validate loss:0.48179394006729126
Epoch:25,validate loss:0.4541817009449005
Epoch:26,validate loss:0.44705167412757874
Validation loss decreased (0.451822 --> 0.447052).  Saving model ...
Epoch:27,validate loss:0.4528178870677948
Epoch:28,validate loss:0.49697741866111755
Epoch:29,validate loss:0.47880589962005615
Epoch:30,validate loss:0.4779949486255646
Epoch:31,validate loss:0.4791850745677948
Epoch:32,validate loss:0.49240028858184814
Epoch:33,validate loss:0.5264918208122253
Epoch:34,validate loss:0.44786855578422546
Epoch:35,validate loss:0.46139732003211975
Epoch:36,validate loss:0.4590475559234619
Epoch:37,validate loss:0.4483080506324768
Epoch:38,validate loss:0.4552643597126007
Epoch:39,validate loss:0.4483843147754669
Epoch:40,validate loss:0.44934535026550293
Epoch:41,validate loss:0.445111483335495
Validation loss decreased (0.447052 --> 0.445111).  Saving model ...
Epoch:42,validate loss:0.4765003025531769
Epoch:43,validate loss:0.46839284896850586
Epoch:44,validate loss:0.5242955684661865
Epoch:45,validate loss:0.455588161945343
Epoch:46,validate loss:0.4582712948322296
Epoch:47,validate loss:0.44525396823883057
Epoch:48,validate loss:0.44537463784217834
Epoch:49,validate loss:0.4681277275085449
Epoch:50,validate loss:0.4538364112377167
Epoch:51,validate loss:0.4858351945877075
Epoch:52,validate loss:0.4577825963497162
Epoch:53,validate loss:0.45448166131973267
Epoch:54,validate loss:0.47388094663619995
Epoch:55,validate loss:0.4765688180923462
Epoch:56,validate loss:0.47950273752212524
Epoch:57,validate loss:0.4490292966365814
Epoch:58,validate loss:0.46690502762794495
Epoch:59,validate loss:0.4587996304035187
Epoch:60,validate loss:0.4529314339160919
Epoch:61,validate loss:0.4516456127166748
Early stopping.
Training finished
邻接矩阵：min=0.000,max=1.000,avg=0.100
3.273223e-06,3.273223e-06,0.99937314,4.766364e-06,3.273223e-06,3.273223e-06,3.273223e-06,3.273223e-06,0.00058632117,1.623352e-05,
1.5916571e-12,9.157033e-08,1.5916571e-12,1.5916571e-12,0.014718981,1.8266801e-11,4.694033e-08,0.9852808,7.481732e-10,3.9679093e-12,
0.000561864,6.326699e-05,6.35041e-06,6.35041e-06,6.35041e-06,0.9966119,6.9934035e-06,0.0016826552,0.0010478633,6.35041e-06,
9.008371e-14,9.008371e-14,9.008371e-14,4.1086652e-12,3.9997324e-12,0.00023338519,1.7016413e-10,1.9657823e-13,0.99976665,6.228086e-10,
0.0021400542,7.704209e-08,6.941201e-08,3.4253912e-07,6.941201e-08,6.941201e-08,6.941201e-08,0.99785835,8.421589e-07,6.941201e-08,
9.766029e-06,1.4738974e-06,0.00014793655,2.3611062e-06,1.5633516e-08,5.5921333e-07,1.5633516e-08,0.00073610723,0.9987129,0.0003888376,
1.9589129e-11,2.5356009e-08,1.9589129e-11,5.593561e-08,3.780483e-09,1.3061195e-08,7.299292e-11,0.99820256,1.9589129e-11,0.0017973668,
2.3021868e-05,2.3021868e-05,2.3021868e-05,0.9964431,9.136822e-05,2.3021868e-05,2.3021868e-05,0.0011962003,2.3021868e-05,0.0021312744,
0.9951056,0.0041849087,5.393955e-08,5.393955e-08,9.966264e-06,0.000114922834,5.393955e-08,3.7180223e-07,0.00034506895,0.00023900293,
0.99494064,1.5750892e-07,2.4021344e-07,0.0050560916,4.4184583e-07,2.060385e-06,1.3572816e-08,1.3572816e-08,1.0936587e-07,1.9784082e-07,
Evaluate model on site 1 , Test MAE: 0.3138, Test MAPE: 0.0342, Test RMSE: 0.5353
Evaluate model on site 2 , Test MAE: 0.5149, Test MAPE: 0.0667, Test RMSE: 0.8308
Evaluate model on site 3 , Test MAE: 0.2698, Test MAPE: 0.0920, Test RMSE: 0.5934
Evaluate model on site 4 , Test MAE: 0.5076, Test MAPE: 0.1089, Test RMSE: 0.8851
Evaluate model on site 5 , Test MAE: 0.4221, Test MAPE: 0.0945, Test RMSE: 0.7729
Evaluate model on site 6 , Test MAE: 0.7003, Test MAPE: 0.2092, Test RMSE: 1.1803
Evaluate model on site 7 , Test MAE: 0.4743, Test MAPE: 0.1235, Test RMSE: 0.7830
Evaluate model on site 8 , Test MAE: 0.5346, Test MAPE: 0.1057, Test RMSE: 1.0894
Evaluate model on site 9 , Test MAE: 0.5269, Test MAPE: 0.1033, Test RMSE: 0.8973
Evaluate model on site 10 , Test MAE: 0.4023, Test MAPE: 0.5482, Test RMSE: 0.7140
On average over all site, Test MAE: 0.4667, Test MAPE: 0.1486, Test RMSE: 0.8282
(0.46665283739566804, 0.14861710257828237, 0.8281548321247101)
[0.46445582509040834, 0.4699820101261139, 0.46903621554374697, 0.47138906419277193, 0.46665283739566804]
------------------finished-----------------------
data==data/water/shangban/singleFac/0,gcn=0,MAE=0.1484
data==data/water/shangban/singleFac/0,gcn=1,MAE=0.1470
data==data/water/shangban/singleFac/1,gcn=0,MAE=0.5522
data==data/water/shangban/singleFac/1,gcn=1,MAE=0.5441
data==data/water/shangban/singleFac/2,gcn=0,MAE=0.0474
data==data/water/shangban/singleFac/2,gcn=1,MAE=0.0466
data==data/water/shangban/singleFac/3,gcn=0,MAE=0.3103
data==data/water/shangban/singleFac/3,gcn=1,MAE=0.3076
data==data/water/shangban/singleFac/6,gcn=0,MAE=0.8355
data==data/water/shangban/singleFac/6,gcn=1,MAE=0.8291
data==data/water/shangban/singleFac/8,gcn=0,MAE=0.4781
data==data/water/shangban/singleFac/8,gcn=1,MAE=0.4683


Process finished with exit code 0
